<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>CREATE COLLATION</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@lists.postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot" /><link rel="prev" href="sql-createcast.html" title="CREATE CAST" /><link rel="next" href="sql-createconversion.html" title="CREATE CONVERSION" /></head><body id="docContent" class="container-fluid col-10"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">CREATE COLLATION</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="sql-createcast.html" title="CREATE CAST">Пред.</a> </td><td width="10%" align="left"><a accesskey="u" href="sql-commands.html" title="Команды SQL">Наверх</a></td><th width="60%" align="center">Команды SQL</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="Документация к PostgreSQL 16.3">Начало</a></td><td width="10%" align="right"> <a accesskey="n" href="sql-createconversion.html" title="CREATE CONVERSION">След.</a></td></tr></table><hr /></div><div class="refentry" id="SQL-CREATECOLLATION"><div class="titlepage"></div><a id="id-1.9.3.59.1" class="indexterm"></a><div class="refnamediv"><h2><span class="refentrytitle">CREATE COLLATION</span></h2><p>CREATE COLLATION — создать правило сортировки</p></div><div class="refsynopsisdiv"><h2>Синтаксис</h2><pre class="synopsis">CREATE COLLATION [ IF NOT EXISTS ] <em class="replaceable"><code>имя</code></em> (
    [ LOCALE = <em class="replaceable"><code>локаль</code></em>, ]
    [ LC_COLLATE = <em class="replaceable"><code>категория_сортировки</code></em>, ]
    [ LC_CTYPE = <em class="replaceable"><code>категория_типов_символов</code></em>, ]
    [ PROVIDER = <em class="replaceable"><code>провайдер</code></em>, ]
    [ DETERMINISTIC = <em class="replaceable"><code>логическое_значение</code></em>, ]
    [ RULES = <em class="replaceable"><code>правила</code></em>, ]
    [ VERSION = <em class="replaceable"><code>версия</code></em> ]
)
CREATE COLLATION [ IF NOT EXISTS ] <em class="replaceable"><code>имя</code></em> FROM <em class="replaceable"><code>существующее_правило</code></em></pre></div><div class="refsect1" id="SQL-CREATECOLLATION-DESCRIPTION"><h2>Описание</h2><p><code class="command">CREATE COLLATION</code> определяет новое правило сортировки, используя параметры локали операционной системы, либо копируя существующее правило.</p><p>Чтобы создать правило сортировки, необходимо иметь право <code class="literal">CREATE</code> в целевой схеме.</p></div><div class="refsect1" id="id-1.9.3.59.6"><h2>Параметры</h2><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">IF NOT EXISTS</code></span></dt><dd><p>Не считать ошибкой, если правило сортировки с таким именем уже существует. В этом случае будет выдано замечание. Заметьте, что нет никакой гарантии, что существующее правило сортировки как-то соотносится с тем, которое могло бы быть создано.</p></dd><dt><span class="term"><em class="replaceable"><code>имя</code></em></span></dt><dd><p>Имя правила сортировки, возможно, дополненное схемой. Если схема не указана, правило сортировки создаётся в текущей схеме. Заданное имя правила должно быть уникальным в этой схеме. (Системные каталоги могут содержать правила сортировки с одним именем, но предназначенные для разных кодировок, однако они будут игнорироваться, если их кодировка не совпадает с кодировкой базы данных.)</p></dd><dt><span class="term"><em class="replaceable"><code>локаль</code></em></span></dt><dd><p>Имя локали для правила сортировки. За подробностями обратитесь к <a class="xref" href="collation.html#COLLATION-MANAGING-CREATE-LIBC" title="24.2.2.3.1. Правила сортировки libc">Подразделу 24.2.2.3.1</a> и <a class="xref" href="collation.html#COLLATION-MANAGING-CREATE-ICU" title="24.2.2.3.2. Правила сортировки ICU">Подразделу 24.2.2.3.2</a>.</p><p>Если указан <em class="replaceable"><code>провайдер</code></em> <code class="literal">libc</code>, это краткая запись для одновременной установки <code class="symbol">LC_COLLATE</code> и <code class="symbol">LC_CTYPE</code>. Если указана <em class="replaceable"><code>локаль</code></em>, задать любой из этих параметров отдельно нельзя.</p></dd><dt><span class="term"><em class="replaceable"><code>категория_сортировки</code></em></span></dt><dd><p>Если указан <em class="replaceable"><code>провайдер</code></em> <code class="literal">libc</code>, указанная локаль операционной системы устанавливается в качестве категории локали <code class="symbol">LC_COLLATE</code>.</p></dd><dt><span class="term"><em class="replaceable"><code>категория_типов_символов</code></em></span></dt><dd><p>Если указан <em class="replaceable"><code>провайдер</code></em> <code class="literal">libc</code>, указанная локаль операционной системы устанавливается в качестве категории локали <code class="symbol">LC_CTYPE</code>.</p></dd><dt><span class="term"><em class="replaceable"><code>провайдер</code></em></span></dt><dd><p>Задаёт провайдер, который будет использоваться для функций локализации, связанных с данным правилом сортировки. Возможные значения: <code class="literal">icu</code><a id="id-1.9.3.59.6.2.6.2.1.2" class="indexterm"></a> (если сервер собран с поддержкой ICU) или <code class="literal">libc</code>. По умолчанию выбирается <code class="literal">libc</code>. За подробностями обратитесь к <a class="xref" href="locale.html#LOCALE-PROVIDERS" title="24.1.4. Провайдеры локалей">Подразделу 24.1.4</a>.</p></dd><dt><span class="term"><code class="literal">DETERMINISTIC</code></span></dt><dd><p>Определяет, будет ли правило сортировки использовать детерминированное сравнение. По умолчанию выбирается именно такое сравнение. При детерминированном сравнении строки, состоящие из различных байтов, считаются неравными, даже если на логическом уровне они одинаковы. PostgreSQL решает вопрос их равенства, сравнивая их по байтам. Если же для правила сортировки выбрать недетерминированное сравнение, это правило может стать, например, независящим от ударения или регистра символов. Для этого необходимо выбрать подходящее значение <code class="literal">LOCALE</code> <span class="emphasis"><em>и</em></span> сделать это правило сортировки недетерминированным.</p><p>Недетерминированные правила сортировки поддерживаются только с провайдером ICU.</p></dd><dt><span class="term"><em class="replaceable"><code>правила</code></em></span></dt><dd><p>Указывает дополнительные правила для настройки поведения сортировки. Параметр поддерживается только для ICU. За дополнительной информацией обратитесь к <a class="xref" href="collation.html#ICU-TAILORING-RULES" title="24.2.3.4. Правила для сортировки ICU">Подразделу 24.2.3.4</a>.</p></dd><dt><span class="term"><em class="replaceable"><code>версия</code></em></span></dt><dd><p>Задаёт строку версии, сохраняемую с правилом сортировки. Обычно её не следует задавать — тогда эта версия будет получена из фактической версии правила сортировки, сообщённой операционной системой. Это указание предназначено для того, чтобы команда <code class="command">pg_upgrade</code> смогла скопировать версию из существующей инсталляции.</p><p>Что делать при несовпадении версий правил сортировки, описано в <a class="xref" href="sql-altercollation.html" title="ALTER COLLATION"><span class="refentrytitle">ALTER COLLATION</span></a>.</p></dd><dt><span class="term"><em class="replaceable"><code>существующее_правило</code></em></span></dt><dd><p>Имя копируемого существующего правила сортировки. Новое правило сортировки получит те же свойства, что и существующее, но будет независимым объектом.</p></dd></dl></div></div><div class="refsect1" id="SQL-CREATECOLLATION-NOTES"><h2>Замечания</h2><p>Команда <code class="command">CREATE COLLATION</code> устанавливает блокировку <code class="literal">SHARE ROW EXCLUSIVE</code> в системном каталоге <code class="structname">pg_collation</code>. Эта блокировка конфликтует с такой же, поэтому в один момент времени может выполняться только одна команда <code class="command">CREATE COLLATION</code>.</p><p>Для удаления созданных пользователем правил сортировки применяется команда <code class="command">DROP COLLATION</code>.</p><p>Подробнее узнать о создании правил сортировки можно в <a class="xref" href="collation.html#COLLATION-CREATE" title="24.2.2.3. Создание новых правил сортировки">Подразделе 24.2.2.3</a>.</p><p>Когда используется провайдер <code class="literal">libc</code>, локаль должна быть применимой к кодировке текущей базы данных. Точные правила описаны в <a class="xref" href="sql-createdatabase.html" title="CREATE DATABASE"><span class="refentrytitle">CREATE DATABASE</span></a>.</p></div><div class="refsect1" id="SQL-CREATECOLLATION-EXAMPLES"><h2>Примеры</h2><p>Создание правила сортировки из локали операционной системы <code class="literal">fr_FR.utf8</code> (предполагается, что кодировка текущей базы данных — <code class="literal">UTF8</code>): </p><pre class="programlisting">CREATE COLLATION french (locale = 'fr_FR.utf8');</pre><p>Создание правила сортировки с порядком, принятым в Германии для телефонных книг, с использованием провайдера ICU: </p><pre class="programlisting">CREATE COLLATION german_phonebook (provider = icu, locale = 'de-u-co-phonebk');</pre><p>Создание правила сортировки с пользовательскими условиями с использованием провайдера ICU на основе корневой локали ICU: </p><pre class="programlisting">
CREATE COLLATION custom (provider = icu, locale = 'und', rules = '&amp;V &lt;&lt; w &lt;&lt;&lt; W');
</pre><p> За дополнительной информацией и примерами синтаксиса правил обратитесь к <a class="xref" href="collation.html#ICU-TAILORING-RULES" title="24.2.3.4. Правила для сортировки ICU">Подразделу 24.2.3.4</a>.</p><p>Создание правила сортировки из уже существующего: </p><pre class="programlisting">CREATE COLLATION german FROM "de_DE";</pre><p> Иногда удобно использовать в приложениях имена правил сортировки, не зависящие от операционной системы.</p></div><div class="refsect1" id="SQL-CREATECOLLATION-COMPAT"><h2>Совместимость</h2><p>Оператор <code class="command">CREATE COLLATION</code> определён в стандарте SQL, но его действие ограничено копированием существующего правила сортировки. Синтаксис создания нового правила сортировки представляет собой расширение <span class="productname">PostgreSQL</span>.</p></div><div class="refsect1" id="SQL-CREATECOLLATION-SEEALSO"><h2>См. также</h2><span class="simplelist"><a class="xref" href="sql-altercollation.html" title="ALTER COLLATION"><span class="refentrytitle">ALTER COLLATION</span></a>, <a class="xref" href="sql-dropcollation.html" title="DROP COLLATION"><span class="refentrytitle">DROP COLLATION</span></a></span></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="sql-createcast.html" title="CREATE CAST">Пред.</a> </td><td width="20%" align="center"><a accesskey="u" href="sql-commands.html" title="Команды SQL">Наверх</a></td><td width="40%" align="right"> <a accesskey="n" href="sql-createconversion.html" title="CREATE CONVERSION">След.</a></td></tr><tr><td width="40%" align="left" valign="top">CREATE CAST </td><td width="20%" align="center"><a accesskey="h" href="index.html" title="Документация к PostgreSQL 16.3">Начало</a></td><td width="40%" align="right" valign="top"> CREATE CONVERSION</td></tr></table></div></body></html>