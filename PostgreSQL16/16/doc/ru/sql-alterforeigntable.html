<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>ALTER FOREIGN TABLE</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@lists.postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot" /><link rel="prev" href="sql-alterforeigndatawrapper.html" title="ALTER FOREIGN DATA WRAPPER" /><link rel="next" href="sql-alterfunction.html" title="ALTER FUNCTION" /></head><body id="docContent" class="container-fluid col-10"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">ALTER FOREIGN TABLE</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="sql-alterforeigndatawrapper.html" title="ALTER FOREIGN DATA WRAPPER">Пред.</a> </td><td width="10%" align="left"><a accesskey="u" href="sql-commands.html" title="Команды SQL">Наверх</a></td><th width="60%" align="center">Команды SQL</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="Документация к PostgreSQL 16.3">Начало</a></td><td width="10%" align="right"> <a accesskey="n" href="sql-alterfunction.html" title="ALTER FUNCTION">След.</a></td></tr></table><hr /></div><div class="refentry" id="SQL-ALTERFOREIGNTABLE"><div class="titlepage"></div><a id="id-1.9.3.13.1" class="indexterm"></a><div class="refnamediv"><h2><span class="refentrytitle">ALTER FOREIGN TABLE</span></h2><p>ALTER FOREIGN TABLE — изменить определение сторонней таблицы</p></div><div class="refsynopsisdiv"><h2>Синтаксис</h2><pre class="synopsis">ALTER FOREIGN TABLE [ IF EXISTS ] [ ONLY ] <em class="replaceable"><code>имя</code></em> [ * ]
    <em class="replaceable"><code>действие</code></em> [, ... ]
ALTER FOREIGN TABLE [ IF EXISTS ] [ ONLY ] <em class="replaceable"><code>имя</code></em> [ * ]
    RENAME [ COLUMN ] <em class="replaceable"><code>имя_столбца</code></em> TO <em class="replaceable"><code>новое_имя_столбца</code></em>
ALTER FOREIGN TABLE [ IF EXISTS ] <em class="replaceable"><code>имя</code></em>
    RENAME TO <em class="replaceable"><code>новое_имя</code></em>
ALTER FOREIGN TABLE [ IF EXISTS ] <em class="replaceable"><code>имя</code></em>
    SET SCHEMA <em class="replaceable"><code>новая_схема</code></em>

<span class="phrase">Где <em class="replaceable"><code>действие</code></em> может быть следующим:</span>

    ADD [ COLUMN ] <em class="replaceable"><code>имя_столбца</code></em> <em class="replaceable"><code>тип_данных</code></em> [ COLLATE <em class="replaceable"><code>правило_сортировки</code></em> ] [ <em class="replaceable"><code>ограничение_столбца</code></em> [ ... ] ]
    DROP [ COLUMN ] [ IF EXISTS ] <em class="replaceable"><code>имя_столбца</code></em> [ RESTRICT | CASCADE ]
    ALTER [ COLUMN ] <em class="replaceable"><code>имя_столбца</code></em> [ SET DATA ] TYPE <em class="replaceable"><code>тип_данных</code></em> [ COLLATE <em class="replaceable"><code>правило_сортировки</code></em> ]
    ALTER [ COLUMN ] <em class="replaceable"><code>имя_столбца</code></em> SET DEFAULT <em class="replaceable"><code>выражение</code></em>
    ALTER [ COLUMN ] <em class="replaceable"><code>имя_столбца</code></em> DROP DEFAULT
    ALTER [ COLUMN ] <em class="replaceable"><code>имя_столбца</code></em> { SET | DROP } NOT NULL
    ALTER [ COLUMN ] <em class="replaceable"><code>имя_столбца</code></em> SET STATISTICS <em class="replaceable"><code>integer</code></em>
    ALTER [ COLUMN ] <em class="replaceable"><code>имя_столбца</code></em> SET ( <em class="replaceable"><code>атрибут</code></em> = <em class="replaceable"><code>значение</code></em> [, ... ] )
    ALTER [ COLUMN ] <em class="replaceable"><code>имя_столбца</code></em> RESET ( <em class="replaceable"><code>атрибут</code></em> [, ... ] )
    ALTER [ COLUMN ] <em class="replaceable"><code>имя_столбца</code></em> SET STORAGE { PLAIN | EXTERNAL | EXTENDED | MAIN | DEFAULT }
    ALTER [ COLUMN ] <em class="replaceable"><code>имя_столбца</code></em> OPTIONS ( [ ADD | SET | DROP ] <em class="replaceable"><code>параметр</code></em> ['<em class="replaceable"><code>значение</code></em>'] [, ... ])
    ADD <em class="replaceable"><code>ограничение_таблицы</code></em> [ NOT VALID ]
    VALIDATE CONSTRAINT <em class="replaceable"><code>имя_ограничения</code></em>
    DROP CONSTRAINT [ IF EXISTS ]  <em class="replaceable"><code>имя_ограничения</code></em> [ RESTRICT | CASCADE ]
    DISABLE TRIGGER [ <em class="replaceable"><code>имя_триггера</code></em> | ALL | USER ]
    ENABLE TRIGGER [ <em class="replaceable"><code>имя_триггера</code></em> | ALL | USER ]
    ENABLE REPLICA TRIGGER <em class="replaceable"><code>имя_триггера</code></em>
    ENABLE ALWAYS TRIGGER <em class="replaceable"><code>имя_триггера</code></em>
    SET WITHOUT OIDS
    INHERIT <em class="replaceable"><code>таблица_родитель</code></em>
    NO INHERIT <em class="replaceable"><code>таблица_родитель</code></em>
    OWNER TO { <em class="replaceable"><code>новый_владелец</code></em> | CURRENT_ROLE | CURRENT_USER | SESSION_USER }
    OPTIONS ( [ ADD | SET | DROP ] <em class="replaceable"><code>параметр</code></em> ['<em class="replaceable"><code>значение</code></em>'] [, ... ])</pre></div><div class="refsect1" id="id-1.9.3.13.5"><h2>Описание</h2><p><code class="command">ALTER FOREIGN TABLE</code> меняет определение существующей сторонней таблицы. Эта команда имеет несколько разновидностей: </p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">ADD COLUMN</code></span></dt><dd><p>Эта форма добавляет в стороннюю таблицу новый столбец, следуя тому же синтаксису, что и <a class="link" href="sql-createforeigntable.html" title="CREATE FOREIGN TABLE"><code class="command">CREATE FOREIGN TABLE</code></a>. В отличие от добавления столбца в обычную таблицу, при данной операции в базовом хранилище ничего не меняется; эта команда просто объявляет о доступности нового столбца через данную стороннюю таблицу.</p></dd><dt><span class="term"><code class="literal">DROP COLUMN [ IF EXISTS ]</code></span></dt><dd><p>Эта форма удаляет столбец из сторонней таблицы. Если что-либо зависит от этого столбца, например, представление, для успешного результата потребуется добавить <code class="literal">CASCADE</code>. Если указано <code class="literal">IF EXISTS</code> и этот столбец не существует, ошибка не происходит, вместо этого выдаётся замечание.</p></dd><dt><span class="term"><code class="literal">SET DATA TYPE</code></span></dt><dd><p>Эта форма меняет тип столбца сторонней таблицы. И это не влияет на нижележащее хранилище: данная операция просто меняет тип, который по мнению <span class="productname">PostgreSQL</span> будет иметь этот столбец.</p></dd><dt><span class="term"><code class="literal">SET</code>/<code class="literal">DROP DEFAULT</code></span></dt><dd><p>Эти формы задают или удаляют значение по умолчанию для столбцов. Значения по умолчанию применяются только при последующих командах <code class="command">INSERT</code> или <code class="command">UPDATE</code>; их изменения не отражаются в строках, уже существующих в таблице.</p></dd><dt><span class="term"><code class="literal">SET</code>/<code class="literal">DROP NOT NULL</code></span></dt><dd><p>Устанавливает, будет ли столбец принимать значения NULL или нет.</p></dd><dt><span class="term"><code class="literal">SET STATISTICS</code></span></dt><dd><p>Эта форма задаёт ориентир сбора статистики по столбцам для последующих операций <a class="link" href="sql-analyze.html" title="ANALYZE"><code class="command">ANALYZE</code></a>. За подробностями обратитесь к описанию подобной формы <a class="link" href="sql-altertable.html" title="ALTER TABLE"><code class="command">ALTER TABLE</code></a>.</p></dd><dt><span class="term"><code class="literal">SET ( <em class="replaceable"><code>атрибут</code></em> = <em class="replaceable"><code>значение</code></em> [, ... ] )</code><br /></span><span class="term"><code class="literal">RESET ( <em class="replaceable"><code>атрибут</code></em> [, ... ] )</code></span></dt><dd><p>Эта форма задаёт или сбрасывает значения атрибутов. За подробностями обратитесь к описанию подобной формы <a class="link" href="sql-altertable.html" title="ALTER TABLE"><code class="command">ALTER TABLE</code></a>.</p></dd><dt><span class="term">
     <code class="literal">SET STORAGE</code>
    </span></dt><dd><p>Эта форма задаёт режим хранения для столбца. За подробностями обратитесь к описанию подобной формы <a class="link" href="sql-altertable.html" title="ALTER TABLE"><code class="command">ALTER TABLE</code></a>. Заметьте, что режим хранения не имеет значения, если обёртка сторонних данных для этой таблицы будет игнорировать его.</p></dd><dt><span class="term"><code class="literal">ADD <em class="replaceable"><code>ограничение_таблицы</code></em> [ NOT VALID ]</code></span></dt><dd><p>Эта форма добавляет новое ограничение в стороннюю таблицу с применением того же синтаксиса, что и <a class="link" href="sql-createforeigntable.html" title="CREATE FOREIGN TABLE"><code class="command">CREATE FOREIGN TABLE</code></a>. В настоящее время поддерживаются только ограничения <code class="literal">CHECK</code>.</p><p>В отличие от ограничения, добавляемого для обычной таблицы, ограничение сторонней таблицы фактически никак не проверяется; эта команда сводится просто к заявлению о том, что все строки в сторонней таблице предположительно удовлетворяют новому условию. (Подробнее это рассматривается в описании <a class="link" href="sql-createforeigntable.html" title="CREATE FOREIGN TABLE"><code class="command">CREATE FOREIGN TABLE</code></a>.) Если ограничение помечено как <code class="literal">NOT VALID</code> (непроверенное), сервер не будет полагать, что оно выполняется; такая запись делается только на случай использования в будущем.</p></dd><dt><span class="term"><code class="literal">VALIDATE CONSTRAINT</code></span></dt><dd><p>Эта форма отмечает ограничение, которая ранее было помечено <code class="literal">NOT VALID</code>, как проверенное. Собственно для проверки этого ограничения ничего не делается, но последующие запросы будут полагать, что оно действует.</p></dd><dt><span class="term"><code class="literal">DROP CONSTRAINT [ IF EXISTS ]</code></span></dt><dd><p>Эта форма удаляет указанное ограничение сторонней таблицы. Если указано <code class="literal">IF EXISTS</code> и заданное ограничение не существует, это не считается ошибкой. В этом случае выдаётся только замечание.</p></dd><dt><span class="term"><code class="literal">DISABLE</code>/<code class="literal">ENABLE [ REPLICA | ALWAYS ] TRIGGER</code></span></dt><dd><p>Эти формы управляют триггерами, принадлежащими сторонней таблице. За подробностями обратитесь к описанию подобной формы <a class="link" href="sql-altertable.html" title="ALTER TABLE"><code class="command">ALTER TABLE</code></a>.</p></dd><dt><span class="term"><code class="literal">SET WITHOUT OIDS</code></span></dt><dd><p>Синтаксис обратной совместимости для удаления системного столбца <code class="literal">oid</code>. Так как добавить системные столбцы <code class="literal">oid</code> теперь невозможно, это указание фактически не действует.</p></dd><dt><span class="term"><code class="literal">INHERIT <em class="replaceable"><code>таблица_родитель</code></em></code></span></dt><dd><p>Эта форма делает целевую стороннюю таблицу потомком указанной родительской таблицы. За подробностями обратитесь к описанию подобной формы <a class="link" href="sql-altertable.html" title="ALTER TABLE"><code class="command">ALTER TABLE</code></a>.</p></dd><dt><span class="term"><code class="literal">NO INHERIT <em class="replaceable"><code>таблица_родитель</code></em></code></span></dt><dd><p>Эта форма удаляет целевую стороннюю таблицу из списка потомков указанной родительской таблицы.</p></dd><dt><span class="term"><code class="literal">OWNER</code></span></dt><dd><p>Эта форма меняет владельца сторонней таблицы на заданного пользователя.</p></dd><dt><span class="term"><code class="literal">OPTIONS ( [ ADD | SET | DROP ] <em class="replaceable"><code>параметр</code></em> ['<em class="replaceable"><code>значение</code></em>'] [, ... ] )</code></span></dt><dd><p>Эта форма настраивает параметры сторонней таблицы или одного из её столбцов. <code class="literal">ADD</code>, <code class="literal">SET</code> и <code class="literal">DROP</code> определяют, какое действие будет выполнено (добавление, установка и удаление, соответственно). Если действие не задано явно, подразумевается <code class="literal">ADD</code>. Имена параметров не должны повторяться (хотя параметр таблицы и параметр столбца вполне могут иметь одно имя). Имена и значения параметров также проверяются библиотекой обёртки сторонних данных.</p></dd><dt><span class="term"><code class="literal">RENAME</code></span></dt><dd><p>Формы <code class="literal">RENAME</code> меняют имя сторонней таблицы или имя столбца в сторонней таблице.</p></dd><dt><span class="term"><code class="literal">SET SCHEMA</code></span></dt><dd><p>Эта форма переносит стороннюю таблицу в другую схему.</p></dd></dl></div><p>Все действия, кроме <code class="literal">RENAME</code> и <code class="literal">SET SCHEMA</code>, можно объединить в один список изменений и выполнить одновременно. Например, можно добавить несколько столбцов и/или изменить тип столбцов одной командой.</p><p>Если команда записана в виде <code class="literal">ALTER FOREIGN TABLE IF EXISTS ...</code> и сторонняя таблица не существует, это не считается ошибкой. В этом случае выдаётся только замечание.</p><p>Выполнить <code class="command">ALTER FOREIGN TABLE</code> может только владелец соответствующей таблицы. Чтобы сменить схему сторонней таблицы, необходимо также иметь право <code class="literal">CREATE</code> в новой схеме. Чтобы сменить владельца, необходимо иметь право <code class="literal">SET ROLE</code> для новой роли-владельца, а эта роль должна иметь право <code class="literal">CREATE</code> в схеме таблицы. (С такими ограничениями при смене владельца не происходит ничего такого, что нельзя было бы сделать, имея право удалить и вновь создать таблицу. Однако суперпользователь может сменить владельца таблицы в любом случае.) Чтобы добавить столбец или изменить тип столбца, также необходимо иметь право <code class="literal">USAGE</code> для его типа данных.</p></div><div class="refsect1" id="id-1.9.3.13.6"><h2>Параметры</h2><div class="variablelist"><dl class="variablelist"><dt><span class="term"><em class="replaceable"><code>имя</code></em></span></dt><dd><p>Имя (возможно, дополненное схемой) существующей сторонней таблицы, подлежащей изменению. Если перед именем таблицы указано <code class="literal">ONLY</code>, изменяется только заданная таблица. Без <code class="literal">ONLY</code> изменяется и заданная таблица, и все её потомки (если таковые есть). После имени таблицы можно также добавить необязательное указание <code class="literal">*</code>, чтобы явно обозначить, что изменению подлежат все дочерние таблицы.</p></dd><dt><span class="term"><em class="replaceable"><code>имя_столбца</code></em></span></dt><dd><p>Имя нового или существующего столбца.</p></dd><dt><span class="term"><em class="replaceable"><code>новое_имя_столбца</code></em></span></dt><dd><p>Новое имя существующего столбца.</p></dd><dt><span class="term"><em class="replaceable"><code>новое_имя</code></em></span></dt><dd><p>Новое имя таблицы.</p></dd><dt><span class="term"><em class="replaceable"><code>тип_данных</code></em></span></dt><dd><p>Тип данных нового столбца или новый тип данных существующего столбца.</p></dd><dt><span class="term"><em class="replaceable"><code>ограничение_таблицы</code></em></span></dt><dd><p>Новое ограничение уровня таблицы для сторонней таблицы.</p></dd><dt><span class="term"><em class="replaceable"><code>имя_ограничения</code></em></span></dt><dd><p>Имя существующего ограничения, подлежащего удалению.</p></dd><dt><span class="term"><code class="literal">CASCADE</code></span></dt><dd><p>Автоматически удалять объекты, зависящие от удаляемого столбца или ограничения (например, представления, содержащие этот столбец), и, в свою очередь, все зависящие от них объекты (см. <a class="xref" href="ddl-depend.html" title="5.14. Отслеживание зависимостей">Раздел 5.14</a>).</p></dd><dt><span class="term"><code class="literal">RESTRICT</code></span></dt><dd><p>Отказать в удалении столбца или ограничения, если существуют зависящие от них объекты. Это поведение по умолчанию.</p></dd><dt><span class="term"><em class="replaceable"><code>имя_триггера</code></em></span></dt><dd><p>Имя включаемого или отключаемого триггера.</p></dd><dt><span class="term"><code class="literal">ALL</code></span></dt><dd><p>Отключает или включает все триггеры, принадлежащие сторонней таблице. (Если какие-либо из триггеров являются внутрисистемными, для этого требуются права суперпользователя. Сама система не добавляет такие триггеры в сторонние таблицы, но дополнительный код может сделать это.)</p></dd><dt><span class="term"><code class="literal">USER</code></span></dt><dd><p>Отключает или включает все триггеры, принадлежащие сторонней таблице, кроме сгенерированных внутрисистемных.</p></dd><dt><span class="term"><em class="replaceable"><code>таблица_родитель</code></em></span></dt><dd><p>Родительская таблица, с которой будет установлена или разорвана связь данной сторонней таблицы.</p></dd><dt><span class="term"><em class="replaceable"><code>новый_владелец</code></em></span></dt><dd><p>Имя пользователя, назначаемого новым владельцем таблицы.</p></dd><dt><span class="term"><em class="replaceable"><code>новая_схема</code></em></span></dt><dd><p>Имя схемы, в которую будет перемещена таблица.</p></dd></dl></div></div><div class="refsect1" id="id-1.9.3.13.7"><h2>Замечания</h2><p>Ключевое слово <code class="literal">COLUMN</code> не несёт смысловой нагрузки и может быть опущено.</p><p>При добавлении или удалении столбцов (<code class="literal">ADD COLUMN</code>/<code class="literal">DROP COLUMN</code>), добавлении ограничений <code class="literal">NOT NULL</code> или <code class="literal">CHECK</code> или изменении типа данных (<code class="literal">SET DATA TYPE</code>) согласованность этих определений с внешним сервером не гарантируется. Ответственность за соответствие определений таблицы удалённой стороне лежит на пользователе.</p><p>За более полным описанием параметров обратитесь к <a class="link" href="sql-createforeigntable.html" title="CREATE FOREIGN TABLE"><code class="command">CREATE FOREIGN TABLE</code></a>.</p></div><div class="refsect1" id="id-1.9.3.13.8"><h2>Примеры</h2><p>Установление ограничения NOT NULL для столбца: </p><pre class="programlisting">ALTER FOREIGN TABLE distributors ALTER COLUMN street SET NOT NULL;</pre><p>Изменение параметров сторонней таблицы: </p><pre class="programlisting">ALTER FOREIGN TABLE myschema.distributors OPTIONS (ADD opt1 'value', SET opt2 'value2', DROP opt3);</pre></div><div class="refsect1" id="id-1.9.3.13.9"><h2>Совместимость</h2><p>Формы <code class="literal">ADD</code>, <code class="literal">DROP</code> и <code class="literal">SET DATA TYPE</code> соответствуют стандарту SQL. Другие формы являются собственными расширениями <span class="productname">PostgreSQL</span>. Кроме того, возможность указать в одной команде <code class="command">ALTER FOREIGN TABLE</code> несколько операций так же является расширением.</p><p><code class="command">ALTER FOREIGN TABLE DROP COLUMN</code> позволяет удалить единственный столбец сторонней таблицы и оставить таблицу без столбцов. Это является расширением стандарта SQL, который не допускает существование сторонних таблиц с нулём столбцов.</p></div><div class="refsect1" id="id-1.9.3.13.10"><h2>См. также</h2><span class="simplelist"><a class="xref" href="sql-createforeigntable.html" title="CREATE FOREIGN TABLE"><span class="refentrytitle">CREATE FOREIGN TABLE</span></a>, <a class="xref" href="sql-dropforeigntable.html" title="DROP FOREIGN TABLE"><span class="refentrytitle">DROP FOREIGN TABLE</span></a></span></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="sql-alterforeigndatawrapper.html" title="ALTER FOREIGN DATA WRAPPER">Пред.</a> </td><td width="20%" align="center"><a accesskey="u" href="sql-commands.html" title="Команды SQL">Наверх</a></td><td width="40%" align="right"> <a accesskey="n" href="sql-alterfunction.html" title="ALTER FUNCTION">След.</a></td></tr><tr><td width="40%" align="left" valign="top">ALTER FOREIGN DATA WRAPPER </td><td width="20%" align="center"><a accesskey="h" href="index.html" title="Документация к PostgreSQL 16.3">Начало</a></td><td width="40%" align="right" valign="top"> ALTER FUNCTION</td></tr></table></div></body></html>