<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>68.4. Реализация</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@lists.postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot" /><link rel="prev" href="gist-extensibility.html" title="68.3. Расширяемость" /><link rel="next" href="gist-examples.html" title="68.5. Примеры" /></head><body id="docContent" class="container-fluid col-10"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">68.4. Реализация</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="gist-extensibility.html" title="68.3. Расширяемость">Пред.</a> </td><td width="10%" align="left"><a accesskey="u" href="gist.html" title="Глава 68. Индексы GiST">Наверх</a></td><th width="60%" align="center">Глава 68. Индексы GiST</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="Документация к PostgreSQL 16.3">Начало</a></td><td width="10%" align="right"> <a accesskey="n" href="gist-examples.html" title="68.5. Примеры">След.</a></td></tr></table><hr /></div><div class="sect1" id="GIST-IMPLEMENTATION"><div class="titlepage"><div><div><h2 class="title" style="clear: both">68.4. Реализация <a href="#GIST-IMPLEMENTATION" class="id_link">#</a></h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="sect2"><a href="gist-implementation.html#GIST-BUFFERING-BUILD">68.4.1. Способы построения индексов GiST</a></span></dt></dl></div><div class="sect2" id="GIST-BUFFERING-BUILD"><div class="titlepage"><div><div><h3 class="title">68.4.1. Способы построения индексов GiST <a href="#GIST-BUFFERING-BUILD" class="id_link">#</a></h3></div></div></div><p>Самый простой способ построить индекс GiST — просто добавлять все записи одну за другой. Но для больших индексов это может занять много времени, поскольку если индексные кортежи разбросаны по всему индексу и он настолько велик, что не помещается в кеше, потребуется выполнить множество неупорядоченных операций ввода-вывода. <span class="productname">PostgreSQL</span> поддерживает два альтернативных метода начального построения индекса GiST: <em class="firstterm">с сортировкой</em> и <em class="firstterm">с буферизацией</em>.</p><p>Построение индекса с сортировкой возможно, только если все классы операторов, используемые индексом, предоставляют функцию <code class="function">sortsupport</code>, как описано в <a class="xref" href="gist-extensibility.html" title="68.3. Расширяемость">Раздел 68.3</a>. В таком случае данный метод используется по умолчанию, как оптимальный.</p><p>При построении индекса с буферизацией кортежи не вставляются в индекс немедленно. Это позволяет кардинально сократить число операций произвольного доступа, требующихся при обработке неупорядоченных наборов данных. Для хорошо упорядоченных наборов выигрыш может быть минимальным или вообще отсутствовать, так как всего несколько страниц будут принимать новые кортежи в один момент времени и эти страницы будут умещаться в кеше, даже если весь индекс очень большой.</p><p>При построении индекса с буферизацией приходится гораздо чаще вызывать функцию <code class="function">penalty</code> по сравнению с обычным построением, на что уходят дополнительные ресурсы процессора. Кроме того, буферам требуется временное место на диске, вплоть до размера результирующего индекса. Буферизация также может повлиять на качество результирующего индекса, как в положительную, так и в отрицательную сторону. Это влияние зависит от различных факторов, например, от распределения поступающих данных и от реализации класса операторов.</p><p>Если сортировка невозможна, по умолчанию при построении индекса GiST включается буферизация, когда размер индекса достигает значения <a class="xref" href="runtime-config-query.html#GUC-EFFECTIVE-CACHE-SIZE">effective_cache_size</a>. Буферизацию можно принудительно включить или отключить вручную с помощью параметра <code class="literal">buffering</code> команды CREATE INDEX. Поведение по умолчанию достаточно эффективно в большинстве случаев, но если входные данные упорядочены, выключив буферизацию, можно получить некоторое ускорение.</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="gist-extensibility.html" title="68.3. Расширяемость">Пред.</a> </td><td width="20%" align="center"><a accesskey="u" href="gist.html" title="Глава 68. Индексы GiST">Наверх</a></td><td width="40%" align="right"> <a accesskey="n" href="gist-examples.html" title="68.5. Примеры">След.</a></td></tr><tr><td width="40%" align="left" valign="top">68.3. Расширяемость </td><td width="20%" align="center"><a accesskey="h" href="index.html" title="Документация к PostgreSQL 16.3">Начало</a></td><td width="40%" align="right" valign="top"> 68.5. Примеры</td></tr></table></div></body></html>