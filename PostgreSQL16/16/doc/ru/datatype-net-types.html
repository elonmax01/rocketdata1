<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>8.9. Типы, описывающие сетевые адреса</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@lists.postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot" /><link rel="prev" href="datatype-geometric.html" title="8.8. Геометрические типы" /><link rel="next" href="datatype-bit.html" title="8.10. Битовые строки" /></head><body id="docContent" class="container-fluid col-10"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">8.9. Типы, описывающие сетевые адреса</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="datatype-geometric.html" title="8.8. Геометрические типы">Пред.</a> </td><td width="10%" align="left"><a accesskey="u" href="datatype.html" title="Глава 8. Типы данных">Наверх</a></td><th width="60%" align="center">Глава 8. Типы данных</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="Документация к PostgreSQL 16.3">Начало</a></td><td width="10%" align="right"> <a accesskey="n" href="datatype-bit.html" title="8.10. Битовые строки">След.</a></td></tr></table><hr /></div><div class="sect1" id="DATATYPE-NET-TYPES"><div class="titlepage"><div><div><h2 class="title" style="clear: both">8.9. Типы, описывающие сетевые адреса <a href="#DATATYPE-NET-TYPES" class="id_link">#</a></h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="sect2"><a href="datatype-net-types.html#DATATYPE-INET">8.9.1. <code class="type">inet</code></a></span></dt><dt><span class="sect2"><a href="datatype-net-types.html#DATATYPE-CIDR">8.9.2. <code class="type">cidr</code></a></span></dt><dt><span class="sect2"><a href="datatype-net-types.html#DATATYPE-INET-VS-CIDR">8.9.3. Различия <code class="type">inet</code> и <code class="type">cidr</code></a></span></dt><dt><span class="sect2"><a href="datatype-net-types.html#DATATYPE-MACADDR">8.9.4. <code class="type">macaddr</code></a></span></dt><dt><span class="sect2"><a href="datatype-net-types.html#DATATYPE-MACADDR8">8.9.5. <code class="type">macaddr8</code></a></span></dt></dl></div><a id="id-1.5.7.17.2" class="indexterm"></a><p><span class="productname">PostgreSQL</span> предлагает типы данных для хранения адресов IPv4, IPv6 и MAC, показанные в <a class="xref" href="datatype-net-types.html#DATATYPE-NET-TYPES-TABLE" title="Таблица 8.21. Типы, описывающие сетевые адреса">Таблице 8.21</a>. Для хранения сетевых адресов лучше использовать эти типы, а не простые текстовые строки, так как <span class="productname">PostgreSQL</span> проверяет вводимые значения данных типов и предоставляет специализированные операторы и функции для работы с ними (см. <a class="xref" href="functions-net.html" title="9.12. Функции и операторы для работы с сетевыми адресами">Раздел 9.12</a>).</p><div class="table" id="DATATYPE-NET-TYPES-TABLE"><p class="title"><strong>Таблица 8.21. Типы, описывающие сетевые адреса</strong></p><div class="table-contents"><table class="table" summary="Типы, описывающие сетевые адреса" border="1"><colgroup><col class="col1" /><col class="col2" /><col class="col3" /></colgroup><thead><tr><th>Name</th><th>Размер</th><th>Описание</th></tr></thead><tbody><tr><td><code class="type">cidr</code></td><td>7 или 19 байт</td><td>Сети IPv4 и IPv6</td></tr><tr><td><code class="type">inet</code></td><td>7 или 19 байт</td><td>Узлы и сети IPv4 и IPv6</td></tr><tr><td><code class="type">macaddr</code></td><td>6 байт</td><td>MAC-адреса</td></tr><tr><td><code class="type">macaddr8</code></td><td>8 байт</td><td>MAC-адреса (в формате EUI-64)</td></tr></tbody></table></div></div><br class="table-break" /><p>При сортировке типов <code class="type">inet</code> и <code class="type">cidr</code>, адреса IPv4 всегда идут до адресов IPv6, в том числе адреса IPv4, включённые в IPv6 или сопоставленные с ними, например ::10.2.3.4 или ::ffff:10.4.3.2.</p><div class="sect2" id="DATATYPE-INET"><div class="titlepage"><div><div><h3 class="title">8.9.1. <code class="type">inet</code> <a href="#DATATYPE-INET" class="id_link">#</a></h3></div></div></div><a id="id-1.5.7.17.6.2" class="indexterm"></a><p>Тип <code class="type">inet</code> содержит IPv4- или IPv6-адрес узла и может также содержать его подсеть, всё в одном поле. Подсеть представляется числом бит, определяющих адрес сети в адресе узла (или <span class="quote">«<span class="quote">маску сети</span>»</span>). Если маска сети равна 32 для адреса IPv4, такое значение представляет не подсеть, а определённый узел. Адреса IPv6 имеют длину 128 бит, поэтому уникальный адрес узла задаётся с маской 128 бит. Заметьте, что когда нужно, чтобы принимались только адреса сетей, следует использовать тип <code class="type">cidr</code>, а не <code class="type">inet</code>.</p><p>Вводимые значения такого типа должны иметь формат <em class="replaceable"><code>адрес/y</code></em>, где <em class="replaceable"><code>адрес</code></em> — адрес IPv4 или IPv6, а <em class="replaceable"><code>y</code></em> — число бит в маске сети. Если компонент <em class="replaceable"><code>/y</code></em> опущен, маска сети считается равной 32 для IPv4 и 128 для IPv6, так что это значение будет представлять один узел. При выводе компонент <em class="replaceable"><code>/y</code></em> опускается, если сетевой адрес определяет адрес одного узла.</p></div><div class="sect2" id="DATATYPE-CIDR"><div class="titlepage"><div><div><h3 class="title">8.9.2. <code class="type">cidr</code> <a href="#DATATYPE-CIDR" class="id_link">#</a></h3></div></div></div><a id="id-1.5.7.17.7.2" class="indexterm"></a><p>Тип <code class="type">cidr</code> содержит определение сети IPv4 или IPv6. Входные и выходные форматы соответствуют соглашениям CIDR (Classless Internet Domain Routing, Бесклассовая межсетевая адресация). Определение сети записывается в формате <em class="replaceable"><code>адрес/y</code></em>, где <em class="replaceable"><code>адрес</code></em> — минимальный адрес в сети, представленный в виде адреса IPv4 или IPv6, а <em class="replaceable"><code>y</code></em> — число бит в маске сети. Если <em class="replaceable"><code>y</code></em> не указывается, это значение вычисляется по старой классовой схеме нумерации сетей, но при этом оно может быть увеличено, чтобы в него вошли все байты введённого адреса. Если в сетевом адресе справа от маски сети окажутся биты со значением 1, он будет считаться ошибочным.</p><p>В <a class="xref" href="datatype-net-types.html#DATATYPE-NET-CIDR-TABLE" title="Таблица 8.22. Примеры допустимых значений типа cidr">Таблице 8.22</a> показаны несколько примеров адресов.</p><div class="table" id="DATATYPE-NET-CIDR-TABLE"><p class="title"><strong>Таблица 8.22. Примеры допустимых значений типа <code class="type">cidr</code></strong></p><div class="table-contents"><table class="table" summary="Примеры допустимых значений типа cidr" border="1"><colgroup><col /><col /><col /></colgroup><thead><tr><th>Вводимое значение <code class="type">cidr</code></th><th>Выводимое значение <code class="type">cidr</code></th><th><code class="literal"><code class="function">abbrev(<code class="type">cidr</code>)</code></code></th></tr></thead><tbody><tr><td>192.168.100.128/25</td><td>192.168.100.128/25</td><td>192.168.100.128/25</td></tr><tr><td>192.168/24</td><td>192.168.0.0/24</td><td>192.168.0/24</td></tr><tr><td>192.168/25</td><td>192.168.0.0/25</td><td>192.168.0.0/25</td></tr><tr><td>192.168.1</td><td>192.168.1.0/24</td><td>192.168.1/24</td></tr><tr><td>192.168</td><td>192.168.0.0/24</td><td>192.168.0/24</td></tr><tr><td>128.1</td><td>128.1.0.0/16</td><td>128.1/16</td></tr><tr><td>128</td><td>128.0.0.0/16</td><td>128.0/16</td></tr><tr><td>128.1.2</td><td>128.1.2.0/24</td><td>128.1.2/24</td></tr><tr><td>10.1.2</td><td>10.1.2.0/24</td><td>10.1.2/24</td></tr><tr><td>10.1</td><td>10.1.0.0/16</td><td>10.1/16</td></tr><tr><td>10</td><td>10.0.0.0/8</td><td>10/8</td></tr><tr><td>10.1.2.3/32</td><td>10.1.2.3/32</td><td>10.1.2.3/32</td></tr><tr><td>2001:4f8:3:ba::/64</td><td>2001:4f8:3:ba::/64</td><td>2001:4f8:3:ba/64</td></tr><tr><td>2001:4f8:3:ba:​2e0:81ff:fe22:d1f1/128</td><td>2001:4f8:3:ba:​2e0:81ff:fe22:d1f1/128</td><td>2001:4f8:3:ba:​2e0:81ff:fe22:d1f1/128</td></tr><tr><td>::ffff:1.2.3.0/120</td><td>::ffff:1.2.3.0/120</td><td>::ffff:1.2.3/120</td></tr><tr><td>::ffff:1.2.3.0/128</td><td>::ffff:1.2.3.0/128</td><td>::ffff:1.2.3.0/128</td></tr></tbody></table></div></div><br class="table-break" /></div><div class="sect2" id="DATATYPE-INET-VS-CIDR"><div class="titlepage"><div><div><h3 class="title">8.9.3. Различия <code class="type">inet</code> и <code class="type">cidr</code> <a href="#DATATYPE-INET-VS-CIDR" class="id_link">#</a></h3></div></div></div><p>Существенным различием типов данных <code class="type">inet</code> и <code class="type">cidr</code> является то, что <code class="type">inet</code> принимает значения с ненулевыми битами справа от маски сети, а <code class="type">cidr</code> — нет. Например, значение <code class="literal">192.168.0.1/24</code> является допустимым для типа <code class="type">inet</code>, но не для <code class="type">cidr</code>.</p><div class="tip"><h3 class="title">Подсказка</h3><p>Если вас не устраивает выходной формат значений <code class="type">inet</code> или <code class="type">cidr</code>, попробуйте функции <code class="function">host</code>, <code class="function">text</code> и <code class="function">abbrev</code>.</p></div></div><div class="sect2" id="DATATYPE-MACADDR"><div class="titlepage"><div><div><h3 class="title">8.9.4. <code class="type">macaddr</code> <a href="#DATATYPE-MACADDR" class="id_link">#</a></h3></div></div></div><a id="id-1.5.7.17.9.2" class="indexterm"></a><a id="id-1.5.7.17.9.3" class="indexterm"></a><p>Тип <code class="type">macaddr</code> предназначен для хранения MAC-адреса, примером которого является адрес сетевой платы Ethernet (хотя MAC-адреса применяются и для других целей). Вводимые значения могут задаваться в следующих форматах: </p><table border="0" summary="Simple list" class="simplelist"><tr><td><code class="literal">'08:00:2b:01:02:03'</code></td></tr><tr><td><code class="literal">'08-00-2b-01-02-03'</code></td></tr><tr><td><code class="literal">'08002b:010203'</code></td></tr><tr><td><code class="literal">'08002b-010203'</code></td></tr><tr><td><code class="literal">'0800.2b01.0203'</code></td></tr><tr><td><code class="literal">'0800-2b01-0203'</code></td></tr><tr><td><code class="literal">'08002b010203'</code></td></tr></table><p> Все эти примеры определяют один и тот же адрес. Шестнадцатеричные цифры от <code class="literal">a</code> до <code class="literal">f</code> могут быть и в нижнем, и в верхнем регистре. Выводятся MAC-адреса всегда в первой форме.</p><p>В стандарте IEEE 802-2001 стандартной считается вторая форма MAC-адресов (с минусами), а первая (с двоеточиями) предполагает обратный порядок бит, от старшего к младшему, так что 08-00-2b-01-02-03 = 10:00:D4:80:40:C0. В настоящее время этому соглашению практически никто не следует, и уместно оно было только для устаревших сетевых протоколов (таких как Token Ring). PostgreSQL не меняет порядок бит и во всех принимаемых форматах подразумевается традиционный порядок LSB.</p><p>Последние пять входных форматов не описаны ни в каком стандарте.</p></div><div class="sect2" id="DATATYPE-MACADDR8"><div class="titlepage"><div><div><h3 class="title">8.9.5. <code class="type">macaddr8</code> <a href="#DATATYPE-MACADDR8" class="id_link">#</a></h3></div></div></div><a id="id-1.5.7.17.10.2" class="indexterm"></a><a id="id-1.5.7.17.10.3" class="indexterm"></a><p>Тип <code class="type">macaddr8</code> хранит MAC-адреса в формате EUI-64, применяющиеся, например, для аппаратных адресов плат Ethernet (хотя MAC-адреса используются и для других целей). Этот тип может принять и 6-байтовые, и 8-байтовые адреса MAC и сохраняет их в 8 байтах. MAC-адреса, заданные в 6-байтовом формате, хранятся в формате 8 байт, а 4-ый и 5-ый байт содержат FF и FE, соответственно. Заметьте, что для IPv6 используется модифицированный формат EUI-64, в котором 7-ой бит должен быть установлен в 1 после преобразования из EUI-48. Для выполнения этого изменения предоставляется функция <code class="function">macaddr8_set7bit</code>. Вообще говоря, этот тип принимает любые строки, состоящие из пар шестнадцатеричных цифр (выровненных по границам байт), которые могут согласованно разделяться одинаковыми символами <code class="literal">':'</code>, <code class="literal">'-'</code> или <code class="literal">'.'</code>. Шестнадцатеричных цифр должно быть либо 16 (для 8 байт), либо 12 (для 6 байт). Начальные и конечные пробелы игнорируются. Ниже показаны примеры допустимых входных строк: </p><table border="0" summary="Simple list" class="simplelist"><tr><td><code class="literal">'08:00:2b:01:02:03:04:05'</code></td></tr><tr><td><code class="literal">'08-00-2b-01-02-03-04-05'</code></td></tr><tr><td><code class="literal">'08002b:0102030405'</code></td></tr><tr><td><code class="literal">'08002b-0102030405'</code></td></tr><tr><td><code class="literal">'0800.2b01.0203.0405'</code></td></tr><tr><td><code class="literal">'0800-2b01-0203-0405'</code></td></tr><tr><td><code class="literal">'08002b01:02030405'</code></td></tr><tr><td><code class="literal">'08002b0102030405'</code></td></tr></table><p> Во всех этих примерах задаётся один и тот же адрес. Для цифр с <code class="literal">a</code> по <code class="literal">f</code> принимаются буквы и в верхнем, и в нижнем регистре. Вывод всегда представляется в первом из показанных форматов.</p><p>Последние шесть входных форматов из показанных выше не являются стандартизированными.</p><p>Чтобы преобразовать традиционный 48-битный MAC-адрес в формате EUI-48 в модифицированный формат EUI-64 для включения в состав адреса IPv6 в качестве адреса узла, используйте функцию <code class="function">macaddr8_set7bit</code> следующим образом: </p><pre class="programlisting">SELECT macaddr8_set7bit('08:00:2b:01:02:03');
<code class="computeroutput">
    macaddr8_set7bit
-------------------------
 0a:00:2b:ff:fe:01:02:03
(1 row)
</code></pre></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="datatype-geometric.html" title="8.8. Геометрические типы">Пред.</a> </td><td width="20%" align="center"><a accesskey="u" href="datatype.html" title="Глава 8. Типы данных">Наверх</a></td><td width="40%" align="right"> <a accesskey="n" href="datatype-bit.html" title="8.10. Битовые строки">След.</a></td></tr><tr><td width="40%" align="left" valign="top">8.8. Геометрические типы </td><td width="20%" align="center"><a accesskey="h" href="index.html" title="Документация к PostgreSQL 16.3">Начало</a></td><td width="40%" align="right" valign="top"> 8.10. Битовые строки</td></tr></table></div></body></html>