<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>55.7. Форматы сообщений</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@lists.postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot" /><link rel="prev" href="protocol-message-types.html" title="55.6. Типы данных в сообщениях" /><link rel="next" href="protocol-error-fields.html" title="55.8. Поля сообщений с ошибками и замечаниями" /></head><body id="docContent" class="container-fluid col-10"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">55.7. Форматы сообщений</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="protocol-message-types.html" title="55.6. Типы данных в сообщениях">Пред.</a> </td><td width="10%" align="left"><a accesskey="u" href="protocol.html" title="Глава 55. Клиент-серверный протокол">Наверх</a></td><th width="60%" align="center">Глава 55. Клиент-серверный протокол</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="Документация к PostgreSQL 16.3">Начало</a></td><td width="10%" align="right"> <a accesskey="n" href="protocol-error-fields.html" title="55.8. Поля сообщений с ошибками и замечаниями">След.</a></td></tr></table><hr /></div><div class="sect1" id="PROTOCOL-MESSAGE-FORMATS"><div class="titlepage"><div><div><h2 class="title" style="clear: both">55.7. Форматы сообщений <a href="#PROTOCOL-MESSAGE-FORMATS" class="id_link">#</a></h2></div></div></div><p>В этом разделе подробно описывается формат каждого сообщения. Все сообщения помечены символами, обозначающими, какая сторона может их передавать: клиент (F), сервер (B) или обе стороны (F &amp; B). Заметьте, что хотя каждое сообщение включает счётчик байт в начале, формат сообщения разработан так, чтобы конец сообщения можно было найти, не обращаясь к счётчику байт. Это помогает проверять корректность сообщений. (Исключением является сообщение CopyData, так как оно образует часть потока данных; содержимое любого отдельного сообщения CopyData нельзя интерпретировать само по себе.)</p><div class="variablelist"><dl class="variablelist"><dt id="PROTOCOL-MESSAGE-FORMATS-AUTHENTICATIONOK"><span class="term">AuthenticationOk (B)</span> <a href="#PROTOCOL-MESSAGE-FORMATS-AUTHENTICATIONOK" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1('R')</span></dt><dd><p>Указывает, что это сообщение представляет запрос аутентификации.</p></dd><dt><span class="term">Int32(8)</span></dt><dd><p>Длина содержимого сообщения в байтах, включая само поле длины.</p></dd><dt><span class="term">Int32(0)</span></dt><dd><p>Показывает, что проверка подлинности прошла успешно.</p></dd></dl></div></dd><dt id="PROTOCOL-MESSAGE-FORMATS-AUTHENTICATIONKERBEROSV5"><span class="term">AuthenticationKerberosV5 (B)</span> <a href="#PROTOCOL-MESSAGE-FORMATS-AUTHENTICATIONKERBEROSV5" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1('R')</span></dt><dd><p>Указывает, что это сообщение представляет запрос аутентификации.</p></dd><dt><span class="term">Int32(8)</span></dt><dd><p>Длина содержимого сообщения в байтах, включая само поле длины.</p></dd><dt><span class="term">Int32(2)</span></dt><dd><p>Указывает, что требуется проверка подлинности по протоколу Kerberos V5.</p></dd></dl></div></dd><dt id="PROTOCOL-MESSAGE-FORMATS-AUTHENTICATIONCLEARTEXTPASSWORD"><span class="term">AuthenticationCleartextPassword (B)</span> <a href="#PROTOCOL-MESSAGE-FORMATS-AUTHENTICATIONCLEARTEXTPASSWORD" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1('R')</span></dt><dd><p>Указывает, что это сообщение представляет запрос аутентификации.</p></dd><dt><span class="term">Int32(8)</span></dt><dd><p>Длина содержимого сообщения в байтах, включая само поле длины.</p></dd><dt><span class="term">Int32(3)</span></dt><dd><p>Указывает, что требуется пароль, передаваемый открытым текстом.</p></dd></dl></div></dd><dt id="PROTOCOL-MESSAGE-FORMATS-AUTHENTICATIONMD5PASSWORD"><span class="term">AuthenticationMD5Password (B)</span> <a href="#PROTOCOL-MESSAGE-FORMATS-AUTHENTICATIONMD5PASSWORD" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1('R')</span></dt><dd><p>Указывает, что это сообщение представляет запрос аутентификации.</p></dd><dt><span class="term">Int32(12)</span></dt><dd><p>Длина содержимого сообщения в байтах, включая само поле длины.</p></dd><dt><span class="term">Int32(5)</span></dt><dd><p>Указывает, что требуется пароль, преобразованный в хеш MD5.</p></dd><dt><span class="term">Byte4</span></dt><dd><p>Значение соли, с которым должен хешироваться пароль.</p></dd></dl></div></dd><dt id="PROTOCOL-MESSAGE-FORMATS-AUTHENTICATIONGSS"><span class="term">AuthenticationGSS (B)</span> <a href="#PROTOCOL-MESSAGE-FORMATS-AUTHENTICATIONGSS" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1('R')</span></dt><dd><p>Указывает, что это сообщение представляет запрос аутентификации.</p></dd><dt><span class="term">Int32(8)</span></dt><dd><p>Длина содержимого сообщения в байтах, включая само поле длины.</p></dd><dt><span class="term">Int32(7)</span></dt><dd><p>Указывает, что требуется проверка подлинности на базе GSSAPI.</p></dd></dl></div></dd><dt id="PROTOCOL-MESSAGE-FORMATS-AUTHENTICATIONGSSCONTINUE"><span class="term">AuthenticationGSSContinue (B)</span> <a href="#PROTOCOL-MESSAGE-FORMATS-AUTHENTICATIONGSSCONTINUE" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1('R')</span></dt><dd><p>Указывает, что это сообщение представляет запрос аутентификации.</p></dd><dt><span class="term">Int32</span></dt><dd><p>Длина содержимого сообщения в байтах, включая само поле длины.</p></dd><dt><span class="term">Int32(8)</span></dt><dd><p>Указывает, что это сообщение содержит данные GSSAPI или SSPI.</p></dd><dt><span class="term">Byte<em class="replaceable"><code>n</code></em></span></dt><dd><p>Данные аутентификации для GSSAPI или SSPI.</p></dd></dl></div></dd><dt id="PROTOCOL-MESSAGE-FORMATS-AUTHENTICATIONSSPI"><span class="term">AuthenticationSSPI (B)</span> <a href="#PROTOCOL-MESSAGE-FORMATS-AUTHENTICATIONSSPI" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1('R')</span></dt><dd><p>Указывает, что это сообщение представляет запрос аутентификации.</p></dd><dt><span class="term">Int32(8)</span></dt><dd><p>Длина содержимого сообщения в байтах, включая само поле длины.</p></dd><dt><span class="term">Int32(9)</span></dt><dd><p>Указывает, что требуется проверка подлинности на базе SSPI.</p></dd></dl></div></dd><dt id="PROTOCOL-MESSAGE-FORMATS-AUTHENTICATIONSASL"><span class="term">AuthenticationSASL (B)</span> <a href="#PROTOCOL-MESSAGE-FORMATS-AUTHENTICATIONSASL" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1('R')</span></dt><dd><p>Указывает, что это сообщение представляет запрос аутентификации.</p></dd><dt><span class="term">Int32</span></dt><dd><p>Длина содержимого сообщения в байтах, включая само поле длины.</p></dd><dt><span class="term">Int32(10)</span></dt><dd><p>Указывает, что требуется проверка подлинности на базе SASL.</p></dd></dl></div><p>Тело сообщения содержит список механизмов аутентификации SASL в порядке предпочтений сервера. За последним именем механизма аутентификации должен идти завершающий нулевой байт. Для каждого механизма передаётся: </p><div class="variablelist"><dl class="variablelist"><dt><span class="term">String</span></dt><dd><p>Имя механизма аутентификации SASL.</p></dd></dl></div></dd><dt id="PROTOCOL-MESSAGE-FORMATS-AUTHENTICATIONSASLCONTINUE"><span class="term">AuthenticationSASLContinue (B)</span> <a href="#PROTOCOL-MESSAGE-FORMATS-AUTHENTICATIONSASLCONTINUE" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1('R')</span></dt><dd><p>Указывает, что это сообщение представляет запрос аутентификации.</p></dd><dt><span class="term">Int32</span></dt><dd><p>Длина содержимого сообщения в байтах, включая само поле длины.</p></dd><dt><span class="term">Int32(11)</span></dt><dd><p>Указывает, что это сообщение содержит данные вызова SASL.</p></dd><dt><span class="term">Byte<em class="replaceable"><code>n</code></em></span></dt><dd><p>Данные SASL, специфичные для применяемого механизма SASL.</p></dd></dl></div></dd><dt id="PROTOCOL-MESSAGE-FORMATS-AUTHENTICATIONSASLFINAL"><span class="term">AuthenticationSASLFinal (B)</span> <a href="#PROTOCOL-MESSAGE-FORMATS-AUTHENTICATIONSASLFINAL" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1('R')</span></dt><dd><p>Указывает, что это сообщение представляет запрос аутентификации.</p></dd><dt><span class="term">Int32</span></dt><dd><p>Длина содержимого сообщения в байтах, включая само поле длины.</p></dd><dt><span class="term">Int32(12)</span></dt><dd><p>Указывает, что аутентификация SASL завершена.</p></dd><dt><span class="term">Byte<em class="replaceable"><code>n</code></em></span></dt><dd><p>«Дополнительные данные» результата SASL, специфичные для применяемого механизма SASL.</p></dd></dl></div></dd><dt id="PROTOCOL-MESSAGE-FORMATS-BACKENDKEYDATA"><span class="term">BackendKeyData (B)</span> <a href="#PROTOCOL-MESSAGE-FORMATS-BACKENDKEYDATA" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1('K')</span></dt><dd><p>Указывает, что это сообщение содержит ключевые данные для отмены запросов. Клиент должен сохранить эти данные, если ему нужна возможность впоследствии выдавать сообщения CancelRequest.</p></dd><dt><span class="term">Int32(12)</span></dt><dd><p>Длина содержимого сообщения в байтах, включая само поле длины.</p></dd><dt><span class="term">Int32</span></dt><dd><p>PID обслуживающего процесса.</p></dd><dt><span class="term">Int32</span></dt><dd><p>Секретный ключ обслуживающего процесса.</p></dd></dl></div></dd><dt id="PROTOCOL-MESSAGE-FORMATS-BIND"><span class="term">Bind (F)</span> <a href="#PROTOCOL-MESSAGE-FORMATS-BIND" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1('B')</span></dt><dd><p>Указывает, что это сообщение представляет команду Bind.</p></dd><dt><span class="term">Int32</span></dt><dd><p>Длина содержимого сообщения в байтах, включая само поле длины.</p></dd><dt><span class="term">String</span></dt><dd><p>Имя целевого портала (пустая строка выбирает безымянный портал).</p></dd><dt><span class="term">String</span></dt><dd><p>Имя исходного подготовленного оператора (пустая строка выбирает безымянный подготовленный оператор).</p></dd><dt><span class="term">Int16</span></dt><dd><p>Количество кодов форматов следующих параметров (обозначается ниже символом <em class="replaceable"><code>C</code></em>). Может быть нулевым, что показывает, что параметры отсутствуют или все параметры передаются в формате по умолчанию (текстовом); либо равняться одному, в этом случае указанный один код формата применяется ко всем параметрам; либо может равняться действительному количеству параметров.</p></dd><dt><span class="term">Int16[<em class="replaceable"><code>C</code></em>]</span></dt><dd><p>Коды форматов параметров. В настоящее время допускаются коды ноль (текстовый формат) и один (двоичный).</p></dd><dt><span class="term">Int16</span></dt><dd><p>Количество следующих значений параметров (может быть нулевым). Оно должно совпадать с количеством параметров, требующихся для запроса.</p></dd></dl></div><p>Затем для каждого параметра идёт следующая пара полей:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Int32</span></dt><dd><p>Длина значения параметра, в байтах (само поле длины не считается). Может быть нулевой. В качестве особого значения, -1 представляет значение NULL. В случае с NULL никакие байты значений далее не следуют.</p></dd><dt><span class="term">Byte<em class="replaceable"><code>n</code></em></span></dt><dd><p>Значение параметра в формате, определённом соответствующим кодом формата. Переменная <em class="replaceable"><code>n</code></em> задаёт длину значения.</p></dd></dl></div><p>За последним параметром идёт следующее поле:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Int16</span></dt><dd><p>Количество кодов формата для следующих столбцов результата (обозначается ниже символом <em class="replaceable"><code>R</code></em>). Может быть нулевым, что показывает, что столбцы результата отсутствуют или для всех столбцов должен использоваться формат по умолчанию (текстовый), либо равняться одному, в этом случае указанный один код формата применяется ко всем столбцам (если они есть), либо может равняться действительному количеству столбцов результата запроса.</p></dd><dt><span class="term">Int16[<em class="replaceable"><code>R</code></em>]</span></dt><dd><p>Коды форматов столбцов результата. В настоящее время допускаются коды ноль (текстовый формат) и один (двоичный).</p></dd></dl></div></dd><dt id="PROTOCOL-MESSAGE-FORMATS-BINDCOMPLETE"><span class="term">BindComplete (B)</span> <a href="#PROTOCOL-MESSAGE-FORMATS-BINDCOMPLETE" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1('2')</span></dt><dd><p>Указывает, что это сообщение, сигнализирующее о завершении Bind.</p></dd><dt><span class="term">Int32(4)</span></dt><dd><p>Длина содержимого сообщения в байтах, включая само поле длины.</p></dd></dl></div></dd><dt id="PROTOCOL-MESSAGE-FORMATS-CANCELREQUEST"><span class="term">CancelRequest (F)</span> <a href="#PROTOCOL-MESSAGE-FORMATS-CANCELREQUEST" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Int32(16)</span></dt><dd><p>Длина содержимого сообщения в байтах, включая само поле длины.</p></dd><dt><span class="term">Int32(80877102)</span></dt><dd><p>Код запроса отмены. Это специально выбранное значение содержит <code class="literal">1234</code> в старших 16 битах и <code class="literal">5678</code> в младших 16 битах. (Во избежание неоднозначности этот код не должен совпадать с номером версии протокола.)</p></dd><dt><span class="term">Int32</span></dt><dd><p>PID целевого обслуживающего процесса.</p></dd><dt><span class="term">Int32</span></dt><dd><p>Секретный ключ целевого обслуживающего процесса.</p></dd></dl></div></dd><dt id="PROTOCOL-MESSAGE-FORMATS-CLOSE"><span class="term">Close (F)</span> <a href="#PROTOCOL-MESSAGE-FORMATS-CLOSE" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1('C')</span></dt><dd><p>Указывает, что это сообщение представляет команду Close.</p></dd><dt><span class="term">Int32</span></dt><dd><p>Длина содержимого сообщения в байтах, включая само поле длины.</p></dd><dt><span class="term">Byte1</span></dt><dd><p>'<code class="literal">S</code>' для закрытия подготовленного оператора, '<code class="literal">P</code>' для закрытия портала.</p></dd><dt><span class="term">String</span></dt><dd><p>Имя подготовленного оператора или портала, который должен быть закрыт (пустая строка выбирает безымянный подготовленный оператор или портал).</p></dd></dl></div></dd><dt id="PROTOCOL-MESSAGE-FORMATS-CLOSECOMPLETE"><span class="term">CloseComplete (B)</span> <a href="#PROTOCOL-MESSAGE-FORMATS-CLOSECOMPLETE" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1('3')</span></dt><dd><p>Указывает, что это сообщение, сигнализирующее о завершении Close.</p></dd><dt><span class="term">Int32(4)</span></dt><dd><p>Длина содержимого сообщения в байтах, включая само поле длины.</p></dd></dl></div></dd><dt id="PROTOCOL-MESSAGE-FORMATS-COMMANDCOMPLETE"><span class="term">CommandComplete (B)</span> <a href="#PROTOCOL-MESSAGE-FORMATS-COMMANDCOMPLETE" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1('C')</span></dt><dd><p>Указывает, что это сообщение об успешном завершении команды.</p></dd><dt><span class="term">Int32</span></dt><dd><p>Длина содержимого сообщения в байтах, включая само поле длины.</p></dd><dt><span class="term">String</span></dt><dd><p>Тег команды. Обычно это одно слово, обозначающее завершённую команду SQL.</p><p>Для команды <code class="command">INSERT</code> в качестве тега передаётся <code class="literal">INSERT <em class="replaceable"><code>oid</code></em> <em class="replaceable"><code>число_строк</code></em></code>, где <em class="replaceable"><code>число_строк</code></em> — количество вставленных строк. В поле <em class="replaceable"><code>oid</code></em> передавался идентификатор объекта вставленной строки, когда <em class="replaceable"><code>число_строк</code></em> было равно 1 и в целевой таблице содержались OID; таким образом, сейчас <em class="replaceable"><code>oid</code></em> всегда равняется 0.</p><p>Для команды <code class="command">DELETE</code> в качестве тега передаётся <code class="literal">DELETE <em class="replaceable"><code>число_строк</code></em></code>, где <em class="replaceable"><code>число_строк</code></em> — количество удалённых строк.</p><p>Для команды <code class="command">UPDATE</code> в качестве тега передаётся <code class="literal">UPDATE <em class="replaceable"><code>число_строк</code></em></code>, где <em class="replaceable"><code>число_строк</code></em> — количество изменённых строк.</p><p>Для команды <code class="command">MERGE</code> в качестве тега передаётся <code class="literal">MERGE <em class="replaceable"><code>число_строк</code></em></code>, где <em class="replaceable"><code>число_строк</code></em> — количество вставленных, изменённых или удалённых строк.</p><p>Для команды <code class="command">SELECT</code> или <code class="command">CREATE TABLE AS</code> в качестве тега передаётся <code class="literal">SELECT <em class="replaceable"><code>число_строк</code></em></code>, где <em class="replaceable"><code>число_строк</code></em> — число полученных строк.</p><p>Для команды <code class="command">MOVE</code> в качестве тега передаётся <code class="literal">MOVE <em class="replaceable"><code>число_строк</code></em></code>, где <em class="replaceable"><code>число_строк</code></em> — количество строк, на которое изменилась позиция курсора.</p><p>Для команды <code class="command">FETCH</code> в качестве тега передаётся <code class="literal">FETCH <em class="replaceable"><code>число_строк</code></em></code>, где <em class="replaceable"><code>число_строк</code></em> — количество строк, полученное через курсор.</p><p>Для команды <code class="command">COPY</code> в качестве тега передаётся <code class="literal">COPY <em class="replaceable"><code>число_строк</code></em></code>, где <em class="replaceable"><code>число_строк</code></em> — количество скопированных строк. (Заметьте: число строк выводится, начиная только с <span class="productname">PostgreSQL</span> 8.2.)</p></dd></dl></div></dd><dt id="PROTOCOL-MESSAGE-FORMATS-COPYDATA"><span class="term">CopyData (F &amp; B)</span> <a href="#PROTOCOL-MESSAGE-FORMATS-COPYDATA" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1('d')</span></dt><dd><p>Указывает, что в этом сообщении передаются данные <code class="command">COPY</code>.</p></dd><dt><span class="term">Int32</span></dt><dd><p>Длина содержимого сообщения в байтах, включая само поле длины.</p></dd><dt><span class="term">Byte<em class="replaceable"><code>n</code></em></span></dt><dd><p>Данные, образующие часть информационного потока <code class="command">COPY</code>. Сообщения от сервера всегда соответствуют отдельным строкам данных, но сообщения, передаваемые клиентами, могут разделять поток произвольным образом.</p></dd></dl></div></dd><dt id="PROTOCOL-MESSAGE-FORMATS-COPYDONE"><span class="term">CopyDone (F &amp; B)</span> <a href="#PROTOCOL-MESSAGE-FORMATS-COPYDONE" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1('c')</span></dt><dd><p>Указывает, что это сообщение, сигнализирующее о завершении <code class="command">COPY</code>.</p></dd><dt><span class="term">Int32(4)</span></dt><dd><p>Длина содержимого сообщения в байтах, включая само поле длины.</p></dd></dl></div></dd><dt id="PROTOCOL-MESSAGE-FORMATS-COPYFAIL"><span class="term">CopyFail (F)</span> <a href="#PROTOCOL-MESSAGE-FORMATS-COPYFAIL" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1('f')</span></dt><dd><p>Указывает, что это сообщение, сигнализирующее об ошибке операции <code class="command">COPY</code>.</p></dd><dt><span class="term">Int32</span></dt><dd><p>Длина содержимого сообщения в байтах, включая само поле длины.</p></dd><dt><span class="term">String</span></dt><dd><p>Сообщение об ошибке, описывающее причину сбоя операции.</p></dd></dl></div></dd><dt id="PROTOCOL-MESSAGE-FORMATS-COPYINRESPONSE"><span class="term">CopyInResponse (B)</span> <a href="#PROTOCOL-MESSAGE-FORMATS-COPYINRESPONSE" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1('G')</span></dt><dd><p>Указывает, что это сообщение является ответом на запуск входящего копирования. Получив его, клиент начинает передавать данные на вход операции копирования (если клиент не готов к этому, он передаёт сообщение CopyFail).</p></dd><dt><span class="term">Int32</span></dt><dd><p>Длина содержимого сообщения в байтах, включая само поле длины.</p></dd><dt><span class="term">Int8</span></dt><dd><p>Значение 0 указывает, что для всей операции <code class="command">COPY</code> применяется текстовый формат (строки разделяются символами новой строки, столбцы разделяются символами-разделителями и т. д.). Значение 1 указывает, что для всей операции копирования применяется двоичный формат (подобный формату DataRow). За дополнительными сведениями обратитесь к <a class="xref" href="sql-copy.html" title="COPY"><span class="refentrytitle">COPY</span></a>.</p></dd><dt><span class="term">Int16</span></dt><dd><p>Количество столбцов в копируемых данных (ниже обозначается символом <em class="replaceable"><code>N</code></em>).</p></dd><dt><span class="term">Int16[<em class="replaceable"><code>N</code></em>]</span></dt><dd><p>Коды формата для каждого столбца. В настоящее время допускаются коды ноль (текстовый формат) и один (двоичный). Если общий формат копирования — текстовый, все эти коды должны быть нулевыми.</p></dd></dl></div></dd><dt id="PROTOCOL-MESSAGE-FORMATS-COPYOUTRESPONSE"><span class="term">CopyOutResponse (B)</span> <a href="#PROTOCOL-MESSAGE-FORMATS-COPYOUTRESPONSE" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1('H')</span></dt><dd><p>Указывает, что это сообщение является ответом на запуск исходящего копирования. За этим сообщением следуют данные, исходящие со стороны сервера.</p></dd><dt><span class="term">Int32</span></dt><dd><p>Длина содержимого сообщения в байтах, включая само поле длины.</p></dd><dt><span class="term">Int8</span></dt><dd><p>Значение 0 указывает, что для всей операции <code class="command">COPY</code> применяется текстовый формат (строки разделяются символами новой строки, столбцы разделяются символами-разделителями и т. д.). Значение 1 указывает, что для всей операции копирования применяется двоичный формат (подобный формату DataRow). За дополнительными сведениями обратитесь к <a class="xref" href="sql-copy.html" title="COPY"><span class="refentrytitle">COPY</span></a>.</p></dd><dt><span class="term">Int16</span></dt><dd><p>Количество столбцов в копируемых данных (ниже обозначается символом <em class="replaceable"><code>N</code></em>).</p></dd><dt><span class="term">Int16[<em class="replaceable"><code>N</code></em>]</span></dt><dd><p>Коды формата для каждого столбца. В настоящее время допускаются коды ноль (текстовый формат) и один (двоичный). Если общий формат копирования — текстовый, все эти коды должны быть нулевыми.</p></dd></dl></div></dd><dt id="PROTOCOL-MESSAGE-FORMATS-COPYBOTHRESPONSE"><span class="term">CopyBothResponse (B)</span> <a href="#PROTOCOL-MESSAGE-FORMATS-COPYBOTHRESPONSE" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1('W')</span></dt><dd><p>Указывает, что это сообщение является ответом на запуск двустороннего копирования. Это сообщение используется только для потоковой репликации.</p></dd><dt><span class="term">Int32</span></dt><dd><p>Длина содержимого сообщения в байтах, включая само поле длины.</p></dd><dt><span class="term">Int8</span></dt><dd><p>Значение 0 указывает, что для всей операции <code class="command">COPY</code> применяется текстовый формат (строки разделяются символами новой строки, столбцы разделяются символами-разделителями и т. д.). Значение 1 указывает, что для всей операции копирования применяется двоичный формат (подобный формату DataRow). За дополнительными сведениями обратитесь к <a class="xref" href="sql-copy.html" title="COPY"><span class="refentrytitle">COPY</span></a>.</p></dd><dt><span class="term">Int16</span></dt><dd><p>Количество столбцов в копируемых данных (ниже обозначается символом <em class="replaceable"><code>N</code></em>).</p></dd><dt><span class="term">Int16[<em class="replaceable"><code>N</code></em>]</span></dt><dd><p>Коды формата для каждого столбца. В настоящее время допускаются коды ноль (текстовый формат) и один (двоичный). Если общий формат копирования — текстовый, все эти коды должны быть нулевыми.</p></dd></dl></div></dd><dt id="PROTOCOL-MESSAGE-FORMATS-DATAROW"><span class="term">DataRow (B)</span> <a href="#PROTOCOL-MESSAGE-FORMATS-DATAROW" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1('D')</span></dt><dd><p>Указывает, что в этом сообщении передаётся строка данных.</p></dd><dt><span class="term">Int32</span></dt><dd><p>Длина содержимого сообщения в байтах, включая само поле длины.</p></dd><dt><span class="term">Int16</span></dt><dd><p>Количество последующих значений столбцов (может быть нулевым).</p></dd></dl></div><p>Затем для каждого столбца идёт следующая пара полей:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Int32</span></dt><dd><p>Длина значения столбца, в байтах (само поле длины не считается). Может быть нулевой. В качестве особого значения, -1 представляет значение NULL. В случае с NULL никакие байты значений далее не следуют.</p></dd><dt><span class="term">Byte<em class="replaceable"><code>n</code></em></span></dt><dd><p>Значение столбца в формате, определённом соответствующим кодом формата. Переменная <em class="replaceable"><code>n</code></em> задаёт длину значения.</p></dd></dl></div></dd><dt id="PROTOCOL-MESSAGE-FORMATS-DESCRIBE"><span class="term">Describe (F)</span> <a href="#PROTOCOL-MESSAGE-FORMATS-DESCRIBE" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1('D')</span></dt><dd><p>Указывает, что это сообщение представляет команду Describe.</p></dd><dt><span class="term">Int32</span></dt><dd><p>Длина содержимого сообщения в байтах, включая само поле длины.</p></dd><dt><span class="term">Byte1</span></dt><dd><p>'<code class="literal">S</code>' для получения описания подготовленного оператора, '<code class="literal">P</code>' — портала.</p></dd><dt><span class="term">String</span></dt><dd><p>Имя подготовленного оператора или портала, описание которого запрашивается (пустая строка выбирает безымянный подготовленный оператор или портал).</p></dd></dl></div></dd><dt id="PROTOCOL-MESSAGE-FORMATS-EMPTYQUERYRESPONSE"><span class="term">EmptyQueryResponse (B)</span> <a href="#PROTOCOL-MESSAGE-FORMATS-EMPTYQUERYRESPONSE" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1('I')</span></dt><dd><p>Указывает, что это сообщение является ответом на пустую строку запроса. (Это сообщение заменяет CommandComplete.)</p></dd><dt><span class="term">Int32(4)</span></dt><dd><p>Длина содержимого сообщения в байтах, включая само поле длины.</p></dd></dl></div></dd><dt id="PROTOCOL-MESSAGE-FORMATS-ERRORRESPONSE"><span class="term">ErrorResponse (B)</span> <a href="#PROTOCOL-MESSAGE-FORMATS-ERRORRESPONSE" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1('E')</span></dt><dd><p>Указывает, что это сообщение ошибки.</p></dd><dt><span class="term">Int32</span></dt><dd><p>Длина содержимого сообщения в байтах, включая само поле длины.</p></dd></dl></div><p>Тело сообщения состоит из одного или нескольких определённых полей, за которыми в качестве завершающего следует нулевой байт. Поля могут идти в любом порядке. Для каждого поля передаётся:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1</span></dt><dd><p>Код, задающий тип поля; ноль обозначает конец сообщения, после которого ничего нет. Типы полей, определённые в настоящее время, перечислены в <a class="xref" href="protocol-error-fields.html" title="55.8. Поля сообщений с ошибками и замечаниями">Разделе 55.8</a>. Так как в будущем могут появиться другие типы полей, клиенты должны просто игнорировать поля нераспознанного типа.</p></dd><dt><span class="term">String</span></dt><dd><p>Значение поля.</p></dd></dl></div></dd><dt id="PROTOCOL-MESSAGE-FORMATS-EXECUTE"><span class="term">Execute (F)</span> <a href="#PROTOCOL-MESSAGE-FORMATS-EXECUTE" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1('E')</span></dt><dd><p>Указывает, что это сообщение представляет команду Execute.</p></dd><dt><span class="term">Int32</span></dt><dd><p>Длина содержимого сообщения в байтах, включая само поле длины.</p></dd><dt><span class="term">String</span></dt><dd><p>Имя портала, подлежащего выполнению (пустая строка выбирает безымянный портал).</p></dd><dt><span class="term">Int32</span></dt><dd><p>Максимальное число строк, которое должно быть возвращено, если портал содержит запрос, возвращающий строки (в противном случае игнорируется). Ноль означает <span class="quote">«<span class="quote">без ограничения</span>»</span>.</p></dd></dl></div></dd><dt id="PROTOCOL-MESSAGE-FORMATS-FLUSH"><span class="term">Flush (F)</span> <a href="#PROTOCOL-MESSAGE-FORMATS-FLUSH" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1('H')</span></dt><dd><p>Указывает, что это сообщение представляет команду Flush.</p></dd><dt><span class="term">Int32(4)</span></dt><dd><p>Длина содержимого сообщения в байтах, включая само поле длины.</p></dd></dl></div></dd><dt id="PROTOCOL-MESSAGE-FORMATS-FUNCTIONCALL"><span class="term">FunctionCall (F)</span> <a href="#PROTOCOL-MESSAGE-FORMATS-FUNCTIONCALL" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1('F')</span></dt><dd><p>Указывает, что это сообщение представляет вызов функции.</p></dd><dt><span class="term">Int32</span></dt><dd><p>Длина содержимого сообщения в байтах, включая само поле длины.</p></dd><dt><span class="term">Int32</span></dt><dd><p>Задаёт идентификатор объекта вызываемой функции.</p></dd><dt><span class="term">Int16</span></dt><dd><p>Количество кодов форматов следующих аргументов (обозначается ниже символом <em class="replaceable"><code>C</code></em>). Может быть нулевым, что показывает, что аргументы отсутствуют или все аргументы передаются в формате по умолчанию (текстовом); либо равняться одному, в этом случае указанный один код формата применяется ко всем аргументами, либо может равняться действительному количеству аргументов.</p></dd><dt><span class="term">Int16[<em class="replaceable"><code>C</code></em>]</span></dt><dd><p>Коды форматов аргументов. В настоящее время допускаются коды ноль (текстовый формат) и один (двоичный).</p></dd><dt><span class="term">Int16</span></dt><dd><p>Задаёт число аргументов, передаваемых функции.</p></dd></dl></div><p>Затем для каждого аргумента идёт следующая пара полей:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Int32</span></dt><dd><p>Длина значения аргумента, в байтах (само поле длины не считается). Может быть нулевой. В качестве особого значения, -1 представляет значение NULL. В случае с NULL никакие байты значений далее не следуют.</p></dd><dt><span class="term">Byte<em class="replaceable"><code>n</code></em></span></dt><dd><p>Значение аргумента, в формате, определённом соответствующим кодом формата. Переменная <em class="replaceable"><code>n</code></em> задаёт длину значения.</p></dd></dl></div><p>За последним аргументом идёт следующее поле:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Int16</span></dt><dd><p>Код формата результата функции. В настоящее время допускается код ноль (текстовый формат) и один (двоичный).</p></dd></dl></div></dd><dt id="PROTOCOL-MESSAGE-FORMATS-FUNCTIONCALLRESPONSE"><span class="term">FunctionCallResponse (B)</span> <a href="#PROTOCOL-MESSAGE-FORMATS-FUNCTIONCALLRESPONSE" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1('V')</span></dt><dd><p>Указывает, что в этом сообщении передаётся результат вызова функции.</p></dd><dt><span class="term">Int32</span></dt><dd><p>Длина содержимого сообщения в байтах, включая само поле длины.</p></dd><dt><span class="term">Int32</span></dt><dd><p>Длина значения результата функции, в байтах (само поле длины не считается). Может быть нулевой. В качестве особого значения, -1 представляет значение NULL. В случае с NULL никакие байты значения далее не следуют.</p></dd><dt><span class="term">Byte<em class="replaceable"><code>n</code></em></span></dt><dd><p>Значение результата функции в формате, определённом соответствующим кодом формата. Переменная <em class="replaceable"><code>n</code></em> задаёт длину значения.</p></dd></dl></div></dd><dt id="PROTOCOL-MESSAGE-FORMATS-GSSENCREQUEST"><span class="term">GSSENCRequest (F)</span> <a href="#PROTOCOL-MESSAGE-FORMATS-GSSENCREQUEST" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Int32(8)</span></dt><dd><p>Длина содержимого сообщения в байтах, включая само поле длины.</p></dd><dt><span class="term">Int32(80877104)</span></dt><dd><p>Код запроса <acronym class="acronym">GSSAPI</acronym> Encryption. Это специально выбранное значение содержит <code class="literal">1234</code> в старших 16 битах и <code class="literal">5680</code> в младших 16 битах. (Во избежание неоднозначности этот код не должен совпадать с номером версии протокола.)</p></dd></dl></div></dd><dt id="PROTOCOL-MESSAGE-FORMATS-GSSRESPONSE"><span class="term">GSSResponse (F)</span> <a href="#PROTOCOL-MESSAGE-FORMATS-GSSRESPONSE" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1('p')</span></dt><dd><p>Обозначает это сообщение как ответ GSSAPI или SSPI. Заметьте, что оно также применяется для ответов SASL и при аутентификации по паролю. Точный тип сообщения можно определить из контекста.</p></dd><dt><span class="term">Int32</span></dt><dd><p>Длина содержимого сообщения в байтах, включая само поле длины.</p></dd><dt><span class="term">Byte<em class="replaceable"><code>n</code></em></span></dt><dd><p>Данные сообщения, специфичные для GSSAPI/SSPI.</p></dd></dl></div></dd><dt id="PROTOCOL-MESSAGE-FORMATS-NEGOTIATEPROTOCOLVERSION"><span class="term">NegotiateProtocolVersion (B)</span> <a href="#PROTOCOL-MESSAGE-FORMATS-NEGOTIATEPROTOCOLVERSION" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1('v')</span></dt><dd><p>Указывает, что это сообщение согласования версии протокола.</p></dd><dt><span class="term">Int32</span></dt><dd><p>Длина содержимого сообщения в байтах, включая само поле длины.</p></dd><dt><span class="term">Int32</span></dt><dd><p>Новейшая младшая версия протокола, поддерживаемая сервером, для запрошенной клиентом старшей версии.</p></dd><dt><span class="term">Int32</span></dt><dd><p>Число параметров протокола, не принятых сервером.</p></dd></dl></div><p>Затем для параметров протокола, не принятых сервером, передаётся:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">String</span></dt><dd><p>Имя параметра.</p></dd></dl></div></dd><dt id="PROTOCOL-MESSAGE-FORMATS-NODATA"><span class="term">NoData (B)</span> <a href="#PROTOCOL-MESSAGE-FORMATS-NODATA" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1('n')</span></dt><dd><p>Указывает, что это сообщение сигнализирует об отсутствии данных.</p></dd><dt><span class="term">Int32(4)</span></dt><dd><p>Длина содержимого сообщения в байтах, включая само поле длины.</p></dd></dl></div></dd><dt id="PROTOCOL-MESSAGE-FORMATS-NOTICERESPONSE"><span class="term">NoticeResponse (B)</span> <a href="#PROTOCOL-MESSAGE-FORMATS-NOTICERESPONSE" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1('N')</span></dt><dd><p>Указывает, что это сообщение представляет замечание.</p></dd><dt><span class="term">Int32</span></dt><dd><p>Длина содержимого сообщения в байтах, включая само поле длины.</p></dd></dl></div><p>Тело сообщения состоит из одного или нескольких определённых полей, за которыми в качестве завершающего следует нулевой байт. Поля могут идти в любом порядке. Для каждого поля передаётся:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1</span></dt><dd><p>Код, задающий тип поля; ноль обозначает конец сообщения, после которого ничего нет. Типы полей, определённые в настоящее время, перечислены в <a class="xref" href="protocol-error-fields.html" title="55.8. Поля сообщений с ошибками и замечаниями">Разделе 55.8</a>. Так как в будущем могут появиться другие типы полей, клиенты должны просто игнорировать поля нераспознанного типа.</p></dd><dt><span class="term">String</span></dt><dd><p>Значение поля.</p></dd></dl></div></dd><dt id="PROTOCOL-MESSAGE-FORMATS-NOTIFICATIONRESPONSE"><span class="term">NotificationResponse (B)</span> <a href="#PROTOCOL-MESSAGE-FORMATS-NOTIFICATIONRESPONSE" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1('A')</span></dt><dd><p>Указывает, что это сообщение представляет уведомление.</p></dd><dt><span class="term">Int32</span></dt><dd><p>Длина содержимого сообщения в байтах, включая само поле длины.</p></dd><dt><span class="term">Int32</span></dt><dd><p>PID обслуживающего процесса, отправляющего уведомление.</p></dd><dt><span class="term">String</span></dt><dd><p>Имя канала, для которого было выдано уведомление.</p></dd><dt><span class="term">String</span></dt><dd><p>Строка <span class="quote">«<span class="quote">сообщения</span>»</span>, сопровождающего уведомление.</p></dd></dl></div></dd><dt id="PROTOCOL-MESSAGE-FORMATS-PARAMETERDESCRIPTION"><span class="term">ParameterDescription (B)</span> <a href="#PROTOCOL-MESSAGE-FORMATS-PARAMETERDESCRIPTION" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1('t')</span></dt><dd><p>Указывает, что это сообщение представляет описание параметра.</p></dd><dt><span class="term">Int32</span></dt><dd><p>Длина содержимого сообщения в байтах, включая само поле длины.</p></dd><dt><span class="term">Int16</span></dt><dd><p>Количество параметров для оператора (может быть нулевым).</p></dd></dl></div><p>Затем для каждого параметра передаётся:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Int32</span></dt><dd><p>Задаёт идентификатор объекта типа данных параметра.</p></dd></dl></div></dd><dt id="PROTOCOL-MESSAGE-FORMATS-PARAMETERSTATUS"><span class="term">ParameterStatus (B)</span> <a href="#PROTOCOL-MESSAGE-FORMATS-PARAMETERSTATUS" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1('S')</span></dt><dd><p>Указывает, что в этом сообщении передаётся состояние параметра времени выполнения.</p></dd><dt><span class="term">Int32</span></dt><dd><p>Длина содержимого сообщения в байтах, включая само поле длины.</p></dd><dt><span class="term">String</span></dt><dd><p>Имя параметра времени выполнения, состояние которого передаётся.</p></dd><dt><span class="term">String</span></dt><dd><p>Текущее значение параметра.</p></dd></dl></div></dd><dt id="PROTOCOL-MESSAGE-FORMATS-PARSE"><span class="term">Parse (F)</span> <a href="#PROTOCOL-MESSAGE-FORMATS-PARSE" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1('P')</span></dt><dd><p>Указывает, что это сообщение представляет команду Parse.</p></dd><dt><span class="term">Int32</span></dt><dd><p>Длина содержимого сообщения в байтах, включая само поле длины.</p></dd><dt><span class="term">String</span></dt><dd><p>Имя целевого подготовленного оператора (пустая строка выбирает безымянный подготовленный оператор).</p></dd><dt><span class="term">String</span></dt><dd><p>Строка запроса, которая должна быть разобрана.</p></dd><dt><span class="term">Int16</span></dt><dd><p>Количество типов параметров (может быть нулевым). Заметьте, что это значение представляет не число параметров, которые могут фигурировать в строке запроса, а число параметров, для которых клиент хочет предопределить типы.</p></dd></dl></div><p>Затем для каждого параметра передаётся:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Int32</span></dt><dd><p>Задаёт идентификатор объекта типа данных параметра. Указание нулевого значения равносильно отсутствию указания типа.</p></dd></dl></div></dd><dt id="PROTOCOL-MESSAGE-FORMATS-PARSECOMPLETE"><span class="term">ParseComplete (B)</span> <a href="#PROTOCOL-MESSAGE-FORMATS-PARSECOMPLETE" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1('1')</span></dt><dd><p>Указывает, что это сообщение, сигнализирующее о завершении Parse.</p></dd><dt><span class="term">Int32(4)</span></dt><dd><p>Длина содержимого сообщения в байтах, включая само поле длины.</p></dd></dl></div></dd><dt id="PROTOCOL-MESSAGE-FORMATS-PASSWORDMESSAGE"><span class="term">PasswordMessage (F)</span> <a href="#PROTOCOL-MESSAGE-FORMATS-PASSWORDMESSAGE" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1('p')</span></dt><dd><p>Обозначает это сообщение как ответ SASL. Заметьте, что оно также применяется для ответов GSSAPI, SSPI и SASL. Точный тип сообщения можно определить из контекста.</p></dd><dt><span class="term">Int32</span></dt><dd><p>Длина содержимого сообщения в байтах, включая само поле длины.</p></dd><dt><span class="term">String</span></dt><dd><p>Пароль (зашифрованный, если требуется).</p></dd></dl></div></dd><dt id="PROTOCOL-MESSAGE-FORMATS-PORTALSUSPENDED"><span class="term">PortalSuspended (B)</span> <a href="#PROTOCOL-MESSAGE-FORMATS-PORTALSUSPENDED" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1('s')</span></dt><dd><p>Указывает, что это сообщение сигнализирует о приостановке портала. Заметьте, что оно выдаётся только при достижении ограничения числа строк, заданного в сообщении Execute.</p></dd><dt><span class="term">Int32(4)</span></dt><dd><p>Длина содержимого сообщения в байтах, включая само поле длины.</p></dd></dl></div></dd><dt id="PROTOCOL-MESSAGE-FORMATS-QUERY"><span class="term">Query (F)</span> <a href="#PROTOCOL-MESSAGE-FORMATS-QUERY" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1('Q')</span></dt><dd><p>Указывает, что это сообщение представляет простой протокол запросов.</p></dd><dt><span class="term">Int32</span></dt><dd><p>Длина содержимого сообщения в байтах, включая само поле длины.</p></dd><dt><span class="term">String</span></dt><dd><p>Собственно строка запроса.</p></dd></dl></div></dd><dt id="PROTOCOL-MESSAGE-FORMATS-READYFORQUERY"><span class="term">ReadyForQuery (B)</span> <a href="#PROTOCOL-MESSAGE-FORMATS-READYFORQUERY" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1('Z')</span></dt><dd><p>Определяет тип сообщения. Сообщение ReadyForQuery передаётся, когда сервер готов к новому циклу запросов.</p></dd><dt><span class="term">Int32(5)</span></dt><dd><p>Длина содержимого сообщения в байтах, включая само поле длины.</p></dd><dt><span class="term">Byte1</span></dt><dd><p>Индикатор текущего состояния транзакции на сервере. Возможные значения: '<code class="literal">I</code>', транзакция неактивна (вне блока транзакции), '<code class="literal">T</code>' в блоке транзакции, либо '<code class="literal">E</code>' в блоке прерванной транзакции (запросы не будут обрабатываться до завершения блока).</p></dd></dl></div></dd><dt id="PROTOCOL-MESSAGE-FORMATS-ROWDESCRIPTION"><span class="term">RowDescription (B)</span> <a href="#PROTOCOL-MESSAGE-FORMATS-ROWDESCRIPTION" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1('T')</span></dt><dd><p>Указывает, что это сообщение представляет описание строки.</p></dd><dt><span class="term">Int32</span></dt><dd><p>Длина содержимого сообщения в байтах, включая само поле длины.</p></dd><dt><span class="term">Int16</span></dt><dd><p>Задаёт количество полей в строке (может быть нулевым).</p></dd></dl></div><p>Затем для каждого поля передаётся:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">String</span></dt><dd><p>Имя поля.</p></dd><dt><span class="term">Int32</span></dt><dd><p>Если поле связано со столбцом определённой таблицы, идентификатор объекта этой таблицы; в противном случае — ноль.</p></dd><dt><span class="term">Int16</span></dt><dd><p>Если поле связано со столбцом определённой таблицы, номер атрибута для этого столбца; в противном случае — ноль.</p></dd><dt><span class="term">Int32</span></dt><dd><p>Идентификатор объекта типа данных поля.</p></dd><dt><span class="term">Int16</span></dt><dd><p>Размер типа данных (см. <code class="varname">pg_type.typlen</code>). Заметьте, что отрицательные значения показывают, что тип имеет переменную длину.</p></dd><dt><span class="term">Int32</span></dt><dd><p>Модификатор типа (см. <code class="varname">pg_attribute.atttypmod</code>). Смысл этого модификатора зависит от типа.</p></dd><dt><span class="term">Int16</span></dt><dd><p>Код формата, используемого для поля. В настоящее время допускаются коды ноль (текстовый формат) и один (двоичный). В сообщении RowDescription, возвращаемом вариацией Describe для оператора, код формата ещё не известен и всегда будет нулевым.</p></dd></dl></div></dd><dt id="PROTOCOL-MESSAGE-FORMATS-SASLINITIALRESPONSE"><span class="term">SASLInitialResponse (F)</span> <a href="#PROTOCOL-MESSAGE-FORMATS-SASLINITIALRESPONSE" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1('p')</span></dt><dd><p>Обозначает это сообщение как начальный ответ SASL. Заметьте, что оно также применяется для ответов GSSAPI, SSPI и при аутентификации по паролю. Точный тип сообщения определяется из контекста.</p></dd><dt><span class="term">Int32</span></dt><dd><p>Длина содержимого сообщения в байтах, включая само поле длины.</p></dd><dt><span class="term">String</span></dt><dd><p>Имя механизма аутентификации SASL, выбранного клиентом.</p></dd><dt><span class="term">Int32</span></dt><dd><p>Длина последующего сообщения «Начальный ответ клиента», специфичного для механизма SASL, или -1, если начального ответа нет.</p></dd><dt><span class="term">Byte<em class="replaceable"><code>n</code></em></span></dt><dd><p>«Начальный ответ», специфичный для механизма SASL.</p></dd></dl></div></dd><dt id="PROTOCOL-MESSAGE-FORMATS-SASLRESPONSE"><span class="term">SASLResponse (F)</span> <a href="#PROTOCOL-MESSAGE-FORMATS-SASLRESPONSE" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1('p')</span></dt><dd><p>Обозначает это сообщение как ответ SASL. Заметьте, что оно также применяется для ответов GSSAPI, SSPI и при аутентификации по паролю. Точный тип сообщения можно определить из контекста.</p></dd><dt><span class="term">Int32</span></dt><dd><p>Длина содержимого сообщения в байтах, включая само поле длины.</p></dd><dt><span class="term">Byte<em class="replaceable"><code>n</code></em></span></dt><dd><p>Данные сообщения, специфичные для механизма SASL.</p></dd></dl></div></dd><dt id="PROTOCOL-MESSAGE-FORMATS-SSLREQUEST"><span class="term">SSLRequest (F)</span> <a href="#PROTOCOL-MESSAGE-FORMATS-SSLREQUEST" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Int32(8)</span></dt><dd><p>Длина содержимого сообщения в байтах, включая само поле длины.</p></dd><dt><span class="term">Int32(80877103)</span></dt><dd><p>Код запроса <acronym class="acronym">SSL</acronym>. Это специально выбранное значение содержит <code class="literal">1234</code> в старших 16 битах и <code class="literal">5679</code> в младших 16 битах. (Во избежание неоднозначности этот код не должен совпадать с номером версии протокола.)</p></dd></dl></div></dd><dt id="PROTOCOL-MESSAGE-FORMATS-STARTUPMESSAGE"><span class="term">StartupMessage (F)</span> <a href="#PROTOCOL-MESSAGE-FORMATS-STARTUPMESSAGE" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Int32</span></dt><dd><p>Длина содержимого сообщения в байтах, включая само поле длины.</p></dd><dt><span class="term">Int32(196608)</span></dt><dd><p>Номер версии протокола. В старших 16 битах задаётся старший номер версии (3 для протокола, описываемого здесь). В младших 16 битах задаётся младший номер версии (0 для протокола, описываемого здесь).</p></dd></dl></div><p>За номером версии протокола следует одна или несколько пар из имени параметра и строки значения. За последней парой имя/значение должен следовать нулевой байт. Передаваться параметры могут в любом порядке. Обязательным является только параметр <code class="literal">user</code>, остальные могут отсутствовать. Каждый параметр задаётся так:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">String</span></dt><dd><p>Имя параметра. В настоящее время принимаются имена: </p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">user</code></span></dt><dd><p>Имя пользователя баз данных, с которым выполняется подключение. Является обязательным, значения по умолчанию нет.</p></dd><dt><span class="term"><code class="literal">database</code></span></dt><dd><p>База данных, к которой выполняется подключение. По умолчанию подставляется имя пользователя.</p></dd><dt><span class="term"><code class="literal">options</code></span></dt><dd><p>Аргументы командной строки для обслуживающего процесса. (Этот способ считается устаревшим; теперь следует устанавливать отдельные параметры времени выполнения.) Пробелы в этой строке воспринимаются как разделяющие аргументы, если перед ними нет обратной косой черты (<code class="literal">\</code>); чтобы представить обратную косую черту буквально, продублируйте её (<code class="literal">\\</code>).</p></dd><dt><span class="term"><code class="literal">replication</code></span></dt><dd><p>Используется для подключения в режиме потоковой репликации, в котором вместо операторов SQL может выполняться небольшой набор команд репликации. Допустимые значения: <code class="literal">true</code>, <code class="literal">false</code> (по умолчанию) и <code class="literal">database</code>. За подробностями обратитесь к <a class="xref" href="protocol-replication.html" title="55.4. Протокол потоковой репликации">Разделу 55.4</a>.</p></dd></dl></div><p> В дополнение к ним могут задаваться и другие параметры. Имена параметров, начинающиеся с <code class="literal">_pq_.</code>, резервируются для использования в расширениях протокола, а остальные воспринимаются как параметры времени выполнения, передаваемые во время запуска серверному процессу. Такие параметры будут применяться при запуске серверного процесса (после разбора аргументов командной строки, если они есть) и будут действовать как параметры сеанса по умолчанию.</p></dd><dt><span class="term">String</span></dt><dd><p>Значение параметра.</p></dd></dl></div></dd><dt id="PROTOCOL-MESSAGE-FORMATS-SYNC"><span class="term">Sync (F)</span> <a href="#PROTOCOL-MESSAGE-FORMATS-SYNC" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1('S')</span></dt><dd><p>Указывает, что это сообщение представляет команду Sync.</p></dd><dt><span class="term">Int32(4)</span></dt><dd><p>Длина содержимого сообщения в байтах, включая само поле длины.</p></dd></dl></div></dd><dt id="PROTOCOL-MESSAGE-FORMATS-TERMINATE"><span class="term">Terminate (F)</span> <a href="#PROTOCOL-MESSAGE-FORMATS-TERMINATE" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1('X')</span></dt><dd><p>Указывает, что это сообщение завершает сеанс.</p></dd><dt><span class="term">Int32(4)</span></dt><dd><p>Длина содержимого сообщения в байтах, включая само поле длины.</p></dd></dl></div></dd></dl></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="protocol-message-types.html" title="55.6. Типы данных в сообщениях">Пред.</a> </td><td width="20%" align="center"><a accesskey="u" href="protocol.html" title="Глава 55. Клиент-серверный протокол">Наверх</a></td><td width="40%" align="right"> <a accesskey="n" href="protocol-error-fields.html" title="55.8. Поля сообщений с ошибками и замечаниями">След.</a></td></tr><tr><td width="40%" align="left" valign="top">55.6. Типы данных в сообщениях </td><td width="20%" align="center"><a accesskey="h" href="index.html" title="Документация к PostgreSQL 16.3">Начало</a></td><td width="40%" align="right" valign="top"> 55.8. Поля сообщений с ошибками и замечаниями</td></tr></table></div></body></html>