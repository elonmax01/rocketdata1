<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>11.2. Типы индексов</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@lists.postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot" /><link rel="prev" href="indexes-intro.html" title="11.1. Введение" /><link rel="next" href="indexes-multicolumn.html" title="11.3. Составные индексы" /></head><body id="docContent" class="container-fluid col-10"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">11.2. Типы индексов</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="indexes-intro.html" title="11.1. Введение">Пред.</a> </td><td width="10%" align="left"><a accesskey="u" href="indexes.html" title="Глава 11. Индексы">Наверх</a></td><th width="60%" align="center">Глава 11. Индексы</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="Документация к PostgreSQL 16.3">Начало</a></td><td width="10%" align="right"> <a accesskey="n" href="indexes-multicolumn.html" title="11.3. Составные индексы">След.</a></td></tr></table><hr /></div><div class="sect1" id="INDEXES-TYPES"><div class="titlepage"><div><div><h2 class="title" style="clear: both">11.2. Типы индексов <a href="#INDEXES-TYPES" class="id_link">#</a></h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="sect2"><a href="indexes-types.html#INDEXES-TYPES-BTREE">11.2.1. B-дерево</a></span></dt><dt><span class="sect2"><a href="indexes-types.html#INDEXES-TYPES-HASH">11.2.2. Хеш</a></span></dt><dt><span class="sect2"><a href="indexes-types.html#INDEXES-TYPE-GIST">11.2.3. GiST</a></span></dt><dt><span class="sect2"><a href="indexes-types.html#INDEXES-TYPE-SPGIST">11.2.4. SP-GiST</a></span></dt><dt><span class="sect2"><a href="indexes-types.html#INDEXES-TYPES-GIN">11.2.5. GIN</a></span></dt><dt><span class="sect2"><a href="indexes-types.html#INDEXES-TYPES-BRIN">11.2.6. BRIN</a></span></dt></dl></div><p><span class="productname">PostgreSQL</span> поддерживает несколько типов индексов: B-дерево, хеш, GiST, SP-GiST, GIN, BRIN и расширение <a class="link" href="bloom.html" title="F.7. bloom — индексный метод доступа, основанный на фильтрах Блума">bloom</a>. Для разных типов индексов применяются разные алгоритмы, ориентированные на определённые типы индексируемых предложений. По умолчанию команда <a class="link" href="sql-createindex.html" title="CREATE INDEX"><code class="command">CREATE INDEX</code></a> создаёт индексы-B-деревья, эффективные в большинстве случаев. Выбрать другой тип можно, написав название типа индекса после ключевого слова <code class="literal">USING</code>. Например, создать хеш-индекс можно так: </p><pre class="programlisting">CREATE INDEX <em class="replaceable"><code>имя</code></em> ON <em class="replaceable"><code>таблица</code></em> USING HASH (<em class="replaceable"><code>столбец</code></em>);</pre><div class="sect2" id="INDEXES-TYPES-BTREE"><div class="titlepage"><div><div><h3 class="title">11.2.1. B-дерево <a href="#INDEXES-TYPES-BTREE" class="id_link">#</a></h3></div></div></div><a id="id-1.5.10.5.3.2" class="indexterm"></a><a id="id-1.5.10.5.3.3" class="indexterm"></a><p>B-деревья могут работать в условиях на равенство и в проверках диапазонов с данными, которые можно отсортировать в некотором порядке. Точнее, планировщик запросов <span class="productname">PostgreSQL</span> может задействовать индекс-B-дерево, когда индексируемый столбец участвует в сравнении с одним из следующих операторов: </p><pre class="synopsis">
&lt;   &lt;=   =   &gt;=   &gt;
 </pre><p> При обработке конструкций, представимых как сочетание этих операторов, например <code class="literal">BETWEEN</code> и <code class="literal">IN</code>, так же может выполняться поиск по индексу-B-дереву. Кроме того, такие индексы могут использоваться и в условиях <code class="literal">IS NULL</code> и <code class="literal">IS NOT NULL</code> по индексированным столбцам.</p><p>Также оптимизатор может использовать эти индексы в запросах с операторами сравнения по шаблону <code class="literal">LIKE</code> и <code class="literal">~</code>, <span class="emphasis"><em>если</em></span> этот шаблон определяется константой и он привязан к началу строки — например, <code class="literal">col LIKE 'foo%'</code> или <code class="literal">col ~ '^foo'</code>, но не <code class="literal">col LIKE '%bar'</code>. Но если ваша база данных использует не локаль C, для поддержки индексирования запросов с шаблонами вам потребуется создать индекс со специальным классом операторов; см. <a class="xref" href="indexes-opclass.html" title="11.10. Семейства и классы операторов">Раздел 11.10</a>. Индексы-B-деревья можно использовать и для <code class="literal">ILIKE</code> и <code class="literal">~*</code>, но только если шаблон начинается не с алфавитных символов, то есть символов, не подверженных преобразованию регистра.</p><p>B-деревья могут также применяться для получения данных, отсортированных по порядку. Это не всегда быстрее простого сканирования и сортировки, но иногда бывает полезно.</p></div><div class="sect2" id="INDEXES-TYPES-HASH"><div class="titlepage"><div><div><h3 class="title">11.2.2. Хеш <a href="#INDEXES-TYPES-HASH" class="id_link">#</a></h3></div></div></div><a id="id-1.5.10.5.4.2" class="indexterm"></a><a id="id-1.5.10.5.4.3" class="indexterm"></a><p>Хеш-индексы хранят 32-битный хеш-код, полученный из значения индексированного столбца, поэтому хеш-индексы работают только с простыми условиями равенства. Планировщик запросов может применить хеш-индекс, только если индексируемый столбец участвует в сравнении с оператором <code class="literal">=</code>. Создать такой индекс можно следующей командой: </p><pre class="synopsis">
CREATE INDEX <em class="replaceable"><code>имя</code></em> ON <em class="replaceable"><code>таблица</code></em> USING HASH (<em class="replaceable"><code>столбец</code></em>);
</pre></div><div class="sect2" id="INDEXES-TYPE-GIST"><div class="titlepage"><div><div><h3 class="title">11.2.3. GiST <a href="#INDEXES-TYPE-GIST" class="id_link">#</a></h3></div></div></div><a id="id-1.5.10.5.5.2" class="indexterm"></a><a id="id-1.5.10.5.5.3" class="indexterm"></a><p>GiST-индексы представляют собой не просто разновидность индексов, а инфраструктуру, позволяющую реализовать много разных стратегий индексирования. Как следствие, GiST-индексы могут применяться с разными операторами, в зависимости от стратегии индексирования (<em class="firstterm">класса операторов</em>). Например, стандартный дистрибутив <span class="productname">PostgreSQL</span> включает классы операторов GiST для нескольких двумерных типов геометрических данных, что позволяет применять индексы в запросах с операторами: </p><pre class="synopsis">
&lt;&lt;   &amp;&lt;   &amp;&gt;   &gt;&gt;   &lt;&lt;|   &amp;&lt;|   |&amp;&gt;   |&gt;&gt;   @&gt;   &lt;@   ~=   &amp;&amp;
</pre><p> (Эти операторы описаны в <a class="xref" href="functions-geometry.html" title="9.11. Геометрические функции и операторы">Разделе 9.11</a>.) Классы операторов GiST, включённые в стандартный дистрибутив, описаны в <a class="xref" href="gist-builtin-opclasses.html#GIST-BUILTIN-OPCLASSES-TABLE" title="Таблица 68.1. Встроенные классы операторов GiST">Таблице 68.1</a>. В коллекции <code class="literal">contrib</code> можно найти и другие классы операторов GiST, реализованные как отдельные проекты. За дополнительными сведениями обратитесь к <a class="xref" href="gist.html" title="Глава 68. Индексы GiST">Главе 68</a>.</p><p>GiST-индексы также могут оптимизировать поиск <span class="quote">«<span class="quote">ближайшего соседа</span>»</span>, например такой: </p><pre class="programlisting">
SELECT * FROM places ORDER BY location &lt;-&gt; point '(101,456)' LIMIT 10;

</pre><p> который возвращает десять расположений, ближайших к заданной точке. Возможность такого применения индекса опять же зависит от класса используемого оператора. Операторы, которые можно использовать таким образом, перечислены в <a class="xref" href="gist-builtin-opclasses.html#GIST-BUILTIN-OPCLASSES-TABLE" title="Таблица 68.1. Встроенные классы операторов GiST">Таблице 68.1</a>, в столбце <span class="quote">«<span class="quote">Операторы сортировки</span>»</span>.</p></div><div class="sect2" id="INDEXES-TYPE-SPGIST"><div class="titlepage"><div><div><h3 class="title">11.2.4. SP-GiST <a href="#INDEXES-TYPE-SPGIST" class="id_link">#</a></h3></div></div></div><a id="id-1.5.10.5.6.2" class="indexterm"></a><a id="id-1.5.10.5.6.3" class="indexterm"></a><p>Индексы SP-GiST, как и GiST, предоставляют инфраструктуру, поддерживающую различные типы поиска. SP-GiST позволяет организовывать на диске самые разные несбалансированные структуры данных, такие как деревья квадрантов, k-мерные и префиксные деревья. Например, стандартный дистрибутив <span class="productname">PostgreSQL</span> включает классы операторов SP-GiST для точек в двумерном пространстве, что позволяет применять индексы в запросах с операторами: </p><pre class="synopsis">
&lt;&lt;   &gt;&gt;   ~=   &lt;@   &lt;&lt;|   |&gt;&gt;
</pre><p> (Эти операторы описаны в <a class="xref" href="functions-geometry.html" title="9.11. Геометрические функции и операторы">Разделе 9.11</a>.) Классы операторов SP-GiST, включённые в стандартный дистрибутив, описаны в <a class="xref" href="spgist-builtin-opclasses.html#SPGIST-BUILTIN-OPCLASSES-TABLE" title="Таблица 69.1. Встроенные классы операторов SP-GiST">Таблице 69.1</a>. За дополнительными сведениями обратитесь к <a class="xref" href="spgist.html" title="Глава 69. Индексы SP-GiST">Главе 69</a>.</p><p>Индексы SP-GiST, как и GiST, поддерживают поиск ближайших соседей. Для классов операторов SP-GiST, поддерживающих упорядочивание по расстоянию, соответствующий оператор указан в столбце <span class="quote">«<span class="quote">Операторы упорядочивания</span>»</span> в <a class="xref" href="spgist-builtin-opclasses.html#SPGIST-BUILTIN-OPCLASSES-TABLE" title="Таблица 69.1. Встроенные классы операторов SP-GiST">Таблице 69.1</a>.</p></div><div class="sect2" id="INDEXES-TYPES-GIN"><div class="titlepage"><div><div><h3 class="title">11.2.5. GIN <a href="#INDEXES-TYPES-GIN" class="id_link">#</a></h3></div></div></div><a id="id-1.5.10.5.7.2" class="indexterm"></a><a id="id-1.5.10.5.7.3" class="indexterm"></a><p>GIN-индексы представляют собой <span class="quote">«<span class="quote">инвертированные индексы</span>»</span>, в которых могут содержаться значения с несколькими ключами, например массивы. Инвертированный индекс содержит отдельный элемент для значения каждого компонента, и может эффективно работать в запросах, проверяющих присутствие определённых значений компонентов.</p><p>Подобно GiST и SP-GiST, индексы GIN могут поддерживать различные определённые пользователем стратегии и в зависимости от них могут применяться с разными операторами. Например, стандартный дистрибутив <span class="productname">PostgreSQL</span> включает класс операторов GIN для массивов, что позволяет применять индексы в запросах с операторами: </p><pre class="synopsis">
&lt;@   @&gt;   =   &amp;&amp;
</pre><p> (Эти операторы описаны в <a class="xref" href="functions-array.html" title="9.19. Функции и операторы для работы с массивами">Разделе 9.19</a>.) Классы операторов GIN, включённые в стандартный дистрибутив, описаны в <a class="xref" href="gin-builtin-opclasses.html#GIN-BUILTIN-OPCLASSES-TABLE" title="Таблица 70.1. Встроенные классы операторов GIN">Таблице 70.1</a>. В коллекции <code class="literal">contrib</code> и в отдельных проектах можно найти и много других классов операторов GIN. За дополнительными сведениями обратитесь к <a class="xref" href="gin.html" title="Глава 70. Индексы GIN">Главе 70</a>.</p></div><div class="sect2" id="INDEXES-TYPES-BRIN"><div class="titlepage"><div><div><h3 class="title">11.2.6. BRIN <a href="#INDEXES-TYPES-BRIN" class="id_link">#</a></h3></div></div></div><a id="id-1.5.10.5.8.2" class="indexterm"></a><a id="id-1.5.10.5.8.3" class="indexterm"></a><p>BRIN-индексы (сокращение от Block Range INdexes, Индексы зон блоков) хранят обобщённые сведения о значениях, находящихся в физически последовательно расположенных блоках таблицы. Поэтому такие индексы наиболее эффективны для столбцов, значения в которых хорошо коррелируют с физическим порядком столбцов таблицы. Подобно GiST, SP-GiST и GIN, индексы BRIN могут поддерживать определённые пользователем стратегии и в зависимости от них применяться с разными операторами. Для типов данных, имеющих линейный порядок сортировки, записям в индексе соответствуют минимальные и максимальные значения данных в столбце для каждой зоны блоков. Это позволяет поддерживать запросы со следующими операторами: </p><pre class="synopsis">
&lt;   &lt;=   =   &gt;=   &gt;
</pre><p> Классы операторов BRIN, включённые в стандартный дистрибутив, описаны в <a class="xref" href="brin-builtin-opclasses.html#BRIN-BUILTIN-OPCLASSES-TABLE" title="Таблица 71.1. Встроенные классы операторов BRIN">Таблице 71.1</a>. За дополнительными сведениями обратитесь к <a class="xref" href="brin.html" title="Глава 71. Индексы BRIN">Главе 71</a>.</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="indexes-intro.html" title="11.1. Введение">Пред.</a> </td><td width="20%" align="center"><a accesskey="u" href="indexes.html" title="Глава 11. Индексы">Наверх</a></td><td width="40%" align="right"> <a accesskey="n" href="indexes-multicolumn.html" title="11.3. Составные индексы">След.</a></td></tr><tr><td width="40%" align="left" valign="top">11.1. Введение </td><td width="20%" align="center"><a accesskey="h" href="index.html" title="Документация к PostgreSQL 16.3">Начало</a></td><td width="40%" align="right" valign="top"> 11.3. Составные индексы</td></tr></table></div></body></html>