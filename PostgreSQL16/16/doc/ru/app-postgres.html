<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>postgres</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@lists.postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot" /><link rel="prev" href="pgwaldump.html" title="pg_waldump" /><link rel="next" href="internals.html" title="Часть VII. Внутреннее устройство" /></head><body id="docContent" class="container-fluid col-10"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center"><span class="application">postgres</span></th></tr><tr><td width="10%" align="left"><a accesskey="p" href="pgwaldump.html" title="pg_waldump">Пред.</a> </td><td width="10%" align="left"><a accesskey="u" href="reference-server.html" title="Серверные приложения PostgreSQL">Наверх</a></td><th width="60%" align="center">Серверные приложения PostgreSQL</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="Документация к PostgreSQL 16.3">Начало</a></td><td width="10%" align="right"> <a accesskey="n" href="internals.html" title="Часть VII. Внутреннее устройство">След.</a></td></tr></table><hr /></div><div class="refentry" id="APP-POSTGRES"><div class="titlepage"></div><a id="id-1.9.5.14.1" class="indexterm"></a><div class="refnamediv"><h2><span class="refentrytitle"><span class="application">postgres</span></span></h2><p>postgres — сервер баз данных <span class="productname">PostgreSQL</span></p></div><div class="refsynopsisdiv"><h2>Синтаксис</h2><div class="cmdsynopsis"><p id="id-1.9.5.14.4.1"><code class="command">postgres</code> [<em class="replaceable"><code>параметр</code></em>...]</p></div></div><div class="refsect1" id="id-1.9.5.14.5"><h2>Описание</h2><p><code class="command">postgres</code> это сервер баз данных <span class="productname">PostgreSQL</span>. Для получения доступа к базе данных клиент устанавливает соединение (локально или по сети) с сервером <code class="command">postgres</code>. После установки соединения сервер <code class="command">postgres</code> поднимает выделенный процесс для его обслуживания.</p><p>Один экземпляр <code class="command">postgres</code> всегда управляет данными ровно одного кластера баз данных. Кластер — это коллекция баз данных, хранящихся в файловой системе в определённом размещении (<span class="quote">«<span class="quote">области данных</span>»</span>). На одном физическом сервере можно запустить несколько экземпляров <code class="command">postgres</code> одновременно, при условии, что они используют различные области данных и порты. При запуске <code class="command">postgres</code> необходимо указать размещение данных, которое задаётся в параметре <code class="option">-D</code> или переменной окружения <code class="envar">PGDATA</code>, значение по умолчанию отсутствует. Обычно <code class="option">-D</code> или <code class="envar">PGDATA</code> указывает на каталог, созданный во время развёртывания кластера с помощью <a class="xref" href="app-initdb.html" title="initdb"><span class="refentrytitle"><span class="application">initdb</span></span></a>. Иные варианты рассмотрены в <a class="xref" href="runtime-config-file-locations.html" title="20.2. Расположения файлов">Разделе 20.2</a>.</p><p>По умолчанию <code class="command">postgres</code> запускается не в фоновом режиме, а вывод журнала осуществляет в стандартный поток ошибок. На практике <code class="command">postgres</code> должен запускаться в фоновом режиме, возможно, при старте системы.</p><p>Команду <code class="command">postgres</code> также возможно использовать в однопользовательском режиме. В основном этот режим используется на этапе инициализации при выполнении <a class="xref" href="app-initdb.html" title="initdb"><span class="refentrytitle"><span class="application">initdb</span></span></a>. Иногда он также применяется в целях отладки или после аварийного сбоя. Заметьте, что однопользовательский режим не вполне подходит для отладки сервера ввиду отсутствия в нём межпроцессного взаимодействия и блокировок. Когда сервер запускается в однопользовательском режиме из командной строки, он может принимать запросы и выводить их результаты на экран, но формат этого вывода ориентирован больше на разработчиков, чем на обычных пользователей. В этом режиме текущим пользователем считается пользователь под номером 1, который неявно наделяется правами суперпользователя. При этом данный пользователь может фактически не существовать, поэтому в ряде случаев этот режим даёт возможность вручную восстановить базу при повреждении системных каталогов.</p></div><div class="refsect1" id="APP-POSTGRES-OPTIONS"><h2>Параметры</h2><p>Программа <code class="command">postgres</code> принимает следующие аргументы командной строки. За подробным описанием параметров обратитесь к <a class="xref" href="runtime-config.html" title="Глава 20. Настройка сервера">Главе 20</a>. От необходимости вводить большинство этих параметров можно избавиться, записав их в файл конфигурации. Некоторые (безопасные) параметры можно также задать со стороны подключающегося клиента (в зависимости от приложения), чтобы они применялись только к одному сеансу. Например, если установлена переменная окружения <code class="envar">PGOPTIONS</code>, клиенты на базе <span class="application">libpq</span> передадут эту строку серверу, который воспримет её как параметры, передаваемые в командной строке <code class="command">postgres</code>.</p><div class="refsect2" id="id-1.9.5.14.6.3"><h3>Параметры общего назначения</h3><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="option">-B <em class="replaceable"><code>количество-буферов</code></em></code></span></dt><dd><p>Устанавливает количество разделяемых между процессами буферов. Значение по умолчанию выбирается автоматически при развёртывании кластера с помощью <span class="application">initdb</span>. Установка флага аналогична конфигурации параметра <a class="xref" href="runtime-config-resource.html#GUC-SHARED-BUFFERS">shared_buffers</a>.</p></dd><dt><span class="term"><code class="option">-c <em class="replaceable"><code>имя</code></em>=<em class="replaceable"><code>значение</code></em></code></span></dt><dd><p>Устанавливает заданный параметр времени выполнения. Конфигурационные параметры, поддерживаемые <span class="productname">PostgreSQL</span>, описаны в <a class="xref" href="runtime-config.html" title="Глава 20. Настройка сервера">Главе 20</a>. Большинство других параметров командной строки на самом деле представляют собой краткие формы такого присваивания значений параметрам. Для установления нескольких параметров <code class="option">-c</code> можно указывать многократно.</p></dd><dt><span class="term"><code class="option">-C <em class="replaceable"><code>имя</code></em></code></span></dt><dd><p>Отображает значение заданного параметра времени выполнения и завершается. (См. также описание параметра <code class="option">-c</code> выше.) При этом выдаются значения из <code class="filename">postgresql.conf</code> с учётом возможных переопределений параметров при вызове. Однако параметры, установленные при запущенном сервере, в выводе не отражаются.</p><p>Для большинства параметров можно запросить значения при работающем сервере. Однако для некоторых параметров, вычисляемых во время выполнения, сервер должен быть отключён (например, <a class="xref" href="runtime-config-preset.html#GUC-SHARED-MEMORY-SIZE">shared_memory_size</a>, <a class="xref" href="runtime-config-preset.html#GUC-SHARED-MEMORY-SIZE-IN-HUGE-PAGES">shared_memory_size_in_huge_pages</a> и <a class="xref" href="runtime-config-preset.html#GUC-WAL-SEGMENT-SIZE">wal_segment_size</a>).</p><p>Параметр предназначен для приложений, взаимодействующих с сервером, например <a class="xref" href="app-pg-ctl.html" title="pg_ctl"><span class="refentrytitle"><span class="application">pg_ctl</span></span></a>, и запрашивающих параметры конфигурации. Пользовательские приложения должны использовать команду <a class="link" href="sql-show.html" title="SHOW"><code class="command">SHOW</code></a> или представление <code class="structname">pg_settings</code>.</p></dd><dt><span class="term"><code class="option">-d <em class="replaceable"><code>уровень-отладки</code></em></code></span></dt><dd><p>Устанавливает уровень отладки (от 1 до 5). Чем выше значение, тем подробнее осуществляется вывод в журнал сервера. Также возможно передать <code class="literal">-d 0</code> для отдельного сеанса, что предотвратит в его рамках влияние выставленного для <code class="command">postgres</code> значения.</p></dd><dt><span class="term"><code class="option">-D <em class="replaceable"><code>datadir</code></em></code></span></dt><dd><p>Указывает размещение конфигурационных файлов базы в пределах файловой системы. За подробностями обратитесь к <a class="xref" href="runtime-config-file-locations.html" title="20.2. Расположения файлов">Разделу 20.2</a>.</p></dd><dt><span class="term"><code class="option">-e</code></span></dt><dd><p>Устанавливает формат вводимых дат по умолчанию в <span class="quote">«<span class="quote">European</span>»</span> с последовательностью значений <code class="literal">DMY</code>. Также влияет на вывод дня, идущего перед значением месяца, более подробно см. <a class="xref" href="datatype-datetime.html" title="8.5. Типы даты/времени">Раздел 8.5</a>.</p></dd><dt><span class="term"><code class="option">-F</code></span></dt><dd><p>Отключает вызовы <code class="function">fsync</code> для увеличения производительности, но с увеличением рисков потери данных в случае краха системы. Этот параметр работает аналогично параметру конфигурации <a class="xref" href="runtime-config-wal.html#GUC-FSYNC">fsync</a>. Внимательно прочтите документацию перед использованием данного параметра!</p></dd><dt><span class="term"><code class="option">-h <em class="replaceable"><code>компьютер</code></em></code></span></dt><dd><p>Указывает IP-адрес или имя компьютера, на котором сервер <code class="command">postgres</code> принимает клиентские подключения по TCP/IP. Значением может быть список адресов, разделённых запятыми, либо символ <code class="literal">*</code>, обозначающий все доступные интерфейсы. Если значение опущено, то подключения принимаются только через Unix-сокеты. По умолчанию принимаются подключения только к <span class="systemitem">localhost</span>. Флаг работает аналогично конфигурационному параметру <a class="xref" href="runtime-config-connection.html#GUC-LISTEN-ADDRESSES">listen_addresses</a>.</p></dd><dt><span class="term"><code class="option">-i</code></span></dt><dd><p>Позволяет клиентам подключаться по TCP/IP. Без этого параметра допускаются лишь локальные подключения. Действие этого параметра аналогично действию параметра конфигурации <code class="varname">listen_addresses</code> со значением <code class="literal">*</code> в <code class="filename">postgresql.conf</code> или ключа <code class="option">-h</code>.</p><p>Параметр устарел, так как не даёт полной функциональности <a class="xref" href="runtime-config-connection.html#GUC-LISTEN-ADDRESSES">listen_addresses</a>. Лучше устанавливать значение <code class="varname">listen_addresses</code> напрямую.</p></dd><dt><span class="term"><code class="option">-k <em class="replaceable"><code>каталог</code></em></code></span></dt><dd><p>Указывает каталог Unix-сокета, через который <code class="command">postgres</code> будет принимать подключения. Значением параметра может быть список каталогов через запятую. Если это значение пустое, использование Unix-сокетов запрещается, разрешаются только подключения по TCP/IP. По умолчанию выбирается каталог <code class="filename">/tmp</code>, но его можно сменить на этапе компиляции. Этот параметр действует аналогично параметру конфигурации <a class="xref" href="runtime-config-connection.html#GUC-UNIX-SOCKET-DIRECTORIES">unix_socket_directories</a>.</p></dd><dt><span class="term"><code class="option">-l</code></span></dt><dd><p>Включает поддержку безопасных соединений с использованием <acronym class="acronym">SSL</acronym> шифрования. <span class="productname">PostgreSQL</span> необходимо скомпилировать с поддержкой <acronym class="acronym">SSL</acronym> для использования этого флага. Подробнее использование <acronym class="acronym">SSL</acronym> описано в <a class="xref" href="ssl-tcp.html" title="19.9. Защита соединений TCP/IP с применением SSL">Раздел 19.9</a>.</p></dd><dt><span class="term"><code class="option">-N <em class="replaceable"><code>максимальное количество соединений</code></em></code></span></dt><dd><p>Устанавливает максимально возможное количество одновременных клиентских соединений. Значение по умолчанию устанавливается автоматически на этапе развёртывания с помощью <span class="application">initdb</span>. Флаг работает аналогично конфигурационному параметру <a class="xref" href="runtime-config-connection.html#GUC-MAX-CONNECTIONS">max_connections</a>.</p></dd><dt><span class="term"><code class="option">-p <em class="replaceable"><code>порт</code></em></code></span></dt><dd><p>Указывает порт TCP/IP или расширение файла локального Unix-сокета, через который <code class="command">postgres</code> принимает подключения клиентских приложений. По умолчанию принимает значение переменной окружения <code class="envar">PGPORT</code>, или, если значение <code class="envar">PGPORT</code> не установлено, то используется значение, установленное на этапе компиляции (обычно это 5432). Если значение порта меняется, то на стороне клиентов это необходимо учитывать, установив, либо <code class="envar">PGPORT</code>, либо флаг командной строки.</p></dd><dt><span class="term"><code class="option">-s</code></span></dt><dd><p>Отображает информацию о времени и другую статистику после каждой выполненной команды, что полезно для оценки производительности во время настройки количества буферов.</p></dd><dt><span class="term"><code class="option">-S</code> <em class="replaceable"><code>рабочая-память</code></em></span></dt><dd><p>Указывает базовый объём памяти, который сервер будет использовать для сортировок и хеш-таблиц, прежде чем прибегнуть к использованию временных файлов на диске. Обратитесь к описанию параметра <code class="varname">work_mem</code>, приведённому в <a class="xref" href="runtime-config-resource.html#RUNTIME-CONFIG-RESOURCE-MEMORY" title="20.4.1. Память">Подразделе 20.4.1</a>.</p></dd><dt><span class="term"><code class="option">-V</code><br /></span><span class="term"><code class="option">--version</code></span></dt><dd><p>Отображает версию <span class="application">postgres</span> и прерывает дальнейшее выполнение.</p></dd><dt><span class="term"><code class="option">--<em class="replaceable"><code>имя</code></em>=<em class="replaceable"><code>значение</code></em></code></span></dt><dd><p>Устанавливает заданный параметр времени выполнения. Является короткой формой ключа <code class="option">-c</code>.</p></dd><dt><span class="term"><code class="option">--describe-config</code></span></dt><dd><p>Выводит значения конфигурационных переменных сервера, их описаний и значений по умолчанию в формате команды <code class="command">COPY</code> со знаком табуляции в качестве разделителя. В основном это предназначено для средств администрирования.</p></dd><dt><span class="term"><code class="option">-?</code><br /></span><span class="term"><code class="option">--help</code></span></dt><dd><p>Выводит помощь по аргументам команды <span class="application">postgres</span>.</p></dd></dl></div></div><div class="refsect2" id="id-1.9.5.14.6.4"><h3>Параметры для внутреннего использования</h3><p>Далее описанные параметры, в основном, применяются в целях отладки, а в некоторых случаях при восстановлении сильно повреждённых баз данных. Их описание приведено для системных разработчиков <span class="productname">PostgreSQL</span>, поэтому они могут быть изменены без уведомления.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="option">-f</code> <code class="literal">{ s | i | o | b | t | n | m | h }</code></span></dt><dd><p>Запрещает использование специфических методов сканирования и объединения: <code class="literal">s</code> и <code class="literal">i</code> выключают последовательное сканирование и по индексу соответственно, а <code class="literal">o</code>, <code class="literal">b</code> и <code class="literal">t</code> выключает сканирование только по индексу, сканирование по битовым векторам, и сканирование по ID кортежей соответственно, в то время как <code class="literal">n</code>, <code class="literal">m</code> и <code class="literal">h</code> выключает вложенные циклы, слияния и хеширование соответственно.</p><p>Ни последовательное сканирование, ни вложенные циклы невозможно выключить полностью. Флаги <code class="literal">-fs</code> и <code class="literal">-fn</code> просто указывают планировщику избегать выполнения этих операций при наличии других альтернатив.</p></dd><dt><span class="term"><code class="option">-O</code></span></dt><dd><p>Разрешает модифицировать структуру системных таблиц. Используется командой <code class="command">initdb</code>.</p></dd><dt><span class="term"><code class="option">-P</code></span></dt><dd><p>Игнорировать системные индексы при чтении, но продолжать обновлять их при изменениях системных таблиц. Это используется при их восстановлении после повреждения.</p></dd><dt><span class="term"><code class="option">-t</code> <code class="literal">pa[rser] | pl[anner] | e[xecutor]</code></span></dt><dd><p>Выводит статистику по времени исполнения каждого запроса в контексте каждого системного модуля. Использование флага совместно с <code class="option">-s</code> невозможно.</p></dd><dt><span class="term"><code class="option">-T</code></span></dt><dd><p>Параметр предназначен для отладки сервера в случае аномального завершения процесса. Обычная практика в таком случае — завершение порождённых процессов путём отправки сигналов <span class="systemitem">SIGQUIT</span>. С этим параметром будет отправляться сигнал <span class="systemitem">SIGABRT</span>, а в результате будут создаваться файлы дампа памяти.</p></dd><dt><span class="term"><code class="option">-v</code> <em class="replaceable"><code>протокол</code></em></span></dt><dd><p>Указывает для данного сеанса версию протокола взаимодействия сервера с клиентом. Флаг используется лишь для внутренних целей.</p></dd><dt><span class="term"><code class="option">-W</code> <em class="replaceable"><code>секунды</code></em></span></dt><dd><p>При старте сервера производится задержка на указанное количество секунд, после чего производится процедура аутентификации, что позволяет подключить отладчик к процессу.</p></dd></dl></div></div><div class="refsect2" id="id-1.9.5.14.6.5"><h3>Параметры для однопользовательского режима</h3><a id="id-1.9.5.14.6.5.2" class="indexterm"></a><p>Следующие параметры применимы только для однопользовательского режима (см. раздел <a class="xref" href="app-postgres.html#APP-POSTGRES-SINGLE-USER" title="Однопользовательский режим">Однопользовательский режим</a> ниже).</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="option">--single</code></span></dt><dd><p>Устанавливает однопользовательский режим. Параметр должен идти первым в командной строке.</p></dd><dt><span class="term"><em class="replaceable"><code>база_данных</code></em></span></dt><dd><p>Указывает имя базы данных, к которой производится подключение. Параметр должен идти последним в командной строке. Если не указан, то используется имя текущего системного пользователя.</p></dd><dt><span class="term"><code class="option">-E</code></span></dt><dd><p>Выводить все команды в устройство стандартного вывода прежде чем выполнять их.</p></dd><dt><span class="term"><code class="option">-j</code></span></dt><dd><p>Считать признаком окончания ввода команды точку с запятой с двумя переводами строки, а не один перевод строки.</p></dd><dt><span class="term"><code class="option">-r</code> <em class="replaceable"><code>имя_файла</code></em></span></dt><dd><p>Отправляет вывод журнала сервера в файл <em class="replaceable"><code>filename</code></em>. Этот параметр применяется лишь при запуске из командной строки.</p></dd></dl></div></div></div><div class="refsect1" id="id-1.9.5.14.7"><h2>Переменные окружения</h2><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="envar">PGCLIENTENCODING</code></span></dt><dd><p>Кодировка, используемая клиентом по умолчанию. Может переопределяться на стороне клиента, а также устанавливаться в конфигурационном файле сервера.</p></dd><dt><span class="term"><code class="envar">PGDATA</code></span></dt><dd><p>Каталог размещения данных кластера по умолчанию</p></dd><dt><span class="term"><code class="envar">PGDATESTYLE</code></span></dt><dd><p>Значение по умолчанию для параметра времени выполнения <a class="xref" href="runtime-config-client.html#GUC-DATESTYLE">DateStyle</a>. Применение этой переменной является устаревшим.</p></dd><dt><span class="term"><code class="envar">PGPORT</code></span></dt><dd><p>Порт по умолчанию, лучше устанавливать в конфигурационном файле.</p></dd></dl></div></div><div class="refsect1" id="id-1.9.5.14.8"><h2>Диагностика</h2><p>Ошибки с упоминанием о <code class="literal">semget</code> или <code class="literal">shmget</code> говорят о возможной необходимости проведения более оптимального конфигурирования ядра. Подробнее это обсуждается в <a class="xref" href="kernel-resources.html" title="19.4. Управление ресурсами ядра">Разделе 19.4</a>. Отложить переконфигурирование можно, уменьшив <a class="xref" href="runtime-config-resource.html#GUC-SHARED-BUFFERS">shared_buffers</a> для снижения общего потребления разделяемой памяти <span class="productname">PostgreSQL</span> и/или уменьшив <a class="xref" href="runtime-config-connection.html#GUC-MAX-CONNECTIONS">max_connections</a> для снижения затрат на использование семафоров.</p><p>Необходимо внимательно проверять сообщения об ошибке с упоминанием о другом запущенном экземпляре, например, с использованием команды </p><pre class="screen">
<code class="prompt">$</code> <strong class="userinput"><code>ps ax | grep postgres</code></strong>
</pre><p> или </p><pre class="screen">
<code class="prompt">$</code> <strong class="userinput"><code>ps -ef | grep postgres</code></strong>
</pre><p> в зависимости от ОС. Если есть полная уверенность, что противоречий нет, необходимо самостоятельно удалить упомянутый в сообщении запирающий файл и повторить попытку.</p><p>Упоминание о невозможности привязки к порту в сообщениях об ошибках может указывать на то, что он уже занят другим процессом помимо <span class="productname">PostgreSQL</span>. Также сообщение может возникнуть при мгновенном рестарте <code class="command">postgres</code> на том же порту. В этом случае нужно немного подождать, пока ОС не закроет порт, и повторить попытку. Ещё возможна ситуация, в которой используется резервный системный порт. Например, многие Unix-подобные ОС резервируют <span class="quote">«<span class="quote">доверительные</span>»</span> порты от 1024 и ниже, и лишь суперпользователь имеет к ним доступ.</p></div><div class="refsect1" id="id-1.9.5.14.9"><h2>Замечания</h2><p>Для комфортного запуска и остановки сервера можно использовать утилиту <a class="xref" href="app-pg-ctl.html" title="pg_ctl"><span class="refentrytitle"><span class="application">pg_ctl</span></span></a>.</p><p>Если возможно, <span class="emphasis"><em>не используйте</em></span> сигнал <code class="literal">SIGKILL</code> для головного процесса <code class="command">postgres</code>. В этом случае <code class="command">postgres</code> не освободит системные ресурсы, например, разделяемую память и семафоры. Это может привести к проблемам при повторном запуске <code class="command">postgres</code>.</p><p>Для корректного завершения <code class="command">postgres</code> используются сигналы <code class="literal">SIGTERM</code>, <code class="literal">SIGINT</code> или <code class="literal">SIGQUIT</code>. При первом будут ожидаться все дочерние процессы до их завершения, второй приведёт к принудительному закрытию соединений, а третий — к незамедлительному выходу без корректного завершения, приводящему к необходимости выполнения процедуры восстановления на следующем старте.</p><p>Получая сигнал <code class="literal">SIGHUP</code>, сервер перечитывает свои файлы конфигурации. Также возможно отправить <code class="literal">SIGHUP</code> отдельному процессу, но это чаще всего бессмысленно.</p><p>Для отмены исполняющегося запроса, отправьте <code class="literal">SIGINT</code> обслуживающему его процессу. Для чистого завершения серверного процесса отправьте ему <code class="literal">SIGTERM</code>. Также см. <code class="function">pg_cancel_backend</code> и <code class="function">pg_terminate_backend</code> в <a class="xref" href="functions-admin.html#FUNCTIONS-ADMIN-SIGNAL" title="9.27.2. Функции для передачи сигналов серверу">Подразделе 9.27.2</a>, которые являются аналогами в форме SQL-инструкций.</p><p>Сервер <code class="command">postgres</code> обрабатывает <code class="literal">SIGQUIT</code> для завершения дочерних процессов в грязную, и сигнал <span class="emphasis"><em>не должен</em></span> отправляться пользователем. Также не стоит посылать <code class="literal">SIGKILL</code> серверному процессу — головной <code class="command">postgres</code> процесс расценит это как аварию и принудительно завершит остальные порождённые, как это было бы сделано при процедуре восстановления после сбоя.</p></div><div class="refsect1" id="APP-POSTGRES-BUGS"><h2>Ошибки</h2><p>Флаги, начинающиеся с <code class="option">--</code> не работают в ОС <span class="systemitem">FreeBSD</span> или <span class="systemitem">OpenBSD</span>. Чтобы обойти это, используйте <code class="option">-c</code>. Это ошибка ОС. В будущих релизах <span class="productname">PostgreSQL</span> будет предоставлен обходной путь, если ошибка так и не будет устранена.</p></div><div class="refsect1" id="APP-POSTGRES-SINGLE-USER"><h2>Однопользовательский режим</h2><p>Для запуска сервера в однопользовательском режиме используется, например, команда </p><pre class="screen">
<strong class="userinput"><code>postgres --single -D /usr/local/pgsql/data <em class="replaceable"><code>другие параметры</code></em> my_database</code></strong>
</pre><p> Необходимо указать корректный путь к каталогу хранения данных в параметре <code class="option">-D</code>, или установить переменную окружения <code class="envar">PGDATA</code>. Также замените имя базы данных на необходимое.</p><p>Обычно перевод строки в однопользовательском режиме сервер воспринимает как завершение ввода команды; точка с запятой не имеет для него такого значения, как для <span class="application">psql</span>. Поэтому, чтобы ввести команду, занимающую несколько строк, необходимо добавлять в конце каждой строки, кроме последней, обратную косую черту. Обратная косая черта и следующий за ней символ перевода строки автоматически убираются из вводимой команды. Заметьте, что это происходит даже внутри строковой константы или комментария.</p><p>Но если применить аргумент командной строки <code class="option">-j</code>, одиночный символ перевода строки не будет завершать ввод команды; это будет делать последовательность «точка с запятой, перевод строки, перевод строки». То есть для завершения команды нужно ввести точку с запятой, и сразу за ней пустую строку. Просто точка с запятой, дополненная переводом строки, в этом режиме не имеет специального значения. Внутри строковых констант и комментариев такая завершающая последовательность воспринимается в том же ключе.</p><p>Вне зависимости от режима ввода, символ точки с запятой, введённый не прямо перед или в составе последовательности завершения команды, воспринимается как разделитель команд. После ввода завершающей последовательности введённые с разделителями несколько операторов будут выполняться в одной транзакции.</p><p>Для завершения сеанса введите символ конца файла (<acronym class="acronym">EOF</acronym>, обычно это сочетание <span class="keycap"><strong>Control</strong></span>+<span class="keycap"><strong>D</strong></span>). Если вы вводили текст после окончания ввода последней команды, символ <acronym class="acronym">EOF</acronym> будет воспринят как символ завершения команды, и для выхода потребуется ещё один <acronym class="acronym">EOF</acronym>.</p><p>Заметьте, что однопользовательский режим не предоставляет особых возможностей для редактирования команд (например, нет истории команд). Также в однопользовательском режиме не производятся никакие фоновые действия, например, не выполняются автоматические контрольные точки или репликация.</p></div><div class="refsect1" id="APP-POSTGRES-EXAMPLES"><h2>Примеры</h2><p>Для запуска <code class="command">postgres</code> в фоновом режиме с параметрами по умолчанию: </p><pre class="screen">
<code class="prompt">$</code> <strong class="userinput"><code>nohup postgres &gt;logfile 2&gt;&amp;1 &lt;/dev/null &amp;</code></strong>
</pre><p>Для запуска <code class="command">postgres</code> с определённым портом, например, 1234: </p><pre class="screen">
<code class="prompt">$</code> <strong class="userinput"><code>postgres -p 1234</code></strong>
</pre><p> Для соединения с помощью <span class="application">psql</span> укажите этот порт в параметре -p: </p><pre class="screen">
<code class="prompt">$</code> <strong class="userinput"><code>psql -p 1234</code></strong>
</pre><p> или в переменной окружения <code class="envar">PGPORT</code>: </p><pre class="screen">
<code class="prompt">$</code> <strong class="userinput"><code>export PGPORT=1234</code></strong>
<code class="prompt">$</code> <strong class="userinput"><code>psql</code></strong>
</pre><p>Именованный параметр времени выполнения можно указать одним из приведённых способом: </p><pre class="screen">
<code class="prompt">$</code> <strong class="userinput"><code>postgres -c work_mem=1234</code></strong>
<code class="prompt">$</code> <strong class="userinput"><code>postgres --work-mem=1234</code></strong>
</pre><p> Любой из методов переопределяет значение <code class="varname">work_mem</code> конфигурации <code class="filename">postgresql.conf</code>. Символ подчёркивания в именах можно указать и в виде тире. Задавать параметры обычно (не считая кратковременных экспериментов) лучше в <code class="filename">postgresql.conf</code>, а не в аргументах командной строки.</p></div><div class="refsect1" id="id-1.9.5.14.13"><h2>См. также</h2><p><a class="xref" href="app-initdb.html" title="initdb"><span class="refentrytitle"><span class="application">initdb</span></span></a>, <a class="xref" href="app-pg-ctl.html" title="pg_ctl"><span class="refentrytitle"><span class="application">pg_ctl</span></span></a></p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="pgwaldump.html" title="pg_waldump">Пред.</a> </td><td width="20%" align="center"><a accesskey="u" href="reference-server.html" title="Серверные приложения PostgreSQL">Наверх</a></td><td width="40%" align="right"> <a accesskey="n" href="internals.html" title="Часть VII. Внутреннее устройство">След.</a></td></tr><tr><td width="40%" align="left" valign="top"><span class="application">pg_waldump</span> </td><td width="20%" align="center"><a accesskey="h" href="index.html" title="Документация к PostgreSQL 16.3">Начало</a></td><td width="40%" align="right" valign="top"> Часть VII. Внутреннее устройство</td></tr></table></div></body></html>