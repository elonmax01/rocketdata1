<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>9.8. Функции форматирования данных</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@lists.postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot" /><link rel="prev" href="functions-matching.html" title="9.7. Поиск по шаблону" /><link rel="next" href="functions-datetime.html" title="9.9. Операторы и функции даты/времени" /></head><body id="docContent" class="container-fluid col-10"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">9.8. Функции форматирования данных</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="functions-matching.html" title="9.7. Поиск по шаблону">Пред.</a> </td><td width="10%" align="left"><a accesskey="u" href="functions.html" title="Глава 9. Функции и операторы">Наверх</a></td><th width="60%" align="center">Глава 9. Функции и операторы</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="Документация к PostgreSQL 16.3">Начало</a></td><td width="10%" align="right"> <a accesskey="n" href="functions-datetime.html" title="9.9. Операторы и функции даты/времени">След.</a></td></tr></table><hr /></div><div class="sect1" id="FUNCTIONS-FORMATTING"><div class="titlepage"><div><div><h2 class="title" style="clear: both">9.8. Функции форматирования данных <a href="#FUNCTIONS-FORMATTING" class="id_link">#</a></h2></div></div></div><a id="id-1.5.8.14.2" class="indexterm"></a><p>Функции форматирования в <span class="productname">PostgreSQL</span> предоставляют богатый набор инструментов для преобразования самых разных типов данных (дата/время, целое, числа с плавающей и фиксированной точкой) в форматированные строки и обратно. Все они перечислены в <a class="xref" href="functions-formatting.html#FUNCTIONS-FORMATTING-TABLE" title="Таблица 9.26. Функции форматирования">Таблице 9.26</a>. Все эти функции следует одному соглашению: в первом аргументе передаётся значение, которое нужно отформатировать, а во втором — шаблон, определяющий формат ввода или вывода.</p><div class="table" id="FUNCTIONS-FORMATTING-TABLE"><p class="title"><strong>Таблица 9.26. Функции форматирования</strong></p><div class="table-contents"><table class="table" summary="Функции форматирования" border="1"><colgroup><col /></colgroup><thead><tr><th class="func_table_entry"><p class="func_signature">Функция</p>
       <p>Описание</p>
       <p>Пример(ы)</p></th></tr></thead><tbody><tr><td class="func_table_entry"><p class="func_signature"><a id="id-1.5.8.14.4.2.2.1.1.1.1" class="indexterm"></a> <code class="function">to_char</code> ( <code class="type">timestamp</code>, <code class="type">text</code> ) → <code class="returnvalue">text</code></p>
       <p class="func_signature"><code class="function">to_char</code> ( <code class="type">timestamp with time zone</code>, <code class="type">text</code> ) → <code class="returnvalue">text</code></p>
       <p>Преобразует время в строку согласно заданному формату.</p>
       <p>
        <code class="literal">to_char(timestamp '2002-04-20 17:31:12.66', 'HH12:MI:SS')</code>
        → <code class="returnvalue">05:31:12</code>
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature"><code class="function">to_char</code> ( <code class="type">interval</code>, <code class="type">text</code> ) → <code class="returnvalue">text</code></p>
       <p>Преобразует интервал в строку согласно заданному формату.</p>
       <p>
       <code class="literal">to_char(interval '15h 2m 12s', 'HH24:MI:SS')</code>
       → <code class="returnvalue">15:02:12</code>
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature"><code class="function">to_char</code> ( <em class="replaceable"><code>numeric_type</code></em>, <code class="type">text</code> ) → <code class="returnvalue">text</code></p>
       <p>Преобразует число в строку согласно заданному формату; поддерживаются типы <code class="type">integer</code>, <code class="type">bigint</code>, <code class="type">numeric</code>, <code class="type">real</code>, <code class="type">double precision</code>.</p>
       <p>
        <code class="literal">to_char(125, '999')</code>
        → <code class="returnvalue">125</code>
       </p>
       <p>
        <code class="literal">to_char(125.8::real, '999D9')</code>
        → <code class="returnvalue">125.8</code>
       </p>
       <p>
        <code class="literal">to_char(-125.8, '999D99S')</code>
        → <code class="returnvalue">125.80-</code>
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature"><a id="id-1.5.8.14.4.2.2.4.1.1.1" class="indexterm"></a> <code class="function">to_date</code> ( <code class="type">text</code>, <code class="type">text</code> ) → <code class="returnvalue">date</code></p>
       <p>Преобразует строку в дату согласно заданному формату.</p>
       <p>
        <code class="literal">to_date('05 Dec 2000', 'DD Mon YYYY')</code>
        → <code class="returnvalue">2000-12-05</code>
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature"><a id="id-1.5.8.14.4.2.2.5.1.1.1" class="indexterm"></a> <code class="function">to_number</code> ( <code class="type">text</code>, <code class="type">text</code> ) → <code class="returnvalue">numeric</code></p>
       <p>Преобразует строку в число согласно заданному формату.</p>
       <p>
        <code class="literal">to_number('12,454.8-', '99G999D9S')</code>
        → <code class="returnvalue">-12454.8</code>
       </p></td></tr><tr><td class="func_table_entry"><p class="func_signature"><a id="id-1.5.8.14.4.2.2.6.1.1.1" class="indexterm"></a> <code class="function">to_timestamp</code> ( <code class="type">text</code>, <code class="type">text</code> ) → <code class="returnvalue">timestamp with time zone</code></p>
       <p>Преобразует строку в значение времени согласно заданному формату. (См. также <code class="function">to_timestamp(double precision)</code> в <a class="xref" href="functions-datetime.html#FUNCTIONS-DATETIME-TABLE" title="Таблица 9.33. Функции даты/времени">Таблице 9.33</a>.)</p>
       <p>
        <code class="literal">to_timestamp('05 Dec 2000', 'DD Mon YYYY')</code>
        → <code class="returnvalue">2000-12-05 00:00:00-05</code>
       </p></td></tr></tbody></table></div></div><br class="table-break" /><div class="tip"><h3 class="title">Подсказка</h3><p>Функции <code class="function">to_timestamp</code> и <code class="function">to_date</code> предназначены для работы с входными форматами, которые нельзя преобразовать простым приведением. Для большинства стандартных форматов даты/времени работает простое приведение исходной строки к требуемому типу и использовать его гораздо легче. Так же и функцию <code class="function">to_number</code> нет необходимости использовать для стандартных представлений чисел.</p></div><p>Шаблон вывода <code class="function">to_char</code> может содержать ряд кодов, которые распознаются при форматировании и заменяются соответствующими данными в зависимости от заданного значения. Любой текст, который не является кодом, просто копируется в неизменном виде. Подобным образом в строке шаблона ввода (для других функций) шаблонные коды определяют, какие значения должны поступать из входной строки. Если в строке шаблона есть символы, не относящиеся к шаблонным кодам, соответствующие символы во входной строке просто пропускаются (вне зависимости от того, совпадают ли они с символами в строке шаблона).</p><p>Все коды форматирования даты и времени перечислены в <a class="xref" href="functions-formatting.html#FUNCTIONS-FORMATTING-DATETIME-TABLE" title="Таблица 9.27. Коды форматирования даты/времени">Таблице 9.27</a>.</p><div class="table" id="FUNCTIONS-FORMATTING-DATETIME-TABLE"><p class="title"><strong>Таблица 9.27. Коды форматирования даты/времени</strong></p><div class="table-contents"><table class="table" summary="Коды форматирования даты/времени" border="1"><colgroup><col /><col /></colgroup><thead><tr><th>Код</th><th>Описание</th></tr></thead><tbody><tr><td><code class="literal">HH</code></td><td>час дня (01–12)</td></tr><tr><td><code class="literal">HH12</code></td><td>час дня (01–12)</td></tr><tr><td><code class="literal">HH24</code></td><td>час дня (00–23)</td></tr><tr><td><code class="literal">MI</code></td><td>минута (00–59)</td></tr><tr><td><code class="literal">SS</code></td><td>секунда (00–59)</td></tr><tr><td><code class="literal">MS</code></td><td>миллисекунда (000–999)</td></tr><tr><td><code class="literal">US</code></td><td>микросекунда (000000–999999)</td></tr><tr><td><code class="literal">FF1</code></td><td>десятая доля секунды (0–9)</td></tr><tr><td><code class="literal">FF2</code></td><td>сотая доля секунды (00–99)</td></tr><tr><td><code class="literal">FF3</code></td><td>миллисекунда (000–999)</td></tr><tr><td><code class="literal">FF4</code></td><td>десятитысячная доля секунды (0000–9999)</td></tr><tr><td><code class="literal">FF5</code></td><td>стотысячная доля секунды (00000–99999)</td></tr><tr><td><code class="literal">FF6</code></td><td>микросекунда (000000–999999)</td></tr><tr><td><code class="literal">SSSS</code>, <code class="literal">SSSSS</code></td><td>секунды после полуночи (0–86399)</td></tr><tr><td><code class="literal">AM</code>, <code class="literal">am</code>, <code class="literal">PM</code> или <code class="literal">pm</code></td><td>обозначение времени до/после полудня (без точек)</td></tr><tr><td><code class="literal">A.M.</code>, <code class="literal">a.m.</code>, <code class="literal">P.M.</code> или <code class="literal">p.m.</code></td><td>обозначение времени до/после полудня (с точками)</td></tr><tr><td><code class="literal">Y,YYY</code></td><td>год (4 или более цифр) с разделителем</td></tr><tr><td><code class="literal">YYYY</code></td><td>год (4 или более цифр)</td></tr><tr><td><code class="literal">YYY</code></td><td>последние 3 цифры года</td></tr><tr><td><code class="literal">YY</code></td><td>последние 2 цифры года</td></tr><tr><td><code class="literal">Y</code></td><td>последняя цифра года</td></tr><tr><td><code class="literal">IYYY</code></td><td>недельный год по ISO 8601 (4 или более цифр)</td></tr><tr><td><code class="literal">IYY</code></td><td>последние 3 цифры недельного года по ISO 8601</td></tr><tr><td><code class="literal">IY</code></td><td>последние 2 цифры недельного года по ISO 8601</td></tr><tr><td><code class="literal">I</code></td><td>последняя цифра недельного года по ISO 8601</td></tr><tr><td><code class="literal">BC</code>, <code class="literal">bc</code>, <code class="literal">AD</code> или <code class="literal">ad</code></td><td>обозначение эры (без точек)</td></tr><tr><td><code class="literal">B.C.</code>, <code class="literal">b.c.</code>, <code class="literal">A.D.</code> или <code class="literal">a.d.</code></td><td>обозначение эры (с точками)</td></tr><tr><td><code class="literal">MONTH</code></td><td>полное название месяца в верхнем регистре (дополненное пробелами до 9 символов)</td></tr><tr><td><code class="literal">Month</code></td><td>полное название месяца с большой буквы (дополненное пробелами до 9 символов)</td></tr><tr><td><code class="literal">month</code></td><td>полное название месяца в нижнем регистре (дополненное пробелами до 9 символов)</td></tr><tr><td><code class="literal">MON</code></td><td>сокращённое название месяца в верхнем регистре (3 буквы в английском; в других языках длина может меняться)</td></tr><tr><td><code class="literal">Mon</code></td><td>сокращённое название месяца с большой буквы (3 буквы в английском; в других языках длина может меняться)</td></tr><tr><td><code class="literal">mon</code></td><td>сокращённое название месяца в нижнем регистре (3 буквы в английском; в других языках длина может меняться)</td></tr><tr><td><code class="literal">MM</code></td><td>номер месяца (01–12)</td></tr><tr><td><code class="literal">DAY</code></td><td>полное название дня недели в верхнем регистре (дополненное пробелами до 9 символов)</td></tr><tr><td><code class="literal">Day</code></td><td>полное название дня недели с большой буквы (дополненное пробелами до 9 символов)</td></tr><tr><td><code class="literal">day</code></td><td>полное название дня недели в нижнем регистре (дополненное пробелами до 9 символов)</td></tr><tr><td><code class="literal">DY</code></td><td>сокращённое название дня недели в верхнем регистре (3 буквы в английском; в других языках может меняться)</td></tr><tr><td><code class="literal">Dy</code></td><td>сокращённое название дня недели с большой буквы (3 буквы в английском; в других языках длина может меняться)</td></tr><tr><td><code class="literal">dy</code></td><td>сокращённое название дня недели в нижнем регистре (3 буквы в английском; в других языках длина может меняться)</td></tr><tr><td><code class="literal">DDD</code></td><td>номер дня в году (001–366)</td></tr><tr><td><code class="literal">IDDD</code></td><td>номер дня в году по ISO 8601 (001–371; первый день года — понедельник первой недели по ISO)</td></tr><tr><td><code class="literal">DD</code></td><td>день месяца (01–31)</td></tr><tr><td><code class="literal">D</code></td><td>номер дня недели, считая с воскресенья (<code class="literal">1</code>) до субботы (<code class="literal">7</code>)</td></tr><tr><td><code class="literal">ID</code></td><td>номер дня недели по ISO 8601, считая с понедельника (<code class="literal">1</code>) до воскресенья (<code class="literal">7</code>)</td></tr><tr><td><code class="literal">W</code></td><td>неделя месяца (1–5) (первая неделя начинается в первый день месяца)</td></tr><tr><td><code class="literal">WW</code></td><td>номер недели в году (1–53) (первая неделя начинается в первый день года)</td></tr><tr><td><code class="literal">IW</code></td><td>номер недели в году по ISO 8601 (01–53; первый четверг года относится к неделе 1)</td></tr><tr><td><code class="literal">CC</code></td><td>век (2 цифры) (двадцать первый век начался 2001-01-01)</td></tr><tr><td><code class="literal">J</code></td><td>юлианская дата (целое число дней от 24 ноября 4714 г. до н. э. 00:00 по местному времени; см. <a class="xref" href="datetime-julian-dates.html" title="B.7. Юлианские даты">Раздел B.7</a>)</td></tr><tr><td><code class="literal">Q</code></td><td>квартал</td></tr><tr><td><code class="literal">RM</code></td><td>номер месяца римскими цифрами в верхнем регистре (I–XII; I=январь)</td></tr><tr><td><code class="literal">rm</code></td><td>номер месяца римскими цифрами в нижнем регистре (i–xii; i=январь)</td></tr><tr><td><code class="literal">TZ</code></td><td>сокращённое название часового пояса в верхнем регистре (поддерживается только в <code class="function">to_char</code>)</td></tr><tr><td><code class="literal">tz</code></td><td>сокращённое название часового пояса в нижнем регистре (поддерживается только в <code class="function">to_char</code>)</td></tr><tr><td><code class="literal">TZH</code></td><td>часы часового пояса</td></tr><tr><td><code class="literal">TZM</code></td><td>минуты часового пояса</td></tr><tr><td><code class="literal">OF</code></td><td>смещение часового пояса от UTC (поддерживается только в <code class="function">to_char</code>)</td></tr></tbody></table></div></div><br class="table-break" /><p>К любым кодам форматирования можно добавить модификаторы, изменяющие их поведение. Например, шаблон форматирования <code class="literal">FMMonth</code> включает код <code class="literal">Month</code> с модификатором <code class="literal">FM</code>. Модификаторы, предназначенные для форматирования даты/времени, перечислены в <a class="xref" href="functions-formatting.html#FUNCTIONS-FORMATTING-DATETIMEMOD-TABLE" title="Таблица 9.28. Модификаторы кодов для форматирования даты/времени">Таблице 9.28</a>.</p><div class="table" id="FUNCTIONS-FORMATTING-DATETIMEMOD-TABLE"><p class="title"><strong>Таблица 9.28. Модификаторы кодов для форматирования даты/времени</strong></p><div class="table-contents"><table class="table" summary="Модификаторы кодов для форматирования даты/времени" border="1"><colgroup><col /><col /><col /></colgroup><thead><tr><th>Модификатор</th><th>Описание</th><th>Пример</th></tr></thead><tbody><tr><td>Приставка <code class="literal">FM</code></td><td>режим заполнения (подавляет ведущие нули и дополнение пробелами)</td><td><code class="literal">FMMonth</code></td></tr><tr><td>Окончание <code class="literal">TH</code></td><td>окончание порядкового числительного в верхнем регистре</td><td><code class="literal">DDTH</code>, например <code class="literal">12TH</code></td></tr><tr><td>Окончание <code class="literal">th</code></td><td>окончание порядкового числительного в нижнем регистре</td><td><code class="literal">DDth</code>, например <code class="literal">12th</code></td></tr><tr><td>Приставка <code class="literal">FX</code></td><td>глобальный параметр фиксированного формата (см. замечания)</td><td><code class="literal">FX Month DD Day</code></td></tr><tr><td>Приставка <code class="literal">TM</code></td><td>режим перевода (используются локализованные названия дней и месяцев, исходя из <a class="xref" href="runtime-config-client.html#GUC-LC-TIME">lc_time</a>)</td><td><code class="literal">TMMonth</code></td></tr><tr><td>Окончание <code class="literal">SP</code></td><td>режим числа прописью (не реализован)</td><td><code class="literal">DDSP</code></td></tr></tbody></table></div></div><br class="table-break" /><p>Замечания по использованию форматов даты/времени: </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="literal">FM</code> подавляет дополняющие пробелы и нули справа, которые в противном случае будут добавлены, чтобы результат имел фиксированную ширину. В <span class="productname">PostgreSQL</span> модификатор <code class="literal">FM</code> действует только на следующий код, тогда как в Oracle <code class="literal">FM</code> её действие распространяется на все последующие коды, пока не будет отключено последующим модификатором <code class="literal">FM</code>.</p></li><li class="listitem"><p><code class="literal">TM</code> подавляет замыкающие пробелы вне зависимости от указания <code class="literal">FM</code>.</p></li><li class="listitem"><p>Функции <code class="function">to_timestamp</code> и <code class="function">to_date</code> игнорируют регистр букв во входной строке; поэтому, например, для шаблонов <code class="literal">MON</code>, <code class="literal">Mon</code> и <code class="literal">mon</code> подойдут одни и те же строки. Если используется приставка <code class="literal">TM</code>, смена регистра производится в соответствии с правилом сортировки, установленным для входной строки (см. <a class="xref" href="collation.html" title="24.2. Поддержка правил сортировки">Раздел 24.2</a>).</p></li><li class="listitem"><p><code class="function">to_timestamp</code> и <code class="function">to_date</code> пропускают повторяющиеся пробелы в начале входной строки и вокруг значений даты и времени, если только не используется приставка <code class="literal">FX</code>. Например, <code class="literal">to_timestamp(' 2000    JUN', 'YYYY MON')</code> и <code class="literal">to_timestamp('2000 - JUN', 'YYYY-MON')</code> будут работать, но <code class="literal">to_timestamp('2000    JUN', 'FXYYYY MON')</code> выдаст ошибку, так как <code class="function">to_timestamp</code> ожидает только один пробел. Приставка <code class="literal">FX</code> должна быть первой в шаблоне.</p></li><li class="listitem"><p>Разделитель (пробел или отличный от цифры/буквы символ) в строке шаблона функций <code class="function">to_timestamp</code> и <code class="function">to_date</code> соответствует любому разделителю во входной строке или пропускается, если только не добавлена приставка <code class="literal">FX</code>. Например, <code class="literal">to_timestamp('2000JUN', 'YYYY///MON')</code> и <code class="literal">to_timestamp('2000/JUN', 'YYYY MON')</code> будут работать, но <code class="literal">to_timestamp('2000//JUN', 'YYYY/MON')</code> выдаст ошибку, так как количество разделителей во входной строке превышает количество разделителей в шаблоне.</p><p>Если добавляется приставка <code class="literal">FX</code>, разделитель в строке шаблона соответствует ровно одному символу во входной строке. Но заметьте, что символ во входной строке не обязательно должен совпадать с символом разделителя в шаблоне. Например, <code class="literal">to_timestamp('2000/JUN', 'FXYYYY MON')</code> будет работать, а <code class="literal">to_timestamp('2000/JUN', 'FXYYYY  MON')</code> выдаст ошибку, потому что второй пробел в строке шаблона забирает букву <code class="literal">J</code> из входной строки.</p></li><li class="listitem"><p>Коду шаблона <code class="literal">TZH</code> может соответствовать число со знаком. Без приставки <code class="literal">FX</code> знаки минуса могут быть неоднозначными и восприниматься как разделители. Эта неоднозначность разрешается следующим образом: если число разделителей перед <code class="literal">TZH</code> в строке шаблона меньше числа разделителей перед знаком минуса во входной строке, знак минус воспринимается как относящийся к <code class="literal">TZH</code>. В противном случае знак минуса воспринимается как разделитель значений. Например, в <code class="literal">to_timestamp('2000 -10', 'YYYY TZH')</code> в поле <code class="literal">TZH</code> попадает <code class="literal">-10</code>, а в <code class="literal">to_timestamp('2000 -10', 'YYYY  TZH')</code> в <code class="literal">TZH</code> попадает значение <code class="literal">10</code>.</p></li><li class="listitem"><p>Шаблоны для <code class="function">to_char</code> могут содержать обычный текст; он будет выведен в неизменном виде. Чтобы принудительно вывести текст буквально, даже если он содержит шаблонные коды, подстроку с ним можно заключить в кавычки. Например, в строке <code class="literal">'"Hello Year "YYYY'</code>, код <code class="literal">YYYY</code> будет заменён годом, а буква <code class="literal">Y</code> в слове <code class="literal">Year</code> останется неизменной. В функциях <code class="function">to_date</code>, <code class="function">to_number</code> и <code class="function">to_timestamp</code> при обработке подстрок в кавычках и буквального текста некоторой длины пропускается такое же число символов во входной строке; например, при обработке подстроки <code class="literal">"XX"</code> будут пропущены два символа (любые, не обязательно <code class="literal">XX</code>).</p><div class="tip"><h3 class="title">Подсказка</h3><p>До <span class="productname">PostgreSQL</span> 12 во входной строке можно было пропускать произвольный текст, используя в шаблоне символы, отличные от цифр и букв. Например, раньше работало <code class="literal">to_timestamp('2000y6m1d', 'yyyy-MM-DD')</code>. Теперь для этой цели можно использовать только буквы. Например, шаблоны <code class="literal">to_timestamp('2000y6m1d', 'yyyytMMtDDt')</code> и <code class="literal">to_timestamp('2000y6m1d', 'yyyy"y"MM"m"DD"d"')</code> пропускают <code class="literal">y</code>, <code class="literal">m</code> и <code class="literal">d</code>.</p></div></li><li class="listitem"><p>Если вам нужно получить на выходе двойные кавычки, вы должны предварить их символом обратной косой черты, например: <code class="literal">'\"YYYY Month\"'</code>. В остальном этот символ вне кавычек воспринимается как обычный. Внутри строки в кавычках он указывает, что следующий символ должен восприниматься буквально, каким бы он ни был (но это имеет смысл, только если следующий символ — кавычки или обратная косая черта).</p></li><li class="listitem"><p>Если в функциях <code class="function">to_timestamp</code> и <code class="function">to_date</code> формат года определяется менее, чем 4 цифрами, например, как <code class="literal">YYY</code>, и в переданном значении года тоже меньше 4 цифр, год пересчитывается в максимально близкий к году 2020, т. е. <code class="literal">95</code> воспринимается как 1995.</p></li><li class="listitem"><p>Функции <code class="function">to_timestamp</code> и <code class="function">to_date</code> воспринимают отрицательные значения годов как относящиеся к годам до н. э. Если же указать отрицательное значение и добавить явный признак <code class="literal">BC</code> (до н. э.), год будет относиться к н. э. Нулевое значение года воспринимается как 1 год до н. э.</p></li><li class="listitem"><p>В функциях <code class="function">to_timestamp</code> и <code class="function">to_date</code> с преобразованием <code class="literal">YYYY</code> связано ограничение, когда обрабатываемый год записывается более чем 4 цифрами. После <code class="literal">YYYY</code> необходимо будет добавить нецифровой символ или соответствующий код, иначе год всегда будет восприниматься как 4 цифры. Например, в <code class="literal">to_date('200001130', 'YYYYMMDD')</code> (с годом 20000) год будет интерпретирован как состоящий из 4 цифр; чтобы исправить ситуацию, нужно добавить нецифровой разделитель после года, как в <code class="literal">to_date('20000-1130', 'YYYY-MMDD')</code>, или код как в <code class="literal">to_date('20000Nov30', 'YYYYMonDD')</code>.</p></li><li class="listitem"><p>Функции <code class="function">to_timestamp</code> и <code class="function">to_date</code> принимают поле <code class="literal">CC</code> (век), но игнорируют его, если в шаблоне есть поле <code class="literal">YYY</code>, <code class="literal">YYYY</code> или <code class="literal">Y,YYY</code>. Если <code class="literal">CC</code> используется с <code class="literal">YY</code> или <code class="literal">Y</code>, результатом будет год в данном столетии. Если присутствует только код столетия, без года, подразумевается первый год этого века.</p></li><li class="listitem"><p>Функции <code class="function">to_timestamp</code> и <code class="function">to_date</code> принимают названия и номера дней недели (<code class="literal">DAY</code>, <code class="literal">D</code> и связанные типы полей), но игнорируют их при вычислении результата. То же самое происходит с полями квартала (<code class="literal">Q</code>).</p></li><li class="listitem"><p>Функциям <code class="function">to_timestamp</code> и <code class="function">to_date</code> можно передать даты по недельному календарю ISO 8601 (отличающиеся от григорианских) одним из двух способов: </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>Год, номер недели и дня недели: например, <code class="literal">to_date('2006-42-4', 'IYYY-IW-ID')</code> возвращает дату <code class="literal">2006-10-19</code>. Если день недели опускается, он считается равным 1 (понедельнику).</p></li><li class="listitem"><p>Год и день года: например, <code class="literal">to_date('2006-291', 'IYYY-IDDD')</code> также возвращает <code class="literal">2006-10-19</code>.</p></li></ul></div><p>Попытка ввести дату из смеси полей григорианского и недельного календаря ISO 8601 бессмысленна, поэтому это будет считаться ошибкой. В контексте ISO 8601 понятия <span class="quote">«<span class="quote">номер месяца</span>»</span> и <span class="quote">«<span class="quote">день месяца</span>»</span> не существуют, а в григорианском календаре нет понятия номера недели по ISO.</p><div class="caution"><h3 class="title">Внимание</h3><p>Тогда как <code class="function">to_date</code> не примет смесь полей григорианского и недельного календаря ISO, <code class="function">to_char</code> способна на это, так как форматы вроде <code class="literal">YYYY-MM-DD (IYYY-IDDD)</code> могут быть полезны. Но избегайте форматов типа <code class="literal">IYYY-MM-DD</code>; в противном случае с датами в начале года возможны сюрпризы. (За дополнительными сведениями обратитесь к <a class="xref" href="functions-datetime.html#FUNCTIONS-DATETIME-EXTRACT" title="9.9.1. EXTRACT, date_part">Подразделу 9.9.1</a>.)</p></div></li><li class="listitem"><p>Функция <code class="function">to_timestamp</code> воспринимает поля миллисекунд (<code class="literal">MS</code>) или микросекунд (<code class="literal">US</code>) как дробную часть число секунд. Например, <code class="literal">to_timestamp('12.3', 'SS.MS')</code> — это не 3 миллисекунды, а 300, так как это значение воспринимается как 12 + 0.3 секунды. Это значит, что для формата <code class="literal">SS.MS</code> входные значения <code class="literal">12.3</code>, <code class="literal">12.30</code> и <code class="literal">12.300</code> задают одно и то же число миллисекунд. Чтобы получить три миллисекунды, время нужно записать в виде <code class="literal">12.003</code>, тогда оно будет воспринято как 12 + 0.003 = 12.003 сек.</p><p>Ещё более сложный пример: <code class="literal">to_timestamp('15:12:02.020.001230', 'HH24:MI:SS.MS.US')</code> будет преобразовано в 15 часов, 12 минут и 2 секунды + 20 миллисекунд + 1230 микросекунд = 2.021230 seconds.</p></li><li class="listitem"><p>Нумерация дней недели в <code class="function">to_char(..., 'ID')</code> соответствует функции <code class="function">extract(isodow from ...)</code>, но нумерация <code class="function">to_char(..., 'D')</code> не соответствует нумерации, принятой в <code class="function">extract(dow from ...)</code>.</p></li><li class="listitem"><p>Функция <code class="function">to_char(interval)</code> обрабатывает форматы <code class="literal">HH</code> и <code class="literal">HH12</code> в рамках 12 часов, то есть 0 и 36 часов будут выводиться как <code class="literal">12</code>, тогда как <code class="literal">HH24</code> выводит число часов полностью, и для значений <code class="type">interval</code> результат может превышать 23.</p></li></ul></div><p>Коды форматирования числовых значений перечислены в <a class="xref" href="functions-formatting.html#FUNCTIONS-FORMATTING-NUMERIC-TABLE" title="Таблица 9.29. Коды форматирования чисел">Таблице 9.29</a>.</p><div class="table" id="FUNCTIONS-FORMATTING-NUMERIC-TABLE"><p class="title"><strong>Таблица 9.29. Коды форматирования чисел</strong></p><div class="table-contents"><table class="table" summary="Коды форматирования чисел" border="1"><colgroup><col /><col /></colgroup><thead><tr><th>Код</th><th>Описание</th></tr></thead><tbody><tr><td><code class="literal">9</code></td><td>позиция цифры (может отсутствовать, если цифра незначащая)</td></tr><tr><td><code class="literal">0</code></td><td>позиция цифры (присутствует всегда, даже если цифра незначащая)</td></tr><tr><td><code class="literal">.</code> (точка)</td><td>десятичная точка</td></tr><tr><td><code class="literal">,</code> (запятая)</td><td>разделитель групп (тысяч)</td></tr><tr><td><code class="literal">PR</code></td><td>отрицательное значение в угловых скобках</td></tr><tr><td><code class="literal">S</code></td><td>знак, добавляемый к числу (с учётом локали)</td></tr><tr><td><code class="literal">L</code></td><td>символ денежной единицы (с учётом локали)</td></tr><tr><td><code class="literal">D</code></td><td>разделитель целой и дробной части числа (с учётом локали)</td></tr><tr><td><code class="literal">G</code></td><td>разделитель групп (с учётом локали)</td></tr><tr><td><code class="literal">MI</code></td><td>знак минус в заданной позиции (если число &lt; 0)</td></tr><tr><td><code class="literal">PL</code></td><td>знак плюс в заданной позиции (если число &gt; 0)</td></tr><tr><td><code class="literal">SG</code></td><td>знак плюс или минус в заданной позиции</td></tr><tr><td><code class="literal">RN</code></td><td>число римскими цифрами (в диапазоне от 1 до 3999)</td></tr><tr><td><code class="literal">TH</code> или <code class="literal">th</code></td><td>окончание порядкового числительного</td></tr><tr><td><code class="literal">V</code></td><td>сдвиг на заданное количество цифр (см. замечания)</td></tr><tr><td><code class="literal">EEEE</code></td><td>экспоненциальная запись числа</td></tr></tbody></table></div></div><br class="table-break" /><p>Замечания по использованию форматов чисел: </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="literal">0</code> обозначает позицию цифры, которая будет выводиться всегда, даже если это незначащий ноль слева или справа. <code class="literal">9</code> также обозначает позицию цифры, но если это незначащий ноль слева, он заменяется пробелом, а если справа и задан режим заполнения, он удаляется. (Для функции <code class="function">to_number()</code> эти два символа равнозначны.)</p></li><li class="listitem"><p>Если в формате числа предусмотрено меньше знаков после запятой, чем в форматируемом числе, функция <code class="function">to_char()</code> округлит число до указанного количества знаков.</p></li><li class="listitem"><p>Символы шаблона <code class="literal">S</code>, <code class="literal">L</code>, <code class="literal">D</code> и <code class="literal">G</code> представляют знак, символ денежной единицы, десятичную точку и разделитель тысяч, как их определяет текущая локаль (см. <a class="xref" href="runtime-config-client.html#GUC-LC-MONETARY">lc_monetary</a> и <a class="xref" href="runtime-config-client.html#GUC-LC-NUMERIC">lc_numeric</a>). Символы точка и запятая представляют те же символы, обозначающие десятичную точку и разделитель тысяч, но не зависят от локали.</p></li><li class="listitem"><p>Если в шаблоне <code class="function">to_char()</code> отсутствует явное указание положения знака, для него резервируется одна позиция рядом с числом (слева от него). Если левее нескольких <code class="literal">9</code> помещён <code class="literal">S</code>, знак также будет приписан слева к числу.</p></li><li class="listitem"><p>Знак числа, полученный кодами <code class="literal">SG</code>, <code class="literal">PL</code> или <code class="literal">MI</code>, не присоединяется к числу; например, <code class="literal">to_char(-12, 'MI9999')</code> выдаёт <code class="literal">'-  12'</code>, тогда как <code class="literal">to_char(-12, 'S9999')</code> — <code class="literal">'  -12'</code>. (В Oracle <code class="literal">MI</code> не может идти перед <code class="literal">9</code>, наоборот <code class="literal">9</code> нужно указать перед <code class="literal">MI</code>.)</p></li><li class="listitem"><p><code class="literal">TH</code> не преобразует значения меньше 0 и не поддерживает дробные числа.</p></li><li class="listitem"><p><code class="literal">PL</code>, <code class="literal">SG</code> и <code class="literal">TH</code> — расширения <span class="productname">PostgreSQL</span>.</p></li><li class="listitem"><p>В <code class="function">to_number</code> при использовании шаблонных кодов, не обозначающих данные, таких как <code class="literal">L</code> и <code class="literal">TH</code>, пропускается соответствующее количество входных символов. При этом не имеет значения, совпадают ли они с символами шаблона, если только это не символы данных (то есть цифры, знак числа, десятичная точка или запятая). Например, для подстроки <code class="literal">TH</code> будут пропущены два символа, не представляющие данные.</p></li><li class="listitem"><p><code class="literal">V</code> c <code class="function">to_char</code> умножает вводимое значение на <code class="literal">10^<em class="replaceable"><code>n</code></em></code>, где <em class="replaceable"><code>n</code></em> — число цифр, следующих за <code class="literal">V</code>. <code class="literal">V</code> с <code class="function">to_number</code> подобным образом делит значение. Функции <code class="function">to_char</code> и <code class="function">to_number</code> не поддерживают <code class="literal">V</code> с дробными числами (например, <code class="literal">99.9V99</code> не допускается).</p></li><li class="listitem"><p>Код <code class="literal">EEEE</code> (научная запись) не может сочетаться с любыми другими вариантами форматирования или модификаторами, за исключением цифр и десятичной точки, и должен располагаться в конце строки шаблона (например, <code class="literal">9.99EEEE</code> — допустимый шаблон).</p></li></ul></div><p>Для изменения поведения кодов к ним могут быть применены определённые модификаторы. Например, <code class="literal">FM99.99</code> обрабатывается как код <code class="literal">99.99</code> с модификатором <code class="literal">FM</code>. Все модификаторы для форматирования чисел перечислены в <a class="xref" href="functions-formatting.html#FUNCTIONS-FORMATTING-NUMERICMOD-TABLE" title="Таблица 9.30. Модификаторы шаблонов для форматирования чисел">Таблице 9.30</a>.</p><div class="table" id="FUNCTIONS-FORMATTING-NUMERICMOD-TABLE"><p class="title"><strong>Таблица 9.30. Модификаторы шаблонов для форматирования чисел</strong></p><div class="table-contents"><table class="table" summary="Модификаторы шаблонов для форматирования чисел" border="1"><colgroup><col /><col /><col /></colgroup><thead><tr><th>Модификатор</th><th>Описание</th><th>Пример</th></tr></thead><tbody><tr><td>Приставка <code class="literal">FM</code></td><td>режим заполнения (подавляет завершающие нули и дополнение пробелами)</td><td><code class="literal">FM99.99</code></td></tr><tr><td>Окончание <code class="literal">TH</code></td><td>окончание порядкового числительного в верхнем регистре</td><td><code class="literal">999TH</code></td></tr><tr><td>Окончание <code class="literal">th</code></td><td>окончание порядкового числительного в нижнем регистре</td><td><code class="literal">999th</code></td></tr></tbody></table></div></div><br class="table-break" /><p>В <a class="xref" href="functions-formatting.html#FUNCTIONS-FORMATTING-EXAMPLES-TABLE" title="Таблица 9.31. Примеры to_char">Таблице 9.31</a> приведены некоторые примеры использования функции <code class="function">to_char</code>.</p><div class="table" id="FUNCTIONS-FORMATTING-EXAMPLES-TABLE"><p class="title"><strong>Таблица 9.31. Примеры <code class="function">to_char</code></strong></p><div class="table-contents"><table class="table" summary="Примеры to_char" border="1"><colgroup><col /><col /></colgroup><thead><tr><th>Выражение</th><th>Результат</th></tr></thead><tbody><tr><td><code class="literal">to_char(current_timestamp, 'Day, DD  HH12:MI:SS')</code></td><td><code class="literal">'Tuesday  , 06  05:39:18'</code></td></tr><tr><td><code class="literal">to_char(current_timestamp, 'FMDay, FMDD  HH12:MI:SS')</code></td><td><code class="literal">'Tuesday, 6  05:39:18'</code></td></tr><tr><td><code class="literal">to_char(-0.1, '99.99')</code></td><td><code class="literal">'  -.10'</code></td></tr><tr><td><code class="literal">to_char(-0.1, 'FM9.99')</code></td><td><code class="literal">'-.1'</code></td></tr><tr><td><code class="literal">to_char(-0.1, 'FM90.99')</code></td><td><code class="literal">'-0.1'</code></td></tr><tr><td><code class="literal">to_char(0.1, '0.9')</code></td><td><code class="literal">' 0.1'</code></td></tr><tr><td><code class="literal">to_char(12, '9990999.9')</code></td><td><code class="literal">'    0012.0'</code></td></tr><tr><td><code class="literal">to_char(12, 'FM9990999.9')</code></td><td><code class="literal">'0012.'</code></td></tr><tr><td><code class="literal">to_char(485, '999')</code></td><td><code class="literal">' 485'</code></td></tr><tr><td><code class="literal">to_char(-485, '999')</code></td><td><code class="literal">'-485'</code></td></tr><tr><td><code class="literal">to_char(485, '9 9 9')</code></td><td><code class="literal">' 4 8 5'</code></td></tr><tr><td><code class="literal">to_char(1485, '9,999')</code></td><td><code class="literal">' 1,485'</code></td></tr><tr><td><code class="literal">to_char(1485, '9G999')</code></td><td><code class="literal">' 1 485'</code></td></tr><tr><td><code class="literal">to_char(148.5, '999.999')</code></td><td><code class="literal">' 148.500'</code></td></tr><tr><td><code class="literal">to_char(148.5, 'FM999.999')</code></td><td><code class="literal">'148.5'</code></td></tr><tr><td><code class="literal">to_char(148.5, 'FM999.990')</code></td><td><code class="literal">'148.500'</code></td></tr><tr><td><code class="literal">to_char(148.5, '999D999')</code></td><td><code class="literal">' 148,500'</code></td></tr><tr><td><code class="literal">to_char(3148.5, '9G999D999')</code></td><td><code class="literal">' 3 148,500'</code></td></tr><tr><td><code class="literal">to_char(-485, '999S')</code></td><td><code class="literal">'485-'</code></td></tr><tr><td><code class="literal">to_char(-485, '999MI')</code></td><td><code class="literal">'485-'</code></td></tr><tr><td><code class="literal">to_char(485, '999MI')</code></td><td><code class="literal">'485 '</code></td></tr><tr><td><code class="literal">to_char(485, 'FM999MI')</code></td><td><code class="literal">'485'</code></td></tr><tr><td><code class="literal">to_char(485, 'PL999')</code></td><td><code class="literal">'+485'</code></td></tr><tr><td><code class="literal">to_char(485, 'SG999')</code></td><td><code class="literal">'+485'</code></td></tr><tr><td><code class="literal">to_char(-485, 'SG999')</code></td><td><code class="literal">'-485'</code></td></tr><tr><td><code class="literal">to_char(-485, '9SG99')</code></td><td><code class="literal">'4-85'</code></td></tr><tr><td><code class="literal">to_char(-485, '999PR')</code></td><td><code class="literal">'&lt;485&gt;'</code></td></tr><tr><td><code class="literal">to_char(485, 'L999')</code></td><td><code class="literal">'DM 485'</code></td></tr><tr><td><code class="literal">to_char(485, 'RN')</code></td><td><code class="literal">'        CDLXXXV'</code></td></tr><tr><td><code class="literal">to_char(485, 'FMRN')</code></td><td><code class="literal">'CDLXXXV'</code></td></tr><tr><td><code class="literal">to_char(5.2, 'FMRN')</code></td><td><code class="literal">'V'</code></td></tr><tr><td><code class="literal">to_char(482, '999th')</code></td><td><code class="literal">' 482nd'</code></td></tr><tr><td><code class="literal">to_char(485, '"Good number:"999')</code></td><td><code class="literal">'Good number: 485'</code></td></tr><tr><td><code class="literal">to_char(485.8, '"Pre:"999" Post:" .999')</code></td><td><code class="literal">'Pre: 485 Post: .800'</code></td></tr><tr><td><code class="literal">to_char(12, '99V999')</code></td><td><code class="literal">' 12000'</code></td></tr><tr><td><code class="literal">to_char(12.4, '99V999')</code></td><td><code class="literal">' 12400'</code></td></tr><tr><td><code class="literal">to_char(12.45, '99V9')</code></td><td><code class="literal">' 125'</code></td></tr><tr><td><code class="literal">to_char(0.0004859, '9.99EEEE')</code></td><td><code class="literal">' 4.86e-04'</code></td></tr></tbody></table></div></div><br class="table-break" /></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="functions-matching.html" title="9.7. Поиск по шаблону">Пред.</a> </td><td width="20%" align="center"><a accesskey="u" href="functions.html" title="Глава 9. Функции и операторы">Наверх</a></td><td width="40%" align="right"> <a accesskey="n" href="functions-datetime.html" title="9.9. Операторы и функции даты/времени">След.</a></td></tr><tr><td width="40%" align="left" valign="top">9.7. Поиск по шаблону </td><td width="20%" align="center"><a accesskey="h" href="index.html" title="Документация к PostgreSQL 16.3">Начало</a></td><td width="40%" align="right" valign="top"> 9.9. Операторы и функции даты/времени</td></tr></table></div></body></html>