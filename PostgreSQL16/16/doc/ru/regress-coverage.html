<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>33.5. Определение покрытия кода тестами</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@lists.postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot" /><link rel="prev" href="regress-tap.html" title="33.4. TAP-тесты" /><link rel="next" href="client-interfaces.html" title="Часть IV. Клиентские интерфейсы" /></head><body id="docContent" class="container-fluid col-10"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">33.5. Определение покрытия кода тестами</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="regress-tap.html" title="33.4. TAP-тесты">Пред.</a> </td><td width="10%" align="left"><a accesskey="u" href="regress.html" title="Глава 33. Регрессионные тесты">Наверх</a></td><th width="60%" align="center">Глава 33. Регрессионные тесты</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="Документация к PostgreSQL 16.3">Начало</a></td><td width="10%" align="right"> <a accesskey="n" href="client-interfaces.html" title="Часть IV. Клиентские интерфейсы">След.</a></td></tr></table><hr /></div><div class="sect1" id="REGRESS-COVERAGE"><div class="titlepage"><div><div><h2 class="title" style="clear: both">33.5. Определение покрытия кода тестами <a href="#REGRESS-COVERAGE" class="id_link">#</a></h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="sect2"><a href="regress-coverage.html#REGRESS-COVERAGE-CONFIGURE">33.5.1. Покрытие с Autoconf и Make</a></span></dt><dt><span class="sect2"><a href="regress-coverage.html#REGRESS-COVERAGE-MESON">33.5.2. Покрытие с Meson</a></span></dt></dl></div><p>Исходный код PostgreSQL может быть скомпилирован с инструментарием определения покрытия, чтобы узнать, какие части кода покрываются регрессионными тестами или другим комплектом тестов, выполняемых в дереве кода. В настоящее время эта возможность поддерживается в случае использования компилятора GCC и требует наличия пакетов <code class="literal">gcov</code> и <code class="literal">lcov</code>.</p><div class="sect2" id="REGRESS-COVERAGE-CONFIGURE"><div class="titlepage"><div><div><h3 class="title">33.5.1. Покрытие с Autoconf и Make <a href="#REGRESS-COVERAGE-CONFIGURE" class="id_link">#</a></h3></div></div></div><p>Типичный рабочий процесс выглядит так: </p><pre class="screen">
./configure --enable-coverage ... OTHER OPTIONS ...
make
make check # или другой комплект тестов
make coverage-html
</pre><p> Затем откройте в своём HTML-браузере страницу <code class="filename">coverage/index.html</code>.</p><p>Если у вас нет программы <code class="command">lcov</code> или вы предпочитаете HTML-отчёту текстовый формат, вы можете выполнить </p><pre class="screen">
make coverage
</pre><p> вместо <code class="literal">make coverage-html</code> и получить выходные файлы <code class="filename">.gcov</code> для каждого исходного файла, относящегося к тесту. (Команды <code class="literal">make coverage</code> и <code class="literal">make coverage-html</code> перезаписывают файлы друг друга, поэтому при одновременном их использовании может возникнуть путаница.)</p><p>Вы можете запустить несколько разных тестов перед проверкой покрытия — счётчики выполнений будут накапливать значения. Чтобы счётчики выполнений сбрасывались между тестами, запустите: </p><pre class="screen">
make coverage-clean
</pre><p>Если вам нужно собрать покрытие только для части дерева исходного кода, вы можете запустить команду <code class="literal">make coverage-html</code> или <code class="literal">make coverage</code> в подкаталоге.</p><p>После завершения тестирования выполните очистку с помощью <code class="literal">make distclean</code>.</p></div><div class="sect2" id="REGRESS-COVERAGE-MESON"><div class="titlepage"><div><div><h3 class="title">33.5.2. Покрытие с Meson <a href="#REGRESS-COVERAGE-MESON" class="id_link">#</a></h3></div></div></div><p>Типичный рабочий процесс выглядит так: </p><pre class="screen">
meson setup -Db_coverage=true ... OTHER OPTIONS ... builddir/
meson compile -C builddir/
meson test -C builddir/
cd builddir/
ninja coverage-html
</pre><p> Затем откройте в своём HTML-браузере страницу <code class="filename">/meson-logs/coveragereport/index.html</code>.</p><p>Вы можете запустить несколько разных тестов перед проверкой покрытия — счётчики выполнений будут накапливать значения.</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="regress-tap.html" title="33.4. TAP-тесты">Пред.</a> </td><td width="20%" align="center"><a accesskey="u" href="regress.html" title="Глава 33. Регрессионные тесты">Наверх</a></td><td width="40%" align="right"> <a accesskey="n" href="client-interfaces.html" title="Часть IV. Клиентские интерфейсы">След.</a></td></tr><tr><td width="40%" align="left" valign="top">33.4. TAP-тесты </td><td width="20%" align="center"><a accesskey="h" href="index.html" title="Документация к PostgreSQL 16.3">Начало</a></td><td width="40%" align="right" valign="top"> Часть IV. Клиентские интерфейсы</td></tr></table></div></body></html>