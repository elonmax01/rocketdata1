<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>8.1. Числовые типы</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@lists.postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot" /><link rel="prev" href="datatype.html" title="Глава 8. Типы данных" /><link rel="next" href="datatype-money.html" title="8.2. Денежные типы" /></head><body id="docContent" class="container-fluid col-10"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">8.1. Числовые типы</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="datatype.html" title="Глава 8. Типы данных">Пред.</a> </td><td width="10%" align="left"><a accesskey="u" href="datatype.html" title="Глава 8. Типы данных">Наверх</a></td><th width="60%" align="center">Глава 8. Типы данных</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="Документация к PostgreSQL 16.3">Начало</a></td><td width="10%" align="right"> <a accesskey="n" href="datatype-money.html" title="8.2. Денежные типы">След.</a></td></tr></table><hr /></div><div class="sect1" id="DATATYPE-NUMERIC"><div class="titlepage"><div><div><h2 class="title" style="clear: both">8.1. Числовые типы <a href="#DATATYPE-NUMERIC" class="id_link">#</a></h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="sect2"><a href="datatype-numeric.html#DATATYPE-INT">8.1.1. Целочисленные типы</a></span></dt><dt><span class="sect2"><a href="datatype-numeric.html#DATATYPE-NUMERIC-DECIMAL">8.1.2. Числа с произвольной точностью</a></span></dt><dt><span class="sect2"><a href="datatype-numeric.html#DATATYPE-FLOAT">8.1.3. Типы с плавающей точкой</a></span></dt><dt><span class="sect2"><a href="datatype-numeric.html#DATATYPE-SERIAL">8.1.4. Последовательные типы</a></span></dt></dl></div><a id="id-1.5.7.9.2" class="indexterm"></a><p>Числовые типы включают двух-, четырёх- и восьмибайтные целые, четырёх- и восьмибайтные числа с плавающей точкой, а также десятичные числа с задаваемой точностью. Все эти типы перечислены в <a class="xref" href="datatype-numeric.html#DATATYPE-NUMERIC-TABLE" title="Таблица 8.2. Числовые типы">Таблице 8.2</a>.</p><div class="table" id="DATATYPE-NUMERIC-TABLE"><p class="title"><strong>Таблица 8.2. Числовые типы</strong></p><div class="table-contents"><table class="table" summary="Числовые типы" border="1"><colgroup><col class="col1" /><col class="col2" /><col class="col3" /><col class="col4" /></colgroup><thead><tr><th>Name</th><th>Размер</th><th>Описание</th><th>Диапазон</th></tr></thead><tbody><tr><td><code class="type">smallint</code></td><td>2 байта</td><td>целое в небольшом диапазоне</td><td>-32768 .. +32767</td></tr><tr><td><code class="type">integer</code></td><td>4 байта</td><td>типичный выбор для целых чисел</td><td>-2147483648 .. +2147483647</td></tr><tr><td><code class="type">bigint</code></td><td>8 байт</td><td>целое в большом диапазоне</td><td>-9223372036854775808 .. 9223372036854775807</td></tr><tr><td><code class="type">decimal</code></td><td>переменный</td><td>вещественное число с указанной точностью</td><td>до 131072 цифр до десятичной точки и до 16383 — после</td></tr><tr><td><code class="type">numeric</code></td><td>переменный</td><td>вещественное число с указанной точностью</td><td>до 131072 цифр до десятичной точки и до 16383 — после</td></tr><tr><td><code class="type">real</code></td><td>4 байта</td><td>вещественное число с переменной точностью</td><td>точность в пределах 6 десятичных цифр</td></tr><tr><td><code class="type">double precision</code></td><td>8 байт</td><td>вещественное число с переменной точностью</td><td>точность в пределах 15 десятичных цифр</td></tr><tr><td><code class="type">smallserial</code></td><td>2 байта</td><td>небольшое целое с автоувеличением</td><td>1 .. 32767</td></tr><tr><td><code class="type">serial</code></td><td>4 байта</td><td>целое с автоувеличением</td><td>1 .. 2147483647</td></tr><tr><td><code class="type">bigserial</code></td><td>8 байт</td><td>большое целое с автоувеличением</td><td>1 .. 9223372036854775807</td></tr></tbody></table></div></div><br class="table-break" /><p>Синтаксис констант числовых типов описан в <a class="xref" href="sql-syntax-lexical.html#SQL-SYNTAX-CONSTANTS" title="4.1.2. Константы">Подразделе 4.1.2</a>. Для этих типов определён полный набор соответствующих арифметических операторов и функций. За дополнительными сведениями обратитесь к <a class="xref" href="functions.html" title="Глава 9. Функции и операторы">Главе 9</a>. Подробнее эти типы описаны в следующих разделах.</p><div class="sect2" id="DATATYPE-INT"><div class="titlepage"><div><div><h3 class="title">8.1.1. Целочисленные типы <a href="#DATATYPE-INT" class="id_link">#</a></h3></div></div></div><a id="id-1.5.7.9.6.2" class="indexterm"></a><a id="id-1.5.7.9.6.3" class="indexterm"></a><a id="id-1.5.7.9.6.4" class="indexterm"></a><a id="id-1.5.7.9.6.5" class="indexterm"></a><a id="id-1.5.7.9.6.6" class="indexterm"></a><a id="id-1.5.7.9.6.7" class="indexterm"></a><p>Типы <code class="type">smallint</code>, <code class="type">integer</code> и <code class="type">bigint</code> хранят целые числа, то есть числа без дробной части, имеющие разные допустимые диапазоны. Попытка сохранить значение, выходящее за рамки диапазона, приведёт к ошибке.</p><p>Чаще всего используется тип <code class="type">integer</code>, как наиболее сбалансированный выбор ширины диапазона, размера и быстродействия. Тип <code class="type">smallint</code> обычно применяется, только когда крайне важно уменьшить размер данных на диске. Тип <code class="type">bigint</code> предназначен для тех случаев, когда числа не умещаются в диапазон типа <code class="type">integer</code>.</p><p>В <acronym class="acronym">SQL</acronym> определены только типы <code class="type">integer</code> (или <code class="type">int</code>), <code class="type">smallint</code> и <code class="type">bigint</code>. Имена типов <code class="type">int2</code>, <code class="type">int4</code> и <code class="type">int8</code> выходят за рамки стандарта, хотя могут работать и в некоторых других СУБД.</p></div><div class="sect2" id="DATATYPE-NUMERIC-DECIMAL"><div class="titlepage"><div><div><h3 class="title">8.1.2. Числа с произвольной точностью <a href="#DATATYPE-NUMERIC-DECIMAL" class="id_link">#</a></h3></div></div></div><a id="id-1.5.7.9.7.2" class="indexterm"></a><a id="id-1.5.7.9.7.3" class="indexterm"></a><a id="id-1.5.7.9.7.4" class="indexterm"></a><p>Тип <code class="type">numeric</code> позволяет хранить числа с очень большим количеством цифр. Он особенно рекомендуется для хранения денежных сумм и других величин, где важна точность. Вычисления с типом <code class="type">numeric</code> дают точные результаты, где это возможно, например, при сложении, вычитании и умножении. Однако операции со значениями <code class="type">numeric</code> выполняются гораздо медленнее, чем с целыми числами или с типами с плавающей точкой, описанными в следующем разделе.</p><p>Ниже мы используем следующие термины: <em class="firstterm">масштаб</em> значения <code class="type">numeric</code> определяет количество десятичных цифр в дробной части, справа от десятичной точки, а <em class="firstterm">точность</em> — общее количество значимых цифр в числе, т. е. количество цифр по обе стороны десятичной точки. Например, число 23.5141 имеет точность 6 и масштаб 4. Целочисленные значения можно считать числами с масштабом 0.</p><p>Для столбца типа <code class="type">numeric</code> можно настроить и максимальную точность, и максимальный масштаб. Столбец типа <code class="type">numeric</code> объявляется следующим образом: </p><pre class="programlisting">NUMERIC(<em class="replaceable"><code>точность</code></em>, <em class="replaceable"><code>масштаб</code></em>)</pre><p> Точность должна быть положительной, а масштаб может быть положительным или отрицательным (см. ниже). Альтернативный вариант </p><pre class="programlisting">NUMERIC(<em class="replaceable"><code>точность</code></em>)</pre><p> устанавливает масштаб 0. Форма: </p><pre class="programlisting">NUMERIC</pre><p> без указания точности и масштаба создаёт столбец типа <span class="quote">«<span class="quote">неограниченное число</span>»</span>, в котором можно сохранять числовые значения любой длины до предела, обусловленного реализацией. В столбце этого типа входные значения не будут приводиться к какому-либо масштабу, тогда как в столбцах <code class="type">numeric</code> с явно заданным масштабом значения подгоняются под этот масштаб. (Стандарт <acronym class="acronym">SQL</acronym> утверждает, что по умолчанию должен устанавливаться масштаб 0, т. е. значения должны приводиться к целым числам. Однако мы считаем это не очень полезным. Если для вас важна переносимость, всегда указывайте точность и масштаб явно.)</p><div class="note"><h3 class="title">Примечание</h3><p>Максимальная точность, которую можно указать в объявлении типа <code class="type">numeric</code>, равна 1000. Для столбцов типа <span class="quote">«<span class="quote">неограниченный <code class="type">numeric</code></span>»</span> существуют пределы, описанные в <a class="xref" href="datatype-numeric.html#DATATYPE-NUMERIC-TABLE" title="Таблица 8.2. Числовые типы">Таблице 8.2</a>.</p></div><p>Если масштаб значения, которое нужно сохранить, превышает объявленный масштаб столбца, система округлит его до заданного количества цифр после точки. Если же после этого количество цифр слева в сумме с масштабом превысит объявленную точность, произойдёт ошибка. Например, столбец, объявленный как </p><pre class="programlisting">NUMERIC(3, 1)</pre><p>, будет содержать значения, округлённые до одного десятичного знака, от -99.9 до 99.9 включительно.</p><p>Начиная с <span class="productname">PostgreSQL</span> 15, столбец типа <code class="type">numeric</code> можно объявить с отрицательным масштабом. В этом случае значения будут округляться до позиции слева от десятичной точки. При этом точность так же задаёт максимальное число цифр, без учёта округления. Таким образом, в столбце, объявленном как </p><pre class="programlisting">NUMERIC(2, -3)</pre><p>, число будет округляться до ближайшей тысячи, и в нём можно будет хранить значения от -99000 до 99000 включительно. Также вполне возможно задать масштаб, превышающий объявленную точность. Такой столбец сможет содержать только дробные значения, в которых количество нулей сразу после точки должно равняться разности масштаба и точности. Например, столбец, объявленный как </p><pre class="programlisting">NUMERIC(3, 5)</pre><p>, будет округлять значения до пяти знаков после точки и сможет хранить значения от -0.00999 до 0.00999 включительно.</p><div class="note"><h3 class="title">Примечание</h3><p><span class="productname">PostgreSQL</span> позволяет использовать в объявлении типа <code class="type">numeric</code> любое значение масштаба в диапазоне от -1000 до 1000. Однако стандарт <acronym class="acronym">SQL</acronym> требует, чтобы масштаб находился в диапазоне от 0 до значения <em class="replaceable"><code>точности</code></em>. Масштабы вне этого диапазона могут не поддерживаться другими системами баз данных.</p></div><p>Числовые значения физически хранятся без каких-либо дополняющих нулей слева или справа. Таким образом, объявляемые точность и масштаб столбца определяют максимальный, а не фиксированный размер хранения. (В этом смысле тип <code class="type">numeric</code> больше похож на тип <code class="type">varchar(<em class="replaceable"><code>n</code></em>)</code>, чем на <code class="type">char(<em class="replaceable"><code>n</code></em>)</code>.) Действительный размер хранения такого значения складывается из двух байт для каждой группы из четырёх цифр и дополнительных трёх-восьми байт.</p><a id="id-1.5.7.9.7.13" class="indexterm"></a><a id="id-1.5.7.9.7.14" class="indexterm"></a><a id="id-1.5.7.9.7.15" class="indexterm"></a><p>В дополнение к обычным числовым значениям тип <code class="type">numeric</code> принимает следующие специальные значения: </p><div class="literallayout"><p><br />
<code class="literal">Infinity</code><br />
<code class="literal">-Infinity</code><br />
<code class="literal">NaN</code><br />
</p></div><p> Они представляют особые значения, описанные в IEEE 754, соответственно <span class="quote">«<span class="quote">бесконечность</span>»</span>, <span class="quote">«<span class="quote">минус бесконечность</span>»</span> и <span class="quote">«<span class="quote">не число</span>»</span>. Записывая эти значения в виде констант в команде SQL, их нужно заключать в апострофы, например так: <code class="literal">UPDATE table SET x = '-Infinity'</code>. Регистр символов в этих строках не важен. В качестве альтернативы значения бесконечности могут быть записаны как <code class="literal">inf</code> и <code class="literal">-inf</code>.</p><p>Значения бесконечности соответствуют ожиданиям с точки зрения математики. Например, <code class="literal">Infinity</code> плюс любое конечное значение равно <code class="literal">Infinity</code>, как и <code class="literal">Infinity</code> плюс <code class="literal">Infinity</code>; но <code class="literal"> Infinity</code> минус <code class="literal">Infinity</code> даёт <code class="literal">NaN</code> (не число), потому что в результате получается неопределённость. Обратите внимание, что бесконечность может быть сохранена только в столбце типа <span class="quote">«<span class="quote">неограниченный <code class="type">numeric</code></span>»</span>, потому что она теоретически превышает любой конечный предел точности.</p><p>Значение <code class="literal">NaN</code> (не число) используется для представления неопределённых результатов вычислений. Вообще, любая операция с <code class="literal">NaN</code> выдаёт в результате тоже <code class="literal">NaN</code>. Единственное исключение составляют операции, которые дают один и тот же результат для любого числового значения, конечного или бесконечного — этот результат будет выдаваться и для <code class="literal">NaN</code>. (Пример этого принципа: результатом возведения <code class="literal">NaN</code> в нулевую степень будет единица.)</p><div class="note"><h3 class="title">Примечание</h3><p>В большинстве реализаций <span class="quote">«<span class="quote">не число</span>»</span> (<code class="literal">NaN</code>) считается не равным любому другому значению (в том числе и самому <code class="literal">NaN</code>). Чтобы значения <code class="type">numeric</code> можно было сортировать и использовать в древовидных индексах, <span class="productname">PostgreSQL</span> считает, что значения <code class="literal">NaN</code> равны друг другу и при этом больше любых числовых значений (не <code class="literal">NaN</code>).</p></div><p>Типы <code class="type">decimal</code> и <code class="type">numeric</code> равнозначны. Оба эти типа описаны в стандарте <acronym class="acronym">SQL</acronym>.</p><p>При округлении значений тип <code class="type">numeric</code> выдаёт число, большее по модулю, тогда как (на большинстве платформ) типы <code class="type">real</code> и <code class="type">double precision</code> выдают ближайшее чётное число. Например: </p><pre class="programlisting">SELECT x,
  round(x::numeric) AS num_round,
  round(x::double precision) AS dbl_round
FROM generate_series(-3.5, 3.5, 1) as x;
  x   | num_round | dbl_round
------+-----------+-----------
 -3.5 |        -4 |        -4
 -2.5 |        -3 |        -2
 -1.5 |        -2 |        -2
 -0.5 |        -1 |        -0
  0.5 |         1 |         0
  1.5 |         2 |         2
  2.5 |         3 |         2
  3.5 |         4 |         4
(8 rows)</pre></div><div class="sect2" id="DATATYPE-FLOAT"><div class="titlepage"><div><div><h3 class="title">8.1.3. Типы с плавающей точкой <a href="#DATATYPE-FLOAT" class="id_link">#</a></h3></div></div></div><a id="id-1.5.7.9.8.2" class="indexterm"></a><a id="id-1.5.7.9.8.3" class="indexterm"></a><a id="id-1.5.7.9.8.4" class="indexterm"></a><a id="id-1.5.7.9.8.5" class="indexterm"></a><a id="id-1.5.7.9.8.6" class="indexterm"></a><p>Типы данных <code class="type">real</code> и <code class="type">double precision</code> хранят приближённые числовые значения с переменной точностью. На всех поддерживаемых в настоящее время платформах эти типы реализуют стандарт <acronym class="acronym">IEEE</acronym> 754 для двоичной арифметики с плавающей точкой (с одинарной и двойной точностью соответственно), в той мере, в какой его поддерживают процессор, операционная система и компилятор.</p><p>Неточность здесь выражается в том, что некоторые значения, которые нельзя преобразовать во внутренний формат, сохраняются приближённо, так что полученное значение может несколько отличаться от записанного. Управление подобными ошибками и их распространение в процессе вычислений является предметом изучения целого раздела математики и компьютерной науки, и здесь не рассматривается. Мы отметим только следующее: </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Если вам нужна точность при хранении и вычислениях (например, для денежных сумм), используйте вместо этого тип <code class="type">numeric</code>.</p></li><li class="listitem"><p>Если вы хотите выполнять с этими типами сложные вычисления, имеющие большую важность, тщательно изучите реализацию операций в вашей среде и особенно поведение в крайних случаях (бесконечность, антипереполнение).</p></li><li class="listitem"><p>Проверка равенства двух чисел с плавающей точкой может не всегда давать ожидаемый результат.</p></li></ul></div><p>На всех поддерживаемых сейчас платформах тип <code class="type">real</code> может сохранить значения примерно от 1E-37 до 1E+37 с точностью не меньше 6 десятичных цифр. Тип <code class="type">double precision</code> предлагает значения в диапазоне приблизительно от 1E-307 до 1E+308 и с точностью не меньше 15 цифр. Попытка сохранить слишком большие или слишком маленькие значения приведёт к ошибке. Если точность вводимого числа слишком велика, оно будет округлено. При попытке сохранить число, близкое к 0, но непредставимое как отличное от 0, произойдёт ошибка антипереполнения.</p><p>По умолчанию числа с плавающей точкой выводятся в текстовом виде в кратчайшем точном десятичном представлении; выводимое десятичное значение оказывается более близким к изначальному двоичному числу, чем любое другое значение, представимое с той же двоичной точностью. (Однако выводимое значение в текущей реализации никогда не находится <span class="emphasis"><em>точно</em></span> посередине между двумя представимыми двоичными значениями, во избежание распространённой ошибки с функциями ввода, не учитывающими корректно правило округления до ближайшего чётного.) Выводимое значение может занимать не больше 17 значащих десятичных цифр для типа <code class="type">float8</code> и не больше 9 цифр для типа <code class="type">float4</code>.</p><div class="note"><h3 class="title">Примечание</h3><p>Преобразование в кратчайший точный вид производится гораздо быстрее, чем в традиционное представление с округлением.</p></div><p>Для совместимости с результатами, выдаваемыми старыми версиями <span class="productname">PostgreSQL</span>, и уменьшения точности выводимых чисел, когда это требуется, в параметре <a class="xref" href="runtime-config-client.html#GUC-EXTRA-FLOAT-DIGITS">extra_float_digits</a> можно выбрать также вариант округлённого десятичного вывода. Со значением 0 восстанавливается действовавшее ранее по умолчанию округление числа до 6 (для типа <code class="type">float4</code>) или 15 (для <code class="type">float8</code>) значащих десятичных цифр. При отрицательных значениях число значащих цифр уменьшается дополнительно; например, при -2 результат будет округлён до 4 или 13 цифр, соответственно.</p><p>При любом значении <a class="xref" href="runtime-config-client.html#GUC-EXTRA-FLOAT-DIGITS">extra_float_digits</a>, большем 0, выбирается кратчайшее точное представление.</p><div class="note"><h3 class="title">Примечание</h3><p>Приложения, которым были нужны точные числовые значения, раньше задавали для параметра <a class="xref" href="runtime-config-client.html#GUC-EXTRA-FLOAT-DIGITS">extra_float_digits</a> значение 3, чтобы получить их. Они могут продолжать использовать это значение для максимальной совместимости с разными версиями.</p></div><a id="id-1.5.7.9.8.15" class="indexterm"></a><a id="id-1.5.7.9.8.16" class="indexterm"></a><p>В дополнение к обычным числовым значениям типы с плавающей точкой принимают следующие специальные значения: </p><div class="literallayout"><p><br />
<code class="literal">Infinity</code><br />
<code class="literal">-Infinity</code><br />
<code class="literal">NaN</code><br />
</p></div><p> Они представляют особые значения, описанные в IEEE 754, соответственно <span class="quote">«<span class="quote">бесконечность</span>»</span>, <span class="quote">«<span class="quote">минус бесконечность</span>»</span> и <span class="quote">«<span class="quote">не число</span>»</span>. Записывая эти значения в виде констант в команде SQL, их нужно заключать в апострофы, например так: <code class="literal">UPDATE table SET x = '-Infinity'</code>. Регистр символов в этих строках не важен. В качестве альтернативы значения бесконечности могут быть записаны как <code class="literal">inf</code> и <code class="literal">-inf</code>.</p><div class="note"><h3 class="title">Примечание</h3><p>Согласно IEEE 754, <code class="literal">NaN</code> не должно считаться равным любому другому значению с плавающей точкой (в том числе и самому <code class="literal">NaN</code>). Чтобы значения с плавающей точкой можно было сортировать и использовать в древовидных индексах, <span class="productname">PostgreSQL</span> считает, что значения <code class="literal">NaN</code> равны друг другу, и при этом больше любых числовых значений (не <code class="literal">NaN</code>).</p></div><p><span class="productname">PostgreSQL</span> также поддерживает форматы <code class="type">float</code> и <code class="type">float(<em class="replaceable"><code>p</code></em>)</code>, оговорённые в стандарте SQL, для указания неточных числовых типов. Здесь <em class="replaceable"><code>p</code></em> определяет минимально допустимую точность в <span class="emphasis"><em>двоичных</em></span> цифрах. <span class="productname">PostgreSQL</span> воспринимает запись от <code class="type">float(1)</code> до <code class="type">float(24)</code> как выбор типа <code class="type">real</code>, а запись от <code class="type">float(25)</code> до <code class="type">float(53)</code> как выбор типа <code class="type">double precision</code>. Значения <em class="replaceable"><code>p</code></em> вне допустимого диапазона вызывают ошибку. Если <code class="type">float</code> указывается без точности, подразумевается тип <code class="type">double precision</code>.</p></div><div class="sect2" id="DATATYPE-SERIAL"><div class="titlepage"><div><div><h3 class="title">8.1.4. Последовательные типы <a href="#DATATYPE-SERIAL" class="id_link">#</a></h3></div></div></div><a id="id-1.5.7.9.9.2" class="indexterm"></a><a id="id-1.5.7.9.9.3" class="indexterm"></a><a id="id-1.5.7.9.9.4" class="indexterm"></a><a id="id-1.5.7.9.9.5" class="indexterm"></a><a id="id-1.5.7.9.9.6" class="indexterm"></a><a id="id-1.5.7.9.9.7" class="indexterm"></a><a id="id-1.5.7.9.9.8" class="indexterm"></a><a id="id-1.5.7.9.9.9" class="indexterm"></a><div class="note"><h3 class="title">Примечание</h3><p>В этом разделе описывается специфичный для PostgreSQL способ создания столбца с автоувеличением. Другой способ, соответствующий стандарту SQL, заключается в использовании столбцов идентификации и рассматривается в описании <a class="xref" href="sql-createtable.html" title="CREATE TABLE"><span class="refentrytitle">CREATE TABLE</span></a>.</p></div><p>Типы данных <code class="type">smallserial</code>, <code class="type">serial</code> и <code class="type">bigserial</code> не являются настоящими типами, а представляют собой просто удобное средство для создания столбцов с уникальными идентификаторами (подобное свойству <code class="literal">AUTO_INCREMENT</code> в некоторых СУБД). В текущей реализации запись: </p><pre class="programlisting">CREATE TABLE <em class="replaceable"><code>имя_таблицы</code></em> (
    <em class="replaceable"><code>имя_столбца</code></em> SERIAL
);</pre><p> равнозначна следующим командам: </p><pre class="programlisting">CREATE SEQUENCE <em class="replaceable"><code>имя_таблицы</code></em>_<em class="replaceable"><code>имя_столбца</code></em>_seq AS integer;
CREATE TABLE <em class="replaceable"><code>имя_таблицы</code></em> (
    <em class="replaceable"><code>имя_столбца</code></em> integer NOT NULL DEFAULT nextval('<em class="replaceable"><code>имя_таблицы</code></em>_<em class="replaceable"><code>имя_столбца</code></em>_seq')
);
ALTER SEQUENCE <em class="replaceable"><code>имя_таблицы</code></em>_<em class="replaceable"><code>имя_столбца</code></em>_seq OWNED BY <em class="replaceable"><code>имя_таблицы</code></em>.<em class="replaceable"><code>имя_столбца</code></em>;</pre><p> То есть при определении такого типа создаётся целочисленный столбец со значением по умолчанию, извлекаемым из генератора последовательности. Чтобы в столбец нельзя было вставить NULL, в его определение добавляется ограничение <code class="literal">NOT NULL</code>. (Во многих случаях также имеет смысл добавить для этого столбца ограничения <code class="literal">UNIQUE</code> или <code class="literal">PRIMARY KEY</code> для защиты от ошибочного добавления дублирующихся значений, но автоматически это не происходит.) Последняя команда определяет, что последовательность <span class="quote">«<span class="quote">принадлежит</span>»</span> столбцу, так что она будет удалена при удалении столбца или таблицы.</p><div class="note"><h3 class="title">Примечание</h3><p>Так как типы <code class="type">smallserial</code>, <code class="type">serial</code> и <code class="type">bigserial</code> реализованы через последовательности, в числовом ряду значений столбца могут образовываться пропуски (или «дыры»), даже если никакие строки не удалялись. Значение, выделенное из последовательности, считается «задействованным», даже если строку с этим значением не удалось вставить в таблицу. Это может произойти, например, при откате транзакции, добавляющей данные. См. описание <code class="literal">nextval()</code> в <a class="xref" href="functions-sequence.html" title="9.17. Функции для работы с последовательностями">Разделе 9.17</a>.</p></div><p>Чтобы вставить в столбец <code class="type">serial</code> следующее значение последовательности, ему нужно присвоить значение по умолчанию. Это можно сделать, либо исключив его из списка столбцов в операторе <code class="command">INSERT</code>, либо с помощью ключевого слова <code class="literal">DEFAULT</code>.</p><p>Имена типов <code class="type">serial</code> и <code class="type">serial4</code> равнозначны: они создают столбцы <code class="type">integer</code>. Так же являются синонимами имена <code class="type">bigserial</code> и <code class="type">serial8</code>, но они создают столбцы <code class="type">bigint</code>. Тип <code class="type">bigserial</code> следует использовать, если за всё время жизни таблицы планируется использовать больше чем 2<sup>31</sup> значений. И наконец, синонимами являются имена типов <code class="type">smallserial</code> и <code class="type">serial2</code>, но они создают столбец <code class="type">smallint</code>.</p><p>Последовательность, созданная для столбца <code class="type">serial</code>, автоматически удаляется при удалении связанного столбца. Последовательность можно удалить и отдельно от столбца, но при этом также будет удалено определение значения по умолчанию.</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="datatype.html" title="Глава 8. Типы данных">Пред.</a> </td><td width="20%" align="center"><a accesskey="u" href="datatype.html" title="Глава 8. Типы данных">Наверх</a></td><td width="40%" align="right"> <a accesskey="n" href="datatype-money.html" title="8.2. Денежные типы">След.</a></td></tr><tr><td width="40%" align="left" valign="top">Глава 8. Типы данных </td><td width="20%" align="center"><a accesskey="h" href="index.html" title="Документация к PostgreSQL 16.3">Начало</a></td><td width="40%" align="right" valign="top"> 8.2. Денежные типы</td></tr></table></div></body></html>