<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>28.2. Система накопительной статистики</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@lists.postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot" /><link rel="prev" href="monitoring-ps.html" title="28.1. Стандартные инструменты Unix" /><link rel="next" href="monitoring-locks.html" title="28.3. Просмотр информации о блокировках" /></head><body id="docContent" class="container-fluid col-10"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">28.2. Система накопительной статистики</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="monitoring-ps.html" title="28.1. Стандартные инструменты Unix">Пред.</a> </td><td width="10%" align="left"><a accesskey="u" href="monitoring.html" title="Глава 28. Мониторинг работы СУБД">Наверх</a></td><th width="60%" align="center">Глава 28. Мониторинг работы СУБД</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="Документация к PostgreSQL 16.3">Начало</a></td><td width="10%" align="right"> <a accesskey="n" href="monitoring-locks.html" title="28.3. Просмотр информации о блокировках">След.</a></td></tr></table><hr /></div><div class="sect1" id="MONITORING-STATS"><div class="titlepage"><div><div><h2 class="title" style="clear: both">28.2. Система накопительной статистики <a href="#MONITORING-STATS" class="id_link">#</a></h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="sect2"><a href="monitoring-stats.html#MONITORING-STATS-SETUP">28.2.1. Конфигурация системы сбора статистики</a></span></dt><dt><span class="sect2"><a href="monitoring-stats.html#MONITORING-STATS-VIEWS">28.2.2. Просмотр статистики</a></span></dt><dt><span class="sect2"><a href="monitoring-stats.html#MONITORING-PG-STAT-ACTIVITY-VIEW">28.2.3. <code class="structname">pg_stat_activity</code></a></span></dt><dt><span class="sect2"><a href="monitoring-stats.html#MONITORING-PG-STAT-REPLICATION-VIEW">28.2.4. <code class="structname">pg_stat_replication</code></a></span></dt><dt><span class="sect2"><a href="monitoring-stats.html#MONITORING-PG-STAT-REPLICATION-SLOTS-VIEW">28.2.5. <code class="structname">pg_stat_replication_slots</code></a></span></dt><dt><span class="sect2"><a href="monitoring-stats.html#MONITORING-PG-STAT-WAL-RECEIVER-VIEW">28.2.6. <code class="structname">pg_stat_wal_receiver</code></a></span></dt><dt><span class="sect2"><a href="monitoring-stats.html#MONITORING-PG-STAT-RECOVERY-PREFETCH">28.2.7. <code class="structname">pg_stat_recovery_prefetch</code></a></span></dt><dt><span class="sect2"><a href="monitoring-stats.html#MONITORING-PG-STAT-SUBSCRIPTION">28.2.8. <code class="structname">pg_stat_subscription</code></a></span></dt><dt><span class="sect2"><a href="monitoring-stats.html#MONITORING-PG-STAT-SUBSCRIPTION-STATS">28.2.9. <code class="structname">pg_stat_subscription_stats</code></a></span></dt><dt><span class="sect2"><a href="monitoring-stats.html#MONITORING-PG-STAT-SSL-VIEW">28.2.10. <code class="structname">pg_stat_ssl</code></a></span></dt><dt><span class="sect2"><a href="monitoring-stats.html#MONITORING-PG-STAT-GSSAPI-VIEW">28.2.11. <code class="structname">pg_stat_gssapi</code></a></span></dt><dt><span class="sect2"><a href="monitoring-stats.html#MONITORING-PG-STAT-ARCHIVER-VIEW">28.2.12. <code class="structname">pg_stat_archiver</code></a></span></dt><dt><span class="sect2"><a href="monitoring-stats.html#MONITORING-PG-STAT-IO-VIEW">28.2.13. <code class="structname">pg_stat_io</code></a></span></dt><dt><span class="sect2"><a href="monitoring-stats.html#MONITORING-PG-STAT-BGWRITER-VIEW">28.2.14. <code class="structname">pg_stat_bgwriter</code></a></span></dt><dt><span class="sect2"><a href="monitoring-stats.html#MONITORING-PG-STAT-WAL-VIEW">28.2.15. <code class="structname">pg_stat_wal</code></a></span></dt><dt><span class="sect2"><a href="monitoring-stats.html#MONITORING-PG-STAT-DATABASE-VIEW">28.2.16. <code class="structname">pg_stat_database</code></a></span></dt><dt><span class="sect2"><a href="monitoring-stats.html#MONITORING-PG-STAT-DATABASE-CONFLICTS-VIEW">28.2.17. <code class="structname">pg_stat_database_conflicts</code></a></span></dt><dt><span class="sect2"><a href="monitoring-stats.html#MONITORING-PG-STAT-ALL-TABLES-VIEW">28.2.18. <code class="structname">pg_stat_all_tables</code></a></span></dt><dt><span class="sect2"><a href="monitoring-stats.html#MONITORING-PG-STAT-ALL-INDEXES-VIEW">28.2.19. <code class="structname">pg_stat_all_indexes</code></a></span></dt><dt><span class="sect2"><a href="monitoring-stats.html#MONITORING-PG-STATIO-ALL-TABLES-VIEW">28.2.20. <code class="structname">pg_statio_all_tables</code></a></span></dt><dt><span class="sect2"><a href="monitoring-stats.html#MONITORING-PG-STATIO-ALL-INDEXES-VIEW">28.2.21. <code class="structname">pg_statio_all_indexes</code></a></span></dt><dt><span class="sect2"><a href="monitoring-stats.html#MONITORING-PG-STATIO-ALL-SEQUENCES-VIEW">28.2.22. <code class="structname">pg_statio_all_sequences</code></a></span></dt><dt><span class="sect2"><a href="monitoring-stats.html#MONITORING-PG-STAT-USER-FUNCTIONS-VIEW">28.2.23. <code class="structname">pg_stat_user_functions</code></a></span></dt><dt><span class="sect2"><a href="monitoring-stats.html#MONITORING-PG-STAT-SLRU-VIEW">28.2.24. <code class="structname">pg_stat_slru</code></a></span></dt><dt><span class="sect2"><a href="monitoring-stats.html#MONITORING-STATS-FUNCTIONS">28.2.25. Статистические функции</a></span></dt></dl></div><a id="id-1.6.15.7.2" class="indexterm"></a><p><em class="firstterm">Система накопительной статистики</em> в <span class="productname">PostgreSQL</span> представляет собой подсистему, которая собирает и отображает информацию о работе сервера. В настоящее время в ней отслеживаются обращения к таблицам и индексам как на уровне блоков на диске, так и на уровне отдельных строк. Также подсчитывается общее число строк в каждой таблице, и собирается информация о выполняемых для каждой таблицы действиях очистки и анализа. Кроме того, может быть включён подсчёт вызовов пользовательских функций и времени, затраченного на выполнение каждой из них.</p><p>Кроме того, <span class="productname">PostgreSQL</span> может предоставить динамическую информацию о том, что происходит в системе прямо сейчас, в частности, сообщить, какие именно команды выполняются другими серверными процессами и какие другие соединения существуют в системе. Эта возможность не зависит от системы накопительной статистики.</p><div class="sect2" id="MONITORING-STATS-SETUP"><div class="titlepage"><div><div><h3 class="title">28.2.1. Конфигурация системы сбора статистики <a href="#MONITORING-STATS-SETUP" class="id_link">#</a></h3></div></div></div><p>Поскольку сбор статистики несколько увеличивает накладные расходы при выполнении запроса, есть возможность настроить СУБД так, чтобы выполнять или не выполнять сбор статистической информации. Это контролируется конфигурационными параметрами, которые обычно устанавливаются в файле <code class="filename">postgresql.conf</code>. (Подробно установка конфигурационных параметров описывается в <a class="xref" href="runtime-config.html" title="Глава 20. Настройка сервера">Главе 20</a>.)</p><p>Параметр <a class="xref" href="runtime-config-statistics.html#GUC-TRACK-ACTIVITIES">track_activities</a> включает мониторинг текущих команд, выполняемой любым серверным процессом.</p><p>Параметр <a class="xref" href="runtime-config-statistics.html#GUC-TRACK-COUNTS">track_counts</a> определяет, будет ли собираться накопительная статистика по обращениям к таблицам и индексам.</p><p>Параметр <a class="xref" href="runtime-config-statistics.html#GUC-TRACK-FUNCTIONS">track_functions</a> включает отслеживание использования пользовательских функций.</p><p>Параметр <a class="xref" href="runtime-config-statistics.html#GUC-TRACK-IO-TIMING">track_io_timing</a> включает мониторинг времени чтения и записи блоков.</p><p>Параметр <a class="xref" href="runtime-config-statistics.html#GUC-TRACK-WAL-IO-TIMING">track_wal_io_timing</a> включает мониторинг времени записи WAL.</p><p>Обычно эти параметры устанавливаются в <code class="filename">postgresql.conf</code>, поэтому они применяются ко всем серверным процессам, однако, используя команду <a class="xref" href="sql-set.html" title="SET"><span class="refentrytitle">SET</span></a>, их можно включать и выключать в отдельных сеансах. (Для того чтобы обычные пользователи не скрывали свою работу от администратора СУБД, изменять эти параметры с помощью команды <code class="command">SET</code> могут только суперпользователи.)</p><p>Накопительная статистика собирается в общей памяти. Каждый процесс <span class="productname">PostgreSQL</span> собирает статистику локально, а затем обновляет общие данные с некоторым интервалом. При штатной остановке сервера, включая физическую реплику, постоянная копия статистической информации сохраняется в подкаталоге <code class="filename">pg_stat</code>, поэтому статистика не теряется после перезапуска сервера. Если же сервер запускается после аварийной остановки (например, после остановки в режиме <code class="literal">immediate</code>, отказа сервера, восстановления на момент времени), все счётчики статистики сбрасываются.</p></div><div class="sect2" id="MONITORING-STATS-VIEWS"><div class="titlepage"><div><div><h3 class="title">28.2.2. Просмотр статистики <a href="#MONITORING-STATS-VIEWS" class="id_link">#</a></h3></div></div></div><p>Для просмотра текущего состояния системы предназначены несколько предопределённых представлений, которые перечислены в <a class="xref" href="monitoring-stats.html#MONITORING-STATS-DYNAMIC-VIEWS-TABLE" title="Таблица 28.1. Динамические статистические представления">Таблице 28.1</a>. В дополнение к ним есть несколько других представлений, перечисленных в <a class="xref" href="monitoring-stats.html#MONITORING-STATS-VIEWS-TABLE" title="Таблица 28.2. Представления собранной статистики">Таблице 28.2</a>, позволяющих просмотреть собранную статистику. Кроме того, на базе нижележащих функций накопительной статистики можно создать собственные представления, как описано в <a class="xref" href="monitoring-stats.html#MONITORING-STATS-FUNCTIONS" title="28.2.25. Статистические функции">Подразделе 28.2.25</a>.</p><p>Используя функции и представления накопительной статистики в целях мониторинга, важно понимать, что эта информация обновляется не сразу. Каждый серверный процесс передаёт собранную статистику в общую память перед переходом в режим ожидания, но не чаще одного раза в интервал, заданный в миллисекундах константой <code class="varname">PGSTAT_MIN_INTERVAL</code> (1 секунда, если эта константа не менялась при компиляции сервера); то есть запрос или транзакция в процессе выполнения не влияют на отображаемые данные статистики, а отображаемая информация отстаёт от того, что происходит в настоящий момент. Однако информация о текущем запросе, собираемая с параметром <code class="varname">track_activities</code>, всегда актуальна.</p><p>Ещё одним важным моментом является то, что когда в серверном процессе запрашивают какую-либо статистику, в конфигурации по умолчанию полученные значения кешируются до конца текущей транзакции. Так что на протяжении одной транзакции эта статистическая информация меняться не будет. При этом информация о текущих запросах во всех сеансах собирается в тот момент, когда она впервые запрашивается в рамках транзакции, и эта же информация будет отображаться на протяжении всей транзакции. Это не ошибка, а полезное свойство СУБД, поскольку оно позволяет выполнять запросы к статистическим данным и сравнивать результаты, не беспокоясь о том, что статистические данные меняются. При интерактивном анализе статистики, или когда выполняются ресурсоёмкие запросы, получаемая статистика может оказаться смещённой из-за задержки между обращениями к отдельным показателям. Установив для параметра <code class="varname">stats_fetch_consistency</code> значение <code class="literal">snapshot</code>, можно минимизировать смещение ценой увеличения объёма памяти для кеширования лишних показателей статистики. И наоборот, когда известно, что обращения к статистике будут единичными, кешировать статистику, к которой уже обращались, не нужно, и этого можно избежать, установив для <code class="varname">stats_fetch_consistency</code> значение <code class="literal">none</code>. Сбросить снимок статистики или кешируемые значения (если таковые имеются) в текущей транзакции можно, вызвав функцию <code class="function">pg_stat_clear_snapshot</code>. При следующем обращении к данным статистики будет создан новый снимок (в режиме <code class="literal">snapshot</code>), или запрошенные данные сохранятся в кеше (в режиме <code class="literal">cache</code>).</p><p>Через представления <code class="structname">pg_stat_xact_all_tables</code>, <code class="structname">pg_stat_xact_sys_tables</code>, <code class="structname">pg_stat_xact_user_tables</code>, и <code class="structname">pg_stat_xact_user_functions</code> транзакции также доступна её собственная статистика (ещё не переданная в общую память статистики). Данные в этих представлениях ведут себя не так, как описано выше; наоборот, они постоянно обновляются в течение транзакции.</p><p>Часть информации в представлениях с динамическими статистическими данными, перечисленных в <a class="xref" href="monitoring-stats.html#MONITORING-STATS-DYNAMIC-VIEWS-TABLE" title="Таблица 28.1. Динамические статистические представления">Таблице 28.1</a> скрыта по соображениям безопасности. Обычные пользователи могут получать информацию только о своих собственных сеансах (сеансах, принадлежащих роли, членами которой они являются). В строках, относящимся к другим сеансам, многие столбцы будут содержать NULL. Заметьте однако, что информация о самом сеансе и его общих свойствах, например, текущем пользователе и базе данных, доступна всем пользователям. Суперпользователи и роли с правами встроенной роли <code class="literal">pg_read_all_stats</code> (см. также <a class="xref" href="predefined-roles.html" title="22.5. Предопределённые роли">Раздел 22.5</a>) могут получить всю информацию о любом сеансе.</p><div class="table" id="MONITORING-STATS-DYNAMIC-VIEWS-TABLE"><p class="title"><strong>Таблица 28.1. Динамические статистические представления</strong></p><div class="table-contents"><table class="table" summary="Динамические статистические представления" border="1"><colgroup><col /><col /></colgroup><thead><tr><th>Имя представления</th><th>Описание</th></tr></thead><tbody><tr><td>
       <code class="structname">pg_stat_activity</code>
       <a id="id-1.6.15.7.6.7.2.2.1.1.2" class="indexterm"></a>
      </td><td>Одна строка для каждого серверного процесса c информацией о текущей активности процесса, включая его состояние и текущий запрос. Подробности в <a class="link" href="monitoring-stats.html#MONITORING-PG-STAT-ACTIVITY-VIEW" title="28.2.3. pg_stat_activity"><code class="structname">pg_stat_activity</code></a>.</td></tr><tr><td><code class="structname">pg_stat_replication</code><a id="id-1.6.15.7.6.7.2.2.2.1.2" class="indexterm"></a></td><td>По одной строке для каждого процесса-передатчика WAL со статистикой по репликации на ведомом сервере, к которому подключён этот процесс. Подробности в <a class="link" href="monitoring-stats.html#MONITORING-PG-STAT-REPLICATION-VIEW" title="28.2.4. pg_stat_replication"><code class="structname">pg_stat_replication</code></a>.</td></tr><tr><td><code class="structname">pg_stat_wal_receiver</code><a id="id-1.6.15.7.6.7.2.2.3.1.2" class="indexterm"></a></td><td>Только одна строка со статистикой приёмника WAL, полученной с сервера, на котором работает приёмник. Подробности в <a class="link" href="monitoring-stats.html#MONITORING-PG-STAT-WAL-RECEIVER-VIEW" title="28.2.6. pg_stat_wal_receiver"><code class="structname">pg_stat_wal_receiver</code></a>.</td></tr><tr><td><code class="structname">pg_stat_recovery_prefetch</code><a id="id-1.6.15.7.6.7.2.2.4.1.2" class="indexterm"></a></td><td>Только одна строка со статистикой блоков, предварительно выбранных во время восстановления. Подробности в <a class="link" href="monitoring-stats.html#MONITORING-PG-STAT-RECOVERY-PREFETCH" title="28.2.7. pg_stat_recovery_prefetch"><code class="structname">pg_stat_recovery_prefetch</code></a>.</td></tr><tr><td><code class="structname">pg_stat_subscription</code><a id="id-1.6.15.7.6.7.2.2.5.1.2" class="indexterm"></a></td><td>Как минимум одна строка для подписки, сообщающая о рабочих процессах подписки. Подробности в <a class="link" href="monitoring-stats.html#MONITORING-PG-STAT-SUBSCRIPTION" title="28.2.8. pg_stat_subscription"><code class="structname">pg_stat_subscription</code></a>.</td></tr><tr><td><code class="structname">pg_stat_ssl</code><a id="id-1.6.15.7.6.7.2.2.6.1.2" class="indexterm"></a></td><td>Одна строка для каждого подключения (обычного и реплицирующего), в которой показывается информация об использовании SSL для данного подключения. Подробности в <a class="link" href="monitoring-stats.html#MONITORING-PG-STAT-SSL-VIEW" title="28.2.10. pg_stat_ssl"><code class="structname">pg_stat_ssl</code></a>.</td></tr><tr><td><code class="structname">pg_stat_gssapi</code><a id="id-1.6.15.7.6.7.2.2.7.1.2" class="indexterm"></a></td><td>Одна строка для каждого подключения (обычного и реплицирующего), в которой показывается информация об использовании аутентификации и шифровании GSSAPI для данного подключения. Подробности в <a class="link" href="monitoring-stats.html#MONITORING-PG-STAT-GSSAPI-VIEW" title="28.2.11. pg_stat_gssapi"><code class="structname">pg_stat_gssapi</code></a>.</td></tr><tr><td><code class="structname">pg_stat_progress_analyze</code><a id="id-1.6.15.7.6.7.2.2.8.1.2" class="indexterm"></a></td><td>По одной строке с текущим состоянием для каждого обслуживающего процесса (включая рабочие процессы автоочистки), в котором работает <code class="command">ANALYZE</code>. См. <a class="xref" href="progress-reporting.html#ANALYZE-PROGRESS-REPORTING" title="28.4.1. Отслеживание выполнения ANALYZE">Подраздел 28.4.1</a>.</td></tr><tr><td><code class="structname">pg_stat_progress_create_index</code><a id="id-1.6.15.7.6.7.2.2.9.1.2" class="indexterm"></a></td><td>По одной строке с текущим состоянием для каждого обслуживающего процесса, в котором выполняется <code class="command">CREATE INDEX</code> или <code class="command">REINDEX</code>. См. <a class="xref" href="progress-reporting.html#CREATE-INDEX-PROGRESS-REPORTING" title="28.4.4. Отслеживание выполнения CREATE INDEX">Подраздел 28.4.4</a>.</td></tr><tr><td><code class="structname">pg_stat_progress_vacuum</code><a id="id-1.6.15.7.6.7.2.2.10.1.2" class="indexterm"></a></td><td>По одной строке с текущим состоянием для каждого обслуживающего процесса (включая рабочие процессы автоочистки), в котором работает <code class="command">VACUUM</code>. См. <a class="xref" href="progress-reporting.html#VACUUM-PROGRESS-REPORTING" title="28.4.5. Отслеживание выполнения VACUUM">Подраздел 28.4.5</a>.</td></tr><tr><td><code class="structname">pg_stat_progress_cluster</code><a id="id-1.6.15.7.6.7.2.2.11.1.2" class="indexterm"></a></td><td>По одной строке с текущим состоянием для каждого обслуживающего процесса, в котором выполняется <code class="command">CLUSTER</code> или <code class="command">VACUUM FULL</code>. См. <a class="xref" href="progress-reporting.html#CLUSTER-PROGRESS-REPORTING" title="28.4.2. Отслеживание выполнения CLUSTER">Подраздел 28.4.2</a>.</td></tr><tr><td><code class="structname">pg_stat_progress_basebackup</code><a id="id-1.6.15.7.6.7.2.2.12.1.2" class="indexterm"></a></td><td>По одной строке с текущим состоянием для каждого передающего WAL процесса, транслирующего базовую копию. См. <a class="xref" href="progress-reporting.html#BASEBACKUP-PROGRESS-REPORTING" title="28.4.6. Отслеживание выполнение базового копирования">Подраздел 28.4.6</a>.</td></tr><tr><td><code class="structname">pg_stat_progress_copy</code><a id="id-1.6.15.7.6.7.2.2.13.1.2" class="indexterm"></a></td><td>По одной строке с текущим состоянием для каждого обслуживающего процесса, в котором выполняется <code class="command">COPY</code>. См. <a class="xref" href="progress-reporting.html#COPY-PROGRESS-REPORTING" title="28.4.3. Отслеживание выполнения COPY">Подраздел 28.4.3</a>.</td></tr></tbody></table></div></div><br class="table-break" /><div class="table" id="MONITORING-STATS-VIEWS-TABLE"><p class="title"><strong>Таблица 28.2. Представления собранной статистики</strong></p><div class="table-contents"><table class="table" summary="Представления собранной статистики" border="1"><colgroup><col /><col /></colgroup><thead><tr><th>Имя представления</th><th>Описание</th></tr></thead><tbody><tr><td><code class="structname">pg_stat_archiver</code><a id="id-1.6.15.7.6.8.2.2.1.1.2" class="indexterm"></a></td><td>Только одна строка со статистикой работы процесса архивации WAL. Подробности в <a class="link" href="monitoring-stats.html#MONITORING-PG-STAT-ARCHIVER-VIEW" title="28.2.12. pg_stat_archiver"><code class="structname">pg_stat_archiver</code></a>.</td></tr><tr><td><code class="structname">pg_stat_bgwriter</code><a id="id-1.6.15.7.6.8.2.2.2.1.2" class="indexterm"></a></td><td>Только одна строка со статистикой работы фонового процесса записи. Подробности в <a class="link" href="monitoring-stats.html#MONITORING-PG-STAT-BGWRITER-VIEW" title="28.2.14. pg_stat_bgwriter"><code class="structname">pg_stat_bgwriter</code></a>.</td></tr><tr><td><code class="structname">pg_stat_database</code><a id="id-1.6.15.7.6.8.2.2.3.1.2" class="indexterm"></a></td><td>Одна строка для каждой базы данных со статистикой на уровне базы. Подробности в <a class="link" href="monitoring-stats.html#MONITORING-PG-STAT-DATABASE-VIEW" title="28.2.16. pg_stat_database"><code class="structname">pg_stat_database</code></a>.</td></tr><tr><td><code class="structname">pg_stat_database_conflicts</code><a id="id-1.6.15.7.6.8.2.2.4.1.2" class="indexterm"></a></td><td>По одной строке на каждую базу данных со статистикой по отменам запросов, выполненным вследствие конфликта с процессами восстановления на ведомых серверах. Подробности в <a class="link" href="monitoring-stats.html#MONITORING-PG-STAT-DATABASE-CONFLICTS-VIEW" title="28.2.17. pg_stat_database_conflicts"><code class="structname">pg_stat_database_conflicts</code></a>.</td></tr><tr><td><code class="structname">pg_stat_io</code><a id="id-1.6.15.7.6.8.2.2.5.1.2" class="indexterm"></a></td><td>Одна строка для каждой комбинации типа обслуживающего процесса, контекста и целевого объекта, содержащая статистику ввода-вывода для всего кластера. За подробностями обратитесь к <a class="link" href="monitoring-stats.html#MONITORING-PG-STAT-IO-VIEW" title="28.2.13. pg_stat_io"><code class="structname">pg_stat_io</code></a>.</td></tr><tr><td><code class="structname">pg_stat_replication_slots</code><a id="id-1.6.15.7.6.8.2.2.6.1.2" class="indexterm"></a></td><td>По одной строке со статистикой по использованию слота репликации для каждого такого слота. Подробности в <a class="link" href="monitoring-stats.html#MONITORING-PG-STAT-REPLICATION-SLOTS-VIEW" title="28.2.5. pg_stat_replication_slots"><code class="structname">pg_stat_replication_slots</code></a>.</td></tr><tr><td><code class="structname">pg_stat_slru</code><a id="id-1.6.15.7.6.8.2.2.7.1.2" class="indexterm"></a></td><td>Одна строка со статистикой работы для каждого SLRU-кеша. Подробности в <a class="link" href="monitoring-stats.html#MONITORING-PG-STAT-SLRU-VIEW" title="28.2.24. pg_stat_slru"><code class="structname">pg_stat_slru</code></a>.</td></tr><tr><td><code class="structname">pg_stat_subscription_stats</code><a id="id-1.6.15.7.6.8.2.2.8.1.2" class="indexterm"></a></td><td>Одна строка для каждой подписки, показывающая статистику ошибок. Подробности в <a class="link" href="monitoring-stats.html#MONITORING-PG-STAT-SUBSCRIPTION-STATS" title="28.2.9. pg_stat_subscription_stats"><code class="structname">pg_stat_subscription_stats</code></a>.</td></tr><tr><td><code class="structname">pg_stat_wal</code><a id="id-1.6.15.7.6.8.2.2.9.1.2" class="indexterm"></a></td><td>Только одна строка со статистикой работы WAL. Подробности в <a class="link" href="monitoring-stats.html#MONITORING-PG-STAT-WAL-VIEW" title="28.2.15. pg_stat_wal"><code class="structname">pg_stat_wal</code></a>.</td></tr><tr><td><code class="structname">pg_stat_all_tables</code><a id="id-1.6.15.7.6.8.2.2.10.1.2" class="indexterm"></a></td><td>По одной строке на каждую таблицу в текущей базе данных со статистикой по обращениям к этой таблице. Подробности в <a class="link" href="monitoring-stats.html#MONITORING-PG-STAT-ALL-TABLES-VIEW" title="28.2.18. pg_stat_all_tables"><code class="structname">pg_stat_all_tables</code></a>.</td></tr><tr><td><code class="structname">pg_stat_sys_tables</code><a id="id-1.6.15.7.6.8.2.2.11.1.2" class="indexterm"></a></td><td>Аналогично <code class="structname">pg_stat_all_tables</code>, за исключением того, что отображаются только системные таблицы.</td></tr><tr><td><code class="structname">pg_stat_user_tables</code><a id="id-1.6.15.7.6.8.2.2.12.1.2" class="indexterm"></a></td><td>Аналогично <code class="structname">pg_stat_all_tables</code>, за исключением того, что отображаются только пользовательские таблицы.</td></tr><tr><td><code class="structname">pg_stat_xact_all_tables</code><a id="id-1.6.15.7.6.8.2.2.13.1.2" class="indexterm"></a></td><td>Подобно <code class="structname">pg_stat_all_tables</code>, но подсчитывает действия, выполненные в текущей транзакции к настоящему моменту (которые ещё <span class="emphasis"><em>не</em></span> вошли в <code class="structname">pg_stat_all_tables</code> и связанные представления). Столбцы для числа живых и мёртвых строк, а также количества операций очистки и сбора статистики, в этом представлении отсутствуют.</td></tr><tr><td><code class="structname">pg_stat_xact_sys_tables</code><a id="id-1.6.15.7.6.8.2.2.14.1.2" class="indexterm"></a></td><td>Аналогично <code class="structname">pg_stat_xact_all_tables</code>, за исключением того, что отображаются только системные таблицы.</td></tr><tr><td><code class="structname">pg_stat_xact_user_tables</code><a id="id-1.6.15.7.6.8.2.2.15.1.2" class="indexterm"></a></td><td>Аналогично <code class="structname">pg_stat_xact_all_tables</code>, за исключением того, что отображаются только пользовательские таблицы.</td></tr><tr><td><code class="structname">pg_stat_all_indexes</code><a id="id-1.6.15.7.6.8.2.2.16.1.2" class="indexterm"></a></td><td>По одной строке для каждого индекса в текущей базе данных со статистикой по обращениям к этому индексу. Подробности в <a class="link" href="monitoring-stats.html#MONITORING-PG-STAT-ALL-INDEXES-VIEW" title="28.2.19. pg_stat_all_indexes"><code class="structname">pg_stat_all_indexes</code></a>.</td></tr><tr><td><code class="structname">pg_stat_sys_indexes</code><a id="id-1.6.15.7.6.8.2.2.17.1.2" class="indexterm"></a></td><td>Аналогично <code class="structname">pg_stat_all_indexes</code>, за исключением того, что показываются только индексы по системным таблицам.</td></tr><tr><td><code class="structname">pg_stat_user_indexes</code><a id="id-1.6.15.7.6.8.2.2.18.1.2" class="indexterm"></a></td><td>Аналогично <code class="structname">pg_stat_all_indexes</code>, за исключением того, что показываются только индексы по пользовательским таблицам.</td></tr><tr><td><code class="structname">pg_stat_user_functions</code><a id="id-1.6.15.7.6.8.2.2.19.1.2" class="indexterm"></a></td><td>По одной строке для каждой отслеживаемой функции со статистикой по выполнениям этой функции. Подробности в <a class="link" href="monitoring-stats.html#MONITORING-PG-STAT-USER-FUNCTIONS-VIEW" title="28.2.23. pg_stat_user_functions"><code class="structname">pg_stat_user_functions</code></a>.</td></tr><tr><td><code class="structname">pg_stat_xact_user_functions</code><a id="id-1.6.15.7.6.8.2.2.20.1.2" class="indexterm"></a></td><td>Аналогично <code class="structname">pg_stat_user_functions</code>, однако подсчитываются только вызовы функций, выполненные в текущей транзакции (которые ещё <span class="emphasis"><em>не</em></span> были включены в <code class="structname">pg_stat_user_functions</code>).</td></tr><tr><td><code class="structname">pg_statio_all_tables</code><a id="id-1.6.15.7.6.8.2.2.21.1.2" class="indexterm"></a></td><td>По одной строке для каждой таблицы в текущей базе данных со статистикой по операциям ввода/вывода с этой таблицей. Подробности в <a class="link" href="monitoring-stats.html#MONITORING-PG-STATIO-ALL-TABLES-VIEW" title="28.2.20. pg_statio_all_tables"><code class="structname">pg_statio_all_tables</code></a>.</td></tr><tr><td><code class="structname">pg_statio_sys_tables</code><a id="id-1.6.15.7.6.8.2.2.22.1.2" class="indexterm"></a></td><td>Аналогично <code class="structname">pg_statio_all_tables</code>, за исключением того, что показываются только системные таблицы.</td></tr><tr><td><code class="structname">pg_statio_user_tables</code><a id="id-1.6.15.7.6.8.2.2.23.1.2" class="indexterm"></a></td><td>Аналогично <code class="structname">pg_statio_all_tables</code>, за исключением того, что показываются только пользовательские таблицы.</td></tr><tr><td><code class="structname">pg_statio_all_indexes</code><a id="id-1.6.15.7.6.8.2.2.24.1.2" class="indexterm"></a></td><td>По одной строке для каждого индекса в текущей базе данных со статистикой по операциям ввода/вывода для этого индекса. Подробности в <a class="link" href="monitoring-stats.html#MONITORING-PG-STATIO-ALL-INDEXES-VIEW" title="28.2.21. pg_statio_all_indexes"><code class="structname">pg_statio_all_indexes</code></a>.</td></tr><tr><td><code class="structname">pg_statio_sys_indexes</code><a id="id-1.6.15.7.6.8.2.2.25.1.2" class="indexterm"></a></td><td>Аналогично <code class="structname">pg_statio_all_indexes</code>, за исключением того, что показываются только индексы по системным таблицам.</td></tr><tr><td><code class="structname">pg_statio_user_indexes</code><a id="id-1.6.15.7.6.8.2.2.26.1.2" class="indexterm"></a></td><td>Аналогично <code class="structname">pg_statio_all_indexes</code>, за исключением того, что показываются только индексы по пользовательским таблицам.</td></tr><tr><td><code class="structname">pg_statio_all_sequences</code><a id="id-1.6.15.7.6.8.2.2.27.1.2" class="indexterm"></a></td><td>По одной строке для каждой последовательности в текущей базе данных со статистикой по операциям ввода/вывода с этой последовательностью. Подробности в <a class="link" href="monitoring-stats.html#MONITORING-PG-STATIO-ALL-SEQUENCES-VIEW" title="28.2.22. pg_statio_all_sequences"><code class="structname">pg_statio_all_sequences</code></a>.</td></tr><tr><td><code class="structname">pg_statio_sys_sequences</code><a id="id-1.6.15.7.6.8.2.2.28.1.2" class="indexterm"></a></td><td>Аналогично <code class="structname">pg_statio_all_sequences</code>, за исключением того, что показываются только системные последовательности. (В настоящее время системных последовательностей нет, поэтому это представление всегда пусто.)</td></tr><tr><td><code class="structname">pg_statio_user_sequences</code><a id="id-1.6.15.7.6.8.2.2.29.1.2" class="indexterm"></a></td><td>Аналогично <code class="structname">pg_statio_all_sequences</code>, за исключением того, что показываются только пользовательские последовательности.</td></tr></tbody></table></div></div><br class="table-break" /><p>Статистика по отдельным индексам особенно полезна для определения того, какие индексы используются и насколько они эффективны.</p><p>Набор представлений <code class="structname">pg_statio_</code> и <code class="structname">pg_stat_io</code> полезны для определения эффективности кеша буфера. Их можно использовать для расчёта процента попадания в кеш. Обратите внимание: в статистике ввода-вывода <span class="productname">PostgreSQL</span> фиксируется большинство случаев вызова ядра для выполнения ввода-вывода, но не разграничиваются случаи, когда обращение к данным, которые необходимо получить с диска или данным, которые уже находятся в кеше страниц ядра. Пользователям рекомендуется использовать статистические представления <span class="productname">PostgreSQL</span> в сочетании с утилитами операционной системы для получения более полной картины производительности ввода-вывода в базе данных.</p></div><div class="sect2" id="MONITORING-PG-STAT-ACTIVITY-VIEW"><div class="titlepage"><div><div><h3 class="title">28.2.3. <code class="structname">pg_stat_activity</code> <a href="#MONITORING-PG-STAT-ACTIVITY-VIEW" class="id_link">#</a></h3></div></div></div><a id="id-1.6.15.7.7.2" class="indexterm"></a><p>В представлении <code class="structname">pg_stat_activity</code> для каждого серверного процесса будет присутствовать по одной строке с информацией, относящейся к текущей деятельности этого процесса.</p><div class="table" id="PG-STAT-ACTIVITY-VIEW"><p class="title"><strong>Таблица 28.3. Представление <code class="structname">pg_stat_activity</code></strong></p><div class="table-contents"><table class="table" summary="Представление pg_stat_activity" border="1"><colgroup><col /></colgroup><thead><tr><th class="catalog_table_entry"><p class="column_definition">Тип столбца</p>
      <p>Описание</p></th></tr></thead><tbody><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">datid</code> <code class="type">oid</code>
      </p>
      <p>OID базы данных, к которой подключён этот серверный процесс</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">datname</code> <code class="type">name</code>
      </p>
      <p>Имя базы данных, к которой подключён этот серверный процесс</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">pid</code> <code class="type">integer</code>
      </p>
      <p>Идентификатор процесса этого серверного процесса</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">leader_pid</code> <code class="type">integer</code>
      </p>
      <p>Идентификатор ведущего процесса группы параллельных процессов, если этот процесс является исполнителем параллельного запроса, или идентификатор ведущего процесса применения изменений, если этот процесс является исполнителем параллельного применения. <code class="literal">NULL</code> указывает, что этот процесс является ведущим процессом в группе параллельных процессов или ведущим процессов применения изменений, или не участвует в каких-либо параллельных операциях.</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">usesysid</code> <code class="type">oid</code>
      </p>
      <p>OID пользователя, подключённого к этому серверному процессу</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">usename</code> <code class="type">name</code>
      </p>
      <p>Имя пользователя, подключённого к этому серверному процессу</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">application_name</code> <code class="type">text</code>
      </p>
      <p>Название приложения, подключённого к этому серверному процессу</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">client_addr</code> <code class="type">inet</code>
      </p>
      <p>IP-адрес клиента, подключённого к этому серверному процессу. Значение null в этом поле означает, что клиент подключён через сокет Unix на стороне сервера или что это внутренний процесс, например, автоочистка.</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">client_hostname</code> <code class="type">text</code>
      </p>
      <p>Имя компьютера для подключённого клиента, получаемое в результате обратного поиска в DNS по <code class="structfield">client_addr</code>. Это поле будет отлично от null только в случае соединений по IP и только при включённом режиме <a class="xref" href="runtime-config-logging.html#GUC-LOG-HOSTNAME">log_hostname</a>.</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">client_port</code> <code class="type">integer</code>
      </p>
      <p>Номер TCP-порта, который используется клиентом для соединения с этим обслуживающим процессом, или <code class="literal">-1</code>, если используется сокет Unix. Если поле содержит NULL, это означает, что это внутренний серверный процесс.</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">backend_start</code> <code class="type">timestamp with time zone</code>
      </p>
      <p>Время запуска процесса. Для процессов, обслуживающих клиентов, это время подключения клиента к серверу.</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">xact_start</code> <code class="type">timestamp with time zone</code>
      </p>
      <p>Время начала текущей транзакции в этом процессе или null при отсутствии активной транзакции. Если текущий запрос был первым в своей транзакции, то значение в этом столбце совпадает со значением столбца <code class="structfield">query_start</code>.</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">query_start</code> <code class="type">timestamp with time zone</code>
      </p>
      <p>Время начала выполнения активного в данный момент запроса, или, если <code class="structfield">state</code> не <code class="literal">active</code>, то время начала выполнения последнего запроса</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">state_change</code> <code class="type">timestamp with time zone</code>
      </p>
      <p>Время последнего изменения состояния (поля <code class="structfield">state</code>)</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">wait_event_type</code> <code class="type">text</code>
      </p>
      <p>Тип события, которого ждёт обслуживающий процесс, если это ожидание имеет место; в противном случае — NULL. См. <a class="xref" href="monitoring-stats.html#WAIT-EVENT-TABLE" title="Таблица 28.4. Типы событий ожидания">Таблицу 28.4</a>.</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">wait_event</code> <code class="type">text</code>
      </p>
      <p>Имя ожидаемого события, если обслуживающий процесс находится в состоянии ожидания, а в противном случае — NULL. См. также <a class="xref" href="monitoring-stats.html#WAIT-EVENT-ACTIVITY-TABLE" title="Таблица 28.5. События ожидания, относящиеся к типу Activity">Таблица 28.5</a> – <a class="xref" href="monitoring-stats.html#WAIT-EVENT-TIMEOUT-TABLE" title="Таблица 28.13. События ожидания, относящиеся к типу Timeout">Таблица 28.13</a>.</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">state</code> <code class="type">text</code>
      </p>
      <p>Общее текущее состояние этого серверного процесса. Возможные значения: </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="literal">active</code>: серверный процесс выполняет запрос.</p></li><li class="listitem"><p><code class="literal">idle</code>: серверный процесс ожидает новой команды от клиента.</p></li><li class="listitem"><p><code class="literal">idle in transaction</code>: серверный процесс находится внутри транзакции, но в настоящее время не выполняет никакой запрос.</p></li><li class="listitem"><p><code class="literal">idle in transaction (aborted)</code>: Это состояние подобно <code class="literal">idle in transaction</code>, за исключением того, что один из операторов в транзакции вызывал ошибку.</p></li><li class="listitem"><p><code class="literal">fastpath function call</code>: серверный процесс выполняет fast-path функцию.</p></li><li class="listitem"><p><code class="literal">disabled</code>: Это состояние отображается для серверных процессов, у которых параметр <a class="xref" href="runtime-config-statistics.html#GUC-TRACK-ACTIVITIES">track_activities</a> отключён.</p></li></ul></div></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">backend_xid</code> <code class="type">xid</code>
      </p>
      <p>Идентификатор транзакции верхнего уровня данного серверного процесса, если есть; см. <a class="xref" href="transaction-id.html" title="74.1. Транзакции и идентификаторы">Раздел 74.1</a>.</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">backend_xmin</code> <code class="type">xid</code>
      </p>
      <p>Текущая граница <code class="literal">xmin</code> для серверного процесса.</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
      <code class="structfield">query_id</code> <code class="type">bigint</code>
     </p>
     <p>Текст последнего запроса этого серверного процесса. Если <code class="structfield">state</code> имеет значение <code class="literal">active</code>, то в этом поле отображается идентификатор запроса, выполняемого в данный момент. Если процесс находится в любом другом состоянии, то в этом поле отображается идентификатор последнего выполненного запроса. По умолчанию идентификаторы запросов не вычисляются, поэтому данное поле будет иметь значение NULL, если не включён параметр <a class="xref" href="runtime-config-statistics.html#GUC-COMPUTE-QUERY-ID">compute_query_id</a> или если не загружен сторонний модуль, вычисляющий идентификаторы запросов.</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">query</code> <code class="type">text</code>
      </p>
      <p>Текст последнего запроса этого серверного процесса. Если <code class="structfield">state</code> имеет значение <code class="literal">active</code>, то в этом поле отображается запрос, который выполняется в настоящий момент. Если процесс находится в любом другом состоянии, то в этом поле отображается последний выполненный запрос. По умолчанию текст запроса обрезается до 1024 байт; это число определяется параметром <a class="xref" href="runtime-config-statistics.html#GUC-TRACK-ACTIVITY-QUERY-SIZE">track_activity_query_size</a>.</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">backend_type</code> <code class="type">text</code>
      </p>
      <p>Тип текущего серверного процесса. Возможные варианты: <code class="literal">autovacuum launcher</code>, <code class="literal">autovacuum worker</code>, <code class="literal">logical replication launcher</code>, <code class="literal">logical replication worker</code>, <code class="literal">parallel worker</code>, <code class="literal">background writer</code>, <code class="literal">client backend</code>, <code class="literal">checkpointer</code>, <code class="literal">archiver</code>, <code class="literal">standalone backend</code>, <code class="literal">startup</code>, <code class="literal">walreceiver</code>, <code class="literal">walsender</code> и <code class="literal">walwriter</code>. Кроме того, фоновые рабочие процессы, регистрируемые расширениями, могут иметь дополнительные типы.</p></td></tr></tbody></table></div></div><br class="table-break" /><div class="note"><h3 class="title">Примечание</h3><p>Значения в столбцах <code class="structfield">wait_event</code> и <code class="structfield">state</code> не зависят друг от друга. Если обслуживающий процесс находится в состоянии <code class="literal">active</code> (активен), он может ожидать какое-то событие, или не ожидать никакое. Если состояние <code class="literal">active</code> и поле <code class="structfield">wait_event</code> содержит не NULL, это означает, что запрос выполняется, но заблокирован чем-то в системе.</p></div><div class="table" id="WAIT-EVENT-TABLE"><p class="title"><strong>Таблица 28.4. Типы событий ожидания</strong></p><div class="table-contents"><table class="table" summary="Типы событий ожидания" border="1"><colgroup><col /><col /></colgroup><thead><tr><th>Тип события ожидания</th><th>Описание</th></tr></thead><tbody><tr><td><code class="literal">Activity</code></td><td>Серверный процесс простаивает. Это состояние показывает, что процесс ожидает активности в основном цикле обработки. В <code class="literal">wait_event</code> обозначается конкретное место ожидания; см. <a class="xref" href="monitoring-stats.html#WAIT-EVENT-ACTIVITY-TABLE" title="Таблица 28.5. События ожидания, относящиеся к типу Activity">Таблицу 28.5</a>.</td></tr><tr><td><code class="literal">BufferPin</code></td><td>Серверный процесс ожидает исключительного доступа к буферу данных. Ожидание закрепления буфера может растягиваться, если другой процесс удерживает открытый курсор, который до этого читал данные из целевого буфера. См. <a class="xref" href="monitoring-stats.html#WAIT-EVENT-BUFFERPIN-TABLE" title="Таблица 28.6. События ожидания, относящиеся к типу BufferPin">Таблицу 28.6</a>.</td></tr><tr><td><code class="literal">Client</code></td><td>Серверный процесс ожидает в сокете некоторую активность пользовательского приложения. То есть сервер ждёт, что произойдёт какое-то событие, не зависящее от его внутренних процессов. В <code class="literal">wait_event</code> обозначается конкретное место ожидания; см. <a class="xref" href="monitoring-stats.html#WAIT-EVENT-CLIENT-TABLE" title="Таблица 28.7. События ожидания, относящиеся к типу Client">Таблицу 28.7</a>.</td></tr><tr><td><code class="literal">Extension</code></td><td>Серверный процесс ожидает условия, возникающего в модуле расширения. См. <a class="xref" href="monitoring-stats.html#WAIT-EVENT-EXTENSION-TABLE" title="Таблица 28.8. События ожидания, относящиеся к типу Extension">Таблицу 28.8</a>.</td></tr><tr><td><code class="literal">IO</code></td><td>Серверный процесс ожидает завершения операции ввода/вывода. В <code class="literal">wait_event</code> обозначается конкретное место ожидания; см. <a class="xref" href="monitoring-stats.html#WAIT-EVENT-IO-TABLE" title="Таблица 28.9. События ожидания, относящиеся к типу IO">Таблицу 28.9</a>.</td></tr><tr><td><code class="literal">IPC</code></td><td>Серверный процесс ожидает взаимодействия с другим процессом. В <code class="literal">wait_event</code> обозначается конкретное место ожидания; см. <a class="xref" href="monitoring-stats.html#WAIT-EVENT-IPC-TABLE" title="Таблица 28.10. События ожидания, относящиеся к типу IPC">Таблицу 28.10</a>.</td></tr><tr><td><code class="literal">Lock</code></td><td>Серверный процесс ожидает тяжёлую блокировку. Тяжёлые блокировки, также называемые блокировками менеджера блокировок или просто блокировками, в основном защищают объекты уровня SQL, такие как таблицы. Однако они также применяются для взаимоисключающего выполнения некоторых внутренних операций, например, расширения отношений. Тип ожидаемой блокировки показывается в <code class="literal">wait_event</code>; см. <a class="xref" href="monitoring-stats.html#WAIT-EVENT-LOCK-TABLE" title="Таблица 28.11. События ожидания, относящиеся к типу Lock">Таблицу 28.11</a>.</td></tr><tr><td><code class="literal">LWLock</code></td><td>Серверный процесс ожидает лёгкую блокировку. В большинстве своём такие блокировки защищают определённые структуры данных в общей памяти. В <code class="literal">wait_event</code> будет содержаться имя, отражающее цель получения лёгкой блокировки. (Некоторые блокировки имеют особые имена; другие объединяются в группы блокировок с похожим предназначением.) См. <a class="xref" href="monitoring-stats.html#WAIT-EVENT-LWLOCK-TABLE" title="Таблица 28.12. События ожидания, относящиеся к типу LWLock">Таблицу 28.12</a>.</td></tr><tr><td><code class="literal">Timeout</code></td><td>Серверный процесс ожидает истечения определённого времени. В <code class="literal">wait_event</code> обозначается конкретное место ожидания; см. <a class="xref" href="monitoring-stats.html#WAIT-EVENT-TIMEOUT-TABLE" title="Таблица 28.13. События ожидания, относящиеся к типу Timeout">Таблицу 28.13</a>.</td></tr></tbody></table></div></div><br class="table-break" /><div class="table" id="WAIT-EVENT-ACTIVITY-TABLE"><p class="title"><strong>Таблица 28.5. События ожидания, относящиеся к типу <code class="literal">Activity</code></strong></p><div class="table-contents"><table class="table" summary="События ожидания, относящиеся к типу Activity" border="1"><colgroup><col /><col /></colgroup><thead><tr><th>Событие ожидания <code class="literal">Activity</code></th><th>Описание</th></tr></thead><tbody><tr><td><code class="literal">ArchiverMain</code></td><td>Ожидание в основном цикле процесса архиватора.</td></tr><tr><td><code class="literal">AutoVacuumMain</code></td><td>Ожидание в основном цикле процесса запуска автоочистки.</td></tr><tr><td><code class="literal">BgWriterHibernate</code></td><td>Ожидание в фоновом процессе записи, переход в режим «заморозки».</td></tr><tr><td><code class="literal">BgWriterMain</code></td><td>Ожидание в основном цикле процесса фоновой записи.</td></tr><tr><td><code class="literal">CheckpointerMain</code></td><td>Ожидание в основном цикле процесса контрольной точки.</td></tr><tr><td><code class="literal">LogicalApplyMain</code></td><td>Ожидание в основном цикле процесса применения логической репликации.</td></tr><tr><td><code class="literal">LogicalLauncherMain</code></td><td>Ожидание в основном цикле процесса запуска обработчиков логической репликации.</td></tr><tr><td><code class="literal">LogicalParallelApplyMain</code></td><td>Ожидание в основном цикле параллельного процесса применения логической репликации.</td></tr><tr><td><code class="literal">RecoveryWalStream</code></td><td>Ожидание поступления записей WAL в основном цикле стартового процесса во время восстановления.</td></tr><tr><td><code class="literal">SysLoggerMain</code></td><td>Ожидание в основном цикле процесса системного журнала (syslogger).</td></tr><tr><td><code class="literal">WalReceiverMain</code></td><td>Ожидание в основном цикле процесса-приёмника WAL.</td></tr><tr><td><code class="literal">WalSenderMain</code></td><td>Ожидание в основном цикле процесса-передатчика WAL.</td></tr><tr><td><code class="literal">WalWriterMain</code></td><td>Ожидание в основном цикле процесса, пишущего WAL.</td></tr></tbody></table></div></div><br class="table-break" /><div class="table" id="WAIT-EVENT-BUFFERPIN-TABLE"><p class="title"><strong>Таблица 28.6. События ожидания, относящиеся к типу <code class="literal">BufferPin</code></strong></p><div class="table-contents"><table class="table" summary="События ожидания, относящиеся к типу BufferPin" border="1"><colgroup><col /><col /></colgroup><thead><tr><th>Событие ожидания <code class="literal">BufferPin</code></th><th>Описание</th></tr></thead><tbody><tr><td><code class="literal">BufferPin</code></td><td>Ожидание получения исключительного закрепления буфера.</td></tr></tbody></table></div></div><br class="table-break" /><div class="table" id="WAIT-EVENT-CLIENT-TABLE"><p class="title"><strong>Таблица 28.7. События ожидания, относящиеся к типу <code class="literal">Client</code></strong></p><div class="table-contents"><table class="table" summary="События ожидания, относящиеся к типу Client" border="1"><colgroup><col /><col /></colgroup><thead><tr><th>События ожидания <code class="literal">Client</code></th><th>Описание</th></tr></thead><tbody><tr><td><code class="literal">ClientRead</code></td><td>Ожидание при чтении данных, получаемых от клиента.</td></tr><tr><td><code class="literal">ClientWrite</code></td><td>Ожидание при записи данных, передаваемых клиенту.</td></tr><tr><td><code class="literal">GSSOpenServer</code></td><td>Ожидание при чтении данных, получаемых от клиента при установлении сеанса GSSAPI.</td></tr><tr><td><code class="literal">LibPQWalReceiverConnect</code></td><td>Ожидание в приёмнике WAL установления подключения к удалённому серверу.</td></tr><tr><td><code class="literal">LibPQWalReceiverReceive</code></td><td>Ожидание в приёмнике WAL поступления данных от удалённого сервера.</td></tr><tr><td><code class="literal">SSLOpenServer</code></td><td>Ожидание SSL при попытке установления соединения.</td></tr><tr><td><code class="literal">WalSenderWaitForWAL</code></td><td>Ожидание сброса WAL в процессе-передатчике WAL.</td></tr><tr><td><code class="literal">WalSenderWriteData</code></td><td>Ожидание какой-либо активности при обработке ответов от WAL-приёмника в процессе-передатчике WAL.</td></tr></tbody></table></div></div><br class="table-break" /><div class="table" id="WAIT-EVENT-EXTENSION-TABLE"><p class="title"><strong>Таблица 28.8. События ожидания, относящиеся к типу <code class="literal">Extension</code></strong></p><div class="table-contents"><table class="table" summary="События ожидания, относящиеся к типу Extension" border="1"><colgroup><col /><col /></colgroup><thead><tr><th>Событие ожидания <code class="literal">Extension</code></th><th>Описание</th></tr></thead><tbody><tr><td><code class="literal">Extension</code></td><td>Ожидание в расширении.</td></tr></tbody></table></div></div><br class="table-break" /><div class="table" id="WAIT-EVENT-IO-TABLE"><p class="title"><strong>Таблица 28.9. События ожидания, относящиеся к типу <code class="literal">IO</code></strong></p><div class="table-contents"><table class="table" summary="События ожидания, относящиеся к типу IO" border="1"><colgroup><col /><col /></colgroup><thead><tr><th>Событие ожидания <code class="literal">IO</code></th><th>Описание</th></tr></thead><tbody><tr><td><code class="literal">BaseBackupRead</code></td><td>Ожидание чтения резервной копии из файла.</td></tr><tr><td><code class="literal">BaseBackupSync</code></td><td>Ожидание помещения данных, записанных процессом базового резервного копирования, в надёжное хранилище.</td></tr><tr><td><code class="literal">BaseBackupWrite</code></td><td>Ожидание записи резервной копии в файл.</td></tr><tr><td><code class="literal">BufFileRead</code></td><td>Ожидание чтения из буферизованного файла.</td></tr><tr><td><code class="literal">BufFileTruncate</code></td><td>Ожидание усечения буферизованного файла.</td></tr><tr><td><code class="literal">BufFileWrite</code></td><td>Ожидание записи в буферизованный файл.</td></tr><tr><td><code class="literal">ControlFileRead</code></td><td>Ожидание чтения из файла <code class="filename">pg_control</code>.</td></tr><tr><td><code class="literal">ControlFileSync</code></td><td>Ожидание помещения файла <code class="filename">pg_control</code> в надёжное хранилище.</td></tr><tr><td><code class="literal">ControlFileSyncUpdate</code></td><td>Ожидание переноса изменений файла <code class="filename">pg_control</code> в надёжное хранилище.</td></tr><tr><td><code class="literal">ControlFileWrite</code></td><td>Ожидание записи в файл <code class="filename">pg_control</code>.</td></tr><tr><td><code class="literal">ControlFileWriteUpdate</code></td><td>Ожидание записи для изменения файла <code class="filename">pg_control</code>.</td></tr><tr><td><code class="literal">CopyFileRead</code></td><td>Ожидание чтения во время операции копирования файла.</td></tr><tr><td><code class="literal">CopyFileWrite</code></td><td>Ожидание записи во время операции копирования файла.</td></tr><tr><td><code class="literal">DSMAllocate</code></td><td>Ожидание выделения сегмента динамической общей памяти.</td></tr><tr><td><code class="literal">DSMFillZeroWrite</code></td><td>Ожидание заполнения нулями файла, применяемого для поддержки динамической общей памяти.</td></tr><tr><td><code class="literal">DataFileExtend</code></td><td>Ожидание расширения файла данных отношения.</td></tr><tr><td><code class="literal">DataFileFlush</code></td><td>Ожидание помещения файла данных отношения в надёжное хранилище.</td></tr><tr><td><code class="literal">DataFileImmediateSync</code></td><td>Ожидание немедленной синхронизации файла данных отношения с надёжным хранилищем.</td></tr><tr><td><code class="literal">DataFilePrefetch</code></td><td>Ожидание асинхронной предвыборки из файла данных отношения.</td></tr><tr><td><code class="literal">DataFileRead</code></td><td>Ожидание чтения из файла данных отношения.</td></tr><tr><td><code class="literal">DataFileSync</code></td><td>Ожидание переноса изменений в файле данных отношения в надёжное хранилище.</td></tr><tr><td><code class="literal">DataFileTruncate</code></td><td>Ожидание усечения файла данных отношения.</td></tr><tr><td><code class="literal">DataFileWrite</code></td><td>Ожидание записи в файл данных отношения.</td></tr><tr><td><code class="literal">LockFileAddToDataDirRead</code></td><td>Ожидание чтения при добавлении строки в файл блокировки каталога данных.</td></tr><tr><td><code class="literal">LockFileAddToDataDirSync</code></td><td>Ожидание помещения данных в надёжное хранилище при добавлении строки в файл блокировки каталога данных.</td></tr><tr><td><code class="literal">LockFileAddToDataDirWrite</code></td><td>Ожидание записи при добавлении строки в файл блокировки каталога данных.</td></tr><tr><td><code class="literal">LockFileCreateRead</code></td><td>Ожидание чтения при создании файла блокировки каталога данных.</td></tr><tr><td><code class="literal">LockFileCreateSync</code></td><td>Ожидание помещения данных в надёжное хранилище при создании файла блокировки каталога данных.</td></tr><tr><td><code class="literal">LockFileCreateWrite</code></td><td>Ожидание записи при создании файла блокировки каталога данных.</td></tr><tr><td><code class="literal">LockFileReCheckDataDirRead</code></td><td>Ожидание чтения во время перепроверки файла блокировки каталога данных.</td></tr><tr><td><code class="literal">LogicalRewriteCheckpointSync</code></td><td>Ожидание помещения отображений логической перезаписи в надёжное хранилище во время контрольной точки.</td></tr><tr><td><code class="literal">LogicalRewriteMappingSync</code></td><td>Ожидание помещения данных отображений в надёжное хранилище в процессе логической перезаписи.</td></tr><tr><td><code class="literal">LogicalRewriteMappingWrite</code></td><td>Ожидание записи данных отображений в процессе логической перезаписи.</td></tr><tr><td><code class="literal">LogicalRewriteSync</code></td><td>Ожидание помещения отображений логической перезаписи в надёжное хранилище.</td></tr><tr><td><code class="literal">LogicalRewriteTruncate</code></td><td>Ожидание усечения файла отображений в процессе логической перезаписи.</td></tr><tr><td><code class="literal">LogicalRewriteWrite</code></td><td>Ожидание сохранения отображений логической перезаписи.</td></tr><tr><td><code class="literal">RelationMapRead</code></td><td>Ожидание чтения файла отображений отношений.</td></tr><tr><td><code class="literal">RelationMapReplace</code></td><td>Ожидание надёжной замены файла карты отношений.</td></tr><tr><td><code class="literal">RelationMapWrite</code></td><td>Ожидание записи в файл отображений отношений.</td></tr><tr><td><code class="literal">ReorderBufferRead</code></td><td>Ожидание чтения при работе с буфером переупорядочивания.</td></tr><tr><td><code class="literal">ReorderBufferWrite</code></td><td>Ожидание записи при работе с буфером переупорядочивания.</td></tr><tr><td><code class="literal">ReorderLogicalMappingRead</code></td><td>Ожидание чтения логического отображения при работе с буфером переупорядочивания.</td></tr><tr><td><code class="literal">ReplicationSlotRead</code></td><td>Ожидание чтения из управляющего файла слота репликации.</td></tr><tr><td><code class="literal">ReplicationSlotRestoreSync</code></td><td>Ожидание помещения в надёжное хранилище управляющего файла слота репликации при восстановлении его в памяти.</td></tr><tr><td><code class="literal">ReplicationSlotSync</code></td><td>Ожидание помещения в надёжное хранилище управляющего файла слота репликации.</td></tr><tr><td><code class="literal">ReplicationSlotWrite</code></td><td>Ожидание записи в управляющий файл слота репликации.</td></tr><tr><td><code class="literal">SLRUFlushSync</code></td><td>Ожидание помещения данных SLRU в надёжное хранилище во время контрольной точки или отключения базы данных.</td></tr><tr><td><code class="literal">SLRURead</code></td><td>Ожидание чтения страницы SLRU.</td></tr><tr><td><code class="literal">SLRUSync</code></td><td>Ожидание помещения данных SLRU в надёжное хранилище после записи страницы.</td></tr><tr><td><code class="literal">SLRUWrite</code></td><td>Ожидание записи страницы SLRU.</td></tr><tr><td><code class="literal">SnapbuildRead</code></td><td>Ожидание чтения сериализованного исторического снимка каталога БД.</td></tr><tr><td><code class="literal">SnapbuildSync</code></td><td>Ожидание помещения сериализованного исторического снимка каталога БД в надёжное хранилище.</td></tr><tr><td><code class="literal">SnapbuildWrite</code></td><td>Ожидание записи сериализованного исторического снимка каталога БД.</td></tr><tr><td><code class="literal">TimelineHistoryFileSync</code></td><td>Ожидание помещения в надёжное хранилище файла истории линии времени, полученного через потоковую репликацию.</td></tr><tr><td><code class="literal">TimelineHistoryFileWrite</code></td><td>Ожидание записи файла истории линии времени, полученного через потоковую репликацию.</td></tr><tr><td><code class="literal">TimelineHistoryRead</code></td><td>Ожидание чтения файла истории линии времени.</td></tr><tr><td><code class="literal">TimelineHistorySync</code></td><td>Ожидание помещения в надёжное хранилище только что созданного файла истории линии времени.</td></tr><tr><td><code class="literal">TimelineHistoryWrite</code></td><td>Ожидание записи только что созданного файла истории линии времени.</td></tr><tr><td><code class="literal">TwophaseFileRead</code></td><td>Ожидание чтения файла двухфазного состояния.</td></tr><tr><td><code class="literal">TwophaseFileSync</code></td><td>Ожидание помещения файла двухфазного состояния в надёжное хранилище.</td></tr><tr><td><code class="literal">TwophaseFileWrite</code></td><td>Ожидание записи файла двухфазного состояния.</td></tr><tr><td><code class="literal">VersionFileSync</code></td><td>Ожидание попадания файла версии в надёжное хранилище при создании базы данных.</td></tr><tr><td><code class="literal">VersionFileWrite</code></td><td>Ожидание записи файла версии при создании базы данных.</td></tr><tr><td><code class="literal">WALBootstrapSync</code></td><td>Ожидание помещения WAL в надёжное хранилище в процессе начальной загрузки.</td></tr><tr><td><code class="literal">WALBootstrapWrite</code></td><td>Ожидание записи страницы WAL в процессе начальной загрузки.</td></tr><tr><td><code class="literal">WALCopyRead</code></td><td>Ожидание чтения при создании нового сегмента WAL путём копирования существующего.</td></tr><tr><td><code class="literal">WALCopySync</code></td><td>Ожидание помещения в надёжное хранилище нового сегмента WAL, созданного путём копирования существующего.</td></tr><tr><td><code class="literal">WALCopyWrite</code></td><td>Ожидание записи при создании нового сегмента WAL путём копирования существующего.</td></tr><tr><td><code class="literal">WALInitSync</code></td><td>Ожидание помещения в надёжное хранилище нового инициализированного файла WAL.</td></tr><tr><td><code class="literal">WALInitWrite</code></td><td>Ожидание записи при инициализации нового файла WAL.</td></tr><tr><td><code class="literal">WALRead</code></td><td>Ожидание чтения из файла WAL.</td></tr><tr><td><code class="literal">WALSenderTimelineHistoryRead</code></td><td>Ожидание чтения из файла истории линии времени при обработки процессом walsender команды timeline.</td></tr><tr><td><code class="literal">WALSync</code></td><td>Ожидание помещения файла WAL в надёжное хранилище.</td></tr><tr><td><code class="literal">WALSyncMethodAssign</code></td><td>Ожидание помещения данных в надёжное хранилище при смене метода синхронизации WAL.</td></tr><tr><td><code class="literal">WALWrite</code></td><td>Ожидание записи в файл WAL.</td></tr></tbody></table></div></div><br class="table-break" /><div class="table" id="WAIT-EVENT-IPC-TABLE"><p class="title"><strong>Таблица 28.10. События ожидания, относящиеся к типу <code class="literal">IPC</code></strong></p><div class="table-contents"><table class="table" summary="События ожидания, относящиеся к типу IPC" border="1"><colgroup><col /><col /></colgroup><thead><tr><th>События ожидания <code class="literal">IPC</code></th><th>Описание</th></tr></thead><tbody><tr><td><code class="literal">AppendReady</code></td><td>Ожидание готовности узлов вложенных планов узла <code class="literal">Append</code>.</td></tr><tr><td><code class="literal">ArchiveCleanupCommand</code></td><td>Ожидание завершения <a class="xref" href="runtime-config-wal.html#GUC-ARCHIVE-CLEANUP-COMMAND">archive_cleanup_command</a>.</td></tr><tr><td><code class="literal">ArchiveCommand</code></td><td>Ожидание завершения <a class="xref" href="runtime-config-wal.html#GUC-ARCHIVE-COMMAND">archive_command</a>.</td></tr><tr><td><code class="literal">BackendTermination</code></td><td>Ожидание завершения другого серверного процесса.</td></tr><tr><td><code class="literal">BackupWaitWalArchive</code></td><td>Ожидание файлов WAL, необходимых для успешного завершения архивации.</td></tr><tr><td><code class="literal">BgWorkerShutdown</code></td><td>Ожидание завершения фонового рабочего процесса.</td></tr><tr><td><code class="literal">BgWorkerStartup</code></td><td>Ожидание запуска фонового рабочего процесса.</td></tr><tr><td><code class="literal">BtreePage</code></td><td>Ожидание доступности номера страницы, необходимого для продолжения параллельного сканирования B-дерева.</td></tr><tr><td><code class="literal">BufferIO</code></td><td>Ожидание завершения буферного ввода/вывода.</td></tr><tr><td><code class="literal">CheckpointDone</code></td><td>Ожидание завершения контрольной точки.</td></tr><tr><td><code class="literal">CheckpointStart</code></td><td>Ожидание начала контрольной точки.</td></tr><tr><td><code class="literal">ExecuteGather</code></td><td>Ожидание активности дочернего процесса при выполнении узла плана <code class="literal">Gather</code>.</td></tr><tr><td><code class="literal">HashBatchAllocate</code></td><td>Ожидание выделения хеш-таблицы выбранным участником параллельного хеширования.</td></tr><tr><td><code class="literal">HashBatchElect</code></td><td>Ожидание выделения хеш-таблицы выбранным участником параллельного хеширования.</td></tr><tr><td><code class="literal">HashBatchLoad</code></td><td>Ожидание завершения загрузки хеш-таблицы другими участниками параллельного хеширования.</td></tr><tr><td><code class="literal">HashBuildAllocate</code></td><td>Ожидание выделения начальной хеш-таблицы выбранным участником параллельного хеширования.</td></tr><tr><td><code class="literal">HashBuildElect</code></td><td>Ожидание в процессе выбора участника параллельного хеширования для выделения начальной хеш-таблицы.</td></tr><tr><td><code class="literal">HashBuildHashInner</code></td><td>Ожидание завершения хеширования внутреннего отношения другими участниками параллельного хеширования.</td></tr><tr><td><code class="literal">HashBuildHashOuter</code></td><td>Ожидание завершения хеширования внешнего отношения другими участниками параллельного хеширования.</td></tr><tr><td><code class="literal">HashGrowBatchesDecide</code></td><td>Ожидание в процессе выбора участника параллельного хеширования для принятия решения о предстоящем добавлении пакетов.</td></tr><tr><td><code class="literal">HashGrowBatchesElect</code></td><td>Ожидание в процессе выбора участника параллельного хеширования для выделения дополнительных пакетов.</td></tr><tr><td><code class="literal">HashGrowBatchesFinish</code></td><td>Ожидание решения о предстоящем добавлении пакетов участником параллельного хеширования.</td></tr><tr><td><code class="literal">HashGrowBatchesReallocate</code></td><td>Ожидание выделения дополнительных пакетов выбранным участником параллельного хеширования.</td></tr><tr><td><code class="literal">HashGrowBatchesRepartition</code></td><td>Ожидание завершения переразбиения другими участниками параллельного хеширования.</td></tr><tr><td><code class="literal">HashGrowBucketsElect</code></td><td>Ожидание в процессе выбора участника параллельного хеширования для выделения дополнительных групп.</td></tr><tr><td><code class="literal">HashGrowBucketsReallocate</code></td><td>Ожидание завершения выделения дополнительных групп выбранным участником параллельного хеширования.</td></tr><tr><td><code class="literal">HashGrowBucketsReinsert</code></td><td>Ожидание завершения добавления кортежей в новые группы другими участниками параллельного хеширования.</td></tr><tr><td><code class="literal">LogicalApplySendData</code></td><td>Ожидание отправки данных ведущим процессом применения изменений логической репликации параллельному процессу применения изменений.</td></tr><tr><td><code class="literal">LogicalParallelApplyStateChange</code></td><td>Ожидание изменения состояния параллельного процесса применения изменений логической репликации.</td></tr><tr><td><code class="literal">LogicalSyncData</code></td><td>Ожидание от удалённого сервера, осуществляющего логическую репликацию, передачи данных для начальной синхронизации таблиц.</td></tr><tr><td><code class="literal">LogicalSyncStateChange</code></td><td>Ожидание изменения состояния удалённого сервера, осуществляющего логическую репликацию.</td></tr><tr><td><code class="literal">MessageQueueInternal</code></td><td>Ожидание подключения другого процесса к общей очереди сообщений.</td></tr><tr><td><code class="literal">MessageQueuePutMessage</code></td><td>Ожидание записи сообщения протокола в общую очередь сообщений.</td></tr><tr><td><code class="literal">MessageQueueReceive</code></td><td>Ожидание получения байтов из общей очереди сообщений.</td></tr><tr><td><code class="literal">MessageQueueSend</code></td><td>Ожидание передачи байтов в общую очередь сообщений.</td></tr><tr><td><code class="literal">ParallelBitmapScan</code></td><td>Ожидание инициализации параллельного сканирования по битовой карте.</td></tr><tr><td><code class="literal">ParallelCreateIndexScan</code></td><td>Ожидание завершения сканирования кучи параллельными исполнителями <code class="command">CREATE INDEX</code>.</td></tr><tr><td><code class="literal">ParallelFinish</code></td><td>Ожидание завершения вычислений параллельными рабочими процессами.</td></tr><tr><td><code class="literal">ProcArrayGroupUpdate</code></td><td>Ожидание обнуления ID транзакции, которое должен произвести ведущий процесс группы по окончании параллельной операции.</td></tr><tr><td><code class="literal">ProcSignalBarrier</code></td><td>Ожидание обработки события барьера всеми обслуживающими процессами.</td></tr><tr><td><code class="literal">Promote</code></td><td>Ожидание повышения ведомого.</td></tr><tr><td><code class="literal">RecoveryConflictSnapshot</code></td><td>Ожидание разрешения конфликтов восстановления для осуществления очистки.</td></tr><tr><td><code class="literal">RecoveryConflictTablespace</code></td><td>Ожидание разрешения конфликтов восстановления для удаления табличного пространства.</td></tr><tr><td><code class="literal">RecoveryEndCommand</code></td><td>Ожидание завершения <a class="xref" href="runtime-config-wal.html#GUC-RECOVERY-END-COMMAND">recovery_end_command</a>.</td></tr><tr><td><code class="literal">RecoveryPause</code></td><td>Ожидание возобновления восстановления.</td></tr><tr><td><code class="literal">ReplicationOriginDrop</code></td><td>Ожидание перехода источника репликации в неактивное состояние, что позволит затем удалить его.</td></tr><tr><td><code class="literal">ReplicationSlotDrop</code></td><td>Ожидание перехода слота репликации в неактивное состояние, что позволит затем удалить его.</td></tr><tr><td><code class="literal">RestoreCommand</code></td><td>Ожидание завершения <a class="xref" href="runtime-config-wal.html#GUC-RESTORE-COMMAND">restore_command</a>.</td></tr><tr><td><code class="literal">SafeSnapshot</code></td><td>Ожидание получения безопасного снимка для транзакции <code class="literal">READ ONLY DEFERRABLE</code>.</td></tr><tr><td><code class="literal">SyncRep</code></td><td>Ожидание подтверждения от удалённого сервера при синхронной репликации.</td></tr><tr><td><code class="literal">WalReceiverExit</code></td><td>Ожидание завершения процесса-приёмника WAL.</td></tr><tr><td><code class="literal">WalReceiverWaitStart</code></td><td>Ожидание от стартового процесса передачи начальных данных для потоковой репликации.</td></tr><tr><td><code class="literal">XactGroupUpdate</code></td><td>Ожидание изменения состояния транзакции, которое должен произвести ведущий процесс группы по окончании параллельной операции.</td></tr></tbody></table></div></div><br class="table-break" /><div class="table" id="WAIT-EVENT-LOCK-TABLE"><p class="title"><strong>Таблица 28.11. События ожидания, относящиеся к типу <code class="literal">Lock</code></strong></p><div class="table-contents"><table class="table" summary="События ожидания, относящиеся к типу Lock" border="1"><colgroup><col /><col /></colgroup><thead><tr><th>Событие ожидания <code class="literal">Lock</code></th><th>Описание</th></tr></thead><tbody><tr><td><code class="literal">advisory</code></td><td>Ожидание при запросе рекомендательной пользовательской блокировки.</td></tr><tr><td><code class="literal">applytransaction</code></td><td>Ожидание получения блокировки для удалённой транзакции, применяемой подписчиком логической репликации.</td></tr><tr><td><code class="literal">extend</code></td><td>Ожидание при расширении отношения.</td></tr><tr><td><code class="literal">frozenid</code></td><td>Ожидание изменения <code class="structname">pg_database</code>.<code class="structfield">datfrozenxid</code> и <code class="structname">pg_database</code>.<code class="structfield">datminmxid</code>.</td></tr><tr><td><code class="literal">object</code></td><td>Ожидание при запросе блокировки для нереляционного объекта БД.</td></tr><tr><td><code class="literal">page</code></td><td>Ожидание при запросе блокировки для страницы отношения.</td></tr><tr><td><code class="literal">relation</code></td><td>Ожидание при запросе блокировки для отношения.</td></tr><tr><td><code class="literal">spectoken</code></td><td>Ожидание при запросе блокировки спекулятивного добавления.</td></tr><tr><td><code class="literal">transactionid</code></td><td>Ожидание завершения транзакции.</td></tr><tr><td><code class="literal">tuple</code></td><td>Ожидание при запросе блокировки для кортежа.</td></tr><tr><td><code class="literal">userlock</code></td><td>Ожидание при запросе пользовательской блокировки.</td></tr><tr><td><code class="literal">virtualxid</code></td><td>Ожидание при запросе блокировки виртуального ID транзакции; см. <a class="xref" href="transaction-id.html" title="74.1. Транзакции и идентификаторы">Раздел 74.1</a>.</td></tr></tbody></table></div></div><br class="table-break" /><div class="table" id="WAIT-EVENT-LWLOCK-TABLE"><p class="title"><strong>Таблица 28.12. События ожидания, относящиеся к типу <code class="literal">LWLock</code></strong></p><div class="table-contents"><table class="table" summary="События ожидания, относящиеся к типу LWLock" border="1"><colgroup><col /><col /></colgroup><thead><tr><th>Событие ожидания <code class="literal">LWLock</code></th><th>Описание</th></tr></thead><tbody><tr><td><code class="literal">AddinShmemInit</code></td><td>Ожидание при распределении блоков общей памяти для расширений.</td></tr><tr><td><code class="literal">AutoFile</code></td><td>Ожидание при изменении файла <code class="filename">postgresql.auto.conf</code>.</td></tr><tr><td><code class="literal">Autovacuum</code></td><td>Ожидание при чтении или изменении текущего состояния рабочих процессов автоочистки.</td></tr><tr><td><code class="literal">AutovacuumSchedule</code></td><td>Ожидание при подтверждении, что таблица, выбранная для автоочистки, всё ещё нуждается в очистке.</td></tr><tr><td><code class="literal">BackgroundWorker</code></td><td>Ожидание при чтении или изменении состояния фонового рабочего процесса.</td></tr><tr><td><code class="literal">BtreeVacuum</code></td><td>Ожидание при чтении или изменении информации, связанной с очисткой, для индекса-B-дерева.</td></tr><tr><td><code class="literal">BufferContent</code></td><td>Ожидание при обращении к странице данных в памяти.</td></tr><tr><td><code class="literal">BufferMapping</code></td><td>Ожидание при связывании блока данных с буфером в пуле буферов.</td></tr><tr><td><code class="literal">CheckpointerComm</code></td><td>Ожидание при управлении запросами fsync.</td></tr><tr><td><code class="literal">CommitTs</code></td><td>Ожидание при чтении или изменении последнего значения, заданного в качестве времени фиксирования транзакции.</td></tr><tr><td><code class="literal">CommitTsBuffer</code></td><td>Ожидание ввода/вывода с SLRU-буфером данных о времени фиксирования транзакций.</td></tr><tr><td><code class="literal">CommitTsSLRU</code></td><td>Ожидание при обращении к SLRU-кешу данных о времени фиксирования транзакций.</td></tr><tr><td><code class="literal">ControlFile</code></td><td>Ожидание при чтении или изменении файла <code class="filename">pg_control</code> либо при создании нового файла WAL.</td></tr><tr><td><code class="literal">DynamicSharedMemoryControl</code></td><td>Ожидание при чтении или изменении информации о выделении динамической общей памяти.</td></tr><tr><td><code class="literal">LockFastPath</code></td><td>Ожидание при чтении или изменении информации процесса о блокировках по быстрому пути.</td></tr><tr><td><code class="literal">LockManager</code></td><td>Ожидание при чтении или изменении информации о <span class="quote">«<span class="quote">тяжёлых</span>»</span> блокировках.</td></tr><tr><td><code class="literal">LogicalRepLauncherDSA</code></td><td>Ожидание выделения области динамической общей памяти для запуска логической репликации</td></tr><tr><td><code class="literal">LogicalRepLauncherHash</code></td><td>Ожидание доступа к общей хеш-таблице процесса запуска логической репликации.</td></tr><tr><td><code class="literal">LogicalRepWorker</code></td><td>Ожидание при чтении или изменении состояния рабочих процессов логической репликации.</td></tr><tr><td><code class="literal">MultiXactGen</code></td><td>Ожидание при чтении или изменении общего состояния мультитранзакций.</td></tr><tr><td><code class="literal">MultiXactMemberBuffer</code></td><td>Ожидание ввода/вывода с SLRU-буфером данных о членах мультитранзакций.</td></tr><tr><td><code class="literal">MultiXactMemberSLRU</code></td><td>Ожидание при обращении к SLRU-кешу данных о членах мультитранзакций.</td></tr><tr><td><code class="literal">MultiXactOffsetBuffer</code></td><td>Ожидание ввода/вывода с SLRU-буфером данных о смещениях мультитранзакций.</td></tr><tr><td><code class="literal">MultiXactOffsetSLRU</code></td><td>Ожидание при обращении к SLRU-кешу данных о смещениях мультитранзакций.</td></tr><tr><td><code class="literal">MultiXactTruncation</code></td><td>Ожидание при чтении или очистке информации мультитранзакций.</td></tr><tr><td><code class="literal">NotifyBuffer</code></td><td>Ожидание ввода/вывода с SLRU-буфером сообщений <code class="command">NOTIFY</code>.</td></tr><tr><td><code class="literal">NotifyQueue</code></td><td>Ожидание при чтении или изменении сообщений <code class="command">NOTIFY</code>.</td></tr><tr><td><code class="literal">NotifyQueueTail</code></td><td>Ожидание при изменении границы массива сообщений <code class="command">NOTIFY</code>.</td></tr><tr><td><code class="literal">NotifySLRU</code></td><td>Ожидание при обращении к SLRU-кешу сообщений <code class="command">NOTIFY</code>.</td></tr><tr><td><code class="literal">OidGen</code></td><td>Ожидание при выделении нового OID.</td></tr><tr><td><code class="literal">OldSnapshotTimeMap</code></td><td>Ожидание при чтении или изменении информации о старом снимке.</td></tr><tr><td><code class="literal">ParallelAppend</code></td><td>Ожидание выбора следующего подплана в процессе выполнения узла параллельного добавления (Parallel Append).</td></tr><tr><td><code class="literal">ParallelHashJoin</code></td><td>Ожидание синхронизации рабочих процессов в процессе выполнения узла плана Parallel Hash Join.</td></tr><tr><td><code class="literal">ParallelQueryDSA</code></td><td>Ожидание выделения динамической общей памяти для параллельного запроса.</td></tr><tr><td><code class="literal">PerSessionDSA</code></td><td>Ожидание выделения динамической общей памяти для параллельного запроса.</td></tr><tr><td><code class="literal">PerSessionRecordType</code></td><td>Ожидание при обращении к информации параллельного запроса о составных типах.</td></tr><tr><td><code class="literal">PerSessionRecordTypmod</code></td><td>Ожидание при обращении к информации параллельного запроса о модификаторах типов, относящихся к типам анонимных записей.</td></tr><tr><td><code class="literal">PerXactPredicateList</code></td><td>Ожидание при обращении к списку предикатных блокировок, удерживаемых текущей сериализуемой транзакцией, во время параллельного запроса.</td></tr><tr><td><code class="literal">PgStatsData</code></td><td>Ожидание доступа к данным статистики в общей памяти.</td></tr><tr><td><code class="literal">PgStatsDSA</code></td><td>Ожидание выделения области динамической общей памяти для статистики.</td></tr><tr><td><code class="literal">PgStatsHash</code></td><td>Ожидание доступа к хеш-таблице статистики в общей памяти.</td></tr><tr><td><code class="literal">PredicateLockManager</code></td><td>Ожидание при обращении к информации о предикатных блокировках, используемой сериализуемыми транзакциями.</td></tr><tr><td><code class="literal">ProcArray</code></td><td>Ожидание при обращении к общим структурам данных в рамках процесса (например, при получении снимка или чтении идентификатора транзакции в сеансе).</td></tr><tr><td><code class="literal">RelationMapping</code></td><td>Ожидание при чтении или изменении файла <code class="filename">pg_filenode.map</code>, в котором отслеживаются назначения файловых узлов для некоторых системных каталогов.</td></tr><tr><td><code class="literal">RelCacheInit</code></td><td>Ожидание при чтении или изменении файла инициализации кеша отношения (<code class="filename">pg_internal.init</code>).</td></tr><tr><td><code class="literal">ReplicationOrigin</code></td><td>Ожидание при создании, удалении или использовании источника репликации.</td></tr><tr><td><code class="literal">ReplicationOriginState</code></td><td>Ожидание при чтении или изменении состояния одного источника репликации.</td></tr><tr><td><code class="literal">ReplicationSlotAllocation</code></td><td>Ожидание при выделении или освобождении слота репликации.</td></tr><tr><td><code class="literal">ReplicationSlotControl</code></td><td>Ожидание при чтении или изменении состояния слота репликации.</td></tr><tr><td><code class="literal">ReplicationSlotIO</code></td><td>Ожидание при вводе/выводе со слотом репликации.</td></tr><tr><td><code class="literal">SerialBuffer</code></td><td>Ожидание ввода/вывода с SLRU-буфером данных о конфликтах сериализуемых транзакций.</td></tr><tr><td><code class="literal">SerializableFinishedList</code></td><td>Ожидание при обращении к списку завершённых сериализуемых транзакций.</td></tr><tr><td><code class="literal">SerializablePredicateList</code></td><td>Ожидание при обращении к списку предикатных блокировок, удерживаемых сериализуемыми транзакциями.</td></tr><tr><td><code class="literal">SerializableXactHash</code></td><td>Ожидание при чтении или изменении информации о сериализуемых транзакциях.</td></tr><tr><td><code class="literal">SerialSLRU</code></td><td>Ожидание при обращении к SLRU-кешу данных о конфликтах сериализуемых транзакций.</td></tr><tr><td><code class="literal">SharedTidBitmap</code></td><td>Ожидание при обращении к разделяемой битовой карте TID в процессе параллельного сканирования индекса по битовой карте.</td></tr><tr><td><code class="literal">SharedTupleStore</code></td><td>Ожидание при обращении к разделяемому хранилищу кортежей во время параллельного запроса.</td></tr><tr><td><code class="literal">ShmemIndex</code></td><td>Ожидание при поиске или выделении области в разделяемой памяти.</td></tr><tr><td><code class="literal">SInvalRead</code></td><td>Ожидание при получении сообщений из общей очереди сообщений аннулирования.</td></tr><tr><td><code class="literal">SInvalWrite</code></td><td>Ожидание при добавлении в общую очередь сообщения аннулирования каталога.</td></tr><tr><td><code class="literal">SubtransBuffer</code></td><td>Ожидание ввода/вывода с SLRU-буфером данных о подтранзакциях.</td></tr><tr><td><code class="literal">SubtransSLRU</code></td><td>Ожидание при обращении к SLRU-кешу данных подтранзакций.</td></tr><tr><td><code class="literal">SyncRep</code></td><td>Ожидание при чтении или изменении информации о состоянии синхронной репликации.</td></tr><tr><td><code class="literal">SyncScan</code></td><td>Ожидание при выборе начального положения для синхронизированного сканирования таблицы.</td></tr><tr><td><code class="literal">TablespaceCreate</code></td><td>Ожидание при создании или удалении табличного пространства.</td></tr><tr><td><code class="literal">TwoPhaseState</code></td><td>Ожидание при чтении или изменении состояния подготовленных транзакций.</td></tr><tr><td><code class="literal">WALBufMapping</code></td><td>Ожидание при замене страницы в буферах WAL.</td></tr><tr><td><code class="literal">WALInsert</code></td><td>Ожидание при добавлении записей WAL в буфер в памяти.</td></tr><tr><td><code class="literal">WALWrite</code></td><td>Ожидание при записи буферов WAL на диск.</td></tr><tr><td><code class="literal">WrapLimitsVacuum</code></td><td>Ожидание при изменении лимитов идентификаторов транзакций и мультитранзакций.</td></tr><tr><td><code class="literal">XactBuffer</code></td><td>Ожидание ввода/вывода с SLRU-буфером данных о состоянии транзакций.</td></tr><tr><td><code class="literal">XactSLRU</code></td><td>Ожидание при обращении к SLRU-кешу данных о состоянии транзакций.</td></tr><tr><td><code class="literal">XactTruncation</code></td><td>Ожидание выполнения функции <code class="function">pg_xact_status</code> или обновления самого старого видимого в ней идентификатора транзакции.</td></tr><tr><td><code class="literal">XidGen</code></td><td>Ожидание при выделении нового идентификатора транзакции.</td></tr></tbody></table></div></div><br class="table-break" /><div class="note"><h3 class="title">Примечание</h3><p>Приложения могут добавлять дополнительные типы <code class="literal">LWLock</code> в список, показанный в <a class="xref" href="monitoring-stats.html#WAIT-EVENT-LWLOCK-TABLE" title="Таблица 28.12. События ожидания, относящиеся к типу LWLock">Таблице 28.12</a>. В некоторых случаях имя, назначенное расширением, может быть не видно во всех серверных процессах, поэтому событие ожидания может отображаться с именем <span class="quote">«<span class="quote"><code class="literal">extension</code></span>»</span>, а не тем, что было назначено.</p></div><div class="table" id="WAIT-EVENT-TIMEOUT-TABLE"><p class="title"><strong>Таблица 28.13. События ожидания, относящиеся к типу <code class="literal">Timeout</code></strong></p><div class="table-contents"><table class="table" summary="События ожидания, относящиеся к типу Timeout" border="1"><colgroup><col /><col /></colgroup><thead><tr><th>Событие ожидания <code class="literal">Timeout</code></th><th>Описание</th></tr></thead><tbody><tr><td><code class="literal">BaseBackupThrottle</code></td><td>Ожидание в процессе базового резервного копирования из-за ограничения активности.</td></tr><tr><td><code class="literal">CheckpointWriteDelay</code></td><td>Ожидание между операциями записи при выполнении контрольной точки.</td></tr><tr><td><code class="literal">PgSleep</code></td><td>Ожидание в результате вызова <code class="function">pg_sleep</code> или родственной функции.</td></tr><tr><td><code class="literal">RecoveryApplyDelay</code></td><td>Ожидание применения WAL при восстановлении, вызванное установленной задержкой.</td></tr><tr><td><code class="literal">RecoveryRetrieveRetryInterval</code></td><td>Ожидание в процессе восстановления, когда нужные сегменты WAL нельзя получить из какого-либо источника (каталога <code class="filename">pg_wal</code>, архива или потока).</td></tr><tr><td><code class="literal">RegisterSyncRequest</code></td><td>Ожидание при передаче запросов синхронизации процессу контрольной точки из-за переполнения очереди запросов.</td></tr><tr><td><code class="literal">SpinDelay</code></td><td>Ожидание получения конкурирующей циклической блокировки.</td></tr><tr><td><code class="literal">VacuumDelay</code></td><td>Ожидание, вызванное задержкой очистки по критерию стоимости.</td></tr><tr><td><code class="literal">VacuumTruncate</code></td><td>Ожидание исключительной блокировки для отсечения пустых страниц в конце очищаемой таблицы.</td></tr></tbody></table></div></div><br class="table-break" /><p>Следующая команда показывает, как можно просмотреть события ожидания: </p><pre class="programlisting">SELECT pid, wait_event_type, wait_event FROM pg_stat_activity WHERE wait_event is NOT NULL;
 pid  | wait_event_type | wait_event
------+-----------------+------------
 2540 | Lock            | relation
 6644 | LWLock          | ProcArray
(2 rows)</pre></div><div class="sect2" id="MONITORING-PG-STAT-REPLICATION-VIEW"><div class="titlepage"><div><div><h3 class="title">28.2.4. <code class="structname">pg_stat_replication</code> <a href="#MONITORING-PG-STAT-REPLICATION-VIEW" class="id_link">#</a></h3></div></div></div><a id="id-1.6.15.7.8.2" class="indexterm"></a><p>Представление <code class="structname">pg_stat_replication</code> для каждого процесса-передатчика WAL будет содержать по одной строке со статистикой о репликации на ведомый сервер, к которому подключён этот процесс. В представлении перечисляются только ведомые серверы, подключённые напрямую; информация о ведомых серверах, подключённых опосредованно, не представлена.</p><div class="table" id="PG-STAT-REPLICATION-VIEW"><p class="title"><strong>Таблица 28.14. Представление <code class="structname">pg_stat_replication</code></strong></p><div class="table-contents"><table class="table" summary="Представление pg_stat_replication" border="1"><colgroup><col /></colgroup><thead><tr><th class="catalog_table_entry"><p class="column_definition">Тип столбца</p>
      <p>Описание</p></th></tr></thead><tbody><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">pid</code> <code class="type">integer</code>
      </p>
      <p>Идентификатор процесса-передатчика WAL</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">usesysid</code> <code class="type">oid</code>
      </p>
      <p>OID пользователя, подключённого к этому процессу-передатчику WAL</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">usename</code> <code class="type">name</code>
      </p>
      <p>Имя пользователя, подключённого к этому процессу-передатчику WAL</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">application_name</code> <code class="type">text</code>
      </p>
      <p>Имя приложения, которое подключено к этому процессу-передатчику WAL</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">client_addr</code> <code class="type">inet</code>
      </p>
      <p>IP-адрес клиента, подключённого к этому процессу-передатчику WAL. Значение null в этом поле говорит о том, что клиент подсоединён через сокет Unix на сервере.</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">client_hostname</code> <code class="type">text</code>
      </p>
      <p>Имя компьютера для подключённого клиента, получаемое в результате обратного поиска в DNS по <code class="structfield">client_addr</code>. Это поле будет отлично от null только в случае соединений по IP и только при включённом режиме <a class="xref" href="runtime-config-logging.html#GUC-LOG-HOSTNAME">log_hostname</a>.</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">client_port</code> <code class="type">integer</code>
      </p>
      <p>Номер TCP-порта, который используется клиентом для взаимодействия с процессом-передатчиком WAL, или <code class="literal">-1</code>, если используется сокет Unix</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">backend_start</code> <code class="type">timestamp with time zone</code>
      </p>
      <p>Время запуска процесса, т. е. время подключения клиента к этому процессу-передатчику WAL</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">backend_xmin</code> <code class="type">xid</code>
      </p>
      <p>Значение <code class="literal">xmin</code>, полученное от ведомого сервера при включённом <a class="xref" href="runtime-config-replication.html#GUC-HOT-STANDBY-FEEDBACK">hot_standby_feedback</a>.</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">state</code> <code class="type">text</code>
      </p>
      <p>Текущее состояние процесса-передатчика WAL. Возможные значения: </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="literal">startup</code>: Передатчик WAL запускается.</p></li><li class="listitem"><p><code class="literal">catchup</code>: Подключённый к этому передатчику WAL ведомый сервер догоняет ведущий.</p></li><li class="listitem"><p><code class="literal">streaming</code>: Передатчик WAL транслирует изменения после того, как подключённый к нему ведомый сервер нагнал ведущий.</p></li><li class="listitem"><p><code class="literal">backup</code>: Передатчик WAL передаёт резервную копию.</p></li><li class="listitem"><p><code class="literal">stopping</code>: Передатчик WAL останавливается.</p></li></ul></div></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">sent_lsn</code> <code class="type">pg_lsn</code>
      </p>
      <p>Последняя позиция в журнале предзаписи, переданная через это соединение</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">write_lsn</code> <code class="type">pg_lsn</code>
      </p>
      <p>Последняя позиция в журнале предзаписи, записанная на диск этим ведомым сервером</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">flush_lsn</code> <code class="type">pg_lsn</code>
      </p>
      <p>Последняя позиция в журнале предзаписи, сброшенная на диск этим ведомым сервером</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">replay_lsn</code> <code class="type">pg_lsn</code>
      </p>
      <p>Последняя позиция в журнале предзаписи, воспроизведённая в базе данных этим ведомым сервером</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">write_lag</code> <code class="type">interval</code>
      </p>
      <p>Время, прошедшее с момента локального сброса последних данных WAL до получения уведомления о том, что этот ведомый сервер записал их (но ещё не сбросил на диск и не применил). Это позволяет оценить задержку, возникающую при фиксации транзакции, когда в <code class="literal">synchronous_commit</code> выбран уровень <code class="literal">remote_write</code>, если данный сервер будет настроен как синхронный ведомый.</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">flush_lag</code> <code class="type">interval</code>
      </p>
      <p>Время, прошедшее с момента локального сброса последних данных WAL до получения уведомления о том, что этот ведомый сервер записал и сбросил их на диск (но ещё не применил). Это позволяет оценить задержку, возникающую при фиксации транзакции, когда в <code class="literal">synchronous_commit</code> выбран уровень <code class="literal">on</code>, если данный сервер будет настроен как синхронный ведомый.</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">replay_lag</code> <code class="type">interval</code>
      </p>
      <p>Время, прошедшее с момента локального сброса последних данных WAL до получения уведомления о том, что этот ведомый сервер записал, сбросил на диск и применил их. Это позволяет оценить задержку, возникающую при фиксации транзакции, когда в <code class="literal">synchronous_commit</code> выбран уровень <code class="literal">remote_apply</code>, если данный сервер будет настроен как синхронный ведомый.</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">sync_priority</code> <code class="type">integer</code>
      </p>
      <p>Приоритет этого ведомого сервера для выбора в качестве синхронного ведомого при синхронной репликации с учётом приоритетов. При синхронной репликации с учётом кворума не имеет значения.</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">sync_state</code> <code class="type">text</code>
      </p>
      <p>Состояние синхронизации этого ведомого сервера. Возможные значения: </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="literal">async</code>: Этот ведомый сервер является асинхронным.</p></li><li class="listitem"><p><code class="literal">potential</code>: Этот ведомый сервер сейчас является асинхронным, но может стать синхронным в случае отказа одного из текущих синхронных серверов.</p></li><li class="listitem"><p><code class="literal">sync</code>: Этот ведомый сервер является синхронным.</p></li><li class="listitem"><p><code class="literal">quorum</code>: Этот ведомый сервер считается кандитатом на участие в кворуме.</p></li></ul></div></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">reply_time</code> <code class="type">timestamp with time zone</code>
      </p>
      <p>Время отправки последнего ответного сообщения, полученного от ведомого сервера</p></td></tr></tbody></table></div></div><br class="table-break" /><p>Длительность задержек, показываемая в представлении <code class="structname">pg_stat_replication</code>, включает время, которое потребовалось для того, чтобы записать, сбросить на диск и воспроизвести последние записи WAL и для того, чтобы передатчик WAL узнал об этом. Эта длительность отражает задержку фиксации, которая была (или могла быть) добавлена на уровнях синхронной фиксации, если ведомый сервер был настроен как синхронный. Для асинхронного ведомого в столбце <code class="structfield">replay_lag</code> показывается примерная задержка перед тем, как последние транзакции становятся видны для запросов. Если ведомый сервер нагоняет передающий и в WAL отсутствует активность, последние длительности задержек будут отображаться ещё некоторое время, а затем сменятся на NULL.</p><p>Длительность задержек автоматически определяется при физической репликации. Модули логического декодирования могут не выдавать необходимые контрольные сообщения; в их отсутствие механизм отслеживания просто выводит задержку NULL.</p><div class="note"><h3 class="title">Примечание</h3><p>Выдаваемые длительности задержек не являются предсказанием времени, которое потребуется ведомому серверу, чтобы нагнать передающий сервер с учётом текущей скорости воспроизведения. Эти показатели будут близки в процессе генерирования нового WAL, но не в то время, когда передающий сервер будет простаивать. В частности, когда ведомый сервер нагоняет ведущий, в <code class="structname">pg_stat_replication</code> показывается, сколько времени потребовалось для записи, сброса на диск и воспроизведения последних данных WAL, а не 0, как могли ожидать некоторые пользователи. Это соответствует задаче измерения задержек синхронной фиксации и видимости транзакций для недавно записанных транзакций. Чтобы меньше смущать пользователей, ожидающих видеть другую модель задержек, столбцы задержек сбрасываются в NULL после небольшой паузы в системе, которая воспроизвела все изменения и теперь простаивает. Системы мониторинга могут представлять это как отсутствующие данные, 0 или продолжать показывать последнее известное значение.</p></div></div><div class="sect2" id="MONITORING-PG-STAT-REPLICATION-SLOTS-VIEW"><div class="titlepage"><div><div><h3 class="title">28.2.5. <code class="structname">pg_stat_replication_slots</code> <a href="#MONITORING-PG-STAT-REPLICATION-SLOTS-VIEW" class="id_link">#</a></h3></div></div></div><a id="id-1.6.15.7.9.2" class="indexterm"></a><p>Представление <code class="structname">pg_stat_replication_slots</code> содержит одну строку со статистикой использования на каждый слот логической репликации.</p><div class="table" id="PG-STAT-REPLICATION-SLOTS-VIEW"><p class="title"><strong>Таблица 28.15. Представление <code class="structname">pg_stat_replication_slots</code></strong></p><div class="table-contents"><table class="table" summary="Представление pg_stat_replication_slots" border="1"><colgroup><col /></colgroup><thead><tr><th class="catalog_table_entry"><p class="column_definition">Тип столбца</p>
       <p>Описание</p></th></tr></thead><tbody><tr><td class="catalog_table_entry"><p class="column_definition">
        <code class="structfield">slot_name</code> <code class="type">text</code>
       </p>
       <p>Уникальный в рамках кластера идентификатор для слота репликации</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
        <code class="structfield">spill_txns</code> <code class="type">bigint</code>
       </p>
       <p>Количество транзакций, вытесненных на диск после того, как объём памяти, используемый при логическом декодировании изменений из WAL, превысил значение <code class="literal">logical_decoding_work_mem</code>. Счётчик учитывает как транзакции верхнего уровня, так и подтранзакции.</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
        <code class="structfield">spill_count</code> <code class="type">bigint</code>
       </p>
       <p>Сколько раз транзакции были вытеснены на диск при декодировании изменений из WAL для этого слота. Этот счётчик увеличивается каждый раз, когда транзакция вытесняется; одна и та же транзакция может быть вытеснена несколько раз.</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
        <code class="structfield">spill_bytes</code> <code class="type">bigint</code>
       </p>
       <p>Объём декодированных транзакционных данных, вытесненных на диск при выполнении декодирования изменений из WAL для этого слота. Этот и другие счётчики, связанные с вытеснением, помогают оценить объём связанного с логическим декодированием ввода/вывода и настроить параметр <code class="literal">logical_decoding_work_mem</code>.</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
        <code class="structfield">stream_txns</code> <code class="type">bigint</code>
       </p>
       <p>Количество текущих транзакций, переданных в потоке в модуль вывода декодирования после того, как объём памяти, используемый для логического декодирования изменений из WAL для этого слота, превысил значение <code class="literal">logical_decoding_work_mem</code>. В потоке передаются только транзакции верхнего уровня (подтранзакции не могут передаваться в потоке отдельно), поэтому счётчик не учитывает подтранзакции.</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
        <code class="structfield">stream_count</code><code class="type">bigint</code>
       </p>
       <p>Сколько раз текущие транзакции были переданы в потоке модулю вывода при декодировании изменений из WAL для этого слота. Этот счётчик увеличивается каждый раз, когда транзакция передаётся в потоке; одна и та же транзакция может быть передана в потоке несколько раз.</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
        <code class="structfield">stream_bytes</code><code class="type">bigint</code>
       </p>
       <p>Объём транзакционных данных, декодированных для передачи текущих транзакций в потоке в модуль вывода при декодировании изменений из WAL для этого слота. Этот и другие счётчики передаваемых транзакций данного слота могут быть полезны для настройки <code class="literal">logical_decoding_work_mem</code>.</p>
      </td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
        <code class="structfield">total_txns</code> <code class="type">bigint</code>
       </p>
       <p>Количество декодированных транзакций, отправленных в модуль вывода декодирования для этого слота. Учитываются только транзакции верхнего уровня, но не подтранзакции. Обратите внимание, что в этом количестве учитываются передаваемые в потоке и/или вытесняемые транзакции.</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
        <code class="structfield">total_bytes</code><code class="type">bigint</code>
       </p>
       <p>Объём транзакционных данных, декодированных для отправки транзакций в модуль вывода при декодировании изменений из WAL для этого слота. Обратите внимание, что в этом объёме учитываются передаваемые в потоке и/или вытесняемые данные.</p>
      </td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
        <code class="structfield">stats_reset</code> <code class="type">timestamp with time zone</code>
       </p>
       <p>Последнее время сброса этих статистических данных</p></td></tr></tbody></table></div></div><br class="table-break" /></div><div class="sect2" id="MONITORING-PG-STAT-WAL-RECEIVER-VIEW"><div class="titlepage"><div><div><h3 class="title">28.2.6. <code class="structname">pg_stat_wal_receiver</code> <a href="#MONITORING-PG-STAT-WAL-RECEIVER-VIEW" class="id_link">#</a></h3></div></div></div><a id="id-1.6.15.7.10.2" class="indexterm"></a><p>Представление <code class="structname">pg_stat_wal_receiver</code> будет иметь только одну строку со статистикой приёмника WAL от сервера, на котором работает приёмник.</p><div class="table" id="PG-STAT-WAL-RECEIVER-VIEW"><p class="title"><strong>Таблица 28.16. Представление <code class="structname">pg_stat_wal_receiver</code></strong></p><div class="table-contents"><table class="table" summary="Представление pg_stat_wal_receiver" border="1"><colgroup><col /></colgroup><thead><tr><th class="catalog_table_entry"><p class="column_definition">Тип столбца</p>
      <p>Описание</p></th></tr></thead><tbody><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">pid</code> <code class="type">integer</code>
      </p>
      <p>Идентификатор процесса WAL-приёмника</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">status</code> <code class="type">text</code>
      </p>
      <p>Состояние активности процесса WAL-приёмника</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">receive_start_lsn</code> <code class="type">pg_lsn</code>
      </p>
      <p>Первая позиция в журнале предзаписи в момент запуска приёмника WAL</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">receive_start_tli</code> <code class="type">integer</code>
      </p>
      <p>Первый номер линии времени в момент запуска приёмника WAL</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">written_lsn</code> <code class="type">pg_lsn</code>
      </p>
      <p>Последняя позиция в журнале предзаписи, уже полученная и переданная для записи на диск, но ещё не сброшенная. Эту позицию не следует использовать при проверках целостности данных.</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">flushed_lsn</code> <code class="type">pg_lsn</code>
      </p>
      <p>Последняя позиция в журнале предзаписи, уже полученная и сброшенная на диск; начальным значением этого поля будет первая позиция в журнале в момент запуска приёмника WAL</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">received_tli</code> <code class="type">integer</code>
      </p>
      <p>Номер линии времени последней позиции в журнале предзаписи, уже полученной и сброшенной на диск; начальным значением этого поля будет номер линии времени первой позиции в момент запуска приёмника WAL</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">last_msg_send_time</code> <code class="type">timestamp with time zone</code>
      </p>
      <p>Время отправки последнего сообщения, полученного от изначального передатчика WAL</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">last_msg_receipt_time</code> <code class="type">timestamp with time zone</code>
      </p>
      <p>Время поступления последнего сообщения, полученного от изначального передатчика WAL</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">latest_end_lsn</code> <code class="type">pg_lsn</code>
      </p>
      <p>Последняя позиция в журнале предзаписи, сообщённая изначальному передатчику WAL</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">latest_end_time</code> <code class="type">timestamp with time zone</code>
      </p>
      <p>Время последней позиции в журнале предзаписи, сообщённой изначальному передатчику WAL</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">slot_name</code> <code class="type">text</code>
      </p>
      <p>Имя слота репликации, используемого этим приёмником WAL</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">sender_host</code> <code class="type">text</code>
      </p>
      <p>Узел, где работает сервер <span class="productname">PostgreSQL</span>, обслуживающий данный приёмник WAL. Может задаваться именем или IP-адресом компьютера либо путём каталога (если подключение установлено через сокет Unix). (Подключение к сокету легко распознать, потому что путь всегда абсолютный и начинается с <code class="literal">/</code>.)</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">sender_port</code> <code class="type">integer</code>
      </p>
      <p>Номер порта сервера <span class="productname">PostgreSQL</span>, к которому подключён этот приёмник WAL.</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">conninfo</code> <code class="type">text</code>
      </p>
      <p>Строка подключения, используемая этим приёмником WAL (секретные поля в ней скрыты).</p></td></tr></tbody></table></div></div><br class="table-break" /></div><div class="sect2" id="MONITORING-PG-STAT-RECOVERY-PREFETCH"><div class="titlepage"><div><div><h3 class="title">28.2.7. <code class="structname">pg_stat_recovery_prefetch</code> <a href="#MONITORING-PG-STAT-RECOVERY-PREFETCH" class="id_link">#</a></h3></div></div></div><a id="id-1.6.15.7.11.2" class="indexterm"></a><p>Представление <code class="structname">pg_stat_recovery_prefetch</code> будет содержать только одну строку. В столбцах <code class="structfield">wal_distance</code>, <code class="structfield">block_distance</code> и <code class="structfield">io_depth</code> показываются текущие значения, а в других столбцах — накопительные счётчики, которые можно сбросить функцией <code class="function">pg_stat_reset_shared</code>.</p><div class="table" id="PG-STAT-RECOVERY-PREFETCH-VIEW"><p class="title"><strong>Таблица 28.17. Представление <code class="structname">pg_stat_recovery_prefetch</code></strong></p><div class="table-contents"><table class="table" summary="Представление pg_stat_recovery_prefetch" border="1"><colgroup><col /></colgroup><thead><tr><th class="catalog_table_entry"><p class="column_definition">Тип столбца</p>
      <p>Описание</p></th></tr></thead><tbody><tr><td class="catalog_table_entry">
       <p class="column_definition">
        <code class="structfield">stats_reset</code> <code class="type">timestamp with time zone</code>
       </p>
       <p>Последнее время сброса этих статистических данных</p>
      </td></tr><tr><td class="catalog_table_entry">
       <p class="column_definition">
        <code class="structfield">prefetch</code> <code class="type">bigint</code>
       </p>
       <p>Количество блоков, выбранных предварительно ввиду их отсутствия в пуле буферов</p>
      </td></tr><tr><td class="catalog_table_entry">
       <p class="column_definition">
        <code class="structfield">hit</code> <code class="type">bigint</code>
       </p>
       <p>Количество блоков, не выбранных предварительно из-за того, что они уже находились в пуле буферов</p>
      </td></tr><tr><td class="catalog_table_entry">
       <p class="column_definition">
        <code class="structfield">skip_init</code> <code class="type">bigint</code>
       </p>
       <p>Количество блоков, не выбранных предварительно, потому что они должны инициализироваться нулями</p>
      </td></tr><tr><td class="catalog_table_entry">
       <p class="column_definition">
        <code class="structfield">skip_new</code> <code class="type">bigint</code>
       </p>
       <p>Количество блоков, не выбранных предварительно, потому что они не существовали</p>
      </td></tr><tr><td class="catalog_table_entry">
       <p class="column_definition">
        <code class="structfield">skip_fpw</code> <code class="type">bigint</code>
       </p>
       <p>Количество блоков, не выбранных предварительно, так как в WAL были записаны образы полных страниц</p>
      </td></tr><tr><td class="catalog_table_entry">
       <p class="column_definition">
        <code class="structfield">skip_rep</code> <code class="type">bigint</code>
       </p>
       <p>Количество блоков, не выбранных предварительно, потому что они были предвыбраны ранее</p>
      </td></tr><tr><td class="catalog_table_entry">
       <p class="column_definition">
        <code class="structfield">wal_distance</code> <code class="type">int</code>
       </p>
       <p>Объём WAL, просматриваемый для предвыборки блоков (в байтах)</p>
      </td></tr><tr><td class="catalog_table_entry">
       <p class="column_definition">
        <code class="structfield">block_distance</code> <code class="type">int</code>
       </p>
       <p>Количество блоков в процессе предвыборки</p>
      </td></tr><tr><td class="catalog_table_entry">
       <p class="column_definition">
        <code class="structfield">io_depth</code> <code class="type">int</code>
       </p>
       <p>Число инициированных операций предвыборки, которые ещё не считаются завершёнными</p>
      </td></tr></tbody></table></div></div><br class="table-break" /></div><div class="sect2" id="MONITORING-PG-STAT-SUBSCRIPTION"><div class="titlepage"><div><div><h3 class="title">28.2.8. <code class="structname">pg_stat_subscription</code> <a href="#MONITORING-PG-STAT-SUBSCRIPTION" class="id_link">#</a></h3></div></div></div><a id="id-1.6.15.7.12.2" class="indexterm"></a><div class="table" id="PG-STAT-SUBSCRIPTION"><p class="title"><strong>Таблица 28.18. Представление <code class="structname">pg_stat_subscription</code></strong></p><div class="table-contents"><table class="table" summary="Представление pg_stat_subscription" border="1"><colgroup><col /></colgroup><thead><tr><th class="catalog_table_entry"><p class="column_definition">Тип столбца</p>
      <p>Описание</p></th></tr></thead><tbody><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">subid</code> <code class="type">oid</code>
      </p>
      <p>OID подписки</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">subname</code> <code class="type">name</code>
      </p>
      <p>Имя подписки</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">pid</code> <code class="type">integer</code>
      </p>
      <p>Идентификатор рабочего процесса, обслуживающего подписку</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">leader_pid</code> <code class="type">integer</code>
      </p>
      <p>Идентификатор ведущего рабочего процесса применения, если этот процесс является параллельным рабочим процессом применения; NULL, если этот процесс является ведущим процессом применения изменений или рабочим процессом синхронизации</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">relid</code> <code class="type">oid</code>
      </p>
      <p>OID отношения, которое синхронизирует рабочий процесс сейчас; NULL для ведущего и параллельных процессов применения изменений</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">received_lsn</code> <code class="type">pg_lsn</code>
      </p>
      <p>Последняя позиция в журнале предзаписи (начальное значение этого поля — 0); NULL для параллельных рабочих процессов применения</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">last_msg_send_time</code> <code class="type">timestamp with time zone</code>
      </p>
      <p>Время отправки последнего сообщения, полученного от изначального передатчика WAL; NULL для параллельных рабочих процессов применения изменений</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">last_msg_receipt_time</code> <code class="type">timestamp with time zone</code>
      </p>
      <p>Время поступления последнего сообщения, полученного от изначального передатчика WAL; NULL для параллельных рабочих процессов применения изменений</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">latest_end_lsn</code> <code class="type">pg_lsn</code>
      </p>
      <p>Последняя позиция в журнале предзаписи, сообщённая изначальному передатчику WAL; NULL для параллельных рабочих процессов применения изменений</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">latest_end_time</code> <code class="type">timestamp with time zone</code>
      </p>
      <p>Время последней позиции в журнале предзаписи, сообщённой изначальному передатчику WAL; NULL для параллельных рабочих процессов применения изменений</p></td></tr></tbody></table></div></div><br class="table-break" /></div><div class="sect2" id="MONITORING-PG-STAT-SUBSCRIPTION-STATS"><div class="titlepage"><div><div><h3 class="title">28.2.9. <code class="structname">pg_stat_subscription_stats</code> <a href="#MONITORING-PG-STAT-SUBSCRIPTION-STATS" class="id_link">#</a></h3></div></div></div><a id="id-1.6.15.7.13.2" class="indexterm"></a><p>Представление <code class="structname">pg_stat_subscription_stats</code> будет содержать одну строку для каждой подписки.</p><div class="table" id="PG-STAT-SUBSCRIPTION-STATS"><p class="title"><strong>Таблица 28.19. Представление <code class="structname">pg_stat_subscription_stats</code></strong></p><div class="table-contents"><table class="table" summary="Представление pg_stat_subscription_stats" border="1"><colgroup><col /></colgroup><thead><tr><th class="catalog_table_entry"><p class="column_definition">Тип столбца</p>
      <p>Описание</p></th></tr></thead><tbody><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">subid</code> <code class="type">oid</code>
      </p>
      <p>OID подписки</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">subname</code> <code class="type">name</code>
      </p>
      <p>Имя подписки</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">apply_error_count</code> <code class="type">bigint</code>
      </p>
      <p>Число ошибок, возникших при применении изменений</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">sync_error_count</code> <code class="type">bigint</code>
      </p>
      <p>Число ошибок, возникших во время начальной синхронизации таблиц</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">stats_reset</code> <code class="type">timestamp with time zone</code>
      </p>
      <p>Последнее время сброса этих статистических данных</p></td></tr></tbody></table></div></div><br class="table-break" /></div><div class="sect2" id="MONITORING-PG-STAT-SSL-VIEW"><div class="titlepage"><div><div><h3 class="title">28.2.10. <code class="structname">pg_stat_ssl</code> <a href="#MONITORING-PG-STAT-SSL-VIEW" class="id_link">#</a></h3></div></div></div><a id="id-1.6.15.7.14.2" class="indexterm"></a><p>Представление <code class="structname">pg_stat_ssl</code> содержит по одной строке для каждого обслуживающего процесса и процесса, передающего WAL, и показывает статистику использования SSL для подключений. Его можно соединить с <code class="structname">pg_stat_activity</code> или <code class="structname">pg_stat_replication</code> по столбцу <code class="structfield">pid</code> и получить дополнительные сведения о подключении.</p><div class="table" id="PG-STAT-SSL-VIEW"><p class="title"><strong>Таблица 28.20. Представление <code class="structname">pg_stat_ssl</code></strong></p><div class="table-contents"><table class="table" summary="Представление pg_stat_ssl" border="1"><colgroup><col /></colgroup><thead><tr><th class="catalog_table_entry"><p class="column_definition">Тип столбца</p>
      <p>Описание</p></th></tr></thead><tbody><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">pid</code> <code class="type">integer</code>
      </p>
      <p>Идентификатор обслуживающего процесса или процесса, передающего WAL</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">ssl</code> <code class="type">boolean</code>
      </p>
      <p>True, если для этого подключения используется SSL</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">version</code> <code class="type">text</code>
      </p>
      <p>Версия SSL либо NULL, если SSL для этого подключения не используется</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">cipher</code> <code class="type">text</code>
      </p>
      <p>Имя применяемого шифра SSL либо NULL, если SSL для этого подключения не используется</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">bits</code> <code class="type">integer</code>
      </p>
      <p>Число бит в применяемом алгоритме шифрования либо NULL, если SSL для этого подключения не используется</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">client_dn</code> <code class="type">text</code>
      </p>
      <p>Поле DN (Distinguished Name, Уникальное имя) из используемого клиентского сертификата либо NULL, если клиент не передал сертификат или SSL для этого подключения не используется. Это значение усекается, если оказывается длиннее <code class="symbol">NAMEDATALEN</code> символов (64 символа в стандартной сборке).</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">client_serial</code> <code class="type">numeric</code>
      </p>
      <p>Серийный номер клиентского сертификата либо NULL, если клиент не передал сертификат или SSL для этого подключения не используется. В сочетании с именем центра сертификации, выдавшего сертификат, серийный номер однозначно идентифицирует сертификат (если только ЦС не выдаёт по ошибке одинаковые серийные номера).</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">issuer_dn</code> <code class="type">text</code>
      </p>
      <p>Уникальное имя (Distinguished Name, DN) центра сертификации, выдавшего клиентский сертификат, либо NULL, если клиент не передал сертификат или SSL для этого подключения не используется. Это значение усекается подобно <code class="structfield">client_dn</code>.</p></td></tr></tbody></table></div></div><br class="table-break" /></div><div class="sect2" id="MONITORING-PG-STAT-GSSAPI-VIEW"><div class="titlepage"><div><div><h3 class="title">28.2.11. <code class="structname">pg_stat_gssapi</code> <a href="#MONITORING-PG-STAT-GSSAPI-VIEW" class="id_link">#</a></h3></div></div></div><a id="id-1.6.15.7.15.2" class="indexterm"></a><p>Представление <code class="structname">pg_stat_gssapi</code> содержит по одной строке для каждого обслуживающего процесса и показывает статистику использования GSSAPI для конкретного подключения. Его можно соединить с <code class="structname">pg_stat_activity</code> или <code class="structname">pg_stat_replication</code> по столбцу <code class="structfield">pid</code> и получить дополнительные сведения о подключении.</p><div class="table" id="PG-STAT-GSSAPI-VIEW"><p class="title"><strong>Таблица 28.21. Представление <code class="structname">pg_stat_gssapi</code></strong></p><div class="table-contents"><table class="table" summary="Представление pg_stat_gssapi" border="1"><colgroup><col /></colgroup><thead><tr><th class="catalog_table_entry"><p class="column_definition">Тип столбца</p>
      <p>Описание</p></th></tr></thead><tbody><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">pid</code> <code class="type">integer</code>
      </p>
      <p>Идентификатор (PID) обслуживающего процесса</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">gss_authenticated</code> <code class="type">boolean</code>
      </p>
      <p>True, если для этого подключения используется аутентификация GSSAPI</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">principal</code> <code class="type">text</code>
      </p>
      <p>Принципал, для которого было аутентифицировано это подключение, либо NULL, если клиент не передал сертификат или GSSAPI для этого подключения не используется. Это значение усекается, если оказывается длиннее <code class="symbol">NAMEDATALEN</code> символов (64 символа в стандартной сборке).</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">encrypted</code> <code class="type">boolean</code>
      </p>
      <p>True, если для этого подключения используется шифрование GSSAPI</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">credentials_delegated</code> <code class="type">boolean</code>
      </p>
      <p>True, если для этого подключения были делегированы учётные данные GSSAPI.</p></td></tr></tbody></table></div></div><br class="table-break" /></div><div class="sect2" id="MONITORING-PG-STAT-ARCHIVER-VIEW"><div class="titlepage"><div><div><h3 class="title">28.2.12. <code class="structname">pg_stat_archiver</code> <a href="#MONITORING-PG-STAT-ARCHIVER-VIEW" class="id_link">#</a></h3></div></div></div><a id="id-1.6.15.7.16.2" class="indexterm"></a><p>В представлении <code class="structname">pg_stat_archiver</code> всегда будет одна строка, содержащая данные о текущем состоянии процесса архивации в кластере.</p><div class="table" id="PG-STAT-ARCHIVER-VIEW"><p class="title"><strong>Таблица 28.22. Представление <code class="structname">pg_stat_archiver</code></strong></p><div class="table-contents"><table class="table" summary="Представление pg_stat_archiver" border="1"><colgroup><col /></colgroup><thead><tr><th class="catalog_table_entry"><p class="column_definition">Тип столбца</p>
      <p>Описание</p></th></tr></thead><tbody><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">archived_count</code> <code class="type">bigint</code>
      </p>
      <p>Число файлов WAL, которые были успешно архивированы</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">last_archived_wal</code> <code class="type">text</code>
      </p>
      <p>Имя последнего успешно заархивированного файла WAL</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">last_archived_time</code> <code class="type">timestamp with time zone</code>
      </p>
      <p>Время последней успешной архивации</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">failed_count</code> <code class="type">bigint</code>
      </p>
      <p>Число неудачных попыток архивации файлов WAL</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">last_failed_wal</code> <code class="type">text</code>
      </p>
      <p>Имя файла WAL, который обрабатывался в ходе последней неудавшейся архивации</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">last_failed_time</code> <code class="type">timestamp with time zone</code>
      </p>
      <p>Время последней неудавшейся архивации</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">stats_reset</code> <code class="type">timestamp with time zone</code>
      </p>
      <p>Последнее время сброса этих статистических данных</p></td></tr></tbody></table></div></div><br class="table-break" /><p>Обычно файлы WAL архивируются в порядке от старых к новым, но это не гарантируется и не выполняется при особых обстоятельствах, например при повышении ведомого сервера или после восстановления после сбоя. Поэтому считать, что все файлы старше <code class="structfield">last_archived_wal</code> также были успешно заархивированы, небезопасно.</p></div><div class="sect2" id="MONITORING-PG-STAT-IO-VIEW"><div class="titlepage"><div><div><h3 class="title">28.2.13. <code class="structname">pg_stat_io</code> <a href="#MONITORING-PG-STAT-IO-VIEW" class="id_link">#</a></h3></div></div></div><a id="id-1.6.15.7.17.2" class="indexterm"></a><p>Представление <code class="structname">pg_stat_io</code> содержит по одной строке со статистикой ввода-вывода на уровне кластера для каждой комбинации типа обслуживающего процесса, целевого объекта ввода-вывода и контекста ввода-вывода. Комбинации, не имеющие смысла, исключаются.</p><p>В настоящее время отслеживаются операции ввода-вывода для отношений (например, таблиц, индексов). Однако операции ввода-вывода для отношений, которые не используют буферный кеш (например, при перемещении таблицы из одного табличного пространства в другое), в настоящее время не отслеживаются.</p><div class="table" id="PG-STAT-IO-VIEW"><p class="title"><strong>Таблица 28.23. Представление <code class="structname">pg_stat_io</code></strong></p><div class="table-contents"><table class="table" summary="Представление pg_stat_io" border="1"><colgroup><col /></colgroup><thead><tr><th class="catalog_table_entry">
       <p class="column_definition">Тип столбца</p>
       <p>Описание</p>
      </th></tr></thead><tbody><tr><td class="catalog_table_entry">
       <p class="column_definition">
        <code class="structfield">backend_type</code> <code class="type">text</code>
       </p>
       <p>Тип обслуживающего процесса (например, фоновый рабочий процесс, рабочий процесс автоочистки). Чтобы узнать больше о <code class="varname">backend_type</code>, обратитесь к описанию представления <a class="link" href="monitoring-stats.html#MONITORING-PG-STAT-ACTIVITY-VIEW" title="28.2.3. pg_stat_activity"><code class="structname">pg_stat_activity</code></a>. По некоторым типам обслуживающих процессов (<code class="varname">backend_type</code>) не накапливается статистика операций ввода-вывода, и она не включаются в представление.</p>
      </td></tr><tr><td class="catalog_table_entry">
       <p class="column_definition">
        <code class="structfield">object</code> <code class="type">text</code>
       </p>
       <p>Целевой объект операции ввода-вывода. Возможные значения: </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="literal">relation</code>: постоянные отношения.</p></li><li class="listitem"><p><code class="literal">temp relation</code>: временные отношения.</p></li></ul></div>
      </td></tr><tr><td class="catalog_table_entry">
       <p class="column_definition">
        <code class="structfield">context</code> <code class="type">text</code>
       </p>
       <p>Контекст операции ввода-вывода. Возможные значения:</p>
       <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="literal">normal</code>: используемый по умолчанию или стандартный контекст для операции ввода-вывода этого типа. Например, по умолчанию данные отношений считываются и записываются через общий буфер, то есть операции чтения и записи, выполняемые через буфер, будут учитываться с контекстом <code class="literal">normal</code>.</p></li><li class="listitem"><p><code class="literal">vacuum</code>: контекст для операций ввода-вывода, выполняемых за пределами общих буферов при очистке и анализе постоянных отношений. Операции очистки временных таблиц используют тот же пул локальных буферов, что и другие операции ввода-вывода с временными таблицами, поэтому учитываются с контекстом <code class="literal">normal</code>.</p></li><li class="listitem"><p><code class="literal">bulkread</code>: некоторые большие операции чтения, выполняемые за пределами общих буферов, например последовательное сканирование большой таблицы.</p></li><li class="listitem"><p><code class="literal">bulkwrite</code>: некоторые большие операции записи, выполняемые за пределами общих буферов, например <code class="command">COPY</code>.</p></li></ul></div>
      </td></tr><tr><td class="catalog_table_entry">
       <p class="column_definition">
        <code class="structfield">reads</code> <code class="type">bigint</code>
       </p>
       <p>Количество операций чтения, размер каждой указан в <code class="varname">op_bytes</code>.</p>
      </td></tr><tr><td class="catalog_table_entry">
       <p class="column_definition">
        <code class="structfield">read_time</code> <code class="type">double precision</code>
       </p>
       <p>Время, затраченное операциями чтения, в миллисекундах (если включён параметр <a class="xref" href="runtime-config-statistics.html#GUC-TRACK-IO-TIMING">track_io_timing</a>; в противном случае 0).</p>
      </td></tr><tr><td class="catalog_table_entry">
       <p class="column_definition">
        <code class="structfield">writes</code> <code class="type">bigint</code>
       </p>
       <p>Количество операций записи, размер каждой указан в <code class="varname">op_bytes</code>.</p>
      </td></tr><tr><td class="catalog_table_entry">
       <p class="column_definition">
        <code class="structfield">write_time</code> <code class="type">double precision</code>
       </p>
       <p>Время, затраченное операциями записи, в миллисекундах (если включён параметр <a class="xref" href="runtime-config-statistics.html#GUC-TRACK-IO-TIMING">track_io_timing</a>; в противном случае 0).</p>
      </td></tr><tr><td class="catalog_table_entry">
       <p class="column_definition">
        <code class="structfield">writebacks</code> <code class="type">bigint</code>
       </p>
       <p>Количество блоков размером <code class="varname">op_bytes</code>, запрошенных процессом для записи ядром в постоянное хранилище.</p>
      </td></tr><tr><td class="catalog_table_entry">
       <p class="column_definition">
        <code class="structfield">writeback_time</code> <code class="type">double precision</code>
       </p>
       <p>Время, затраченное на операции отложенной записи, в миллисекундах (если параметр <a class="xref" href="runtime-config-statistics.html#GUC-TRACK-IO-TIMING">track_io_timing</a> включён, в противном случае 0). Сюда входит время, потраченное на постановку в очередь запросов на запись, и в принципе время, потраченное на запись «грязных» данных.</p>
      </td></tr><tr><td class="catalog_table_entry">
       <p class="column_definition">
        <code class="structfield">extends</code> <code class="type">bigint</code>
       </p>
       <p>Количество операций расширения отношений, размер каждой указан в <code class="varname">op_bytes</code>.</p>
      </td></tr><tr><td class="catalog_table_entry">
       <p class="column_definition">
        <code class="structfield">extend_time</code> <code class="type">double precision</code>
       </p>
       <p>Время, затраченное операциями расширения, в миллисекундах (если включён параметр <a class="xref" href="runtime-config-statistics.html#GUC-TRACK-IO-TIMING">track_io_timing</a>; в противном случае 0).</p>
      </td></tr><tr><td class="catalog_table_entry">
       <p class="column_definition">
        <code class="structfield">op_bytes</code> <code class="type">bigint</code>
       </p>
       <p>Число байтов на единицу ввода-вывода, прочитанную, записанную или расширенную.</p>
       <p>Чтение, запись и расширение отношений выполняются в единицах <code class="varname">block_size</code>, рассчитанных из параметра <code class="symbol">BLCKSZ</code>, задаваемого в процессе сборки и по умолчанию равного <code class="literal">8192</code>.</p>
      </td></tr><tr><td class="catalog_table_entry">
       <p class="column_definition">
        <code class="structfield">hits</code> <code class="type">bigint</code>
       </p>
       <p>Сколько раз нужный блок был найден в общем буфере.</p>
      </td></tr><tr><td class="catalog_table_entry">
       <p class="column_definition">
        <code class="structfield">evictions</code> <code class="type">bigint</code>
       </p>
       <p>Сколько раз блок был записан из общего или локального буфера, чтобы его можно было переиспользовать.</p>
       <p>В контексте <code class="literal">normal</code> подсчитывает количество вытеснений блока из буфера и замены другим блоком. В контекстах <code class="literal">bulkwrite</code>, <code class="literal">bulkread</code> и <code class="literal">vacuum</code> подсчитывает количество вытеснений блока из общего буфера, чтобы добавить общий буфер в отдельный кольцевой буфер с ограниченным размером для использования в массовой операции ввода-вывода.</p>
      </td></tr><tr><td class="catalog_table_entry">
       <p class="column_definition">
        <code class="structfield">reuses</code> <code class="type">bigint</code>
       </p>
       <p>Сколько раз существующий буфер в кольцевом буфере с ограниченным размером за пределами общих буферов был повторно использован как часть операции ввода-вывода в контекстах <code class="literal">bulkread</code>, <code class="literal">bulkwrite</code> или <code class="literal">vacuum</code>.</p>
      </td></tr><tr><td class="catalog_table_entry">
       <p class="column_definition">
        <code class="structfield">fsyncs</code> <code class="type">bigint</code>
       </p>
       <p>Количество вызовов <code class="literal">fsync</code>. Они отслеживаются только в контексте <code class="literal">normal</code>.</p>
      </td></tr><tr><td class="catalog_table_entry">
       <p class="column_definition">
        <code class="structfield">fsync_time</code> <code class="type">double precision</code>
       </p>
       <p>Время, затраченное операциями fsync, в миллисекундах (если включён параметр <a class="xref" href="runtime-config-statistics.html#GUC-TRACK-IO-TIMING">track_io_timing</a>; в противном случае 0).</p>
      </td></tr><tr><td class="catalog_table_entry">
       <p class="column_definition">
        <code class="structfield">stats_reset</code> <code class="type">timestamp with time zone</code>
       </p>
       <p>Последнее время сброса этих статистических данных.</p>
      </td></tr></tbody></table></div></div><br class="table-break" /><p>Некоторые типы обслуживающих процессов никогда не выполняют операции ввода-вывода с некоторыми объектами ввода-вывода и/или в некоторых контекстах ввода-вывода. Эти строки исключаются из представления. Например, процесс контрольной точки не обрабатывает временные таблицы, поэтому не будет строк для объектов типа <code class="literal">checkpointer</code> объектов <code class="literal">temp relation</code>.</p><p>Кроме того, некоторые операции ввода-вывода никогда не будут выполняться ни некоторыми типами обслуживающих процессов, ни с некоторыми объектами ввода-вывода и/или в некоторых контекстах ввода-вывода. Эти ячейки будут иметь значение NULL. Например, <code class="literal">fsync</code> временных таблиц не поддерживается, поэтому <code class="varname">fsyncs</code> будет иметь значение NULL для <code class="varname">object</code> <code class="literal">temp relation</code>. Кроме того, фоновый рабочий процесс записи не выполняет чтение, поэтому <code class="varname">reads</code> будет иметь значение NULL в строках для <code class="varname">backend_type</code> <code class="literal">background writer</code>.</p><p><code class="structname">pg_stat_io</code> можно использовать для информирования о настройке базы данных. Например: </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Большое количество вытеснений (<code class="varname">evictions</code>) в столбце может указывать на необходимость увеличения общих буферов.</p></li><li class="listitem"><p>Чтобы гарантировать сохранение данных в постоянном хранилище, клиентские процессы задействуют процесс контрольных точек. Большое количество <code class="varname">fsyncs</code> со стороны <code class="literal">client backend</code> может указывать на неправильную настройку общих буферов или процесса контрольных точек. Настройка этого процесса подробно описана в <a class="xref" href="wal-configuration.html" title="30.5. Настройка WAL">Разделе 30.5</a>.</p></li><li class="listitem"><p>Обычно клиентские процессы должны иметь возможность задействовать вспомогательные процессы, такие как процесс контрольных точек и процесс фоновой записи, для записи как можно большего количества «грязных» данных. Большое количество записей со стороны клиентских обслуживающих процессов может указывать на неправильную настройку общих буферов или процесса контрольных точек. Настройка процесса контрольных точек подробно описана в <a class="xref" href="wal-configuration.html" title="30.5. Настройка WAL">Разделе 30.5</a>.</p></li></ul></div><div class="note"><h3 class="title">Примечание</h3><p>Столбцы, отслеживающие время ввода-вывода, будут ненулевыми, только если включён параметр <a class="xref" href="runtime-config-statistics.html#GUC-TRACK-IO-TIMING">track_io_timing</a>. Следует с осторожностью обращаться к этим столбцам совместно с соответствующими столбцами, отслеживающими количество операций ввода-вывода, если параметр <code class="varname">track_io_timing</code> не был включён в течение всего времени с момента последнего сброса статистики.</p></div></div><div class="sect2" id="MONITORING-PG-STAT-BGWRITER-VIEW"><div class="titlepage"><div><div><h3 class="title">28.2.14. <code class="structname">pg_stat_bgwriter</code> <a href="#MONITORING-PG-STAT-BGWRITER-VIEW" class="id_link">#</a></h3></div></div></div><a id="id-1.6.15.7.18.2" class="indexterm"></a><p>В представлении <code class="structname">pg_stat_bgwriter</code> всегда будет только одна строка, в которой будут представлены общие данные по всему кластеру.</p><div class="table" id="PG-STAT-BGWRITER-VIEW"><p class="title"><strong>Таблица 28.24. Представление <code class="structname">pg_stat_bgwriter</code></strong></p><div class="table-contents"><table class="table" summary="Представление pg_stat_bgwriter" border="1"><colgroup><col /></colgroup><thead><tr><th class="catalog_table_entry"><p class="column_definition">Тип столбца</p>
      <p>Описание</p></th></tr></thead><tbody><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">checkpoints_timed</code> <code class="type">bigint</code>
      </p>
      <p>Количество запланированных контрольных точек, которые уже были выполнены</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">checkpoints_req</code> <code class="type">bigint</code>
      </p>
      <p>Количество запрошенных контрольных точек, которые уже были выполнены</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">checkpoint_write_time</code> <code class="type">double precision</code>
      </p>
      <p>Общее время, которое было затрачено на этап обработки контрольной точки, в котором файлы записываются на диск, в миллисекундах</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">checkpoint_sync_time</code> <code class="type">double precision</code>
      </p>
      <p>Общее время, которое было затрачено на этап обработки контрольной точки, в котором файлы синхронизируются с диском, в миллисекундах</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">buffers_checkpoint</code> <code class="type">bigint</code>
      </p>
      <p>Количество буферов, записанных при выполнении контрольных точек</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">buffers_clean</code> <code class="type">bigint</code>
      </p>
      <p>Количество буферов, записанных фоновым процессом записи</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">maxwritten_clean</code> <code class="type">bigint</code>
      </p>
      <p>Сколько раз фоновый процесс записи останавливал сброс грязных страниц на диск из-за того, что записал слишком много буферов</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">buffers_backend</code> <code class="type">bigint</code>
      </p>
      <p>Количество буферов, записанных самим серверным процессом</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">buffers_backend_fsync</code> <code class="type">bigint</code>
      </p>
      <p>Сколько раз серверному процессу пришлось выполнить <code class="function">fsync</code> самостоятельно (обычно фоновый процесс записи сам обрабатывает эти вызовы, даже когда серверный процесс выполняет запись самостоятельно)</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">buffers_alloc</code> <code class="type">bigint</code>
      </p>
      <p>Количество выделенных буферов</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">stats_reset</code> <code class="type">timestamp with time zone</code>
      </p>
      <p>Последнее время сброса этих статистических данных</p></td></tr></tbody></table></div></div><br class="table-break" /></div><div class="sect2" id="MONITORING-PG-STAT-WAL-VIEW"><div class="titlepage"><div><div><h3 class="title">28.2.15. <code class="structname">pg_stat_wal</code> <a href="#MONITORING-PG-STAT-WAL-VIEW" class="id_link">#</a></h3></div></div></div><a id="id-1.6.15.7.19.2" class="indexterm"></a><p>В представлении <code class="structname">pg_stat_wal</code> всегда будет одна строка, содержащая данные о работе WAL в кластере.</p><div class="table" id="PG-STAT-WAL-VIEW"><p class="title"><strong>Таблица 28.25. Представление <code class="structname">pg_stat_wal</code></strong></p><div class="table-contents"><table class="table" summary="Представление pg_stat_wal" border="1"><colgroup><col /></colgroup><thead><tr><th class="catalog_table_entry"><p class="column_definition">Тип столбца</p>
      <p>Описание</p></th></tr></thead><tbody><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">wal_records</code> <code class="type">bigint</code>
      </p>
      <p>Общее число сгенерированных записей WAL</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">wal_fpi</code> <code class="type">bigint</code>
      </p>
      <p>Общее число сгенерированных образов полных страниц в WAL</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">wal_bytes</code> <code class="type">numeric</code>
      </p>
      <p>Общий сгенерированный объём WAL в байтах</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">wal_buffers_full</code> <code class="type">bigint</code>
      </p>
      <p>Сколько раз данные WAL записывались на диск из-за переполнения буферов WAL</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">wal_write</code> <code class="type">bigint</code>
      </p>
      <p>Сколько раз буферы WAL были записаны на диск функцией <code class="function">XLogWrite</code>. Более подробную информацию о внутренней функции WAL <code class="function">XLogWrite</code> можно найти в <a class="xref" href="wal-configuration.html" title="30.5. Настройка WAL">Разделе 30.5</a>.</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">wal_sync</code> <code class="type">bigint</code>
      </p>
      <p>Сколько раз файлы WAL сбрасывались на диск функцией <code class="function">issue_xlog_fsync</code> (если параметр <a class="xref" href="runtime-config-wal.html#GUC-FSYNC">fsync</a> включён (<code class="literal">on</code>) и <a class="xref" href="runtime-config-wal.html#GUC-WAL-SYNC-METHOD">wal_sync_method</a> имеет значение <code class="literal">fdatasync</code>, <code class="literal">fsync</code> или <code class="literal">fsync_writethrough</code>, в противном случае будет выведен ноль). Более подробную информацию о внутренней функции WAL <code class="function">issue_xlog_fsync</code> можно найти в <a class="xref" href="wal-configuration.html" title="30.5. Настройка WAL">Разделе 30.5</a>.</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">wal_write_time</code> <code class="type">double precision</code>
      </p>
      <p>Общее время, затраченное на запись буферов WAL на диск функцией <code class="function">XLogWrite</code>, в миллисекундах (если включён параметр <a class="xref" href="runtime-config-statistics.html#GUC-TRACK-WAL-IO-TIMING">track_wal_io_timing</a>, в противном случае 0). Также учитывается время синхронизации, когда <code class="varname">wal_sync_method</code> имеет значение <code class="literal">open_datasync</code> или <code class="literal">open_sync</code>.</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">wal_sync_time</code> <code class="type">double precision</code>
      </p>
      <p>Общее время, затраченное на синхронизацию файлов WAL с диском функцией <code class="function">issue_xlog_fsync</code>, в миллисекундах (если включён <code class="varname">track_wal_io_timing</code>, <code class="varname">fsync</code> имеет значение <code class="literal">on</code>, а <code class="varname">wal_sync_method</code> имеет значение <code class="literal">fdatasync</code>, <code class="literal">fsync</code> или <code class="literal">fsync_writethrough</code>, в противном случае 0).</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">stats_reset</code> <code class="type">timestamp with time zone</code>
      </p>
      <p>Последнее время сброса этих статистических данных</p></td></tr></tbody></table></div></div><br class="table-break" /></div><div class="sect2" id="MONITORING-PG-STAT-DATABASE-VIEW"><div class="titlepage"><div><div><h3 class="title">28.2.16. <code class="structname">pg_stat_database</code> <a href="#MONITORING-PG-STAT-DATABASE-VIEW" class="id_link">#</a></h3></div></div></div><a id="id-1.6.15.7.20.2" class="indexterm"></a><p>Представление <code class="structname">pg_stat_database</code> содержит по одной строке со статистикой уровня базы данных для каждой базы кластера, и ещё одну для общих объектов.</p><div class="table" id="PG-STAT-DATABASE-VIEW"><p class="title"><strong>Таблица 28.26. Представление <code class="structname">pg_stat_database</code></strong></p><div class="table-contents"><table class="table" summary="Представление pg_stat_database" border="1"><colgroup><col /></colgroup><thead><tr><th class="catalog_table_entry"><p class="column_definition">Тип столбца</p>
      <p>Описание</p></th></tr></thead><tbody><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">datid</code> <code class="type">oid</code>
      </p>
      <p>OID базы данных либо 0 для объектов, относящихся к общим отношениям</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">datname</code> <code class="type">name</code>
      </p>
      <p>Имя базы данных либо <code class="literal">NULL</code> для общих объектов.</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">numbackends</code> <code class="type">integer</code>
      </p>
      <p>Количество обслуживающих процессов, в настоящее время подключённых к этой базе данных, либо <code class="literal">NULL</code> для общих объектов. Это единственный столбец в представлении, значение в котором отражает текущее состояние; все другие столбцы возвращают суммарные значения со времени последнего сброса статистики.</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">xact_commit</code> <code class="type">bigint</code>
      </p>
      <p>Количество зафиксированных транзакций в этой базе данных</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">xact_rollback</code> <code class="type">bigint</code>
      </p>
      <p>Количество транзакций в этой базе данных, для которых был выполнен откат транзакции</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">blks_read</code> <code class="type">bigint</code>
      </p>
      <p>Количество прочитанных дисковых блоков в этой базе данных</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">blks_hit</code> <code class="type">bigint</code>
      </p>
      <p>Сколько раз дисковые блоки обнаруживались в буферном кеше, так что чтение с диска не потребовалось (в значение входят только случаи обнаружения в буферном кеше PostgreSQL, а не в кеше файловой системы ОС)</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">tup_returned</code> <code class="type">bigint</code>
      </p>
      <p>Количество «живых» строк, выбранных при последовательном сканировании, и записей индекса, выбранных при сканировании индексов, в этой базе данных</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">tup_fetched</code> <code class="type">bigint</code>
      </p>
      <p>Количество «живых» строк, выбранных при сканировании индексов в этой базе данных</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">tup_inserted</code> <code class="type">bigint</code>
      </p>
      <p>Количество строк, вставленное запросами в этой базе данных</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">tup_updated</code> <code class="type">bigint</code>
      </p>
      <p>Количество строк, изменённое запросами в этой базе данных</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">tup_deleted</code> <code class="type">bigint</code>
      </p>
      <p>Количество строк, удалённое запросами в этой базе данных</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">conflicts</code> <code class="type">bigint</code>
      </p>
      <p>Количество запросов, отменённых из-за конфликта с восстановлением в этой базе данных. (Конфликты происходят только на ведомых серверах; подробности в <a class="link" href="monitoring-stats.html#MONITORING-PG-STAT-DATABASE-CONFLICTS-VIEW" title="28.2.17. pg_stat_database_conflicts"><code class="structname">pg_stat_database_conflicts</code></a>.)</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">temp_files</code> <code class="type">bigint</code>
      </p>
      <p>Количество временных файлов, созданных запросами в этой базе данных. Подсчитываются все временные файлы независимо от причины их создания (например, для сортировки или для хеширования) и независимо от установленного значения <a class="xref" href="runtime-config-logging.html#GUC-LOG-TEMP-FILES">log_temp_files</a></p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">temp_bytes</code> <code class="type">bigint</code>
      </p>
      <p>Общий объём данных, записанных во временные файлы запросами в этой базе данных. Учитываются все временные файлы, вне зависимости от того, по какой причине они созданы и вне зависимости от значения <a class="xref" href="runtime-config-logging.html#GUC-LOG-TEMP-FILES">log_temp_files</a>.</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">deadlocks</code> <code class="type">bigint</code>
      </p>
      <p>Количество взаимных блокировок, зафиксированное в этой базе данных</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">checksum_failures</code> <code class="type">bigint</code>
      </p>
      <p>Количество ошибок контрольных сумм в страницах данных этой базы (или общего объекта) либо NULL, если контрольные суммы не проверяются.</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">checksum_last_failure</code> <code class="type">timestamp with time zone</code>
      </p>
      <p>Время выявления последней ошибки контрольной суммы в страницах данных этой базы (или общего объекта) либо NULL, если контрольные суммы не проверяются.</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">blk_read_time</code> <code class="type">double precision</code>
      </p>
      <p>Время, которое затратили обслуживающие процессы в этой базе на чтение блоков из файлов данных, в миллисекундах (если включён параметр <a class="xref" href="runtime-config-statistics.html#GUC-TRACK-IO-TIMING">track_io_timing</a>; в противном случае 0).</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">blk_write_time</code> <code class="type">double precision</code>
      </p>
      <p>Время, которое затратили обслуживающие процессы в этой базе на запись блоков в файлы данных, в миллисекундах (если включён параметр <a class="xref" href="runtime-config-statistics.html#GUC-TRACK-IO-TIMING">track_io_timing</a>; в противном случае 0)</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">session_time</code> <code class="type">double precision</code>
      </p>
      <p>Длительность сеансов в этой базе в миллисекундах (обратите внимание, что статистика обновляется только при изменении состояния сеанса, поэтому, если сеансы простаивают в течение длительного времени, оно не будет учитываться)</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">active_time</code> <code class="type">double precision</code>
      </p>
      <p>Время, затраченное на выполнение операторов SQL в этой базе, в миллисекундах (соответствует состояниям <code class="literal">active</code> и <code class="literal">fastpath function call</code> в <a class="link" href="monitoring-stats.html#MONITORING-PG-STAT-ACTIVITY-VIEW" title="28.2.3. pg_stat_activity"><code class="structname">pg_stat_activity</code></a>)</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">idle_in_transaction_time</code> <code class="type">double precision</code>
      </p>
      <p>Время простоя в транзакциях в этой базе в миллисекундах (соответствует состояниям <code class="literal">idle in transaction</code> и <code class="literal">idle in transaction (aborted)</code> в <a class="link" href="monitoring-stats.html#MONITORING-PG-STAT-ACTIVITY-VIEW" title="28.2.3. pg_stat_activity"><code class="structname">pg_stat_activity</code></a>)</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">sessions</code> <code class="type">bigint</code>
      </p>
      <p>Общее количество сеансов, относящихся к этой базе</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">sessions_abandoned</code> <code class="type">bigint</code>
      </p>
      <p>Количество сеансов в этой базе данных, прерванных из-за потери соединения с клиентом</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">sessions_fatal</code> <code class="type">bigint</code>
      </p>
      <p>Количество сеансов в этой базе данных, прерванных из-за критических ошибок</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">sessions_killed</code> <code class="type">bigint</code>
      </p>
      <p>Количество сеансов в этой базе данных, прерванных из-за вмешательства оператора</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">stats_reset</code> <code class="type">timestamp with time zone</code>
      </p>
      <p>Последнее время сброса этих статистических данных</p></td></tr></tbody></table></div></div><br class="table-break" /></div><div class="sect2" id="MONITORING-PG-STAT-DATABASE-CONFLICTS-VIEW"><div class="titlepage"><div><div><h3 class="title">28.2.17. <code class="structname">pg_stat_database_conflicts</code> <a href="#MONITORING-PG-STAT-DATABASE-CONFLICTS-VIEW" class="id_link">#</a></h3></div></div></div><a id="id-1.6.15.7.21.2" class="indexterm"></a><p>Представление <code class="structname">pg_stat_database_conflicts</code> для каждой базы данных будет содержать по одной строке со статистикой на уровне базы по отменам запросов, произошедшим вследствие конфликтов с процессами восстановления на ведомых серверах. В этом представлении будет содержаться только информация по ведомым серверам, поскольку на ведущих серверах конфликты не возникают.</p><div class="table" id="PG-STAT-DATABASE-CONFLICTS-VIEW"><p class="title"><strong>Таблица 28.27. Представление <code class="structname">pg_stat_database_conflicts</code></strong></p><div class="table-contents"><table class="table" summary="Представление pg_stat_database_conflicts" border="1"><colgroup><col /></colgroup><thead><tr><th class="catalog_table_entry"><p class="column_definition">Тип столбца</p>
      <p>Описание</p></th></tr></thead><tbody><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">datid</code> <code class="type">oid</code>
      </p>
      <p>OID базы данных</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">datname</code> <code class="type">name</code>
      </p>
      <p>Имя базы данных</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">confl_tablespace</code> <code class="type">bigint</code>
      </p>
      <p>Количество запросов в этой базе данных, отменённых из-за того, что табличные пространства были удалены</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">confl_lock</code> <code class="type">bigint</code>
      </p>
      <p>Количество запросов в этой базе данных, отменённых по истечении времени ожидания блокировки</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">confl_snapshot</code> <code class="type">bigint</code>
      </p>
      <p>Количество запросов в этой базе данных, отменённых из-за устаревших снимков данных</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">confl_bufferpin</code> <code class="type">bigint</code>
      </p>
      <p>Количество запросов в этой базе данных, отменённых из-за прикреплённых страниц буфера</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">confl_deadlock</code> <code class="type">bigint</code>
      </p>
      <p>Количество запросов в этой базе данных, отменённых из-за взаимных блокировок</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">confl_active_logicalslot</code> <code class="type">bigint</code>
      </p>
      <p>Количество использований логических слотов в этой базе данных, отменённых из-за старых снимков или слишком низкого значения <a class="xref" href="runtime-config-wal.html#GUC-WAL-LEVEL">wal_level</a> на ведущем сервере</p></td></tr></tbody></table></div></div><br class="table-break" /></div><div class="sect2" id="MONITORING-PG-STAT-ALL-TABLES-VIEW"><div class="titlepage"><div><div><h3 class="title">28.2.18. <code class="structname">pg_stat_all_tables</code> <a href="#MONITORING-PG-STAT-ALL-TABLES-VIEW" class="id_link">#</a></h3></div></div></div><a id="id-1.6.15.7.22.2" class="indexterm"></a><p>Представление <code class="structname">pg_stat_all_tables</code> будет содержать по одной строке на каждую таблицу в текущей базе данных (включая таблицы TOAST) со статистикой по обращениям к этой таблице. Представления <code class="structname">pg_stat_user_tables</code> и <code class="structname">pg_stat_sys_tables</code> содержат ту же самую информацию, но отфильтрованную так, чтобы показывать только пользовательские и системные таблицы соответственно.</p><div class="table" id="PG-STAT-ALL-TABLES-VIEW"><p class="title"><strong>Таблица 28.28. Представление <code class="structname">pg_stat_all_tables</code></strong></p><div class="table-contents"><table class="table" summary="Представление pg_stat_all_tables" border="1"><colgroup><col /></colgroup><thead><tr><th class="catalog_table_entry"><p class="column_definition">Тип столбца</p>
      <p>Описание</p></th></tr></thead><tbody><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">relid</code> <code class="type">oid</code>
      </p>
      <p>OID таблицы</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">schemaname</code> <code class="type">name</code>
      </p>
      <p>Имя схемы, в которой расположена эта таблица</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">relname</code> <code class="type">name</code>
      </p>
      <p>Имя таблицы</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">seq_scan</code> <code class="type">bigint</code>
      </p>
      <p>Количество последовательных чтений, произведённых в этой таблице</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">last_seq_scan</code> <code class="type">timestamp with time zone</code>
      </p>
      <p>Время последнего последовательного сканирования этой таблицы, исходя из времени последней остановки транзакции</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">seq_tup_read</code> <code class="type">bigint</code>
      </p>
      <p>Количество «живых» строк, прочитанных при последовательных чтениях</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">idx_scan</code> <code class="type">bigint</code>
      </p>
      <p>Количество сканирований по индексу, произведённых в этой таблице</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">last_idx_scan</code> <code class="type">timestamp with time zone</code>
      </p>
      <p>Время последнего последовательного сканирования индекса этой таблицы, исходя из времени последней остановки транзакции</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">idx_tup_fetch</code> <code class="type">bigint</code>
      </p>
      <p>Количество «живых» строк, отобранных при сканированиях по индексу</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">n_tup_ins</code> <code class="type">bigint</code>
      </p>
      <p>Общее количество вставленных строк</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">n_tup_upd</code> <code class="type">bigint</code>
      </p>
      <p>Общее количество изменённых строк. (Включая изменения строк, учитываемые в <code class="structfield">n_tup_hot_upd</code> и <code class="structfield">n_tup_newpage_upd</code>, а также остальные изменения, не относящиеся к <acronym class="acronym">HOT</acronym>.)</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">n_tup_del</code> <code class="type">bigint</code>
      </p>
      <p>Общее количество удалённых строк</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">n_tup_hot_upd</code> <code class="type">bigint</code>
      </p>
      <p>Количество строк, изменённых по схеме <a class="link" href="storage-hot.html" title="73.7. Кортежи только в куче (Heap-Only Tuples, HOT)">HOT</a>. Для таких изменений не требуются последующие версии в индексах.</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">n_tup_newpage_upd</code> <code class="type">bigint</code>
      </p>
      <p>Количество изменённых строк с переходом новой версии строки на <span class="emphasis"><em>новую</em></span> страницу кучи, оставляющих после себя исходную версию с полем <a class="link" href="storage-page-layout.html#STORAGE-TUPLE-LAYOUT" title="73.6.1. Компоновка строки таблицы"><code class="structfield">t_ctid</code></a>, которое указывает на другую страницу кучи. Это всегда изменения, не относящиеся к <acronym class="acronym">HOT</acronym>.</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">n_live_tup</code> <code class="type">bigint</code>
      </p>
      <p>Оценочное количество «живых» строк</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">n_dead_tup</code> <code class="type">bigint</code>
      </p>
      <p>Оценочное количество «мёртвых» строк</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">n_mod_since_analyze</code> <code class="type">bigint</code>
      </p>
      <p>Оценочное число строк, изменённых в этой таблице с момента последнего сбора статистики</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">n_ins_since_vacuum</code> <code class="type">bigint</code>
      </p>
      <p>Примерное число строк, вставленных в эту таблицу с момента последнего сбора статистики</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">last_vacuum</code> <code class="type">timestamp with time zone</code>
      </p>
      <p>Время последней очистки этой таблицы вручную (<code class="command">VACUUM FULL</code> не учитывается)</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">last_autovacuum</code> <code class="type">timestamp with time zone</code>
      </p>
      <p>Время последней очистки таблицы фоновым процессом автоочистки</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">last_analyze</code> <code class="type">timestamp with time zone</code>
      </p>
      <p>Время последнего выполнения сбора статистики для этой таблицы вручную</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">last_autoanalyze</code> <code class="type">timestamp with time zone</code>
      </p>
      <p>Время последнего выполнения сбора статистики для этой таблицы фоновым процессом автоочистки</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">vacuum_count</code> <code class="type">bigint</code>
      </p>
      <p>Сколько раз очистка этой таблицы была выполнена вручную (<code class="command">VACUUM FULL</code> не учитывается)</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">autovacuum_count</code> <code class="type">bigint</code>
      </p>
      <p>Сколько раз очистка этой таблицы была выполнена фоновым процессом автоочистки</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">analyze_count</code> <code class="type">bigint</code>
      </p>
      <p>Сколько раз сбор статистики для этой таблицы был выполнен вручную</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">autoanalyze_count</code> <code class="type">bigint</code>
      </p>
      <p>Сколько раз сбор статистики для этой таблицы был выполнен фоновым процессом автоочистки</p></td></tr></tbody></table></div></div><br class="table-break" /></div><div class="sect2" id="MONITORING-PG-STAT-ALL-INDEXES-VIEW"><div class="titlepage"><div><div><h3 class="title">28.2.19. <code class="structname">pg_stat_all_indexes</code> <a href="#MONITORING-PG-STAT-ALL-INDEXES-VIEW" class="id_link">#</a></h3></div></div></div><a id="id-1.6.15.7.23.2" class="indexterm"></a><p>Представление <code class="structname">pg_stat_all_indexes</code> для каждого индекса в текущей базе данных будет содержать по одной строке со статистикой по обращениям к этому индексу. Представления <code class="structname">pg_stat_user_indexes</code> и <code class="structname">pg_stat_sys_indexes</code> содержат ту же самую информацию, но отфильтрованную так, чтобы показывать только пользовательские и системные индексы соответственно.</p><div class="table" id="PG-STAT-ALL-INDEXES-VIEW"><p class="title"><strong>Таблица 28.29. Представление <code class="structname">pg_stat_all_indexes</code></strong></p><div class="table-contents"><table class="table" summary="Представление pg_stat_all_indexes" border="1"><colgroup><col /></colgroup><thead><tr><th class="catalog_table_entry"><p class="column_definition">Тип столбца</p>
      <p>Описание</p></th></tr></thead><tbody><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">relid</code> <code class="type">oid</code>
      </p>
      <p>OID таблицы для индекса</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">indexrelid</code> <code class="type">oid</code>
      </p>
      <p>OID индекса</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">schemaname</code> <code class="type">name</code>
      </p>
      <p>Имя схемы, в которой расположен индекс</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">relname</code> <code class="type">name</code>
      </p>
      <p>Имя таблицы для индекса</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">indexrelname</code> <code class="type">name</code>
      </p>
      <p>Имя индекса</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">idx_scan</code> <code class="type">bigint</code>
      </p>
      <p>Количество произведённых сканирований по этому индексу</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">last_idx_scan</code> <code class="type">timestamp with time zone</code>
      </p>
      <p>Время последнего сканирования этого индекса, исходя из времени последней остановки транзакции</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">idx_tup_read</code> <code class="type">bigint</code>
      </p>
      <p>Количество элементов индекса, возвращённых при сканированиях по этому индексу</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">idx_tup_fetch</code> <code class="type">bigint</code>
      </p>
      <p>Количество живых строк таблицы, отобранных при простых сканированиях по этому индексу</p></td></tr></tbody></table></div></div><br class="table-break" /><p>Индексы могут использоваться при простом сканировании по индексу, при сканировании <span class="quote">«<span class="quote">битовой карты</span>»</span> индекса и в работе оптимизатора. Результаты сканирования битовых карт разных индексов могут объединяться логическим умножением или сложением, поэтому когда применяются битовые карты, сложно связать выборки отдельных строк с определёнными индексами. Поэтому при сканировании битовых карт увеличиваются счётчики <code class="structname">pg_stat_all_indexes</code>.<code class="structfield">idx_tup_read</code> для задействованных индексов и счётчик <code class="structname">pg_stat_all_tables</code>.<code class="structfield">idx_tup_fetch</code> для каждой таблицы, а <code class="structname">pg_stat_all_indexes</code>.<code class="structfield">idx_tup_fetch</code> не меняется. Оптимизатор тоже обращается к индексам для проверки переданных констант, значения которых оказываются вне диапазона, записанного в статистике оптимизатора, так как эта статистика может быть неактуальной.</p><div class="note"><h3 class="title">Примечание</h3><p>Значения счётчиков <code class="structfield">idx_tup_read</code> и <code class="structfield">idx_tup_fetch</code> могут различаться, даже если сканирование с использованием битовой карты не используется, поскольку <code class="structfield">idx_tup_read</code> подсчитывает полученные из индекса элементы, а <code class="structfield">idx_tup_fetch</code> — количество «живых» строк, выбранных из таблицы. Различие будет меньше, если «мёртвые» или ещё не зафиксированные строки будут извлекаться с использованием индекса или если для получения строк таблицы будет использоваться сканирование только по индексу.</p></div></div><div class="sect2" id="MONITORING-PG-STATIO-ALL-TABLES-VIEW"><div class="titlepage"><div><div><h3 class="title">28.2.20. <code class="structname">pg_statio_all_tables</code> <a href="#MONITORING-PG-STATIO-ALL-TABLES-VIEW" class="id_link">#</a></h3></div></div></div><a id="id-1.6.15.7.24.2" class="indexterm"></a><p>Представление <code class="structname">pg_statio_all_tables</code> для каждой таблицы (включая таблицы TOAST) в текущей базе данных будет содержать по одной строке со статистикой по операциям ввода/вывода для этой таблицы. Представления <code class="structname">pg_statio_user_tables</code> и <code class="structname">pg_statio_sys_tables</code> содержат ту же самую информацию, но отфильтрованную так, чтобы показывать только пользовательские или системные таблицы соответственно.</p><div class="table" id="PG-STATIO-ALL-TABLES-VIEW"><p class="title"><strong>Таблица 28.30. Представление <code class="structname">pg_statio_all_tables</code></strong></p><div class="table-contents"><table class="table" summary="Представление pg_statio_all_tables" border="1"><colgroup><col /></colgroup><thead><tr><th class="catalog_table_entry"><p class="column_definition">Тип столбца</p>
      <p>Описание</p></th></tr></thead><tbody><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">relid</code> <code class="type">oid</code>
      </p>
      <p>OID таблицы</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">schemaname</code> <code class="type">name</code>
      </p>
      <p>Имя схемы, в которой расположена эта таблица</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">relname</code> <code class="type">name</code>
      </p>
      <p>Имя таблицы</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">heap_blks_read</code> <code class="type">bigint</code>
      </p>
      <p>Количество дисковых блоков, прочитанных из этой таблицы</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">heap_blks_hit</code> <code class="type">bigint</code>
      </p>
      <p>Число попаданий в буфер для этой таблицы</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">idx_blks_read</code> <code class="type">bigint</code>
      </p>
      <p>Количество дисковых блоков, прочитанных из всех индексов этой таблицы</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">idx_blks_hit</code> <code class="type">bigint</code>
      </p>
      <p>Число попаданий в буфер для всех индексов по этой таблице</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">toast_blks_read</code> <code class="type">bigint</code>
      </p>
      <p>Количество прочитанных дисковых блоков TOAST (если есть) для этой таблицы</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">toast_blks_hit</code> <code class="type">bigint</code>
      </p>
      <p>Число попаданий в буфер в таблице TOAST для этой таблицы (если такие есть)</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">tidx_blks_read</code> <code class="type">bigint</code>
      </p>
      <p>Количество прочитанных дисковых блоков из индекса по TOAST (если есть) для этой таблицы</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">tidx_blks_hit</code> <code class="type">bigint</code>
      </p>
      <p>Число попаданий в буфер для индекса по TOAST (если есть) для этой таблицы</p></td></tr></tbody></table></div></div><br class="table-break" /></div><div class="sect2" id="MONITORING-PG-STATIO-ALL-INDEXES-VIEW"><div class="titlepage"><div><div><h3 class="title">28.2.21. <code class="structname">pg_statio_all_indexes</code> <a href="#MONITORING-PG-STATIO-ALL-INDEXES-VIEW" class="id_link">#</a></h3></div></div></div><a id="id-1.6.15.7.25.2" class="indexterm"></a><p>Представление <code class="structname">pg_statio_all_indexes</code> для каждого индекса в текущей базе данных будет содержать по одной строке со статистикой по операциям ввода/вывода для этого индекса. Представления <code class="structname">pg_statio_user_indexes</code> и <code class="structname">pg_statio_sys_indexes</code> содержат ту же самую информацию, но отфильтрованную так, чтобы показывать только пользовательские или системные индексы соответственно.</p><div class="table" id="PG-STATIO-ALL-INDEXES-VIEW"><p class="title"><strong>Таблица 28.31. Представление <code class="structname">pg_statio_all_indexes</code></strong></p><div class="table-contents"><table class="table" summary="Представление pg_statio_all_indexes" border="1"><colgroup><col /></colgroup><thead><tr><th class="catalog_table_entry"><p class="column_definition">Тип столбца</p>
      <p>Описание</p></th></tr></thead><tbody><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">relid</code> <code class="type">oid</code>
      </p>
      <p>OID таблицы для индекса</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">indexrelid</code> <code class="type">oid</code>
      </p>
      <p>OID индекса</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">schemaname</code> <code class="type">name</code>
      </p>
      <p>Имя схемы, в которой расположен индекс</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">relname</code> <code class="type">name</code>
      </p>
      <p>Имя таблицы для индекса</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">indexrelname</code> <code class="type">name</code>
      </p>
      <p>Имя индекса</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">idx_blks_read</code> <code class="type">bigint</code>
      </p>
      <p>Количество дисковых блоков, прочитанных из этого индекса</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">idx_blks_hit</code> <code class="type">bigint</code>
      </p>
      <p>Число попаданий в буфер для этого индекса</p></td></tr></tbody></table></div></div><br class="table-break" /></div><div class="sect2" id="MONITORING-PG-STATIO-ALL-SEQUENCES-VIEW"><div class="titlepage"><div><div><h3 class="title">28.2.22. <code class="structname">pg_statio_all_sequences</code> <a href="#MONITORING-PG-STATIO-ALL-SEQUENCES-VIEW" class="id_link">#</a></h3></div></div></div><a id="id-1.6.15.7.26.2" class="indexterm"></a><p>Представление <code class="structname">pg_statio_all_sequences</code> для каждой последовательности в текущей базе данных будет содержать по одной строке со статистикой по операциям ввода/вывода для этой последовательности.</p><div class="table" id="PG-STATIO-ALL-SEQUENCES-VIEW"><p class="title"><strong>Таблица 28.32. Представление <code class="structname">pg_statio_all_sequences</code></strong></p><div class="table-contents"><table class="table" summary="Представление pg_statio_all_sequences" border="1"><colgroup><col /></colgroup><thead><tr><th class="catalog_table_entry"><p class="column_definition">Тип столбца</p>
      <p>Описание</p></th></tr></thead><tbody><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">relid</code> <code class="type">oid</code>
      </p>
      <p>OID последовательности</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">schemaname</code> <code class="type">name</code>
      </p>
      <p>Имя схемы, в которой расположена эта последовательность</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">relname</code> <code class="type">name</code>
      </p>
      <p>Имя последовательности</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">blks_read</code> <code class="type">bigint</code>
      </p>
      <p>Количество дисковых блоков, прочитанных из этой последовательности</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">blks_hit</code> <code class="type">bigint</code>
      </p>
      <p>Число попаданий в буфер в этой последовательности</p></td></tr></tbody></table></div></div><br class="table-break" /></div><div class="sect2" id="MONITORING-PG-STAT-USER-FUNCTIONS-VIEW"><div class="titlepage"><div><div><h3 class="title">28.2.23. <code class="structname">pg_stat_user_functions</code> <a href="#MONITORING-PG-STAT-USER-FUNCTIONS-VIEW" class="id_link">#</a></h3></div></div></div><a id="id-1.6.15.7.27.2" class="indexterm"></a><p>Представление <code class="structname">pg_stat_user_functions</code> для каждой отслеживаемой функции будет содержать по одной строке со статистикой по выполнениям этой функции. Отслеживаемые функции определяются параметром <a class="xref" href="runtime-config-statistics.html#GUC-TRACK-FUNCTIONS">track_functions</a>.</p><div class="table" id="PG-STAT-USER-FUNCTIONS-VIEW"><p class="title"><strong>Таблица 28.33. Представление <code class="structname">pg_stat_user_functions</code></strong></p><div class="table-contents"><table class="table" summary="Представление pg_stat_user_functions" border="1"><colgroup><col /></colgroup><thead><tr><th class="catalog_table_entry"><p class="column_definition">Тип столбца</p>
      <p>Описание</p></th></tr></thead><tbody><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">funcid</code> <code class="type">oid</code>
      </p>
      <p>OID функции</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">schemaname</code> <code class="type">name</code>
      </p>
      <p>Имя схемы, в которой расположена функция</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">funcname</code> <code class="type">name</code>
      </p>
      <p>Имя функции</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">calls</code> <code class="type">bigint</code>
      </p>
      <p>Сколько раз вызывалась функция</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">total_time</code> <code class="type">double precision</code>
      </p>
      <p>Общее время, потраченное на выполнение этой функции и всех других функций, вызванных ею, в миллисекундах</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">self_time</code> <code class="type">double precision</code>
      </p>
      <p>Общее время, потраченное на выполнение самой функции, без учёта других функций, которые были ею вызваны, в миллисекундах</p></td></tr></tbody></table></div></div><br class="table-break" /></div><div class="sect2" id="MONITORING-PG-STAT-SLRU-VIEW"><div class="titlepage"><div><div><h3 class="title">28.2.24. <code class="structname">pg_stat_slru</code> <a href="#MONITORING-PG-STAT-SLRU-VIEW" class="id_link">#</a></h3></div></div></div><a id="id-1.6.15.7.28.2" class="indexterm"></a><a id="id-1.6.15.7.28.3" class="indexterm"></a><p><span class="productname">PostgreSQL</span> обращается к некоторой информации на диске через кеши, работающие по принципу <em class="firstterm">SLRU</em> (simple least-recently-used, простое вытеснение давно не используемых). Представление <code class="structname">pg_stat_slru</code> содержит по одной строке для каждого SLRU-кеша и даёт статистику по обращениям к его страницам.</p><div class="table" id="PG-STAT-SLRU-VIEW"><p class="title"><strong>Таблица 28.34. Представление <code class="structname">pg_stat_slru</code></strong></p><div class="table-contents"><table class="table" summary="Представление pg_stat_slru" border="1"><colgroup><col /></colgroup><thead><tr><th class="catalog_table_entry"><p class="column_definition">Тип столбца</p>
      <p>Описание</p></th></tr></thead><tbody><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">name</code> <code class="type">text</code>
      </p>
      <p>Имя SLRU-кеша</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">blks_zeroed</code> <code class="type">bigint</code>
      </p>
      <p>Количество блоков, обнулённых при инициализации</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">blks_hit</code> <code class="type">bigint</code>
      </p>
      <p>Количество случаев, когда дисковые блоки обнаруживались в SLRU-кеше, так что чтение с диска не потребовалось (здесь учитываются только случаи обнаружения в этом кеше, а не в файловом кеше ОС)</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">blks_read</code> <code class="type">bigint</code>
      </p>
      <p>Количество дисковых блоков, прочитанных через этот SLRU-кеш</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">blks_written</code> <code class="type">bigint</code>
      </p>
      <p>Количество дисковых блоков, записанных из этого SLRU-кеша</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">blks_exists</code> <code class="type">bigint</code>
      </p>
      <p>Количество блоков, проверенных на предмет наличия в этом SLRU-кеше</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">flushes</code> <code class="type">bigint</code>
      </p>
      <p>Количество операций сброса «грязных» данных для этого SLRU-кеша</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">truncates</code> <code class="type">bigint</code>
      </p>
      <p>Количество операций усечения для этого SLRU-кеша</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">stats_reset</code> <code class="type">timestamp with time zone</code>
      </p>
      <p>Последнее время сброса этих статистических данных</p></td></tr></tbody></table></div></div><br class="table-break" /></div><div class="sect2" id="MONITORING-STATS-FUNCTIONS"><div class="titlepage"><div><div><h3 class="title">28.2.25. Статистические функции <a href="#MONITORING-STATS-FUNCTIONS" class="id_link">#</a></h3></div></div></div><p>Статистическую информацию можно просматривать и другими способами. Для этого можно написать запросы, использующие те же функции доступа к статистике, что лежат в основе описанных выше стандартных представлений. За более подробной информацией, например, об именах этих функций, обратитесь к определениям этих стандартных представлений. (Например, в <span class="application">psql</span> можно выполнить <code class="literal">\d+ pg_stat_activity</code>.) В качестве аргумента функции, предоставляющие доступ к статистике на уровне базы, принимают OID базы данных, по которой должна быть выдана информация. Функции, которые работают на уровне таблиц и индексов, принимают в качестве аргумента OID таблицы или индекса. Аргументом для функции, предоставляющей статистику на уровне функций, является OID функции. Обратите внимание, что с помощью этих функций можно получить информацию по таблицам, индексам и функциям исключительно в текущей базе данных.</p><p>Дополнительные функции, связанные с системой накопительной статистики, перечислены в <a class="xref" href="monitoring-stats.html#MONITORING-STATS-FUNCS-TABLE" title="Таблица 28.35. Дополнительные статистические функции">Таблице 28.35</a>.</p><div class="table" id="MONITORING-STATS-FUNCS-TABLE"><p class="title"><strong>Таблица 28.35. Дополнительные статистические функции</strong></p><div class="table-contents"><table class="table" summary="Дополнительные статистические функции" border="1"><colgroup><col /></colgroup><thead><tr><th class="func_table_entry"><p class="func_signature">Функция</p>
       <p>Описание</p></th></tr></thead><tbody><tr><td class="func_table_entry"><p class="func_signature"><code class="function">pg_backend_pid</code> () → <code class="returnvalue">integer</code></p>
       <p>Выдаёт идентификатор серверного процесса, обслуживающего текущий сеанс.</p></td></tr><tr><td class="func_table_entry"><p class="func_signature"><a id="id-1.6.15.7.29.4.2.2.2.1.1.1" class="indexterm"></a> <code class="function">pg_stat_get_activity</code> ( <code class="type">integer</code> ) → <code class="returnvalue">setof record</code></p>
       <p>Возвращает запись с информацией о серверном процессе с заданным ID или по одной строке для каждого активного серверного процесса, если был указан <code class="literal">NULL</code>. Возвращаемые поля являются подмножеством столбцов представления <code class="structname">pg_stat_activity</code>.</p></td></tr><tr><td class="func_table_entry"><p class="func_signature"><a id="id-1.6.15.7.29.4.2.2.3.1.1.1" class="indexterm"></a> <code class="function">pg_stat_get_snapshot_timestamp</code> () → <code class="returnvalue">timestamp with time zone</code></p>
       <p>Возвращает метку времени текущего снимка статистики или NULL, если снимок статистики не был получен. Снимок создаётся при первом обращении к накопительной статистике в транзакции, если для параметра <code class="varname">stats_fetch_consistency</code> задано значение <code class="literal">snapshot</code>.</p></td></tr><tr><td class="func_table_entry"><p class="func_signature"><a id="id-1.6.15.7.29.4.2.2.4.1.1.1" class="indexterm"></a> <code class="function">pg_stat_get_xact_blocks_fetched</code> ( <code class="type">oid</code> ) → <code class="returnvalue">bigint</code></p>
       <p>Возвращает количество запросов на чтение блоков для таблицы или индекса в текущей транзакции. Это число минус <code class="function">pg_stat_get_xact_blocks_hit</code> даёт количество обращений к ядру функцией <code class="function">read()</code>; количество реальных физических операций чтения обычно меньше благодаря буферизации на уровне ядра.</p></td></tr><tr><td class="func_table_entry"><p class="func_signature"><a id="id-1.6.15.7.29.4.2.2.5.1.1.1" class="indexterm"></a> <code class="function">pg_stat_get_xact_blocks_hit</code> ( <code class="type">oid</code> ) → <code class="returnvalue">bigint</code></p>
       <p>Возвращает количество запросов на чтение блоков, уже обнаруженных в кеше, для таблицы или индекса в текущей транзакции (не вызывает обращение к ядру функцией <code class="function">read()</code>).</p></td></tr><tr><td class="func_table_entry"><p class="func_signature"><a id="id-1.6.15.7.29.4.2.2.6.1.1.1" class="indexterm"></a> <code class="function">pg_stat_clear_snapshot</code> () → <code class="returnvalue">void</code></p>
       <p>Сбрасывает текущий снимок статистики или кешированные данные.</p></td></tr><tr><td class="func_table_entry"><p class="func_signature"><a id="id-1.6.15.7.29.4.2.2.7.1.1.1" class="indexterm"></a> <code class="function">pg_stat_reset</code> () → <code class="returnvalue">void</code></p>
       <p>Обнуляет все статистические счётчики в текущей базе данных.</p>
       <p>По умолчанию доступ к этой функции имеют только суперпользователи, но право на её выполнение (EXECUTE) можно дать и другим пользователям.</p></td></tr><tr><td class="func_table_entry"><p class="func_signature"><a id="id-1.6.15.7.29.4.2.2.8.1.1.1" class="indexterm"></a> <code class="function">pg_stat_reset_shared</code> ( <code class="type">text</code> ) → <code class="returnvalue">void</code></p>
       <p>Обнуляет некоторые статистические счётчики уровня кластера, в зависимости от аргумента. Если значение аргумента — <code class="literal">bgwriter</code>, обнуляются все счётчики в представлении <code class="structname">pg_stat_bgwriter</code>, если <code class="literal">archiver</code> — все счётчики в представлении <code class="structname">pg_stat_archiver</code>, <code class="literal">io</code> — все счётчики в представлении <code class="structname">pg_stat_io</code>, <code class="literal">wal</code> — все счётчики в представлении <code class="structname">pg_stat_wal</code>, а если <code class="literal">recovery_prefetch</code> — все счётчики в представлении <code class="structname">pg_stat_recovery_prefetch</code>.</p>
       <p>По умолчанию доступ к этой функции имеют только суперпользователи, но право на её выполнение (EXECUTE) можно дать и другим пользователям.</p></td></tr><tr><td class="func_table_entry"><p class="func_signature"><a id="id-1.6.15.7.29.4.2.2.9.1.1.1" class="indexterm"></a> <code class="function">pg_stat_reset_single_table_counters</code> ( <code class="type">oid</code> ) → <code class="returnvalue">void</code></p>
       <p>Обнуляет статистику по отдельной таблице или индексу в текущей базе данных, а также общую статистику для всех баз данных в кластере.</p>
       <p>По умолчанию доступ к этой функции имеют только суперпользователи, но право на её выполнение (EXECUTE) можно дать и другим пользователям.</p></td></tr><tr><td class="func_table_entry"><p class="func_signature"><a id="id-1.6.15.7.29.4.2.2.10.1.1.1" class="indexterm"></a> <code class="function">pg_stat_reset_single_function_counters</code> ( <code class="type">oid</code> ) → <code class="returnvalue">void</code></p>
       <p>Обнуляет статистику для отдельной функции в текущей базе данных.</p>
       <p>По умолчанию доступ к этой функции имеют только суперпользователи, но право на её выполнение (EXECUTE) можно дать и другим пользователям.</p></td></tr><tr><td class="func_table_entry"><p class="func_signature"><a id="id-1.6.15.7.29.4.2.2.11.1.1.1" class="indexterm"></a> <code class="function">pg_stat_reset_slru</code> ( <code class="type">text</code> ) → <code class="returnvalue">void</code></p>
       <p>Обнуляет статистику для отдельного SLRU-кеша или для всех SLRU-кешей в кластере. Если в аргументе передаётся NULL, обнуляются все счётчики, показанные в представлении <code class="structname">pg_stat_slru</code>, для всех SLRU-кешей. Также в аргументе можно передать текстовое значение <code class="literal">CommitTs</code>, <code class="literal">MultiXactMember</code>, <code class="literal">MultiXactOffset</code>, <code class="literal">Notify</code>, <code class="literal">Serial</code>, <code class="literal">Subtrans</code> или <code class="literal">Xact</code>, чтобы сбросить счётчики только для указанного кеша. Если в аргументе передаётся <code class="literal">other</code> (на самом деле это может быть любая нераспознанная строка), обнулены будут все счётчики для всех кешей, кроме перечисленных поимённо выше.</p>
       <p>По умолчанию доступ к этой функции имеют только суперпользователи, но право на её выполнение (EXECUTE) можно дать и другим пользователям.</p></td></tr><tr><td class="func_table_entry"><p class="func_signature"><a id="id-1.6.15.7.29.4.2.2.12.1.1.1" class="indexterm"></a> <code class="function">pg_stat_reset_replication_slot</code> ( <code class="type">text</code> ) → <code class="returnvalue">void</code></p>
       <p>Сбрасывает статистику указанного в аргументе слота репликации. Если в аргументе передаётся <code class="literal">NULL</code>, сбрасывает статистику для всех слотов репликации.</p>
       <p>По умолчанию доступ к этой функции имеют только суперпользователи, но право на её выполнение (EXECUTE) можно дать и другим пользователям.</p></td></tr><tr><td class="func_table_entry"><p class="func_signature"><a id="id-1.6.15.7.29.4.2.2.13.1.1.1" class="indexterm"></a> <code class="function">pg_stat_reset_subscription_stats</code> ( <code class="type">oid</code> ) → <code class="returnvalue">void</code></p>
       <p>Обнуляет статистику для отдельной подписки, отображаемую в представлении <code class="structname">pg_stat_subscription_stats</code>. Если в аргументе передаётся <code class="literal">NULL</code>, сбрасывается статистика для всех подписок.</p>
       <p>По умолчанию доступ к этой функции имеют только суперпользователи, но право на её выполнение (EXECUTE) можно дать и другим пользователям.</p></td></tr></tbody></table></div></div><br class="table-break" /><div class="warning"><h3 class="title">Предупреждение</h3><p>Функция <code class="function">pg_stat_reset()</code> также сбрасывает счётчики, на основании которых процесс автоочистки принимает решение о запуске очистки или анализа. В результате сброса процесс автоочистки может не выполнить необходимые действия, что чревато раздуванием таблиц, потерей актуальности статистики и тому подобными проблемами. Поэтому после сброса счётчиков рекомендуется выполнить <code class="command">ANALYZE</code> на уровне базы.</p></div><p>Функция <code class="function">pg_stat_get_activity</code>, на которой основано представление <code class="structname">pg_stat_activity</code>, возвращает набор строк, содержащих всю доступную информацию о каждом серверном процессе. Иногда более удобным оказывается получение только части этой информации. В таких случаях можно использовать набор более старых функций, дающих доступ к статистике на уровне серверных процессов; эти функции описаны в <a class="xref" href="monitoring-stats.html#MONITORING-STATS-BACKEND-FUNCS-TABLE" title="Таблица 28.36. Статистические функции на уровне серверных процессов">Таблице 28.36</a>. Эти функции используют идентификатор серверного процесса, который представляет собой небольшое положительное целое число, отличное от идентификатора любого параллельного сеанса, хотя по завершении сеанса идентификатор сразу может переиспользоваться. Идентификатор серверного процесса используется, помимо прочего, для определения временной схемы сеанса, если она есть. Функция <code class="function">pg_stat_get_backend_idset</code> генерирует по одной строке для каждого активного серверного процесса, что необходимо для вызова этих функций. Например, для того, чтобы отобразить значения <acronym class="acronym">PID</acronym> и текущие запросы всех серверных процессов: </p><pre class="programlisting">SELECT pg_stat_get_backend_pid(backendid) AS pid,
       pg_stat_get_backend_activity(backendid) AS query
FROM pg_stat_get_backend_idset() AS backendid;</pre><div class="table" id="MONITORING-STATS-BACKEND-FUNCS-TABLE"><p class="title"><strong>Таблица 28.36. Статистические функции на уровне серверных процессов</strong></p><div class="table-contents"><table class="table" summary="Статистические функции на уровне серверных процессов" border="1"><colgroup><col /></colgroup><thead><tr><th class="func_table_entry"><p class="func_signature">Функция</p>
       <p>Описание</p></th></tr></thead><tbody><tr><td class="func_table_entry"><p class="func_signature"><a id="id-1.6.15.7.29.7.2.2.1.1.1.1" class="indexterm"></a> <code class="function">pg_stat_get_backend_activity</code> ( <code class="type">integer</code> ) → <code class="returnvalue">text</code></p>
       <p>Выдаёт текст последнего запроса этого серверного процесса.</p></td></tr><tr><td class="func_table_entry"><p class="func_signature"><a id="id-1.6.15.7.29.7.2.2.2.1.1.1" class="indexterm"></a> <code class="function">pg_stat_get_backend_activity_start</code> ( <code class="type">integer</code> ) → <code class="returnvalue">timestamp with time zone</code></p>
       <p>Выдаёт время начала выполнения последнего запроса в рамках данного процесса.</p></td></tr><tr><td class="func_table_entry"><p class="func_signature"><a id="id-1.6.15.7.29.7.2.2.3.1.1.1" class="indexterm"></a> <code class="function">pg_stat_get_backend_client_addr</code> ( <code class="type">integer</code> ) → <code class="returnvalue">inet</code></p>
       <p>Выдаёт IP-адрес клиента, подключённого к этому серверному процессу.</p></td></tr><tr><td class="func_table_entry"><p class="func_signature"><a id="id-1.6.15.7.29.7.2.2.4.1.1.1" class="indexterm"></a> <code class="function">pg_stat_get_backend_client_port</code> ( <code class="type">integer</code> ) → <code class="returnvalue">integer</code></p>
       <p>Выдаёт номер TCP-порта, который клиент использует для взаимодействия с сервером.</p></td></tr><tr><td class="func_table_entry"><p class="func_signature"><a id="id-1.6.15.7.29.7.2.2.5.1.1.1" class="indexterm"></a> <code class="function">pg_stat_get_backend_dbid</code> ( <code class="type">integer</code> ) → <code class="returnvalue">oid</code></p>
       <p>Выдаёт OID базы данных, к которой подключён этот серверный процесс.</p></td></tr><tr><td class="func_table_entry"><p class="func_signature"><a id="id-1.6.15.7.29.7.2.2.6.1.1.1" class="indexterm"></a> <code class="function">pg_stat_get_backend_idset</code> () → <code class="returnvalue">setof integer</code></p>
       <p>Выдаёт идентификаторы активных в настоящий момент серверных процессов.</p></td></tr><tr><td class="func_table_entry"><p class="func_signature"><a id="id-1.6.15.7.29.7.2.2.7.1.1.1" class="indexterm"></a> <code class="function">pg_stat_get_backend_pid</code> ( <code class="type">integer</code> ) → <code class="returnvalue">integer</code></p>
       <p>Выдаёт идентификатор (PID) этого серверного процесса.</p></td></tr><tr><td class="func_table_entry"><p class="func_signature"><a id="id-1.6.15.7.29.7.2.2.8.1.1.1" class="indexterm"></a> <code class="function">pg_stat_get_backend_start</code> ( <code class="type">integer</code> ) → <code class="returnvalue">timestamp with time zone</code></p>
       <p>Выдаёт время, когда был запущен данный процесс.</p></td></tr><tr><td class="func_table_entry"><p class="func_signature"><a id="id-1.6.15.7.29.7.2.2.9.1.1.1" class="indexterm"></a> <code class="function">pg_stat_get_backend_subxact</code> ( <code class="type">integer</code> ) → <code class="returnvalue">record</code></p>
       <p>Возвращает запись с информацией о подтранзакциях обслуживающего процесса с указанным идентификатором. Возвращаемые поля: <em class="parameter"><code>subxact_count</code></em>, которое представляет собой количество подтранзакций в кеше подтранзакций обслуживающего процесса, и <em class="parameter"><code>subxact_overflow</code></em>, который указывает, переполнен кеш подтранзакций обслуживающего процесса или нет.</p></td></tr><tr><td class="func_table_entry"><p class="func_signature"><a id="id-1.6.15.7.29.7.2.2.10.1.1.1" class="indexterm"></a> <code class="function">pg_stat_get_backend_userid</code> ( <code class="type">integer</code> ) → <code class="returnvalue">oid</code></p>
       <p>Выдаёт OID пользователя, подключённого к этому серверному процессу.</p></td></tr><tr><td class="func_table_entry"><p class="func_signature"><a id="id-1.6.15.7.29.7.2.2.11.1.1.1" class="indexterm"></a> <code class="function">pg_stat_get_backend_wait_event</code> ( <code class="type">integer</code> ) → <code class="returnvalue">text</code></p>
       <p>Выдаёт имя ожидаемого события, если серверный процесс сейчас находится в состоянии ожидания, или NULL в противном случае. См. также <a class="xref" href="monitoring-stats.html#WAIT-EVENT-ACTIVITY-TABLE" title="Таблица 28.5. События ожидания, относящиеся к типу Activity">Таблица 28.5</a> – <a class="xref" href="monitoring-stats.html#WAIT-EVENT-TIMEOUT-TABLE" title="Таблица 28.13. События ожидания, относящиеся к типу Timeout">Таблица 28.13</a>.</p></td></tr><tr><td class="func_table_entry"><p class="func_signature"><a id="id-1.6.15.7.29.7.2.2.12.1.1.1" class="indexterm"></a> <code class="function">pg_stat_get_backend_wait_event_type</code> ( <code class="type">integer</code> ) → <code class="returnvalue">text</code></p>
       <p>Выдаёт имя типа ожидаемого события, если серверный процесс сейчас находится в состоянии ожидания, или NULL в противном случае. За подробностями обратитесь к <a class="xref" href="monitoring-stats.html#WAIT-EVENT-TABLE" title="Таблица 28.4. Типы событий ожидания">Таблице 28.4</a>.</p></td></tr><tr><td class="func_table_entry"><p class="func_signature"><a id="id-1.6.15.7.29.7.2.2.13.1.1.1" class="indexterm"></a> <code class="function">pg_stat_get_backend_xact_start</code> ( <code class="type">integer</code> ) → <code class="returnvalue">timestamp with time zone</code></p>
       <p>Выдаёт время начала текущей транзакции в данном процессе.</p></td></tr></tbody></table></div></div><br class="table-break" /></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="monitoring-ps.html" title="28.1. Стандартные инструменты Unix">Пред.</a> </td><td width="20%" align="center"><a accesskey="u" href="monitoring.html" title="Глава 28. Мониторинг работы СУБД">Наверх</a></td><td width="40%" align="right"> <a accesskey="n" href="monitoring-locks.html" title="28.3. Просмотр информации о блокировках">След.</a></td></tr><tr><td width="40%" align="left" valign="top">28.1. Стандартные инструменты Unix </td><td width="20%" align="center"><a accesskey="h" href="index.html" title="Документация к PostgreSQL 16.3">Начало</a></td><td width="40%" align="right" valign="top"> 28.3. Просмотр информации о блокировках</td></tr></table></div></body></html>