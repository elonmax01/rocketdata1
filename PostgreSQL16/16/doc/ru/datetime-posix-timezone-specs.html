<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>B.5. Указание часовых поясов в стиле POSIX</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@lists.postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot" /><link rel="prev" href="datetime-config-files.html" title="B.4. Файлы конфигурации даты/времени" /><link rel="next" href="datetime-units-history.html" title="B.6. История единиц измерения времени" /></head><body id="docContent" class="container-fluid col-10"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">B.5. Указание часовых поясов в стиле <acronym class="acronym">POSIX</acronym></th></tr><tr><td width="10%" align="left"><a accesskey="p" href="datetime-config-files.html" title="B.4. Файлы конфигурации даты/времени">Пред.</a> </td><td width="10%" align="left"><a accesskey="u" href="datetime-appendix.html" title="Приложение B. Поддержка даты и времени">Наверх</a></td><th width="60%" align="center">Приложение B. Поддержка даты и времени</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="Документация к PostgreSQL 16.3">Начало</a></td><td width="10%" align="right"> <a accesskey="n" href="datetime-units-history.html" title="B.6. История единиц измерения времени">След.</a></td></tr></table><hr /></div><div class="sect1" id="DATETIME-POSIX-TIMEZONE-SPECS"><div class="titlepage"><div><div><h2 class="title" style="clear: both">B.5. Указание часовых поясов в стиле <acronym class="acronym">POSIX</acronym> <a href="#DATETIME-POSIX-TIMEZONE-SPECS" class="id_link">#</a></h2></div></div></div><a id="id-1.11.3.8.2" class="indexterm"></a><p><span class="productname">PostgreSQL</span> может воспринимать указание часового пояса, записанное по правилам стандарта <acronym class="acronym">POSIX</acronym>, в соответствии с которыми, в частности, задаётся переменная окружения <code class="varname">TZ</code>. Указания часовых поясов в стиле <acronym class="acronym">POSIX</acronym> не удовлетворяют всем условиям, продиктованным сложной историей часовых поясов в реальном мире, но иногда использование этих указаний бывает оправданным.</p><p>Указание часового пояса в стиле POSIX выглядит так: </p><pre class="synopsis">
<em class="replaceable"><code>STD</code></em> <em class="replaceable"><code>смещение</code></em> [<span class="optional"> <em class="replaceable"><code>DST</code></em> [<span class="optional"> <em class="replaceable"><code>смещение_летнего_времени</code></em> </span>] [<span class="optional"> , <em class="replaceable"><code>правило</code></em> </span>] </span>]
</pre><p> (Для наглядности между полями добавлены пробелы, но в реальном указании их не должно быть.) В нём содержатся следующие поля: </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><em class="replaceable"><code>STD</code></em> — аббревиатура, используемая для стандартного часового пояса.</p></li><li class="listitem"><p><em class="replaceable"><code>смещение</code></em> — стандартное смещение пояса от UTC.</p></li><li class="listitem"><p><em class="replaceable"><code>DST</code></em> — аббревиатура часового пояса при переходе на летнее время. Если это поле и следующие за ним опущены, для часового пояса будет использоваться фиксированное смещение от UTC без учёта перехода на летнее время.</p></li><li class="listitem"><p><em class="replaceable"><code>смещение_летнего_времени</code></em> — смещение часового пояса от UTC при переходе на летнее время. Это поле обычно опускается, так как по умолчанию это смещение равно стандартному <em class="replaceable"><code>смещению</code></em> минус один час, что практически всегда имеет место на практике.</p></li><li class="listitem"><p><em class="replaceable"><code>правило</code></em> — определяет, как должен учитываться переход на летнее время, в соответствии с представленным ниже описанием.</p></li></ul></div><p>В этой записи аббревиатура часового пояса может задаваться набором букв, например <code class="literal">EST</code>, или произвольной строкой, заключённой в угловые скобки, например <code class="literal">&lt;UTC-05&gt;</code>. Заметьте, что показанные здесь аббревиатуры используются только при выводе и только в некоторых выходных форматах. Распознаваемые во входных значениях даты/времени аббревиатуры часовых поясов описаны в <a class="xref" href="datetime-config-files.html" title="B.4. Файлы конфигурации даты/времени">Разделе B.4</a>.</p><p>В полях смещений задаётся сдвиг от UTC в часах и, возможно, минутах и секундах. Они имеют формат <em class="replaceable"><code>чч</code></em>[<span class="optional"><code class="literal">:</code><em class="replaceable"><code>мм</code></em>[<span class="optional"><code class="literal">:</code><em class="replaceable"><code>сс</code></em></span>]</span>] и могут содержать спереди знак (<code class="literal">+</code> или <code class="literal">-</code>). Положительный знак имеют часовые пояса <span class="emphasis"><em>к западу</em></span> от Гринвича. (Заметьте, что это противоположно соглашению ISO-8601, используемому в других областях <span class="productname">PostgreSQL</span>.) Компонент <em class="replaceable"><code>чч</code></em> может содержать одну или две цифры, а <em class="replaceable"><code>мм</code></em> и <em class="replaceable"><code>сс</code></em> (если они задаются) должны состоять ровно из двух цифр.</p><p>Поле, задающее <em class="replaceable"><code>правило</code></em> перехода на летнее время, имеет следующий формат: </p><pre class="synopsis">
<em class="replaceable"><code>дата_перехода</code></em> [<span class="optional"> <code class="literal">/</code> <em class="replaceable"><code>время_перехода</code></em> </span>] <code class="literal">,</code> <em class="replaceable"><code>дата_возврата</code></em> [<span class="optional"> <code class="literal">/</code> <em class="replaceable"><code>время_возврата</code></em> </span>]
</pre><p> (Как и ранее, реальное указание не должно содержать пробелы.) Поля <em class="replaceable"><code>дата_перехода</code></em> и <em class="replaceable"><code>время_перехода</code></em> определяют момент перехода на летнее время, а поля <em class="replaceable"><code>дата_возврата</code></em> и <em class="replaceable"><code>время_возврата</code></em> определяют дату возврата к поясному времени. (В некоторых регионах, в частности, в Южном полушарии, вторая дата в календаре может предшествовать первой.) Даты могут задаваться в одном из следующих форматов: </p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><em class="replaceable"><code>n</code></em></span></dt><dd><p>Простое целое, обозначающее день года, с нумерацией от нуля до 364, или 365 в високосном году.</p></dd><dt><span class="term"><code class="literal">J</code><em class="replaceable"><code>n</code></em></span></dt><dd><p>В этой записи <em class="replaceable"><code>n</code></em> обозначает номер дня от 1 до 365, а 29 февраля пропускается, даже когда фактически присутствует. (Таким образом, смены часового пояса, происходящие 29 февраля, в этой записи выразить нельзя. Однако после февраля дни имеют одинаковые номера и в обычные, и в високосные годы, так что эта запись обычно полезнее тем, что позволяет выразить одним числом фиксированную дату перевода часов.)</p></dd><dt><span class="term"><code class="literal">M</code><em class="replaceable"><code>m</code></em><code class="literal">.</code><em class="replaceable"><code>n</code></em><code class="literal">.</code><em class="replaceable"><code>d</code></em></span></dt><dd><p>Эта форма задаёт дату перехода, которая всегда назначается в определённый месяц и день недели. Здесь <em class="replaceable"><code>m</code></em> обозначает номер месяца от 1 до 12, а <em class="replaceable"><code>n</code></em> — номер повторения в этом месяце дня недели, заданного полем <em class="replaceable"><code>d</code></em>. В качестве <em class="replaceable"><code>n</code></em> может задаваться число от 1 до 4 либо число 5, выбирающее последнюю дату с заданным днём недели в этом месяце (она может быть фактически четвёртой или пятой). В качестве <em class="replaceable"><code>d</code></em> задаётся число от 0 до 6, обозначающее день недели (0 — воскресенье). Например, запись <code class="literal">M3.2.0</code> расшифровывается как <span class="quote">«<span class="quote">второе воскресенье марта</span>»</span>.</p></dd></dl></div><div class="note"><h3 class="title">Примечание</h3><p>Для описания многих существующих правил перехода на летнее время обычно достаточно формата <code class="literal">M</code>. Но заметьте, что ни одна из этих вариаций не позволяет описать изменения правил перевода часов. Поэтому на практике для правильной интерпретации значений времени, относящихся к прошлому, необходимы исторические данные, хранящиеся в привязке к именованным часовым поясам (в базе данных IANA с информацией о часовых поясах).</p></div><p>Поля времени в описании правила перехода имеют тот же формат, что и поля смещений, описанные ранее, за исключением того, что в них не может быть знака. Они определяют текущее местное время, в которое производится перевод часов. По умолчанию временем перевода часов считается <code class="literal">02:00:00</code>.</p><p>Если задаётся аббревиатура для летнего времени, но <em class="replaceable"><code>правило</code></em> перехода не задано, в качестве правила по умолчанию используется <code class="literal">M3.2.0,M11.1.0</code>, что соответствует существующему в США в 2020 г. порядку. То есть часы переводятся на летнее время во второе воскресенье марта, а на зимнее — в первое воскресенье ноября, в два часа по действующему времени. Заметьте, что это правило даёт правильные даты для США только с 2007 г.</p><p>Например, запись <code class="literal">CET-1CEST,M3.5.0,M10.5.0/3</code> отражает действующую в 2020 г. практику перевода часов в Париже. Это указание говорит, что стандартное поясное время имеет аббревиатуру <code class="literal">CET</code> и оно смещено на час вперёд (к востоку) от UTC; летнее время имеет аббревиатуру <code class="literal">CEST</code> и смещено вперед от UTC на два часа (это определяется неявно). Часы переводятся на летнее время в последнее воскресенье марта в 2:00 CET, а на зимнее — в последнее воскресенье октября в 3:00 CEST.</p><p>Названия четырёх часовых поясов <code class="literal">EST5EDT</code>, <code class="literal">CST6CDT</code>, <code class="literal">MST7MDT</code> и <code class="literal">PST8PDT</code> выглядят как определяющие часовые пояса в стиле POSIX, но в реальности по историческим причинам они воспринимаются как имена часовых поясов, наравне с другими, так как в базе данных IANA есть файлы с такими именами. Практическое следствие этого состоит в том, что для данных имён может быть получена историческая информация о действовавших правилах перехода на летнее время в США, которую не может дать обычное указание в стиле POSIX.</p><p>Имейте в виду, что ошибиться в указании часового пояса в стиле POSIX очень легко, так как адекватность аббревиатуры никак не проверяется. Например, команда <code class="literal">SET TIMEZONE TO FOOBAR0</code> выполнится без ошибки, и система в итоге будет использовать весьма своеобразную аббревиатуру для UTC.</p></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="datetime-config-files.html" title="B.4. Файлы конфигурации даты/времени">Пред.</a> </td><td width="20%" align="center"><a accesskey="u" href="datetime-appendix.html" title="Приложение B. Поддержка даты и времени">Наверх</a></td><td width="40%" align="right"> <a accesskey="n" href="datetime-units-history.html" title="B.6. История единиц измерения времени">След.</a></td></tr><tr><td width="40%" align="left" valign="top">B.4. Файлы конфигурации даты/времени </td><td width="20%" align="center"><a accesskey="h" href="index.html" title="Документация к PostgreSQL 16.3">Начало</a></td><td width="40%" align="right" valign="top"> B.6. История единиц измерения времени</td></tr></table></div></body></html>