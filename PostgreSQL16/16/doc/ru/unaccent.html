<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>F.48. unaccent — словарь текстового поиска, который убирает диакритические знаки</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@lists.postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot" /><link rel="prev" href="tsm-system-time.html" title="F.47. tsm_system_time — метод извлечения выборки SYSTEM_TIME для TABLESAMPLE" /><link rel="next" href="uuid-ossp.html" title="F.49. uuid-ossp — генератор UUID" /></head><body id="docContent" class="container-fluid col-10"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">F.48. unaccent — словарь текстового поиска, который убирает диакритические знаки</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="tsm-system-time.html" title="F.47. tsm_system_time — метод извлечения выборки SYSTEM_TIME для TABLESAMPLE">Пред.</a> </td><td width="10%" align="left"><a accesskey="u" href="contrib.html" title="Приложение F. Дополнительно поставляемые модули и расширения">Наверх</a></td><th width="60%" align="center">Приложение F. Дополнительно поставляемые модули и расширения</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="Документация к PostgreSQL 16.3">Начало</a></td><td width="10%" align="right"> <a accesskey="n" href="uuid-ossp.html" title="F.49. uuid-ossp — генератор UUID">След.</a></td></tr></table><hr /></div><div class="sect1" id="UNACCENT"><div class="titlepage"><div><div><h2 class="title" style="clear: both">F.48. unaccent — словарь текстового поиска, который убирает диакритические знаки <a href="#UNACCENT" class="id_link">#</a></h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="sect2"><a href="unaccent.html#UNACCENT-CONFIGURATION">F.48.1. Конфигурирование</a></span></dt><dt><span class="sect2"><a href="unaccent.html#UNACCENT-USAGE">F.48.2. Использование</a></span></dt><dt><span class="sect2"><a href="unaccent.html#UNACCENT-FUNCTIONS">F.48.3. Функции</a></span></dt></dl></div><a id="id-1.11.7.58.2" class="indexterm"></a><p>Модуль <code class="filename">unaccent</code> представляет словарь текстового поиска, который убирает надстрочные (диакритические) знаки из лексем. Это фильтрующий словарь, что значит, что выводимые им данные всегда передаются следующему словарю (если он есть), в отличие от нормальных словарей. Применяя его, можно выполнить полнотекстовый поиск без учёта ударений (диакритики).</p><p>Текущую реализацию <code class="filename">unaccent</code> нельзя использовать в качестве нормализующего словаря для словаря <code class="filename">thesaurus</code>.</p><p>Данный модуль считается <span class="quote">«<span class="quote">доверенным</span>»</span>, то есть его могут устанавливать обычные пользователи, имеющие право <code class="literal">CREATE</code> в текущей базе данных.</p><div class="sect2" id="UNACCENT-CONFIGURATION"><div class="titlepage"><div><div><h3 class="title">F.48.1. Конфигурирование <a href="#UNACCENT-CONFIGURATION" class="id_link">#</a></h3></div></div></div><p>Словарь <code class="literal">unaccent</code> принимает следующие параметры:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Параметр <code class="literal">RULES</code> задаёт базовое имя файла со списком правил преобразования. Этот файл должен находиться в каталоге <code class="filename">$SHAREDIR/tsearch_data/</code> (где под <code class="literal">$SHAREDIR</code> понимается каталог с общими данными инсталляции <span class="productname">PostgreSQL</span>). Имя файла должно заканчиваться расширением <code class="literal">.rules</code> (которое не нужно указывать в параметре <code class="literal">RULES</code>).</p></li></ul></div><p>Файл правил имеет следующий формат:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Каждая строка представляет одно правило перевода, состоящее из символа с диакритикой, за которым следует символ без диакритики. Первый символ переводится во второй. Например, </p><pre class="programlisting">À        A
Á        A
Â        A
Ã        A
Ä        A
Å        A
Æ        AE</pre><p> Эти два символа должны разделяться пробельным символом, а любые начальные или конечные пробельные символы в этой строке игнорируются.</p></li><li class="listitem"><p>В качестве альтернативного варианта, если в строке задан всего один символ, вхождения этого символа будут удаляться; это полезно для языков, в которых диакритика представляется отдельными символами.</p></li><li class="listitem"><p>На самом деле роль <span class="quote">«<span class="quote">символа</span>»</span> может играть любая строка, не содержащая пробельные символы, так что словари <code class="filename">unaccent</code> могут быть полезны и для другого рода замены подстрок, а не только для удаления диакритик.</p></li><li class="listitem"><p>Как и другие файлы конфигурации текстового поиска в <span class="productname">PostgreSQL</span>, файл правил должен иметь кодировку UTF-8. При загрузке данные из него будут автоматически преобразованы в кодировку текущей базы данных. Все строки в нём, содержащие непереводимые символы, просто игнорируются, так что файлы правил могут содержать правила, неприменимые в текущей кодировке.</p></li></ul></div><p>Более полный набор правил, непосредственно пригодный для большинства европейских языков, можно найти в файле <code class="filename">unaccent.rules</code>, который помещается в <code class="filename">$SHAREDIR/tsearch_data/</code>, когда устанавливается модуль <code class="filename">unaccent</code>. Этот файл правил переводит буквы с диакритикой в те же буквы без диакритики, а также разворачивает лигатуры в равнозначные последовательности простых символов (например, Æ в AE).</p></div><div class="sect2" id="UNACCENT-USAGE"><div class="titlepage"><div><div><h3 class="title">F.48.2. Использование <a href="#UNACCENT-USAGE" class="id_link">#</a></h3></div></div></div><p>При установке расширения <code class="literal">unaccent</code> в базе создаётся шаблон текстового поиска <code class="literal">unaccent</code> и словарь <code class="literal">unaccent</code> на его основе. Для словаря <code class="literal">unaccent</code> по умолчанию определяется параметр <code class="literal">RULES='unaccent'</code>, благодаря чему его можно сразу использовать со стандартным файлом <code class="filename">unaccent.rules</code>. При желании вы можете изменить этот параметр, например, так </p><pre class="programlisting">mydb=# ALTER TEXT SEARCH DICTIONARY unaccent (RULES='my_rules');</pre><p> или создать новые словари на основе этого шаблона.</p><p>Протестировать этот словарь можно так: </p><pre class="programlisting">mydb=# select ts_lexize('unaccent','Hôtel');
 ts_lexize
-----------
 {Hotel}
(1 row)</pre><p>Следующий пример показывает, как вставить словарь <code class="filename">unaccent</code> в конфигурацию текстового поиска: </p><pre class="programlisting">mydb=# CREATE TEXT SEARCH CONFIGURATION fr ( COPY = french );
mydb=# ALTER TEXT SEARCH CONFIGURATION fr
        ALTER MAPPING FOR hword, hword_part, word
        WITH unaccent, french_stem;
mydb=# select to_tsvector('fr','Hôtels de la Mer');
    to_tsvector
-------------------
 'hotel':1 'mer':4
(1 row)

mydb=# select to_tsvector('fr','Hôtel de la Mer') @@ to_tsquery('fr','Hotels');
 ?column?
----------
 t
(1 row)

mydb=# select ts_headline('fr','Hôtel de la Mer',to_tsquery('fr','Hotels'));
      ts_headline
------------------------
 &lt;b&gt;Hôtel&lt;/b&gt; de la Mer
(1 row)</pre></div><div class="sect2" id="UNACCENT-FUNCTIONS"><div class="titlepage"><div><div><h3 class="title">F.48.3. Функции <a href="#UNACCENT-FUNCTIONS" class="id_link">#</a></h3></div></div></div><p>Функция <code class="function">unaccent()</code> удаляет надстрочные (диакритические) знаки из заданной строки. По сути она представляет собой обёртку вокруг словарей в стиле <code class="filename">unaccent</code>, но может вызываться и вне обычного контекста текстового поиска.</p><a id="id-1.11.7.58.8.3" class="indexterm"></a><pre class="synopsis">unaccent([<span class="optional"><em class="replaceable"><code>словарь</code></em> <code class="type">regdictionary</code>,</span>] <em class="replaceable"><code>строка</code></em> <code class="type">text</code>) returns <code class="type">text</code></pre><p>Если аргумент <em class="replaceable"><code>словарь</code></em> опущен, будет использоваться словарь с именем <code class="literal">unaccent</code>, находящийся в той же схеме, что и сама функция <code class="function">unaccent()</code>.</p><p>Пример: </p><pre class="programlisting">SELECT unaccent('unaccent', 'Hôtel');
SELECT unaccent('Hôtel');</pre></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="tsm-system-time.html" title="F.47. tsm_system_time — метод извлечения выборки SYSTEM_TIME для TABLESAMPLE">Пред.</a> </td><td width="20%" align="center"><a accesskey="u" href="contrib.html" title="Приложение F. Дополнительно поставляемые модули и расширения">Наверх</a></td><td width="40%" align="right"> <a accesskey="n" href="uuid-ossp.html" title="F.49. uuid-ossp — генератор UUID">След.</a></td></tr><tr><td width="40%" align="left" valign="top">F.47. tsm_system_time — метод извлечения выборки <code class="literal">SYSTEM_TIME</code> для <code class="literal">TABLESAMPLE</code> </td><td width="20%" align="center"><a accesskey="h" href="index.html" title="Документация к PostgreSQL 16.3">Начало</a></td><td width="40%" align="right" valign="top"> F.49. uuid-ossp — генератор UUID</td></tr></table></div></body></html>