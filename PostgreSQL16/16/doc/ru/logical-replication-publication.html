<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>31.1. Публикация</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@lists.postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot" /><link rel="prev" href="logical-replication.html" title="Глава 31. Логическая репликация" /><link rel="next" href="logical-replication-subscription.html" title="31.2. Подписка" /></head><body id="docContent" class="container-fluid col-10"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">31.1. Публикация</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="logical-replication.html" title="Глава 31. Логическая репликация">Пред.</a> </td><td width="10%" align="left"><a accesskey="u" href="logical-replication.html" title="Глава 31. Логическая репликация">Наверх</a></td><th width="60%" align="center">Глава 31. Логическая репликация</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="Документация к PostgreSQL 16.3">Начало</a></td><td width="10%" align="right"> <a accesskey="n" href="logical-replication-subscription.html" title="31.2. Подписка">След.</a></td></tr></table><hr /></div><div class="sect1" id="LOGICAL-REPLICATION-PUBLICATION"><div class="titlepage"><div><div><h2 class="title" style="clear: both">31.1. Публикация <a href="#LOGICAL-REPLICATION-PUBLICATION" class="id_link">#</a></h2></div></div></div><p><em class="firstterm">Публикация</em> может быть определена на любом ведущем сервере физической репликации. Сервер, на котором определяется публикация, называется <em class="firstterm">публикующим</em>. Публикация — это набор изменений, выделяемых в таблице или в группе таблиц (он также может называться набором репликации). Публикация существует только в одной базе данных.</p><p>Публикации отличаются от схем и они никак не влияют на доступ к таблице. Если требуется, каждую таблицу можно включить в несколько публикаций. В настоящее время публикации могут содержать только таблицы, при этом они могут содержать все таблицы в схеме. Объекты в них нужно добавлять явным образом, если только публикация не создана для всех таблиц (с указанием <code class="literal">ALL TABLES</code>).</p><p>Публикации могут ограничивать набор публикуемых изменений, выбирая любое сочетание операций из <code class="command">INSERT</code>, <code class="command">UPDATE</code>, <code class="command">DELETE</code> и <code class="command">TRUNCATE</code>, подобно тому как для разных типов событий могут срабатывать триггеры. По умолчанию реплицируются все типы операций. Эти ограничения публикаций распространяются только на операции DML, они не влияют на копирование при начальной синхронизации данных. (Фильтры строк не работают для операции <code class="command">TRUNCATE</code>. См. <a class="xref" href="logical-replication-row-filter.html" title="31.3. Фильтры строк">Раздел 31.3</a>).</p><p>Чтобы можно было реплицировать операции <code class="command">UPDATE</code> и <code class="command">DELETE</code>, в публикуемой таблице должен быть настроен <em class="firstterm">репликационный идентификатор</em>, чтобы идентифицировать соответствующие строки для изменения или удаления на стороне подписчика. По умолчанию это первичный ключ, если он создан. Также репликационным идентификатором можно назначить другой уникальный индекс (с некоторыми дополнительными условиями). Если в таблице нет подходящего ключа, в качестве репликационного идентификатора можно задать <code class="literal">FULL</code>, что будет означать, что ключом будет вся строка. Если выбран репликационный идентификатор <code class="literal">FULL</code>, для поиска строк на стороне подписчика могут использоваться индексы. Подходящими индексами будут нечастичные индексы-B-деревья, самое левое поле которых является столбцом (а не выражением), ссылающимся на столбец опубликованной таблицы. Эти ограничения на свойства неуникальных индексов соответствуют некоторым ограничениям, которые применяются к первичным ключам. Если нет подходящих индексов, поиск на стороне подписчика может быть очень неэффективным, поэтому репликационный идентификатор <code class="literal">FULL</code> следует использовать только в крайнем случае, если нет другого решения. Если на стороне публикации выбран репликационный идентификатор, отличный от <code class="literal">FULL</code>, то идентификатор, состоящий из того же или меньшего количества столбцов, также должен быть определён на стороне подписчика. Подробнее о назначении репликационного идентификатора рассказывается в <a class="xref" href="sql-altertable.html#SQL-ALTERTABLE-REPLICA-IDENTITY"><code class="literal">REPLICA IDENTITY</code></a>. Если в публикацию, в которой реплицируются операции <code class="command">UPDATE</code> и <code class="command">DELETE</code>, добавляется таблица без репликационного идентификатора, то последующие команды <code class="command">UPDATE</code> и <code class="command">DELETE</code> на стороне публикации вызовут ошибку. Команды <code class="command">INSERT</code> могут выполняться вне зависимости от такого идентификатора.</p><p>У каждой публикации может быть множество подписчиков.</p><p>Публикация создаётся командой <a class="link" href="sql-createpublication.html" title="CREATE PUBLICATION"><code class="command">CREATE PUBLICATION</code></a> и может быть впоследствии изменена или удалена с помощью соответствующих команд.</p><p>В публикации можно динамически добавлять или удалять отдельные таблицы, используя команду <a class="link" href="sql-alterpublication.html" title="ALTER PUBLICATION"><code class="command">ALTER PUBLICATION</code></a>. Операции <code class="literal">ADD TABLE</code> и <code class="literal">DROP TABLE</code> являются транзакционными, так что репликация таблицы будет начата или закончена с определённым снимком только после фиксации транзакции.</p></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="logical-replication.html" title="Глава 31. Логическая репликация">Пред.</a> </td><td width="20%" align="center"><a accesskey="u" href="logical-replication.html" title="Глава 31. Логическая репликация">Наверх</a></td><td width="40%" align="right"> <a accesskey="n" href="logical-replication-subscription.html" title="31.2. Подписка">След.</a></td></tr><tr><td width="40%" align="left" valign="top">Глава 31. Логическая репликация </td><td width="20%" align="center"><a accesskey="h" href="index.html" title="Документация к PostgreSQL 16.3">Начало</a></td><td width="40%" align="right" valign="top"> 31.2. Подписка</td></tr></table></div></body></html>