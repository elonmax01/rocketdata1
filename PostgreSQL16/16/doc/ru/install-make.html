<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>17.3. Сборка и установка с использованием Autoconf и Make</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@lists.postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot" /><link rel="prev" href="install-getsource.html" title="17.2. Получение исходного кода" /><link rel="next" href="install-meson.html" title="17.4. Сборка и установка с использованием Meson" /></head><body id="docContent" class="container-fluid col-10"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">17.3. Сборка и установка с использованием Autoconf и Make</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="install-getsource.html" title="17.2. Получение исходного кода">Пред.</a> </td><td width="10%" align="left"><a accesskey="u" href="installation.html" title="Глава 17. Установка из исходного кода">Наверх</a></td><th width="60%" align="center">Глава 17. Установка из исходного кода</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="Документация к PostgreSQL 16.3">Начало</a></td><td width="10%" align="right"> <a accesskey="n" href="install-meson.html" title="17.4. Сборка и установка с использованием Meson">След.</a></td></tr></table><hr /></div><div class="sect1" id="INSTALL-MAKE"><div class="titlepage"><div><div><h2 class="title" style="clear: both">17.3. Сборка и установка с использованием Autoconf и Make <a href="#INSTALL-MAKE" class="id_link">#</a></h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="sect2"><a href="install-make.html#INSTALL-SHORT-MAKE">17.3.1. Краткий вариант</a></span></dt><dt><span class="sect2"><a href="install-make.html#INSTALL-PROCEDURE-MAKE">17.3.2. Процедура установки</a></span></dt><dt><span class="sect2"><a href="install-make.html#CONFIGURE-OPTIONS">17.3.3. Параметры <code class="filename">configure</code></a></span></dt><dt><span class="sect2"><a href="install-make.html#CONFIGURE-ENVVARS">17.3.4. Переменные окружения для <code class="filename">configure</code></a></span></dt></dl></div><div class="sect2" id="INSTALL-SHORT-MAKE"><div class="titlepage"><div><div><h3 class="title">17.3.1. Краткий вариант <a href="#INSTALL-SHORT-MAKE" class="id_link">#</a></h3></div></div></div><pre class="synopsis">
./configure
make
su
make install
adduser postgres
mkdir -p /usr/local/pgsql/data
chown postgres /usr/local/pgsql/data
su - postgres
/usr/local/pgsql/bin/initdb -D /usr/local/pgsql/data
/usr/local/pgsql/bin/pg_ctl -D /usr/local/pgsql/data -l logfile start
/usr/local/pgsql/bin/createdb test
/usr/local/pgsql/bin/psql test
</pre><p> Развёрнутый вариант представлен в продолжении этого <span class="phrase">раздела</span>.</p></div><div class="sect2" id="INSTALL-PROCEDURE-MAKE"><div class="titlepage"><div><div><h3 class="title">17.3.2. Процедура установки <a href="#INSTALL-PROCEDURE-MAKE" class="id_link">#</a></h3></div></div></div><div class="procedure"><ol class="procedure" type="1"><li class="step" id="CONFIGURE"><p class="title"><strong>Конфигурирование</strong></p><a id="id-1.6.4.7.3.2.1.2" class="indexterm"></a><p>На первом шаге установки требуется сконфигурировать дерево установки для вашей системы и выбрать желаемые параметры сборки. Для этого нужно запустить скрипт <code class="filename">configure</code>. Чтобы выполнить стандартную сборку, просто введите: </p><pre class="screen">
<strong class="userinput"><code>./configure</code></strong>
</pre><p> Этот скрипт проведёт несколько проверок с целью определить значения для различных переменных, зависящих от системы, и выявить любые странности вашей ОС, а затем создаст несколько файлов в дереве сборки, в которых отразит полученные результаты.</p><p>Вы также можете выполнить <code class="filename">configure</code> вне дерева исходного кода, если хотите сохранить каталог сборки отдельно. Эта процедура также называется сборкой с <a id="id-1.6.4.7.3.2.1.4.2" class="indexterm"></a><em class="firstterm">VPATH</em>. Выполняется она так: </p><pre class="screen">
<strong class="userinput"><code>mkdir build_dir</code></strong>
<strong class="userinput"><code>cd build_dir</code></strong>
<strong class="userinput"><code>/путь/к/каталогу/исходного/кода/configure [параметры]</code></strong>
<strong class="userinput"><code>make</code></strong>
</pre><p>В стандартной конфигурации собираются сервер и утилиты, а также клиентские приложения и интерфейсы, которым требуется только компилятор C. Все файлы по умолчанию устанавливаются в <code class="filename">/usr/local/pgsql</code>.</p><p>Вы можете настроить процесс сборки и установки, передав <code class="filename">configure</code> один или несколько следующих параметров командной строки. Обычно настраивается место установки или набор дополнительных возможностей, включаемых при сборке. Скрипт <code class="filename">configure</code> принимает большое количество параметров, которые описаны в <a class="xref" href="install-make.html#CONFIGURE-OPTIONS" title="17.3.3. Параметры configure">Подразделе 17.3.3</a>.</p><p>Кроме того, <code class="filename">configure</code> воспринимает ряд переменных окружения, описанных в <a class="xref" href="install-make.html#CONFIGURE-ENVVARS" title="17.3.4. Переменные окружения для configure">Подраздел 17.3.4</a>. Они дают возможность дополнительно настроить конфигурацию.</p></li><li class="step" id="BUILD"><p class="title"><strong>Сборка</strong></p><p>Чтобы запустить сборку, введите одну из двух команд: </p><pre class="screen">
<strong class="userinput"><code>make</code></strong>
<strong class="userinput"><code>make all</code></strong>
</pre><p> (Помните, что нужно использовать <acronym class="acronym">GNU</acronym> <span class="application">make</span>.) Сборка займёт несколько минут, в зависимости от мощности вашего компьютера.</p><p>Если вы хотите собрать всё, что может быть собрано, включая документацию (страницы HTML и man) и дополнительные модули (<code class="filename">contrib</code>), введите: </p><pre class="screen">
<strong class="userinput"><code>make world</code></strong>
</pre><p>Если вы хотите собрать всё, что может быть собрано, включая дополнительные модули (<code class="filename">contrib</code>), но без документации, введите: </p><pre class="screen">
<strong class="userinput"><code>make world-bin</code></strong>
</pre><p>Если вы хотите вызывать сборку из другого сборочного файла, а не вручную, вы должны сбросить переменную <code class="varname">MAKELEVEL</code> или присвоить ей 0, например так: </p><pre class="programlisting">build-postgresql:
        $(MAKE) -C postgresql MAKELEVEL=0 all</pre><p> Если этого не сделать, могут выдаваться странные ошибки, обычно с сообщениями о недостающих заголовочных файлах.</p></li><li class="step"><p class="title"><strong>Регрессионные тесты</strong></p><a id="id-1.6.4.7.3.2.3.2" class="indexterm"></a><p>Если вы хотите протестировать только что собранный сервер, прежде чем устанавливать его, на этом этапе вы можете запустить регрессионные тесты. Регрессионные тесты — это комплект тестов, проверяющих, что <span class="productname">PostgreSQL</span> работает на вашем компьютере так, как задумано разработчиками. Введите: </p><pre class="screen">
<strong class="userinput"><code>make check</code></strong>
</pre><p> (Это должен выполнять обычный пользователь, не root.) Как интерпретировать результаты проверки, подробно описывается в <a class="xref" href="regress.html" title="Глава 33. Регрессионные тесты">Главе 33</a>. Вы можете повторить эту проверку позже в любой момент, выполнив ту же команду.</p></li><li class="step" id="INSTALL"><p class="title"><strong>Установка файлов</strong></p><div class="note"><h3 class="title">Примечание</h3><p>Если вы обновляете существующую систему, обязательно прочитайте инструкции по обновлению кластера, приведённые в <a class="xref" href="upgrading.html" title="19.6. Обновление кластера PostgreSQL">Раздел 19.6</a>.</p></div><p>Чтобы установить <span class="productname">PostgreSQL</span>, введите: </p><pre class="screen">
<strong class="userinput"><code>make install</code></strong>
</pre><p> При этом файлы будут установлены в каталоги, заданные в <a class="xref" href="install-make.html#CONFIGURE" title="Конфигурирование">Шаг 1</a>. Убедитесь в том, что у вас есть соответствующие разрешения для записи туда. Обычно это действие нужно выполнять от имени root. Также возможно заранее создать целевые каталоги и дать требуемый доступ к ним.</p><p>Чтобы установить документацию (HTML и страницы man), введите: </p><pre class="screen">
<strong class="userinput"><code>make install-docs</code></strong>
</pre><p>Если вы собирали цель world, введите вместо этого: </p><pre class="screen">
<strong class="userinput"><code>make install-world</code></strong>
</pre><p> При этом также будет установлена документация.</p><p>Если вы собирали цель world без документации, введите вместо этого: </p><pre class="screen">
<strong class="userinput"><code>make install-world-bin</code></strong>
</pre><p>Вы можете запустить <code class="literal">make install-strip</code> вместо <code class="literal">make install</code>, чтобы убрать лишнее из устанавливаемых исполняемых файлов и библиотек. Это позволит сэкономить немного места. Если вы выполняете сборку для отладки, при этом фактически вырежется поддержка отладки, поэтому этот вариант подходит только если отладка больше не планируется. Процедура <code class="literal">install-strip</code> пытается оптимизировать объём разумными способами, но не рассчитывайте, что она способна удалить каждый ненужный байт из исполняемого файла. Если вы хотите освободить как можно больше места, вам придётся проделать это вручную.</p><p>При стандартной установке в систему устанавливаются все заголовочные файлы для разработки клиентских приложений, а также программ на стороне сервера, в частности, собственных функций или типов данных, реализованных на C.</p><p><strong>Установка только клиентской части: </strong>Если вы хотите установить только клиентские приложения и интерфейсные библиотеки, можно выполнить эти команды: </p><pre class="screen">
<strong class="userinput"><code>make -C src/bin install</code></strong>
<strong class="userinput"><code>make -C src/include install</code></strong>
<strong class="userinput"><code>make -C src/interfaces install</code></strong>
<strong class="userinput"><code>make -C doc install</code></strong>
</pre><p> В <code class="filename">src/bin</code> есть несколько программ, применимых только на сервере, но они очень малы.</p></li></ol></div><p><strong>Удаление: </strong>Чтобы отменить установку, воспользуйтесь командой <code class="command">make uninstall</code>. Однако созданные каталоги при этом удалены не будут.</p><p><strong>Очистка: </strong>После установки вы можете освободить место на диске, удалив файлы сборки из дерева исходного кода, выполнив <code class="command">make clean</code>. При этом файлы, созданные программой <code class="command">configure</code>, будут сохранены, так что позже вы сможете пересобрать всё заново, выполнив <code class="command">make</code>. Чтобы сбросить дерево исходного кода к состоянию, в котором оно распространяется, выполните <code class="command">make distclean</code>. Если вы намерены выполнять сборку одного дерева исходного кода для нескольких платформ, вам придётся делать это и переконфигурировать сборочную среду для каждой. (Также можно использовать отдельное дерево сборки для каждой платформы, чтобы дерево исходного кода оставалось неизменным.)</p><p>Если в процессе сборки вы обнаружите, что заданные вами параметры <code class="command">configure</code> оказались ошибочными, либо вы изменили что-то, от чего зависит работа <code class="command">configure</code> (например, обновили пакеты), стоит выполнить <code class="command">make distclean</code>, прежде чем переконфигурировать и пересобирать всё заново. Если этого не сделать, ваши изменения в конфигурации могут распространиться не везде, где они важны.</p></div><div class="sect2" id="CONFIGURE-OPTIONS"><div class="titlepage"><div><div><h3 class="title">17.3.3. Параметры <code class="filename">configure</code> <a href="#CONFIGURE-OPTIONS" class="id_link">#</a></h3></div></div></div><a id="id-1.6.4.7.4.2" class="indexterm"></a><p>Параметры командной строки <code class="command">configure</code> описываются ниже. Этот список не является исчерпывающим (который можно получить, вызвав <code class="literal">./configure --help</code>). Неописанные здесь параметры предназначены для особых случаев, например для кросс-компиляции, и освещаются в стандартной документации Autoconf.</p><div class="sect3" id="CONFIGURE-OPTIONS-LOCATIONS"><div class="titlepage"><div><div><h4 class="title">17.3.3.1. Место установки <a href="#CONFIGURE-OPTIONS-LOCATIONS" class="id_link">#</a></h4></div></div></div><p>Эти параметры определяют, куда <code class="literal">make install</code> будет устанавливать файлы. В большинстве случаев для определения целевого расположения достаточно параметра <code class="option">--prefix</code>. Если же у вас есть особые требования, вы можете установить разные целевые подкаталоги, воспользовавшись другими описанными здесь параметрами. Однако имейте в виду, что при изменении относительного расположения разных подкаталогов ваша инсталляция может оказаться неперемещаемой, то есть её нельзя будет перенести в другое место после развёртывания. (Это ограничение не касается расположения подкаталогов <code class="literal">man</code> и <code class="literal">doc</code>.) Для получения перемещаемой инсталляции может потребоваться параметр <code class="literal">--disable-rpath</code>, описанный далее.</p><div class="variablelist"><dl class="variablelist"><dt id="CONFIGURE-OPTION-PREFIX"><span class="term"><code class="option">--prefix=<em class="replaceable"><code>ПРЕФИКС</code></em></code></span> <a href="#CONFIGURE-OPTION-PREFIX" class="id_link">#</a></dt><dd><p>Разместить все файлы внутри каталога <em class="replaceable"><code>ПРЕФИКС</code></em>, а не в <code class="filename">/usr/local/pgsql</code>. Собственно файлы будут установлены в различные подкаталоги этого каталога; в самом каталоге <em class="replaceable"><code>ПРЕФИКС</code></em> никакие файлы не размещаются.</p></dd><dt id="CONFIGURE-OPTION-EXEC-PREFIX"><span class="term"><code class="option">--exec-prefix=<em class="replaceable"><code>ИСП-ПРЕФИКС</code></em></code></span> <a href="#CONFIGURE-OPTION-EXEC-PREFIX" class="id_link">#</a></dt><dd><p>Вы можете установить архитектурно-зависимые файлы в размещение с другим префиксом, <em class="replaceable"><code>ИСП-ПРЕФИКС</code></em>, отличным от <em class="replaceable"><code>ПРЕФИКС</code></em>. Это бывает полезно для совместного использования таких файлов несколькими системами. По умолчанию <em class="replaceable"><code>ИСП-ПРЕФИКС</code></em> считается равным <em class="replaceable"><code>ПРЕФИКС</code></em> и все файлы, архитектурно-зависимые и независимые, устанавливаются в одно дерево каталогов, что вам скорее всего и нужно.</p></dd><dt id="CONFIGURE-OPTION-BINDIR"><span class="term"><code class="option">--bindir=<em class="replaceable"><code>КАТАЛОГ</code></em></code></span> <a href="#CONFIGURE-OPTION-BINDIR" class="id_link">#</a></dt><dd><p>Задаёт каталог для исполняемых двоичных программ. По умолчанию это <code class="filename"><em class="replaceable"><code>ИСП-ПРЕФИКС</code></em>/bin</code>, что обычно означает <code class="filename">/usr/local/pgsql/bin</code>.</p></dd><dt id="CONFIGURE-OPTION-SYSCONFDIR"><span class="term"><code class="option">--sysconfdir=<em class="replaceable"><code>КАТАЛОГ</code></em></code></span> <a href="#CONFIGURE-OPTION-SYSCONFDIR" class="id_link">#</a></dt><dd><p>Задаёт каталог для различных файлов конфигурации, <code class="filename"><em class="replaceable"><code>ПРЕФИКС</code></em>/etc</code> по умолчанию.</p></dd><dt id="CONFIGURE-OPTION-LIBDIR"><span class="term"><code class="option">--libdir=<em class="replaceable"><code>КАТАЛОГ</code></em></code></span> <a href="#CONFIGURE-OPTION-LIBDIR" class="id_link">#</a></dt><dd><p>Задаёт каталог для установки библиотек и динамически загружаемых модулей. Значение по умолчанию — <code class="filename"><em class="replaceable"><code>ИСП-ПРЕФИКС</code></em>/lib</code>.</p></dd><dt id="CONFIGURE-OPTION-INCLUDEDIR"><span class="term"><code class="option">--includedir=<em class="replaceable"><code>КАТАЛОГ</code></em></code></span> <a href="#CONFIGURE-OPTION-INCLUDEDIR" class="id_link">#</a></dt><dd><p>Задаёт каталог для установки заголовочных файлов C и C++. Значение по умолчанию — <code class="filename"><em class="replaceable"><code>ПРЕФИКС</code></em>/include</code>.</p></dd><dt id="CONFIGURE-OPTION-DATAROOTDIR"><span class="term"><code class="option">--datarootdir=<em class="replaceable"><code>КАТАЛОГ</code></em></code></span> <a href="#CONFIGURE-OPTION-DATAROOTDIR" class="id_link">#</a></dt><dd><p>Задаёт корневой каталог для разного рода статических файлов. Этот параметр определяет только базу для некоторых из следующих параметров. Значение по умолчанию — <code class="filename"><em class="replaceable"><code>ПРЕФИКС</code></em>/share</code>.</p></dd><dt id="CONFIGURE-OPTION-DATADIR"><span class="term"><code class="option">--datadir=<em class="replaceable"><code>КАТАЛОГ</code></em></code></span> <a href="#CONFIGURE-OPTION-DATADIR" class="id_link">#</a></dt><dd><p>Задаёт каталог для статических файлов данных, используемых установленными программами. Значение по умолчанию — <code class="filename"><em class="replaceable"><code>DATAROOTDIR</code></em></code>. Заметьте, что это совсем не тот каталог, в котором будут размещены файлы базы данных.</p></dd><dt id="CONFIGURE-OPTION-LOCALEDIR"><span class="term"><code class="option">--localedir=<em class="replaceable"><code>КАТАЛОГ</code></em></code></span> <a href="#CONFIGURE-OPTION-LOCALEDIR" class="id_link">#</a></dt><dd><p>Задаёт каталог для установки данных локализации, в частности, каталогов перевода сообщений. Значение по умолчанию — <code class="filename"><em class="replaceable"><code>DATAROOTDIR</code></em>/locale</code>.</p></dd><dt id="CONFIGURE-OPTION-MANDIR"><span class="term"><code class="option">--mandir=<em class="replaceable"><code>КАТАЛОГ</code></em></code></span> <a href="#CONFIGURE-OPTION-MANDIR" class="id_link">#</a></dt><dd><p>Страницы man, поставляемые в составе <span class="productname">PostgreSQL</span>, будут установлены в этот каталог, в соответствующие подкаталоги <code class="filename">man<em class="replaceable"><code>x</code></em></code>. Значение по умолчанию — <code class="filename"><em class="replaceable"><code>DATAROOTDIR</code></em>/man</code>.</p></dd><dt id="CONFIGURE-OPTION-DOCDIR"><span class="term"><code class="option">--docdir=<em class="replaceable"><code>КАТАЛОГ</code></em></code></span> <a href="#CONFIGURE-OPTION-DOCDIR" class="id_link">#</a></dt><dd><p>Задаёт корневой каталог для установки файлов документации, кроме страниц <span class="quote">«<span class="quote">man</span>»</span>. Этот параметр только определяет базу для следующих параметров. Значение по умолчанию — <code class="filename"><em class="replaceable"><code>DATAROOTDIR</code></em>/doc/postgresql</code>.</p></dd><dt id="CONFIGURE-OPTION-HTMLDIR"><span class="term"><code class="option">--htmldir=<em class="replaceable"><code>КАТАЛОГ</code></em></code></span> <a href="#CONFIGURE-OPTION-HTMLDIR" class="id_link">#</a></dt><dd><p>В этот каталог будет помещена документация <span class="productname">PostgreSQL</span> в формате HTML. Значение по умолчанию — <code class="filename"><em class="replaceable"><code>DATAROOTDIR</code></em></code>.</p></dd></dl></div><div class="note"><h3 class="title">Примечание</h3><p>Чтобы <span class="productname">PostgreSQL</span> можно было установить в стандартные системные размещения (например, в <code class="filename">/usr/local/include</code>), не затрагивая пространство имён остальной системы, приняты определённые меры. Во-первых, к путям <code class="varname">datadir</code>, <code class="varname">sysconfdir</code> и <code class="varname">docdir</code> автоматически добавляется строка <span class="quote">«<span class="quote"><code class="literal">/postgresql</code></span>»</span>, если только полный развёрнутый путь каталога уже не содержит строку <span class="quote">«<span class="quote"><code class="literal">postgres</code></span>»</span> или <span class="quote">«<span class="quote"><code class="literal">pgsql</code></span>»</span>. Так, если вы выберете в качестве префикса <code class="filename">/usr/local</code>, документация будет установлена в <code class="filename">/usr/local/doc/postgresql</code>, но с префиксом <code class="filename">/opt/postgres</code> она будет помещена в <code class="filename">/opt/postgres/doc</code>. Внешние заголовочные файлы C для клиентских интерфейсов устанавливаются в <code class="varname">includedir</code>, не загрязняя пространство имён. Внутренние и серверные заголовочные файлы устанавливаются в частные подкаталоги внутри <code class="varname">includedir</code>. Чтобы узнать, как обращаться к заголовочным файлам того или иного интерфейса, обратитесь к документации этого интерфейса. Наконец, для динамически загружаемых модулей, если требуется, будет также создан частный подкаталог внутри <code class="varname">libdir</code>.</p></div></div><div class="sect3" id="CONFIGURE-OPTIONS-FEATURES"><div class="titlepage"><div><div><h4 class="title">17.3.3.2. Функциональность <span class="productname">PostgreSQL</span> <a href="#CONFIGURE-OPTIONS-FEATURES" class="id_link">#</a></h4></div></div></div><p>В этом разделе описаны параметры, включающую различную функциональность <span class="productname">PostgreSQL</span>, которая по умолчанию не собирается. Многие из этих компонентов не собираются по умолчанию, потому что требуют дополнительного программного обеспечения, о чём говорится в <a class="xref" href="install-requirements.html" title="17.1. Требования">Разделе 17.1</a>.</p><div class="variablelist"><dl class="variablelist"><dt id="CONFIGURE-OPTION-ENABLE-NLS"><span class="term"><code class="option">--enable-nls[<span class="optional">=<em class="replaceable"><code>ЯЗЫКИ</code></em></span>]</code></span> <a href="#CONFIGURE-OPTION-ENABLE-NLS" class="id_link">#</a></dt><dd><p>Включает поддержку национальных языков (<acronym class="acronym">NLS</acronym>, Native Language Support), то есть возможность выводить сообщения программы не только на английском языке. Значение <em class="replaceable"><code>ЯЗЫКИ</code></em> представляет необязательный список кодов языков через пробел, поддержка которых вам нужна, например: <code class="literal">--enable-nls='de fr ru'</code>. (Пересечение заданного вами списка и множества действительно доступных переводов будет вычислено автоматически.) Если список не задаётся, устанавливаются все доступные переводы.</p><p>Для использования этой возможности вам потребуется реализация API <span class="application">Gettext</span>.</p></dd><dt id="CONFIGURE-OPTION-WITH-PERL"><span class="term"><code class="option">--with-perl</code></span> <a href="#CONFIGURE-OPTION-WITH-PERL" class="id_link">#</a></dt><dd><p>Включает поддержку языка <span class="application">PL/Perl</span> на стороне сервера.</p></dd><dt id="CONFIGURE-OPTION-WITH-PYTHON"><span class="term"><code class="option">--with-python</code></span> <a href="#CONFIGURE-OPTION-WITH-PYTHON" class="id_link">#</a></dt><dd><p>Включает поддержку языка <span class="application">PL/Python</span> на стороне сервера.</p></dd><dt id="CONFIGURE-OPTION-WITH-TCL"><span class="term"><code class="option">--with-tcl</code></span> <a href="#CONFIGURE-OPTION-WITH-TCL" class="id_link">#</a></dt><dd><p>Включает поддержку языка <span class="application">PL/Tcl</span> на стороне сервера.</p></dd><dt id="CONFIGURE-OPTION-WITH-TCLCONFIG"><span class="term"><code class="option">--with-tclconfig=<em class="replaceable"><code>КАТАЛОГ</code></em></code></span> <a href="#CONFIGURE-OPTION-WITH-TCLCONFIG" class="id_link">#</a></dt><dd><p>Tcl устанавливает файл <code class="filename">tclConfig.sh</code>, содержащий конфигурационные данные, необходимые для сборки модулей, взаимодействующих с Tcl. Этот файл обычно находится автоматически в известном размещении, но если вы хотите использовать другую версию Tcl, вы должны указать каталог, где искать <code class="filename">tclConfig.sh</code>.</p></dd><dt id="CONFIGURE-WITH-LLVM"><span class="term"><code class="option">--with-llvm</code></span> <a href="#CONFIGURE-WITH-LLVM" class="id_link">#</a></dt><dd><p>Включает поддержку <acronym class="acronym">JIT</acronym>-компиляции<span class="phrase"> (см. <a class="xref" href="jit.html" title="Глава 32. JIT-компиляция">Главу 32</a>)</span> на базе <span class="productname">LLVM</span>. Для этого должна быть установлена библиотека <span class="productname">LLVM</span>. В настоящее время требуется версия <span class="productname">LLVM</span> не ниже 3.9.</p><p>Программа <code class="command">llvm-config</code><a id="id-1.6.4.7.4.5.3.6.2.2.2" class="indexterm"></a> будет использоваться для выяснения требуемых параметров компиляции. Поиск её будет выполняться в заданных путях <code class="envar">PATH</code> по имени <code class="command">llvm-config</code>, а затем <code class="command">llvm-config-$major-$minor</code> для всех поддерживаемых версий. Если нужную программу найти таким образом не удастся, воспользуйтесь переменной <code class="envar">LLVM_CONFIG</code> и укажите путь к корректному <code class="command">llvm-config</code>. Например: </p><pre class="programlisting">./configure ... --with-llvm LLVM_CONFIG='/path/to/llvm/bin/llvm-config'</pre><p>Для поддержки <span class="productname">LLVM</span> требуется совместимый компилятор <code class="command">clang</code> (указываемый, если это требуется, в переменной окружения <code class="envar">CLANG</code>) и работающий компилятор C++ (указываемый, если требуется, в переменной окружения <code class="envar">CXX</code>).</p></dd><dt id="CONFIGURE-OPTION-WITH-LZ4"><span class="term"><code class="option">--with-lz4</code></span> <a href="#CONFIGURE-OPTION-WITH-LZ4" class="id_link">#</a></dt><dd><p>Собрать с поддержкой сжатия <span class="productname">LZ4</span>.</p></dd><dt id="CONFIGURE-OPTION-WITH-ZSTD"><span class="term"><code class="option">--with-zstd</code></span> <a href="#CONFIGURE-OPTION-WITH-ZSTD" class="id_link">#</a></dt><dd><p>Собрать с поддержкой сжатия <span class="productname">Zstandard</span>.</p></dd><dt id="CONFIGURE-OPTION-WITH-SSL"><span class="term"><code class="option">--with-ssl=<em class="replaceable"><code>БИБЛИОТЕКА</code></em></code>
       <a id="id-1.6.4.7.4.5.3.9.1.2" class="indexterm"></a>
       </span> <a href="#CONFIGURE-OPTION-WITH-SSL" class="id_link">#</a></dt><dd><p>Включает поддержку соединений <acronym class="acronym">SSL</acronym> (зашифрованных). Единственной поддерживаемой <em class="replaceable"><code>БИБЛИОТЕКОЙ</code></em> является <code class="option">openssl</code>. Для такой сборки необходимо установить пакет <span class="productname">OpenSSL</span>. Скрипт <code class="filename">configure</code> проверит наличие необходимых заголовочных файлов и библиотек, чтобы убедиться в целостности инсталляции <span class="productname">OpenSSL</span> до начала сборки.</p></dd><dt id="CONFIGURE-OPTION-WITH-OPENSSL"><span class="term"><code class="option">--with-openssl</code></span> <a href="#CONFIGURE-OPTION-WITH-OPENSSL" class="id_link">#</a></dt><dd><p>Устаревший вариант указания <code class="literal">--with-ssl=openssl</code>.</p></dd><dt id="CONFIGURE-OPTION-WITH-GSSAPI"><span class="term"><code class="option">--with-gssapi</code></span> <a href="#CONFIGURE-OPTION-WITH-GSSAPI" class="id_link">#</a></dt><dd><p>Включает поддержку аутентификации GSSAPI. Для GSSAPI необходимо установить MIT Kerberos. На многих платформах подсистема GSSAPI (входящая в состав MIT Kerberos) устанавливается не в то размещение, которое просматривается по умолчанию (например, <code class="filename">/usr/include</code>, <code class="filename">/usr/lib</code>), так что помимо этого параметра вам придётся задать параметры <code class="option">--with-includes</code> и <code class="option">--with-libraries</code>. Скрипт <code class="filename">configure</code> проверит наличие необходимых заголовочных файлов и библиотек, чтобы убедиться в целостности инсталляции GSSAPI, прежде чем продолжить.</p></dd><dt id="CONFIGURE-OPTION-WITH-LDAP"><span class="term"><code class="option">--with-ldap</code></span> <a href="#CONFIGURE-OPTION-WITH-LDAP" class="id_link">#</a></dt><dd><p>Включает поддержку <acronym class="acronym">LDAP</acronym><a id="id-1.6.4.7.4.5.3.12.2.1.2" class="indexterm"></a> для проверки подлинности и получения параметров соединения (за дополнительными сведениями обратитесь к <span id="INSTALL-LDAP-LINKS" class="phrase"><a class="xref" href="libpq-ldap.html" title="34.18. Получение параметров соединения через LDAP">Разделу 34.18</a> и <a class="xref" href="auth-ldap.html" title="21.10. Аутентификация LDAP">Разделу 21.10</a></span>). В Unix для этого нужно установить пакет <span class="productname">OpenLDAP</span>. В Windows используется стандартная библиотека <span class="productname">WinLDAP</span>. Скрипт <code class="filename">configure</code> проверит наличие необходимых заголовочных файлов и библиотек, чтобы убедиться в целостности инсталляции <span class="productname">OpenLDAP</span>, прежде чем продолжить.</p></dd><dt id="CONFIGURE-OPTION-WITH-PAM"><span class="term"><code class="option">--with-pam</code></span> <a href="#CONFIGURE-OPTION-WITH-PAM" class="id_link">#</a></dt><dd><p>Включает поддержку <acronym class="acronym">PAM</acronym><a id="id-1.6.4.7.4.5.3.13.2.1.2" class="indexterm"></a> (Pluggable Authentication Modules, подключаемых модулей аутентификации).</p></dd><dt id="CONFIGURE-OPTION-WITH-BSD-AUTH"><span class="term"><code class="option">--with-bsd-auth</code></span> <a href="#CONFIGURE-OPTION-WITH-BSD-AUTH" class="id_link">#</a></dt><dd><p>Включает поддержку аутентификации BSD. (Инфраструктура аутентификации BSD в настоящее время доступна только в OpenBSD.)</p></dd><dt id="CONFIGURE-OPTION-WITH-SYSTEMD"><span class="term"><code class="option">--with-systemd</code></span> <a href="#CONFIGURE-OPTION-WITH-SYSTEMD" class="id_link">#</a></dt><dd><p>Включает поддержку служебных уведомлений для <span class="application">systemd</span><a id="id-1.6.4.7.4.5.3.15.2.1.2" class="indexterm"></a>. Это улучшает интеграцию с системой, когда сервер запускается под управлением <span class="application">systemd</span>, и не оказывает никакого влияния в противном случае<span class="phrase">; за дополнительными сведениями обратитесь к <a class="xref" href="server-start.html" title="19.3. Запуск сервера баз данных">Разделу 19.3</a></span>. Для использования этой поддержки в системе должна быть установлена <span class="application">libsystemd</span> с сопутствующими заголовочными файлами.</p></dd><dt id="CONFIGURE-OPTION-WITH-BONJOUR"><span class="term"><code class="option">--with-bonjour</code></span> <a href="#CONFIGURE-OPTION-WITH-BONJOUR" class="id_link">#</a></dt><dd><p>Включает поддержку Bonjour, протокола автоматического обнаружения служб. Для этого Bonjour должен поддерживаться самой операционной системой. Рекомендуется для macOS.</p></dd><dt id="CONFIGURE-OPTION-WITH-UUID"><span class="term"><code class="option">--with-uuid=<em class="replaceable"><code>БИБЛИОТЕКА</code></em></code></span> <a href="#CONFIGURE-OPTION-WITH-UUID" class="id_link">#</a></dt><dd><p>Собрать модуль <a class="xref" href="uuid-ossp.html" title="F.49. uuid-ossp — генератор UUID">uuid-ossp</a> (предоставляющий функции для генерирования UUID), используя заданную библиотеку UUID.<a id="id-1.6.4.7.4.5.3.17.2.1.2" class="indexterm"></a> <em class="replaceable"><code>БИБЛИОТЕКА</code></em> может быть следующей:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="option">bsd</code>, чтобы использовались функции получения UUID, имеющиеся во FreeBSD и некоторых других системах на базе BSD</p></li><li class="listitem"><p><code class="option">e2fs</code>, чтобы использовалась библиотека получения UUID, созданная в рамках проекта <code class="literal">e2fsprogs</code>; эта библиотека присутствует в большинстве систем Linux и macOS, также её можно найти и для других платформ.</p></li><li class="listitem"><p><code class="option">ossp</code>, чтобы использовалась библиотека <a class="ulink" href="http://www.ossp.org/pkg/lib/uuid/" target="_top">OSSP UUID</a></p></li></ul></div></dd><dt id="CONFIGURE-OPTION-WITH-OSSP-UUID"><span class="term"><code class="option">--with-ossp-uuid</code></span> <a href="#CONFIGURE-OPTION-WITH-OSSP-UUID" class="id_link">#</a></dt><dd><p>Устаревший вариант указания <code class="literal">--with-uuid=ossp</code>.</p></dd><dt id="CONFIGURE-OPTION-WITH-LIBXML"><span class="term"><code class="option">--with-libxml</code></span> <a href="#CONFIGURE-OPTION-WITH-LIBXML" class="id_link">#</a></dt><dd><p>Собрать с libxml2, включая тем самым поддержку SQL/XML. Для этого требуется libxml версии 2.6.23 или новее.</p><p>Для определения нужных параметров компиляции и компоновки PostgreSQL обратится к <code class="command">pkg-config</code>, если эта программа установлена, и запросит у неё информацию о libxml2. В противном случае будет вызвана программа <code class="command">xml2-config</code>, входящая в состав libxml2. Вариант с <code class="command">pkg-config</code> предпочтительнее, так как он лучше работает в конфигурации сборки для разных архитектур.</p><p>Для использования libxml2 в нестандартном размещении вы можете задать переменные окружения для <code class="command">pkg-config</code> (см. документацию pkg-config) или указать в переменной окружения <code class="envar">XML2_CONFIG</code> путь к программе <code class="command">xml2-config</code>, относящейся к нужной инсталляции libxml2, либо задать непосредственно переменные <code class="envar">XML2_CFLAGS</code> и <code class="envar">XML2_LIBS</code>. (Если программа <code class="command">pkg-config</code> установлена, переопределить предоставляемую ей информацию о нахождении libxml2 можно, установив переменную <code class="envar">XML2_CONFIG</code> или присвоив непустые значения обеим переменным <code class="envar">XML2_CFLAGS</code> и <code class="envar">XML2_LIBS</code>.)</p></dd><dt id="CONFIGURE-OPTION-WITH-LIBXSLT"><span class="term"><code class="option">--with-libxslt</code></span> <a href="#CONFIGURE-OPTION-WITH-LIBXSLT" class="id_link">#</a></dt><dd><p>Собрать с libxslt, включая тем самым возможность выполнять XSL-преобразования XML-документов в модуле <a class="xref" href="xml2.html" title="F.50. xml2 — функции для выполнения запросов XPath и преобразований XSLT">xml2</a>. Для этого также должен быть указан ключ <code class="option">--with-libxml</code>.</p></dd></dl></div></div><div class="sect3" id="CONFIGURE-OPTIONS-ANTI-FEATURES"><div class="titlepage"><div><div><h4 class="title">17.3.3.3. Отключение функциональности <a href="#CONFIGURE-OPTIONS-ANTI-FEATURES" class="id_link">#</a></h4></div></div></div><p>В этом разделе описаны параметры, отключающую некоторую функциональность <span class="productname">PostgreSQL</span>, которая по умолчанию собирается, но из-за отсутствия необходимого программного обеспечения или поддержки со стороны системы от неё нужно отказаться.</p><div class="variablelist"><dl class="variablelist"><dt id="CONFIGURE-OPTION-WITHOUT-ICU"><span class="term"><code class="option">--without-icu</code></span> <a href="#CONFIGURE-OPTION-WITHOUT-ICU" class="id_link">#</a></dt><dd><p>Отключает поддержку библиотеки <span class="productname">ICU</span><a id="id-1.6.4.7.4.6.3.1.2.1.2" class="indexterm"></a>, что отключает возможность использовать правила сортировки ICU<span class="phrase"> (см. <a class="xref" href="collation.html" title="24.2. Поддержка правил сортировки">Раздел 24.2</a>)</span>.</p></dd><dt id="CONFIGURE-OPTION-WITHOUT-READLINE"><span class="term"><code class="option">--without-readline</code></span> <a href="#CONFIGURE-OPTION-WITHOUT-READLINE" class="id_link">#</a></dt><dd><p>Запрещает использование библиотеки <span class="application">Readline</span> (а также <span class="application">libedit</span>). При этом отключается редактирование командной строки и история в <span class="application">psql</span>.</p></dd><dt id="CONFIGURE-OPTION-WITH-LIBEDIT-PREFERRED"><span class="term"><code class="option">--with-libedit-preferred</code></span> <a href="#CONFIGURE-OPTION-WITH-LIBEDIT-PREFERRED" class="id_link">#</a></dt><dd><p>Отдаёт предпочтение библиотеке <span class="application">libedit</span> с лицензией BSD, а не <span class="application">Readline</span> (GPL). Этот параметр имеет значение, только если установлены обе библиотеки; по умолчанию в этом случае используется <span class="application">Readline</span>.</p></dd><dt id="CONFIGURE-OPTION-WITHOUT-ZLIB"><span class="term"><code class="option">--without-zlib</code></span> <a href="#CONFIGURE-OPTION-WITHOUT-ZLIB" class="id_link">#</a></dt><dd><p><a id="id-1.6.4.7.4.6.3.4.2.1.1" class="indexterm"></a> Запрещает использование библиотеки <span class="application">Zlib</span>. При этом отключается поддержка сжатых архивов утилитами <span class="application">pg_dump</span> и <span class="application">pg_restore</span>.</p></dd><dt id="CONFIGURE-OPTION-DISABLE-SPINLOCKS"><span class="term"><code class="option">--disable-spinlocks</code></span> <a href="#CONFIGURE-OPTION-DISABLE-SPINLOCKS" class="id_link">#</a></dt><dd><p>Позволяет провести сборку, если <span class="productname">PostgreSQL</span> не может воспользоваться циклическими блокировками CPU на данной платформе. Отсутствие таких блокировок приводит к кардинальному снижению производительности, поэтому использовать этот вариант следует, только если сборка прерывается и выдаётся сообщение, что ваша платформа эти блокировки не поддерживает. Если вы не можете собрать <span class="productname">PostgreSQL</span> на вашей платформе без этого указания, сообщите о данной проблеме разработчикам <span class="productname">PostgreSQL</span>.</p></dd><dt id="CONFIGURE-OPTION-DISABLE-ATOMICS"><span class="term"><code class="option">--disable-atomics</code></span> <a href="#CONFIGURE-OPTION-DISABLE-ATOMICS" class="id_link">#</a></dt><dd><p>Отключает использование атомарных операций процессора. На архитектурах, где такие операции отсутствуют, этот параметр никак не действует. Там же, где они поддерживаются, отказ от их использования приведёт к падению производительности. Этот параметр полезен только для отладки и для сравнительной оценки быстродействия.</p></dd><dt id="CONFIGURE-OPTION-DISABLE-THREAD-SAFETY"><span class="term"><code class="option">--disable-thread-safety</code></span> <a href="#CONFIGURE-OPTION-DISABLE-THREAD-SAFETY" class="id_link">#</a></dt><dd><p>Отключает потокобезопасное поведение клиентских библиотек. При этом параллельные потоки программ на базе <span class="application">libpq</span> и <span class="application">ECPG</span> не будут безопасно контролировать собственные дескрипторы соединений. Используйте это только на тех платформах, где отсутствует полноценная поддержка потоков.</p></dd></dl></div></div><div class="sect3" id="CONFIGURE-OPTIONS-BUILD-PROCESS"><div class="titlepage"><div><div><h4 class="title">17.3.3.4. Особенности процесса сборки <a href="#CONFIGURE-OPTIONS-BUILD-PROCESS" class="id_link">#</a></h4></div></div></div><div class="variablelist"><dl class="variablelist"><dt id="CONFIGURE-OPTION-WITH-INCLUDES"><span class="term"><code class="option">--with-includes=<em class="replaceable"><code>КАТАЛОГИ</code></em></code></span> <a href="#CONFIGURE-OPTION-WITH-INCLUDES" class="id_link">#</a></dt><dd><p>Значение <em class="replaceable"><code>КАТАЛОГИ</code></em> представляет список каталогов через двоеточие, которые будут просмотрены компилятором при поиске заголовочных файлов. Если дополнительные пакеты (например, GNU <span class="application">Readline</span>) установлены у вас в нестандартное расположение, вам придётся использовать этот параметр и, возможно, также добавить соответствующий параметр <code class="option">--with-libraries</code>.</p><p>Пример: <code class="literal">--with-includes=/opt/gnu/include:/usr/sup/include</code>.</p></dd><dt id="CONFIGURE-OPTION-WITH-LIBRARIES"><span class="term"><code class="option">--with-libraries=<em class="replaceable"><code>КАТАЛОГИ</code></em></code></span> <a href="#CONFIGURE-OPTION-WITH-LIBRARIES" class="id_link">#</a></dt><dd><p>Значение <em class="replaceable"><code>КАТАЛОГИ</code></em> представляет список каталогов через двоеточие, в котором следует искать библиотеки. Возможно, вам потребуется использовать этот параметр (и соответствующий <code class="option">--with-includes</code>), если какие-то пакеты установлены у вас в нестандартное размещение.</p><p>Пример: <code class="literal">--with-libraries=/opt/gnu/lib:/usr/sup/lib</code>.</p></dd><dt id="CONFIGURE-OPTION-WITH-SYSTEM-TZDATA"><span class="term"><code class="option">--with-system-tzdata=<em class="replaceable"><code>КАТАЛОГ</code></em></code>
       <a id="id-1.6.4.7.4.7.2.3.1.2" class="indexterm"></a>
       </span> <a href="#CONFIGURE-OPTION-WITH-SYSTEM-TZDATA" class="id_link">#</a></dt><dd><p>В <span class="productname">PostgreSQL</span> включена собственная база данных часовых поясов, необходимая для операций с датой и временем. На самом деле эта база данных совместима с базой часовых поясов IANA, поставляемой в составе многих операционных систем FreeBSD, Linux, Solaris, поэтому устанавливать её дополнительно может быть излишне. С этим параметром вместо базы данных, включённой в пакет исходного кода PostgreSQL, будет использоваться системная база данных часовых поясов, находящаяся в заданном <em class="replaceable"><code>КАТАЛОГЕ</code></em>. <em class="replaceable"><code>КАТАЛОГ</code></em> должен задаваться абсолютным путём (в ряде операционных систем принят путь <code class="filename">/usr/share/zoneinfo</code>). Заметьте, что процедура установки не будет проверять несоответствия или ошибки в данных часовых поясов. Поэтому, используя этот параметр, рекомендуется выполнить регрессионные тесты, чтобы убедиться, что выбранная вами база данных часовых поясов работает корректно с <span class="productname">PostgreSQL</span>.</p><a id="id-1.6.4.7.4.7.2.3.2.2" class="indexterm"></a><p>Этот параметр в основном предназначен для тех, кто собирает двоичные пакеты для дистрибутивов и хорошо знает свою операционную систему. Основной плюс от использования системных данных в том, что пакет PostgreSQL не придётся обновлять при изменениях местных определений часовых поясов. Ещё один плюс заключается в упрощении кросс-компиляции, так как при инсталляции не требуется собирать базу данных часовых поясов.</p></dd><dt id="CONFIGURE-OPTION-WITH-EXTRA-VERSION"><span class="term"><code class="option">--with-extra-version=<em class="replaceable"><code>СТРОКА</code></em></code></span> <a href="#CONFIGURE-OPTION-WITH-EXTRA-VERSION" class="id_link">#</a></dt><dd><p>Заданная <em class="replaceable"><code>СТРОКА</code></em> добавляется к номеру версии PostgreSQL. Это можно использовать, например, чтобы двоичные файлы, собранные из промежуточных снимков Git или кода с дополнительными правками, отличались от стандартных дополнительной строкой в версии, например, содержащей идентификатор <code class="command">git describe</code> или номер выпуска дистрибутивного пакета.</p></dd><dt id="CONFIGURE-OPTION-DISABLE-RPATH"><span class="term"><code class="option">--disable-rpath</code></span> <a href="#CONFIGURE-OPTION-DISABLE-RPATH" class="id_link">#</a></dt><dd><p>Не добавлять в исполняемые файлы <span class="productname">PostgreSQL</span> атрибут, с которым они будут искать разделяемые библиотеки в каталоге библиотек инсталляции (см. <code class="option">--libdir</code>). На большинстве платформ этот атрибут задаёт абсолютный путь к каталогу библиотек, поэтому этот вариант не подходит, если вы намерены перемещать готовую инсталляцию. Однако вам в любом случае нужно каким-то образом указать, где исполняемые файлы могут найти разделяемые библиотеки. Обычно для этого нужно настроить механизм динамического связывания в операционной системе, указав нужный каталог библиотек; за подробностями обратитесь к <a class="xref" href="install-post.html#INSTALL-POST-SHLIBS" title="17.5.1. Разделяемые библиотеки">Подразделу 17.5.1</a>.</p></dd></dl></div></div><div class="sect3" id="CONFIGURE-OPTIONS-MISC"><div class="titlepage"><div><div><h4 class="title">17.3.3.5. Разное <a href="#CONFIGURE-OPTIONS-MISC" class="id_link">#</a></h4></div></div></div><p>Из следующих параметров чаще всего применяется, особенно в тестовых сборках, параметр <code class="option">--with-pgport</code>, позволяющий изменить номер порта по умолчанию. Другие описанные в этом разделе параметры рекомендуется использовать только опытным пользователям.</p><div class="variablelist"><dl class="variablelist"><dt id="CONFIGURE-OPTION-WITH-PGPORT"><span class="term"><code class="option">--with-pgport=<em class="replaceable"><code>НОМЕР</code></em></code></span> <a href="#CONFIGURE-OPTION-WITH-PGPORT" class="id_link">#</a></dt><dd><p>Задаёт <em class="replaceable"><code>НОМЕР</code></em> порта по умолчанию для сервера и клиентов. Стандартное значение — 5432. Этот порт всегда можно изменить позже, но если вы укажете другой номер здесь, и сервер, и клиенты будут скомпилированы с одним значением, что очень удобно. Обычно менять это значение имеет смысл, только если вы намерены запускать в одной системе несколько серверов <span class="productname">PostgreSQL</span>.</p></dd><dt id="CONFIGURE-OPTION-WITH-KRB-SRVNAM"><span class="term"><code class="option">--with-krb-srvnam=<em class="replaceable"><code>ИМЯ</code></em></code></span> <a href="#CONFIGURE-OPTION-WITH-KRB-SRVNAM" class="id_link">#</a></dt><dd><p>Задаёт имя по умолчанию для субъекта-службы Kerberos, используемое GSSAPI (по умолчанию это <code class="literal">postgres</code>). Обычно менять его имеет смысл только в сборке для среды Windows, где оно должно быть задано в верхнем регистре (<code class="literal">POSTGRES</code>).</p></dd><dt id="CONFIGURE-OPTION-WITH-SEGSIZE"><span class="term"><code class="option">--with-segsize=<em class="replaceable"><code>РАЗМЕР_СЕГМЕНТА</code></em></code></span> <a href="#CONFIGURE-OPTION-WITH-SEGSIZE" class="id_link">#</a></dt><dd><p>Задаёт <em class="firstterm">размер сегмента</em> (в гигабайтах). Сервер делит большие таблицы на несколько файлов в файловой системе, ограничивая размер каждого данным размером сегмента. Это позволяет обойти ограничения на размер файлов, существующие на многих платформах. Размер сегмента по умолчанию, 1 гигабайт, безопасен для всех поддерживаемых платформ. Если же ваша операционная система поддерживает <span class="quote">«<span class="quote">большие файлы</span>»</span> (а сегодня это поддерживают почти все), вы можете установить больший размер сегмента. Это позволит уменьшить число файловых дескрипторов, используемых при работе с очень большими таблицами. Но будьте осторожны, чтобы выбранное значение не превысило максимум, поддерживаемый вашей платформой и файловыми системами, которые вы будете применять. Возможно, допустимый размер файла будет ограничиваться и другими утилитами, которые вы захотите использовать, например <span class="application">tar</span>. Рекомендуется, хотя и не требуется, чтобы это значение было степенью 2. Заметьте, что с изменением этого значения нарушается совместимость формата базы на диске, то есть вы не сможете использовать <code class="command">pg_upgrade</code> для перехода к сборке с другим размером сегмента.</p></dd><dt id="CONFIGURE-OPTION-WITH-BLOCKSIZE"><span class="term"><code class="option">--with-blocksize=<em class="replaceable"><code>РАЗМЕР_БЛОКА</code></em></code></span> <a href="#CONFIGURE-OPTION-WITH-BLOCKSIZE" class="id_link">#</a></dt><dd><p>Задаёт <em class="firstterm">размер блока</em> (в килобайтах). Эта величина будет единицей хранения и ввода/вывода данных таблиц. Значение по умолчанию, 8 килобайт, достаточно универсально; но в особых случаях может быть оправдан другой размер блока. Это значение должно быть степенью 2 от 1 до 32 (в килобайтах). Заметьте, что с изменением этого значения нарушается совместимость формата базы на диске, то есть вы не сможете использовать <code class="command">pg_upgrade</code> для перехода к сборке с другим размером блока.</p></dd><dt id="CONFIGURE-OPTION-WITH-WAL-BLOCKSIZE"><span class="term"><code class="option">--with-wal-blocksize=<em class="replaceable"><code>РАЗМЕР_БЛОКА</code></em></code></span> <a href="#CONFIGURE-OPTION-WITH-WAL-BLOCKSIZE" class="id_link">#</a></dt><dd><p>Задаёт <em class="firstterm">размер блока WAL</em> (в килобайтах) Эта величина будет единицей хранения и ввода/вывода записей WAL. Значение по умолчанию, 8 килобайт, достаточно универсально; но в особых случаях может быть оправдан другой размер блока. Это значение должно быть степенью 2 от 1 до 64 (в килобайтах). Заметьте, что с изменением этого значения нарушается совместимость формата базы на диске, то есть вы не сможете использовать <code class="command">pg_upgrade</code> для перехода к сборке с другим размером блока WAL.</p></dd></dl></div></div><div class="sect3" id="CONFIGURE-OPTIONS-DEVEL"><div class="titlepage"><div><div><h4 class="title">17.3.3.6. Параметры для разработчиков <a href="#CONFIGURE-OPTIONS-DEVEL" class="id_link">#</a></h4></div></div></div><p>Большинство параметров в этом разделе имеют ценность только для разработки или отладки <span class="productname">PostgreSQL</span>. Использовать их в производственных сборках не рекомендуется, кроме, возможно, ключа <code class="option">--enable-debug</code>, позволяющего получить подробную информацию об ошибке, в случае, если вы столкнётесь с проблемой. На платформах, поддерживающих DTrace, также может иметь смысл использовать для производственной сборки <code class="option">--enable-dtrace</code>.</p><p>При сборке инсталляции, которая будет использоваться для отладки внутреннего кода сервера, рекомендуется как минимум использовать параметры <code class="option">--enable-debug</code> и <code class="option">--enable-cassert</code>.</p><div class="variablelist"><dl class="variablelist"><dt id="CONFIGURE-OPTION-ENABLE-DEBUG"><span class="term"><code class="option">--enable-debug</code></span> <a href="#CONFIGURE-OPTION-ENABLE-DEBUG" class="id_link">#</a></dt><dd><p>Включает компиляцию всех программ и библиотек с отладочными символами. Это значит, что вы сможете запускать программы в отладчике для анализа проблем. При такой компиляции размер установленных исполняемых файлов значительно увеличивается, а компиляторы, кроме GCC, обычно отключают оптимизацию, что снижает быстродействие. Однако наличие отладочных символов очень полезно при решении возможных проблем любой сложности. В настоящее время рекомендуется использовать этот параметр для производственной среды, только если применяется компилятор GCC. Но если вы занимаетесь разработкой или испытываете бета-версию, его следует использовать всегда.</p></dd><dt id="CONFIGURE-OPTION-ENABLE-CASSERT"><span class="term"><code class="option">--enable-cassert</code></span> <a href="#CONFIGURE-OPTION-ENABLE-CASSERT" class="id_link">#</a></dt><dd><p>Включает для сервера проверочные <em class="firstterm">утверждения</em>, проверяющие множество условий, которые <span class="quote">«<span class="quote">не должны происходить</span>»</span>. Это бесценно в процессе разработки кода, но эти проверки могут значительно замедлить работу сервера. Кроме того, включение этих проверок не обязательно увеличит стабильность вашего сервера! Проверочные утверждения не категоризируются по важности, поэтому относительно безвредная ошибка может привести к перезапуску сервера, если утверждение не выполнится. Применять это следует, только если вы занимаетесь разработкой или испытываете бета-версию, но не в производственной среде.</p></dd><dt id="CONFIGURE-OPTION-ENABLE-TAP-TESTS"><span class="term"><code class="option">--enable-tap-tests</code></span> <a href="#CONFIGURE-OPTION-ENABLE-TAP-TESTS" class="id_link">#</a></dt><dd><p>Включает тесты по технологии Perl TAP. Для этого у вас должен быть установлен Perl и модуль <code class="literal">IPC::Run</code>. <span class="phrase">За дополнительными сведениями обратитесь к <a class="xref" href="regress-tap.html" title="33.4. TAP-тесты">Разделу 33.4</a>.</span></p></dd><dt id="CONFIGURE-OPTION-ENABLE-DEPEND"><span class="term"><code class="option">--enable-depend</code></span> <a href="#CONFIGURE-OPTION-ENABLE-DEPEND" class="id_link">#</a></dt><dd><p>Включает автоматическое отслеживание зависимостей. С этим параметром скрипты Makefile настраиваются так, чтобы при изменении любого заголовочного файла пересобирались все зависимые объектные файлы. Это полезно в процессе разработки, но если вам нужно только скомпилировать и установить сервер, это будет лишней тратой времени. В настоящее время это работает только с GCC.</p></dd><dt id="CONFIGURE-OPTION-ENABLE-COVERAGE"><span class="term"><code class="option">--enable-coverage</code></span> <a href="#CONFIGURE-OPTION-ENABLE-COVERAGE" class="id_link">#</a></dt><dd><p>При использовании GCC все программы и библиотеки компилируются с инструментарием, оценивающим покрытие кода тестами. Если его запустить, в каталоге сборки будут сформированы файлы с метриками покрытия кода. <span class="phrase">За дополнительными сведениями обратитесь к <a class="xref" href="regress-coverage.html" title="33.5. Определение покрытия кода тестами">Разделу 33.5</a>.</span> Этот параметр предназначен только для GCC и только для использования в процессе разработки.</p></dd><dt id="CONFIGURE-OPTION-ENABLE-PROFILING"><span class="term"><code class="option">--enable-profiling</code></span> <a href="#CONFIGURE-OPTION-ENABLE-PROFILING" class="id_link">#</a></dt><dd><p>При использовании GCC все программы и библиотеки компилируются так, чтобы их можно было профилировать. В результате по завершении серверного процесса будет создаваться подкаталог с файлом <code class="filename">gmon.out</code>, содержащим данные для профилирования. Этот параметр предназначен только для GCC и только для тех, кто занимается разработкой.</p></dd><dt id="CONFIGURE-OPTION-ENABLE-DTRACE"><span class="term"><code class="option">--enable-dtrace</code></span> <a href="#CONFIGURE-OPTION-ENABLE-DTRACE" class="id_link">#</a></dt><dd><p><a id="id-1.6.4.7.4.9.4.7.2.1.1" class="indexterm"></a> Включает при компиляции <span class="productname">PostgreSQL</span> поддержку средства динамической трассировки DTrace. <span class="phrase">За дополнительными сведениями обратитесь к <a class="xref" href="dynamic-trace.html" title="28.5. Динамическая трассировка">Разделу 28.5</a>.</span></p><p>Задать расположение программы <code class="command">dtrace</code> можно в переменной окружения <code class="envar">DTRACE</code>. Часто это необходимо, потому что <code class="command">dtrace</code> обычно устанавливается в каталог <code class="filename">/usr/sbin</code>, который может отсутствовать в <code class="envar">PATH</code>.</p><p>Дополнительные параметры командной строки для <code class="command">dtrace</code> можно задать в переменной окружения <code class="envar">DTRACEFLAGS</code>. В Solaris, чтобы включить поддержку DTrace для 64-битной сборки, необходимо передать параметр <code class="literal">DTRACEFLAGS="-64"</code>. Например, с компилятором GCC: </p><pre class="screen">
./configure CC='gcc -m64' --enable-dtrace DTRACEFLAGS='-64' ...
</pre><p> С компилятором Sun: </p><pre class="screen">
./configure CC='/opt/SUNWspro/bin/cc -xtarget=native64' --enable-dtrace DTRACEFLAGS='-64' ...
</pre></dd><dt id="CONFIGURE-OPTION-WITH-SEGSIZE-BLOCKS"><span class="term"><code class="option">--with-segsize-blocks=SEGSIZE_BLOCKS</code></span> <a href="#CONFIGURE-OPTION-WITH-SEGSIZE-BLOCKS" class="id_link">#</a></dt><dd><p>Указывает размер сегмента отношения в блоках. Если указан и данный параметр, и <code class="option">--with-segsize</code>, применяется данный параметр. Он предназначен только для разработчиков и позволяет тестировать код, связанный с сегментом.</p></dd></dl></div></div></div><div class="sect2" id="CONFIGURE-ENVVARS"><div class="titlepage"><div><div><h3 class="title">17.3.4. Переменные окружения для <code class="filename">configure</code> <a href="#CONFIGURE-ENVVARS" class="id_link">#</a></h3></div></div></div><a id="id-1.6.4.7.5.2" class="indexterm"></a><p>Помимо описанных выше обычных парамеров командной строки скрипт <code class="filename">configure</code> воспринимает ряд переменных окружения. Эти переменные можно задать в командной строке <code class="filename">configure</code>, например так: </p><pre class="screen">
<strong class="userinput"><code>./configure CC=/opt/bin/gcc CFLAGS='-O2 -pipe'</code></strong>
</pre><p> При таком указании переменная окружения несколько отличается от параметра командной строки. Также можно задать переменные окружения предварительно: </p><pre class="screen">
<strong class="userinput"><code>export CC=/opt/bin/gcc</code></strong>
<strong class="userinput"><code>export CFLAGS='-O2 -pipe'</code></strong>
<strong class="userinput"><code>./configure</code></strong>
</pre><p> Этот вариант может быть удобнее, так как параметры, заданные таким образом, могут восприниматься конфигурационными скриптами многих программ в одном ключе.</p><p>Из описанных здесь переменных окружения чаще всего используются <code class="envar">CC</code> и <code class="envar">CFLAGS</code>. Если вы предпочитаете компилятор C, отличный от выбираемого скриптом <code class="filename">configure</code>, укажите его в переменной <code class="envar">CC</code>. По умолчанию <code class="filename">configure</code> выбирает <code class="filename">gcc</code> (если он находится) или стандартный компилятор платформы (обычно <code class="filename">cc</code>). Подобным образом при необходимости можно переопределить флаги компилятора по умолчанию с помощью переменной <code class="envar">CFLAGS</code>.</p><p>Ниже приведён список значимых переменных, которые можно установить таким образом: </p><div class="variablelist"><dl class="variablelist"><dt id="CONFIGURE-ENVVARS-BISON"><span class="term"><code class="envar">BISON</code></span> <a href="#CONFIGURE-ENVVARS-BISON" class="id_link">#</a></dt><dd><p>программа Bison</p></dd><dt id="CONFIGURE-ENVVARS-CC"><span class="term"><code class="envar">CC</code></span> <a href="#CONFIGURE-ENVVARS-CC" class="id_link">#</a></dt><dd><p>компилятор C</p></dd><dt id="CONFIGURE-ENVVARS-CFLAGS"><span class="term"><code class="envar">CFLAGS</code></span> <a href="#CONFIGURE-ENVVARS-CFLAGS" class="id_link">#</a></dt><dd><p>параметры, передаваемые компилятору C</p></dd><dt id="CONFIGURE-ENVVARS-CLANG"><span class="term"><code class="envar">CLANG</code></span> <a href="#CONFIGURE-ENVVARS-CLANG" class="id_link">#</a></dt><dd><p>путь к программе <code class="command">clang</code>, которая будет подготавливать исходный код для встраивания при компиляции с ключом <code class="literal">--with-llvm</code></p></dd><dt id="CONFIGURE-ENVVARS-CPP"><span class="term"><code class="envar">CPP</code></span> <a href="#CONFIGURE-ENVVARS-CPP" class="id_link">#</a></dt><dd><p>препроцессор C</p></dd><dt id="CONFIGURE-ENVVARS-CPPFLAGS"><span class="term"><code class="envar">CPPFLAGS</code></span> <a href="#CONFIGURE-ENVVARS-CPPFLAGS" class="id_link">#</a></dt><dd><p>параметры, передаваемые препроцессору C</p></dd><dt id="CONFIGURE-ENVVARS-CXX"><span class="term"><code class="envar">CXX</code></span> <a href="#CONFIGURE-ENVVARS-CXX" class="id_link">#</a></dt><dd><p>компилятор C++</p></dd><dt id="CONFIGURE-ENVVARS-CXXFLAGS"><span class="term"><code class="envar">CXXFLAGS</code></span> <a href="#CONFIGURE-ENVVARS-CXXFLAGS" class="id_link">#</a></dt><dd><p>параметры, передаваемые компилятору C++</p></dd><dt id="CONFIGURE-ENVVARS-DTRACE"><span class="term"><code class="envar">DTRACE</code></span> <a href="#CONFIGURE-ENVVARS-DTRACE" class="id_link">#</a></dt><dd><p>расположение программы <code class="command">dtrace</code></p></dd><dt id="CONFIGURE-ENVVARS-DTRACEFLAGS"><span class="term"><code class="envar">DTRACEFLAGS</code></span> <a href="#CONFIGURE-ENVVARS-DTRACEFLAGS" class="id_link">#</a></dt><dd><p>параметры, передаваемые программе <code class="command">dtrace</code></p></dd><dt id="CONFIGURE-ENVVARS-FLEX"><span class="term"><code class="envar">FLEX</code></span> <a href="#CONFIGURE-ENVVARS-FLEX" class="id_link">#</a></dt><dd><p>программа Flex</p></dd><dt id="CONFIGURE-ENVVARS-LDFLAGS"><span class="term"><code class="envar">LDFLAGS</code></span> <a href="#CONFIGURE-ENVVARS-LDFLAGS" class="id_link">#</a></dt><dd><p>параметры, которые должны использоваться при компоновке исполняемых программ или разделяемых библиотек</p></dd><dt id="CONFIGURE-ENVVARS-LDFLAGS-EX"><span class="term"><code class="envar">LDFLAGS_EX</code></span> <a href="#CONFIGURE-ENVVARS-LDFLAGS-EX" class="id_link">#</a></dt><dd><p>дополнительные параметры для компоновки только исполняемых программ</p></dd><dt id="CONFIGURE-ENVVARS-LDFLAGS-SL"><span class="term"><code class="envar">LDFLAGS_SL</code></span> <a href="#CONFIGURE-ENVVARS-LDFLAGS-SL" class="id_link">#</a></dt><dd><p>дополнительные параметры для компоновки только разделяемых библиотек</p></dd><dt id="CONFIGURE-ENVVARS-LLVM-CONFIG"><span class="term"><code class="envar">LLVM_CONFIG</code></span> <a href="#CONFIGURE-ENVVARS-LLVM-CONFIG" class="id_link">#</a></dt><dd><p>программа <code class="command">llvm-config</code>, помогающая найти инсталляцию <span class="productname">LLVM</span></p></dd><dt id="CONFIGURE-ENVVARS-MSGFMT"><span class="term"><code class="envar">MSGFMT</code></span> <a href="#CONFIGURE-ENVVARS-MSGFMT" class="id_link">#</a></dt><dd><p>расположение программы <code class="command">msgfmt</code> для поддержки национальных языков</p></dd><dt id="CONFIGURE-ENVVARS-PERL"><span class="term"><code class="envar">PERL</code></span> <a href="#CONFIGURE-ENVVARS-PERL" class="id_link">#</a></dt><dd><p>Команда, вызывающая интерпретатор Perl. Она помогает определить зависимости для сборки PL/Perl. Значение по умолчанию — <code class="command">perl</code>.</p></dd><dt id="CONFIGURE-ENVVARS-PYTHON"><span class="term"><code class="envar">PYTHON</code></span> <a href="#CONFIGURE-ENVVARS-PYTHON" class="id_link">#</a></dt><dd><p>Команда, вызывающая интерпретатор Python. Она нужна для определения зависимостей при сборке PL/Python. Если это значение не определено, в указанном порядке перебираются следующие варианты: <code class="literal">python3 python</code>.</p></dd><dt id="CONFIGURE-ENVVARS-TCLSH"><span class="term"><code class="envar">TCLSH</code></span> <a href="#CONFIGURE-ENVVARS-TCLSH" class="id_link">#</a></dt><dd><p>Команда, вызывающая интерпретатор Tcl. Она помогает определить зависимости для сборки PL/Tcl. Если она не задана, в указанном порядке перебираются следующие варианты: <code class="literal">tclsh tcl tclsh8.6 tclsh86 tclsh8.5 tclsh85 tclsh8.4 tclsh84</code>.</p></dd><dt id="CONFIGURE-ENVVARS-XML2-CONFIG"><span class="term"><code class="envar">XML2_CONFIG</code></span> <a href="#CONFIGURE-ENVVARS-XML2-CONFIG" class="id_link">#</a></dt><dd><p>программа <code class="command">xml2-config</code>, помогающая найти инсталляцию libxml2</p></dd></dl></div><p>Иногда может быть полезно добавить флаги компилятора к набору флагов, ранее заданному на этапе <code class="filename">configure</code>. В частности, эта потребность объясняется тем, что параметр <span class="application">gcc</span> <code class="option">-Werror</code> нельзя указать в переменной <code class="envar">CFLAGS</code>, передаваемой <code class="filename">configure</code>, так как в результате сломаются многие встроенные тесты <code class="filename">configure</code>. Чтобы добавить такие флаги, задайте их в переменной среды <code class="envar">COPT</code> при запуске <code class="filename">make</code>. Содержимое <code class="envar">COPT</code> будет добавлено в параметры <code class="envar">CFLAGS</code> и <code class="envar">LDFLAGS</code>, заданные скриптом <code class="filename">configure</code>. Например, вы можете выполнить: </p><pre class="screen">
<strong class="userinput"><code>make COPT='-Werror'</code></strong>
</pre><p> или </p><pre class="screen">
<strong class="userinput"><code>export COPT='-Werror'</code></strong>
<strong class="userinput"><code>make</code></strong>
</pre><div class="note"><h3 class="title">Примечание</h3><p>Используя GCC, лучше выполнять сборку с уровнем оптимизации не ниже <code class="option">-O1</code>, так как без оптимизации (<code class="option">-O0</code>) отключаются некоторые важные предупреждения компилятора (например, об использовании неинициализированных переменных). Однако оптимизация ненулевого уровня может затруднить отладку, так как при пошаговом выполнении скомпилированный код обычно не соответствует в точности строкам исходного кода. При возникновении сложностей с отладкой оптимизированного кода, перекомпилируйте интересующие вас файлы с ключом <code class="option">-O0</code>. Это можно сделать, просто передав соответствующий параметр <span class="application">make</span>: <code class="command">make PROFILE=-O0 file.o</code>.</p><p>На самом деле переменные окружения <code class="envar">COPT</code> и <code class="envar">PROFILE</code> обрабатываются сборочными файлами Makefile <span class="productname">PostgreSQL</span> одинаково. Поэтому выбор одной из этих переменных — дело вкуса, но обычно разработчики используют <code class="envar">PROFILE</code> для одноразовых корректив флагов, а содержимое <code class="envar">COPT</code> сохраняют постоянным.</p></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="install-getsource.html" title="17.2. Получение исходного кода">Пред.</a> </td><td width="20%" align="center"><a accesskey="u" href="installation.html" title="Глава 17. Установка из исходного кода">Наверх</a></td><td width="40%" align="right"> <a accesskey="n" href="install-meson.html" title="17.4. Сборка и установка с использованием Meson">След.</a></td></tr><tr><td width="40%" align="left" valign="top">17.2. Получение исходного кода </td><td width="20%" align="center"><a accesskey="h" href="index.html" title="Документация к PostgreSQL 16.3">Начало</a></td><td width="40%" align="right" valign="top"> 17.4. Сборка и установка с использованием Meson</td></tr></table></div></body></html>