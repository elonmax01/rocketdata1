<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>ALTER ROLE</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@lists.postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot" /><link rel="prev" href="sql-alterpublication.html" title="ALTER PUBLICATION" /><link rel="next" href="sql-alterroutine.html" title="ALTER ROUTINE" /></head><body id="docContent" class="container-fluid col-10"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">ALTER ROLE</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="sql-alterpublication.html" title="ALTER PUBLICATION">Пред.</a> </td><td width="10%" align="left"><a accesskey="u" href="sql-commands.html" title="Команды SQL">Наверх</a></td><th width="60%" align="center">Команды SQL</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="Документация к PostgreSQL 16.3">Начало</a></td><td width="10%" align="right"> <a accesskey="n" href="sql-alterroutine.html" title="ALTER ROUTINE">След.</a></td></tr></table><hr /></div><div class="refentry" id="SQL-ALTERROLE"><div class="titlepage"></div><a id="id-1.9.3.26.1" class="indexterm"></a><div class="refnamediv"><h2><span class="refentrytitle">ALTER ROLE</span></h2><p>ALTER ROLE — изменить роль в базе данных</p></div><div class="refsynopsisdiv"><h2>Синтаксис</h2><pre class="synopsis">ALTER ROLE <em class="replaceable"><code>указание_роли</code></em> [ WITH ] <em class="replaceable"><code>параметр</code></em> [ ... ]

<span class="phrase">Здесь <em class="replaceable"><code>параметр</code></em>:</span>

      SUPERUSER | NOSUPERUSER
    | CREATEDB | NOCREATEDB
    | CREATEROLE | NOCREATEROLE
    | INHERIT | NOINHERIT
    | LOGIN | NOLOGIN
    | REPLICATION | NOREPLICATION
    | BYPASSRLS | NOBYPASSRLS
    | CONNECTION LIMIT <em class="replaceable"><code>предел_подключений</code></em>
    | [ ENCRYPTED ] PASSWORD '<em class="replaceable"><code>пароль</code></em>' | PASSWORD NULL
    | VALID UNTIL '<em class="replaceable"><code>дата_время</code></em>'

ALTER ROLE <em class="replaceable"><code>имя</code></em> RENAME TO <em class="replaceable"><code>новое_имя</code></em>

ALTER ROLE { <em class="replaceable"><code>указание_роли</code></em> | ALL } [ IN DATABASE <em class="replaceable"><code>имя_бд</code></em> ] SET <em class="replaceable"><code>параметр_конфигурации</code></em> { TO | = } { <em class="replaceable"><code>значение</code></em> | DEFAULT }
ALTER ROLE { <em class="replaceable"><code>указание_роли</code></em> | ALL } [ IN DATABASE <em class="replaceable"><code>имя_бд</code></em> ] SET <em class="replaceable"><code>параметр_конфигурации</code></em> FROM CURRENT
ALTER ROLE { <em class="replaceable"><code>указание_роли</code></em> | ALL } [ IN DATABASE <em class="replaceable"><code>имя_бд</code></em> ] RESET <em class="replaceable"><code>параметр_конфигурации</code></em>
ALTER ROLE { <em class="replaceable"><code>указание_роли</code></em> | ALL } [ IN DATABASE <em class="replaceable"><code>имя_бд</code></em> ] RESET ALL

<span class="phrase">Здесь <em class="replaceable"><code>указание_роли</code></em>:</span>

    <em class="replaceable"><code>имя_роли</code></em>
  | CURRENT_ROLE
  | CURRENT_USER
  | SESSION_USER</pre></div><div class="refsect1" id="SQL-ALTERROLE-DESC"><h2>Описание</h2><p><code class="command">ALTER ROLE</code> изменяет атрибуты роли <span class="productname">PostgreSQL</span>.</p><p>Первая форма команды в этой справке может изменить многие атрибуты роли, которые можно указать в <a class="link" href="sql-createrole.html" title="CREATE ROLE"><code class="command">CREATE ROLE</code></a>. (Покрываются все возможные атрибуты, отсутствуют только возможности добавления/удаления членов роли; для этого нужно использовать <a class="link" href="sql-grant.html" title="GRANT"><code class="command">GRANT</code></a> и <a class="link" href="sql-revoke.html" title="REVOKE"><code class="command">REVOKE</code></a>.) Атрибуты, не упомянутые в команде, сохраняют свои предыдущие значения. Суперпользователи базы данных могут изменить любые параметры любой роли. Роли с правом <code class="literal">CREATEROLE</code>, не являющиеся суперпользователями, могут также менять многие параметры ролей, для которых имеют право <code class="literal">ADMIN OPTION</code>, но только не ролей суперпользователей и репликации. Роли, не являющиеся суперпользователями, не могут менять параметр <code class="literal">SUPERUSER</code>, а могут менять <code class="literal">CREATEDB</code>, <code class="literal">REPLICATION</code> и <code class="literal">BYPASSRLS</code>, но только если они имеют соответствующие свойства. Обычные пользователи (роли) могут менять только свой пароль.</p><p>Вторая форма меняет имя роли. Суперпользователи базы данных могут переименовать любую роль, а пользователи с правом <code class="literal">CREATEROLE</code> могут переименовывать роли (не суперпользователей), для которых у них есть право <code class="literal">ADMIN OPTION</code>. Также нельзя переименовать роль текущего пользователя в активном сеансе. (Если вам нужно сделать это, подключитесь другим пользователем.) Так как в паролях с <code class="literal">MD5</code>-шифрованием имя роли используется в качестве криптосоли, при переименовании роли её пароль очищается, если он был зашифрован <code class="literal">MD5</code>.</p><p>Оставшиеся формы меняют значение по умолчанию конфигурационной переменной, которое будет распространяться на сеансы роли во всех базах данных, либо, если добавлено предложение <code class="literal">IN DATABASE</code>, только на сеансы роли в заданной базе. Если вместо имени роли указано <code class="literal">ALL</code>, это значение переменной распространяется на все роли. Использование <code class="literal">ALL</code> с <code class="literal">IN DATABASE</code> по сути равносильно использованию команды <code class="literal">ALTER DATABASE ... SET ...</code>.</p><p>Когда эта роль впоследствии установит новое подключение, указанное значение станет значением по умолчанию в сеансе, переопределяя значение, заданное в <code class="filename">postgresql.conf</code> или полученное из командной строки <code class="command">postgres</code>. Это происходит только в момент входа; при выполнении <a class="link" href="sql-set-role.html" title="SET ROLE"><code class="command">SET ROLE</code></a> или <a class="link" href="sql-set-session-authorization.html" title="SET SESSION AUTHORIZATION"><code class="command">SET SESSION AUTHORIZATION</code></a> новые значения не применятся. Набор параметров для всех баз данных переопределяется параметрами уровня БД, установленными для роли. Параметры для конкретной базы данных или конкретной роли переопределяют параметры для всех ролей.</p><p>Суперпользователи могут менять значения переменных по умолчанию для любых ролей, а пользователи с правом <code class="literal">CREATEROLE</code> могут менять их только для ролей (не суперпользователей), для которых у них есть право <code class="literal">ADMIN OPTION</code>. Обычные пользователи могут определять переменные только для себя. Некоторые переменные конфигурации нельзя задать таким способом, а некоторые может настроить только суперпользователь. Параметры всех ролей во всех базах данных могут настраивать только суперпользователи.</p></div><div class="refsect1" id="SQL-ALTERROLE-PARAMS"><h2>Параметры</h2><div class="variablelist"><dl class="variablelist"><dt id="SQL-ALTERROLE-PARAMS-NAME"><span class="term"><em class="replaceable"><code>имя</code></em></span> <a href="#SQL-ALTERROLE-PARAMS-NAME" class="id_link">#</a></dt><dd><p>Имя роли, атрибуты которой изменяются.</p></dd><dt id="SQL-ALTERROLE-PARAMS-CURRENT-ROLE"><span class="term"><code class="literal">CURRENT_ROLE</code><br /></span><span class="term"><code class="literal">CURRENT_USER</code></span> <a href="#SQL-ALTERROLE-PARAMS-CURRENT-ROLE" class="id_link">#</a></dt><dd><p>Выбирает для изменения текущего пользователя, а не явно задаваемую роль.</p></dd><dt id="SQL-ALTERROLE-PARAMS-SESSION-USER"><span class="term"><code class="literal">SESSION_USER</code></span> <a href="#SQL-ALTERROLE-PARAMS-SESSION-USER" class="id_link">#</a></dt><dd><p>Выбирает для изменения текущего пользователя сеанса, а не явно задаваемую роль.</p></dd><dt id="SQL-ALTERROLE-PARAMS-SUPERUSER"><span class="term"><code class="literal">SUPERUSER</code><br /></span><span class="term"><code class="literal">NOSUPERUSER</code><br /></span><span class="term"><code class="literal">CREATEDB</code><br /></span><span class="term"><code class="literal">NOCREATEDB</code><br /></span><span class="term"><code class="literal">CREATEROLE</code><br /></span><span class="term"><code class="literal">NOCREATEROLE</code><br /></span><span class="term"><code class="literal">INHERIT</code><br /></span><span class="term"><code class="literal">NOINHERIT</code><br /></span><span class="term"><code class="literal">LOGIN</code><br /></span><span class="term"><code class="literal">NOLOGIN</code><br /></span><span class="term"><code class="literal">REPLICATION</code><br /></span><span class="term"><code class="literal">NOREPLICATION</code><br /></span><span class="term"><code class="literal">BYPASSRLS</code><br /></span><span class="term"><code class="literal">NOBYPASSRLS</code><br /></span><span class="term"><code class="literal">CONNECTION LIMIT</code> <em class="replaceable"><code>предел_подключений</code></em><br /></span><span class="term">[ <code class="literal">ENCRYPTED</code> ] <code class="literal">PASSWORD</code> '<em class="replaceable"><code>пароль</code></em>'<br /></span><span class="term"><code class="literal">PASSWORD NULL</code><br /></span><span class="term"><code class="literal">VALID UNTIL</code> '<em class="replaceable"><code>дата_время</code></em>'</span> <a href="#SQL-ALTERROLE-PARAMS-SUPERUSER" class="id_link">#</a></dt><dd><p>Эти предложения меняют атрибуты, изначально установленные командой <a class="link" href="sql-createrole.html" title="CREATE ROLE"><code class="command">CREATE ROLE</code></a>. За дополнительными сведениями обратитесь к странице справки <code class="command">CREATE ROLE</code>.</p></dd><dt id="SQL-ALTERROLE-PARAMS-NEW-NAME"><span class="term"><em class="replaceable"><code>новое_имя</code></em></span> <a href="#SQL-ALTERROLE-PARAMS-NEW-NAME" class="id_link">#</a></dt><dd><p>Новое имя роли.</p></dd><dt id="SQL-ALTERROLE-PARAMS-DATABASE-NAME"><span class="term"><em class="replaceable"><code>имя_бд</code></em></span> <a href="#SQL-ALTERROLE-PARAMS-DATABASE-NAME" class="id_link">#</a></dt><dd><p>Имя базы данных, в которой устанавливается конфигурационная переменная.</p></dd><dt id="SQL-ALTERROLE-PARAMS-CONFIGURATION-PARAMETER"><span class="term"><em class="replaceable"><code>параметр_конфигурации</code></em><br /></span><span class="term"><em class="replaceable"><code>значение</code></em></span> <a href="#SQL-ALTERROLE-PARAMS-CONFIGURATION-PARAMETER" class="id_link">#</a></dt><dd><p>Указанный параметр конфигурации принимает заданное значение по умолчанию в сеансах роли. Если <em class="replaceable"><code>значение</code></em> задано как <code class="literal">DEFAULT</code> или, что то же самое, применяется операция <code class="literal">RESET</code>, переопределение этого параметра для роли удаляется и роль будет получать в новых сеансах системное значение параметра. Для очистки значений всех параметров, связанных с ролью, применяется <code class="literal">RESET ALL</code>. <code class="literal">SET FROM CURRENT</code> сохраняет текущее значение параметра в активном сеансе в качестве значения для данной роли. Если указано <code class="literal">IN DATABASE</code>, параметр конфигурации настраивается или удаляется только для данной роли и указанной базы данных.</p><p>Определения переменных для роли применяются только в начале сеанса; команды <a class="link" href="sql-set-role.html" title="SET ROLE"><code class="command">SET ROLE</code></a> и <a class="link" href="sql-set-session-authorization.html" title="SET SESSION AUTHORIZATION"><code class="command">SET SESSION AUTHORIZATION</code></a> эти определения не обрабатывают.</p><p>За подробными сведениями об именах и значениях параметров обратитесь к <a class="xref" href="sql-set.html" title="SET"><span class="refentrytitle">SET</span></a> и <a class="xref" href="runtime-config.html" title="Глава 20. Настройка сервера">Главе 20</a>.</p></dd></dl></div></div><div class="refsect1" id="SQL-ALTERROLE-NOTES"><h2>Замечания</h2><p>Для добавления новых ролей используйте команду <a class="link" href="sql-createrole.html" title="CREATE ROLE"><code class="command">CREATE ROLE</code></a>, а для удаления роли — <a class="link" href="sql-droprole.html" title="DROP ROLE"><code class="command">DROP ROLE</code></a>.</p><p><code class="command">ALTER ROLE</code> не может управлять членством роли, для этого применяется <a class="link" href="sql-grant.html" title="GRANT"><code class="command">GRANT</code></a> и <a class="link" href="sql-revoke.html" title="REVOKE"><code class="command">REVOKE</code></a>.</p><p>Указывая в этой команде незашифрованный пароль, следует проявлять осторожность. Пароль будет передаваться на сервер открытым текстом и может также записаться в историю команд клиента или в протокол работы сервера. В <a class="xref" href="app-psql.html" title="psql"><span class="refentrytitle"><span class="application">psql</span></span></a> есть команда <code class="command">\password</code>, с помощью которой можно сменить пароль роли, не рискуя рассекретить пароль.</p><p>Также возможно связать сеансовые значения по умолчанию с определённой базой данных, а не с ролью (см. <a class="xref" href="sql-alterdatabase.html" title="ALTER DATABASE"><span class="refentrytitle">ALTER DATABASE</span></a>). В случае конфликта параметры для базы данных и роли переопределяют параметры только для роли, которые, в свою очередь, переопределяют параметры для базы данных.</p></div><div class="refsect1" id="SQL-ALTERROLE-EXAMPLES"><h2>Примеры</h2><p>Изменение пароля роли: </p><pre class="programlisting">ALTER ROLE davide WITH PASSWORD 'hu8jmn3';</pre><p>Удаление пароля роли: </p><pre class="programlisting">ALTER ROLE davide WITH PASSWORD NULL;</pre><p>Изменение срока действия пароля (в частности, определяется, что пароль должен перестать действовать в полдень 4 мая 2015 г. в часовом поясе <acronym class="acronym">UTC</acronym>+1): </p><pre class="programlisting">ALTER ROLE chris VALID UNTIL 'May 4 12:00:00 2015 +1';</pre><p>Установка бесконечного срока действия пароля: </p><pre class="programlisting">ALTER ROLE fred VALID UNTIL 'infinity';</pre><p>Наделение роли правами на управление другими ролями и создание новых баз данных: </p><pre class="programlisting">ALTER ROLE miriam CREATEROLE CREATEDB;</pre><p>Определение нестандартного значения параметра <a class="xref" href="runtime-config-resource.html#GUC-MAINTENANCE-WORK-MEM">maintenance_work_mem</a> для роли: </p><pre class="programlisting">ALTER ROLE worker_bee SET maintenance_work_mem = 100000;</pre><p>Определение нестандартного значения параметра <a class="xref" href="runtime-config-client.html#GUC-CLIENT-MIN-MESSAGES">client_min_messages</a> для роли и заданной базы: </p><pre class="programlisting">ALTER ROLE fred IN DATABASE devel SET client_min_messages = DEBUG;</pre></div><div class="refsect1" id="SQL-ALTERROLE-COMPAT"><h2>Совместимость</h2><p>Оператор <code class="command">ALTER ROLE</code> является расширением <span class="productname">PostgreSQL</span>.</p></div><div class="refsect1" id="SQL-ALTERROLE-SEE"><h2>См. также</h2><span class="simplelist"><a class="xref" href="sql-createrole.html" title="CREATE ROLE"><span class="refentrytitle">CREATE ROLE</span></a>, <a class="xref" href="sql-droprole.html" title="DROP ROLE"><span class="refentrytitle">DROP ROLE</span></a>, <a class="xref" href="sql-alterdatabase.html" title="ALTER DATABASE"><span class="refentrytitle">ALTER DATABASE</span></a>, <a class="xref" href="sql-set.html" title="SET"><span class="refentrytitle">SET</span></a></span></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="sql-alterpublication.html" title="ALTER PUBLICATION">Пред.</a> </td><td width="20%" align="center"><a accesskey="u" href="sql-commands.html" title="Команды SQL">Наверх</a></td><td width="40%" align="right"> <a accesskey="n" href="sql-alterroutine.html" title="ALTER ROUTINE">След.</a></td></tr><tr><td width="40%" align="left" valign="top">ALTER PUBLICATION </td><td width="20%" align="center"><a accesskey="h" href="index.html" title="Документация к PostgreSQL 16.3">Начало</a></td><td width="40%" align="right" valign="top"> ALTER ROUTINE</td></tr></table></div></body></html>