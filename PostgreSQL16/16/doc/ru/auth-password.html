<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>21.5. Аутентификация password</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@lists.postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot" /><link rel="prev" href="auth-trust.html" title="21.4. Аутентификация trust" /><link rel="next" href="gssapi-auth.html" title="21.6. Аутентификация GSSAPI" /></head><body id="docContent" class="container-fluid col-10"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">21.5. Аутентификация password</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="auth-trust.html" title="21.4. Аутентификация trust">Пред.</a> </td><td width="10%" align="left"><a accesskey="u" href="client-authentication.html" title="Глава 21. Аутентификация клиентского приложения">Наверх</a></td><th width="60%" align="center">Глава 21. Аутентификация клиентского приложения</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="Документация к PostgreSQL 16.3">Начало</a></td><td width="10%" align="right"> <a accesskey="n" href="gssapi-auth.html" title="21.6. Аутентификация GSSAPI">След.</a></td></tr></table><hr /></div><div class="sect1" id="AUTH-PASSWORD"><div class="titlepage"><div><div><h2 class="title" style="clear: both">21.5. Аутентификация password <a href="#AUTH-PASSWORD" class="id_link">#</a></h2></div></div></div><a id="id-1.6.8.12.2" class="indexterm"></a><a id="id-1.6.8.12.3" class="indexterm"></a><a id="id-1.6.8.12.4" class="indexterm"></a><p>Существует несколько методов аутентификации по паролю. Они работают примерно одинаково, но различаются тем, как пароли пользователей хранятся на сервере и как пароль передаётся от клиента по каналу связи.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">scram-sha-256</code></span></dt><dd><p>С методом <code class="literal">scram-sha-256</code> выполняется аутентификация SCRAM-SHA-256, как описано в <a class="ulink" href="https://datatracker.ietf.org/doc/html/rfc7677" target="_top">RFC 7677</a>. Она производится по схеме вызов-ответ, которая предотвращает перехват паролей через недоверенные соединения и поддерживает хранение паролей на сервере в виде криптографического хеша, что считается безопасным.</p><p>Это наиболее безопасный из существующих на данный момент методов, но он не поддерживается старыми клиентскими библиотеками.</p></dd><dt><span class="term"><code class="literal">md5</code></span></dt><dd><p>Для метода <code class="literal">md5</code> реализован менее безопасный механизм вызов-ответ. Он предотвращает перехват паролей и предусматривает хранение паролей на сервере в зашифрованном виде, но не защищает в случае похищения хешей паролей с сервера. Кроме того, алгоритм хеширования MD5 в наши дни уже может не защитить от целенаправленных атак.</p><p>Метод <code class="literal">md5</code> несовместим с функциональностью <a class="xref" href="runtime-config-connection.html#GUC-DB-USER-NAMESPACE">db_user_namespace</a>.</p><p>Для облегчения перехода от метода <code class="literal">md5</code> к более новому методу SCRAM, если в качестве метода аутентификации в <code class="filename">pg_hba.conf</code> указан <code class="literal">md5</code>, но пароль пользователя на сервере зашифрован для SCRAM (см. ниже), автоматически будет производиться аутентификация на базе SCRAM.</p></dd><dt><span class="term"><code class="literal">password</code></span></dt><dd><p>С методом <code class="literal">password</code> пароль передаётся в открытом виде и поэтому является уязвимым для атак с перехватом трафика. Его следует избегать всегда, если это возможно. Однако если подключение защищено SSL, метод <code class="literal">password</code> может быть безопасен. (Хотя аутентификация по сертификату SSL может быть лучшим выбором когда используется SSL).</p></dd></dl></div><p>Пароли баз данных <span class="productname">PostgreSQL</span> отделены от паролей пользователей операционной системы. Пароли всех пользователей базы данных хранятся в системном каталоге <code class="literal">pg_authid</code>. Управлять паролями можно либо используя SQL-команды <a class="xref" href="sql-createrole.html" title="CREATE ROLE"><span class="refentrytitle">CREATE ROLE</span></a> и <a class="xref" href="sql-alterrole.html" title="ALTER ROLE"><span class="refentrytitle">ALTER ROLE</span></a>, например, <strong class="userinput"><code>CREATE ROLE foo WITH LOGIN PASSWORD 'secret'</code></strong>, либо с помощью команды <span class="application">psql</span> <code class="literal">\password</code>. Если пароль для пользователя не задан, вместо него хранится NULL, и пройти аутентификацию по паролю этот пользователь не сможет.</p><p>Доступность различных методов аутентификации по паролю зависит от того, как пароли пользователей шифруются на сервере (или, говоря точнее, хешируются). Это определяется параметром конфигурации <a class="xref" href="runtime-config-connection.html#GUC-PASSWORD-ENCRYPTION">password_encryption</a> в момент назначения пароля. Если пароль шифруется в режиме <code class="literal">scram-sha-256</code>, его можно будет использовать для методов аутентификации <code class="literal">scram-sha-256</code> и <code class="literal">password</code> (но в последнем случае он будет передаваться открытым текстом). В случае указания метода аутентификации <code class="literal">md5</code> при этом произойдёт автоматический переход к использованию <code class="literal">scram-sha-256</code>, как сказано выше, так что этот вариант тоже будет работать. Если пароль шифруется в режиме <code class="literal">md5</code>, его можно будет использовать только для методов аутентификации <code class="literal">md5</code> и <code class="literal">password</code> (и в последнем случае он так же будет передаваться открытым текстом). (Ранние версии PostgreSQL поддерживали хранение паролей на сервере в открытом виде, но теперь это невозможно.) Чтобы просмотреть хранящиеся в БД хеши паролей, обратитесь к системному каталогу <code class="literal">pg_authid</code>.</p><p>Для перевода существующей инсталляции с <code class="literal">md5</code> на <code class="literal">scram-sha-256</code>, после того как все клиентские библиотеки будут обновлены до версий, поддерживающих SCRAM, задайте <code class="literal">password_encryption = 'scram-sha-256'</code> в <code class="filename">postgresql.conf</code>, добейтесь, чтобы все пользователи сменили свои пароли, а затем поменяйте указания метода аутентификации в <code class="filename">pg_hba.conf</code> на <code class="literal">scram-sha-256</code>.</p></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="auth-trust.html" title="21.4. Аутентификация trust">Пред.</a> </td><td width="20%" align="center"><a accesskey="u" href="client-authentication.html" title="Глава 21. Аутентификация клиентского приложения">Наверх</a></td><td width="40%" align="right"> <a accesskey="n" href="gssapi-auth.html" title="21.6. Аутентификация GSSAPI">След.</a></td></tr><tr><td width="40%" align="left" valign="top">21.4. Аутентификация trust </td><td width="20%" align="center"><a accesskey="h" href="index.html" title="Документация к PostgreSQL 16.3">Начало</a></td><td width="40%" align="right" valign="top"> 21.6. Аутентификация GSSAPI</td></tr></table></div></body></html>