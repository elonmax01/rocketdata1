<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>55.9. Форматы сообщений логической репликации</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@lists.postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot" /><link rel="prev" href="protocol-error-fields.html" title="55.8. Поля сообщений с ошибками и замечаниями" /><link rel="next" href="protocol-changes.html" title="55.10. Сводка изменений по сравнению с протоколом версии 2.0" /></head><body id="docContent" class="container-fluid col-10"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">55.9. Форматы сообщений логической репликации</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="protocol-error-fields.html" title="55.8. Поля сообщений с ошибками и замечаниями">Пред.</a> </td><td width="10%" align="left"><a accesskey="u" href="protocol.html" title="Глава 55. Клиент-серверный протокол">Наверх</a></td><th width="60%" align="center">Глава 55. Клиент-серверный протокол</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="Документация к PostgreSQL 16.3">Начало</a></td><td width="10%" align="right"> <a accesskey="n" href="protocol-changes.html" title="55.10. Сводка изменений по сравнению с протоколом версии 2.0">След.</a></td></tr></table><hr /></div><div class="sect1" id="PROTOCOL-LOGICALREP-MESSAGE-FORMATS"><div class="titlepage"><div><div><h2 class="title" style="clear: both">55.9. Форматы сообщений логической репликации <a href="#PROTOCOL-LOGICALREP-MESSAGE-FORMATS" class="id_link">#</a></h2></div></div></div><p>В этом разделе подробно описывается формат каждого сообщения логической репликации. Эти сообщения или выдаются через SQL-интерфейс слота репликации или передаются процессом walsender. Когда их передаёт walsender, они помещаются внутрь WAL-сообщений протокола репликации, описанных в <a class="xref" href="protocol-replication.html" title="55.4. Протокол потоковой репликации">Разделе 55.4</a>, и в общем следуют тому же потоку сообщений, что и сообщения физической репликации.</p><div class="variablelist"><dl class="variablelist"><dt id="PROTOCOL-LOGICALREP-MESSAGE-FORMATS-BEGIN"><span class="term">Begin</span> <a href="#PROTOCOL-LOGICALREP-MESSAGE-FORMATS-BEGIN" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1('B')</span></dt><dd><p>Указывает, что это начальное сообщение.</p></dd><dt><span class="term">Int64 (XLogRecPtr)</span></dt><dd><p>Окончательный LSN транзакции.</p></dd><dt><span class="term">Int64 (TimestampTz)</span></dt><dd><p>Время фиксации транзакции. Значение задаётся в микросекундах, прошедших с начала эпохи PostgreSQL (2000-01-01).</p></dd><dt><span class="term">Int32 (TransactionId)</span></dt><dd><p>Идентификатор транзакции.</p></dd></dl></div></dd><dt id="PROTOCOL-LOGICALREP-MESSAGE-FORMATS-MESSAGE"><span class="term">Сообщение</span> <a href="#PROTOCOL-LOGICALREP-MESSAGE-FORMATS-MESSAGE" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1('M')</span></dt><dd><p>Указывает, что это сообщение логического декодирования.</p></dd><dt><span class="term">Int32 (TransactionId)</span></dt><dd><p>Идентификатор транзакции (только для транзакций, передаваемых потоками). Это поле присутствует со 2-й версии протокола.</p></dd><dt><span class="term">Int8</span></dt><dd><p>Флаги; либо 0, если флагов нет, либо 1, если сообщение логического декодирования передано как транзакционное.</p></dd><dt><span class="term">Int64 (XLogRecPtr)</span></dt><dd><p>LSN сообщения логического декодирования.</p></dd><dt><span class="term">String</span></dt><dd><p>Префикс сообщения логического декодирования.</p></dd><dt><span class="term">Int32</span></dt><dd><p>Длина содержимого сообщения.</p></dd><dt><span class="term">Byte<em class="replaceable"><code>n</code></em></span></dt><dd><p>Содержание сообщения логического декодирования.</p></dd></dl></div></dd><dt id="PROTOCOL-LOGICALREP-MESSAGE-FORMATS-COMMIT"><span class="term">Commit</span> <a href="#PROTOCOL-LOGICALREP-MESSAGE-FORMATS-COMMIT" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1('C')</span></dt><dd><p>Указывает, что это сообщение о фиксации.</p></dd><dt><span class="term">Int8(0)</span></dt><dd><p>Флаги; в настоящее время не используются.</p></dd><dt><span class="term">Int64 (XLogRecPtr)</span></dt><dd><p>LSN записи фиксации.</p></dd><dt><span class="term">Int64 (XLogRecPtr)</span></dt><dd><p>Конечный LSN транзакции.</p></dd><dt><span class="term">Int64 (TimestampTz)</span></dt><dd><p>Время фиксации транзакции. Значение задаётся в микросекундах, прошедших с начала эпохи PostgreSQL (2000-01-01).</p></dd></dl></div></dd><dt id="PROTOCOL-LOGICALREP-MESSAGE-FORMATS-ORIGIN"><span class="term">Origin</span> <a href="#PROTOCOL-LOGICALREP-MESSAGE-FORMATS-ORIGIN" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1('O')</span></dt><dd><p>Указывает, что это сообщение об источнике.</p></dd><dt><span class="term">Int64 (XLogRecPtr)</span></dt><dd><p>LSN записи фиксации на сервере-источнике.</p></dd><dt><span class="term">String</span></dt><dd><p>Имя источника.</p></dd></dl></div><p>Заметьте, что внутри одной транзакции может быть несколько сообщений Origin.</p></dd><dt id="PROTOCOL-LOGICALREP-MESSAGE-FORMATS-RELATION"><span class="term">Relation</span> <a href="#PROTOCOL-LOGICALREP-MESSAGE-FORMATS-RELATION" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1('R')</span></dt><dd><p>Указывает, что это сообщение об отношении.</p></dd><dt><span class="term">Int32 (TransactionId)</span></dt><dd><p>Идентификатор транзакции (только для транзакций, передаваемых потоками). Это поле присутствует со 2-й версии протокола.</p></dd><dt><span class="term">Int32 (Oid)</span></dt><dd><p>OID отношения.</p></dd><dt><span class="term">String</span></dt><dd><p>Пространство имён (пустая строка для <code class="literal">pg_catalog</code>).</p></dd><dt><span class="term">String</span></dt><dd><p>Имя отношения.</p></dd><dt><span class="term">Int8</span></dt><dd><p>Свойство идентификации реплики для отношения (то же, что и <code class="structfield">relreplident</code> в <code class="structname">pg_class</code>).</p></dd><dt><span class="term">Int16</span></dt><dd><p>Число столбцов.</p></dd></dl></div><p>Затем для каждого столбца в публикации (за исключением генерируемых) идёт следующий блок сообщения:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Int8</span></dt><dd><p>Флаги столбца. В настоящее время это может быть 0 (флагов нет) или 1 (столбец помечается как часть ключа).</p></dd><dt><span class="term">String</span></dt><dd><p>Имя столбца.</p></dd><dt><span class="term">Int32 (Oid)</span></dt><dd><p>OID типа данных столбца.</p></dd><dt><span class="term">Int32</span></dt><dd><p>Модификатор типа столбца (<code class="structfield">atttypmod</code>).</p></dd></dl></div></dd><dt id="PROTOCOL-LOGICALREP-MESSAGE-FORMATS-TYPE"><span class="term">Тип</span> <a href="#PROTOCOL-LOGICALREP-MESSAGE-FORMATS-TYPE" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1('Y')</span></dt><dd><p>Указывает, что это сообщение о типе.</p></dd><dt><span class="term">Int32 (TransactionId)</span></dt><dd><p>Идентификатор транзакции (только для транзакций, передаваемых потоками). Это поле присутствует со 2-й версии протокола.</p></dd><dt><span class="term">Int32 (Oid)</span></dt><dd><p>OID типа данных.</p></dd><dt><span class="term">String</span></dt><dd><p>Пространство имён (пустая строка для <code class="literal">pg_catalog</code>).</p></dd><dt><span class="term">String</span></dt><dd><p>Имя типа данных.</p></dd></dl></div></dd><dt id="PROTOCOL-LOGICALREP-MESSAGE-FORMATS-INSERT"><span class="term">Insert</span> <a href="#PROTOCOL-LOGICALREP-MESSAGE-FORMATS-INSERT" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1('I')</span></dt><dd><p>Указывает, что это сообщение о добавлении данных.</p></dd><dt><span class="term">Int32 (TransactionId)</span></dt><dd><p>Идентификатор транзакции (только для транзакций, передаваемых потоками). Это поле присутствует со 2-й версии протокола.</p></dd><dt><span class="term">Int32 (Oid)</span></dt><dd><p>OID отношения, соответствующий идентификатору в сообщении об отношении.</p></dd><dt><span class="term">Byte1('N')</span></dt><dd><p>Обозначает следующее сообщение TupleData как содержащее новый кортеж.</p></dd><dt><span class="term">TupleData</span></dt><dd><p>Блок сообщения TupleData, представляющий содержимое нового кортежа.</p></dd></dl></div></dd><dt id="PROTOCOL-LOGICALREP-MESSAGE-FORMATS-UPDATE"><span class="term">Update</span> <a href="#PROTOCOL-LOGICALREP-MESSAGE-FORMATS-UPDATE" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1('U')</span></dt><dd><p>Указывает, что это сообщение об изменении данных.</p></dd><dt><span class="term">Int32 (TransactionId)</span></dt><dd><p>Идентификатор транзакции (только для транзакций, передаваемых потоками). Это поле присутствует со 2-й версии протокола.</p></dd><dt><span class="term">Int32 (Oid)</span></dt><dd><p>OID отношения, соответствующий идентификатору в сообщении об отношении.</p></dd><dt><span class="term">Byte1('K')</span></dt><dd><p>Указывает, что следующий блок TupleData содержит ключ. Это поле является необязательным и присутствует, только если изменение затронуло столбцы, являющиеся частью индекса REPLICA IDENTITY.</p></dd><dt><span class="term">Byte1('O')</span></dt><dd><p>Указывает, что следующий блок TupleData содержит старый кортеж. Это поле является необязательным и присутствует, только если у таблицы, в которой произошло изменение, свойство REPLICA IDENTITY равно FULL.</p></dd><dt><span class="term">TupleData</span></dt><dd><p>Блок сообщения TupleData, представляющий содержимое старого кортежа или первичного ключа. Присутствует, только если перед ним идёт признак 'O' или 'K'.</p></dd><dt><span class="term">Byte1('N')</span></dt><dd><p>Обозначает следующее сообщение TupleData как содержащее новый кортеж.</p></dd><dt><span class="term">TupleData</span></dt><dd><p>Блок сообщения TupleData, представляющий содержимое нового кортежа.</p></dd></dl></div><p>Сообщение Update может содержать либо блок 'K', либо блок 'O', либо ни один из них, но не оба сразу.</p></dd><dt id="PROTOCOL-LOGICALREP-MESSAGE-FORMATS-DELETE"><span class="term">Delete</span> <a href="#PROTOCOL-LOGICALREP-MESSAGE-FORMATS-DELETE" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1('D')</span></dt><dd><p>Указывает, что это сообщение об удалении данных.</p></dd><dt><span class="term">Int32 (TransactionId)</span></dt><dd><p>Идентификатор транзакции (только для транзакций, передаваемых потоками). Это поле присутствует со 2-й версии протокола.</p></dd><dt><span class="term">Int32 (Oid)</span></dt><dd><p>OID отношения, соответствующий идентификатору в сообщении об отношении.</p></dd><dt><span class="term">Byte1('K')</span></dt><dd><p>Указывает, что следующий блок TupleData содержит ключ. Это поле присутствует, если таблица, в которой произошло удаление, использует индекс в качестве REPLICA IDENTITY.</p></dd><dt><span class="term">Byte1('O')</span></dt><dd><p>Указывает, что следующий блок TupleData содержит старый кортеж. Это поле присутствует, если у таблицы, в которой произошло удаление, свойство REPLICA IDENTITY равно FULL.</p></dd><dt><span class="term">TupleData</span></dt><dd><p>Блок сообщения TupleData, представляющий содержимое старого кортежа или первичного ключа, в зависимости от предыдущего поля.</p></dd></dl></div><p>Сообщение Delete может содержать либо блок 'K', либо блок 'O', но не оба сразу.</p></dd><dt id="PROTOCOL-LOGICALREP-MESSAGE-FORMATS-TRUNCATE"><span class="term">Truncate</span> <a href="#PROTOCOL-LOGICALREP-MESSAGE-FORMATS-TRUNCATE" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1('T')</span></dt><dd><p>Указывает, что это сообщение об усечении отношений.</p></dd><dt><span class="term">Int32 (TransactionId)</span></dt><dd><p>Идентификатор транзакции (только для транзакций, передаваемых потоками). Это поле присутствует со 2-й версии протокола.</p></dd><dt><span class="term">Int32</span></dt><dd><p>Число отношений.</p></dd><dt><span class="term">Int8</span></dt><dd><p>Битовые флаги для <code class="command">TRUNCATE</code>: 1 соответствует указанию <code class="literal">CASCADE</code>, 2 — <code class="literal">RESTART IDENTITY</code>.</p></dd><dt><span class="term">Int32 (Oid)</span></dt><dd><p>OID отношения, соответствующий идентификатору в сообщении об отношении. Это поле повторятся для каждого отношения.</p></dd></dl></div></dd></dl></div><p>Описанные ниже сообщения Stream Start, Stream Stop, Stream Commit и Stream Abort доступны со 2-й версии протокола.</p><div class="variablelist"><dl class="variablelist"><dt id="PROTOCOL-LOGICALREP-MESSAGE-FORMATS-STREAM-START"><span class="term">Stream Start</span> <a href="#PROTOCOL-LOGICALREP-MESSAGE-FORMATS-STREAM-START" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1('S')</span></dt><dd><p>Указывает, что это сообщение о начале потока.</p></dd><dt><span class="term">Int32 (TransactionId)</span></dt><dd><p>Идентификатор транзакции.</p></dd><dt><span class="term">Int8</span></dt><dd><p>1 означает, что это первый сегмент потока с этим идентификатором; 0, если это любой другой сегмент.</p></dd></dl></div></dd><dt id="PROTOCOL-LOGICALREP-MESSAGE-FORMATS-STREAM-STOP"><span class="term">Stream Stop</span> <a href="#PROTOCOL-LOGICALREP-MESSAGE-FORMATS-STREAM-STOP" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1('E')</span></dt><dd><p>Указывает, что это сообщение об окончании потока.</p></dd></dl></div></dd><dt id="PROTOCOL-LOGICALREP-MESSAGE-FORMATS-STREAM-COMMIT"><span class="term">Stream Commit</span> <a href="#PROTOCOL-LOGICALREP-MESSAGE-FORMATS-STREAM-COMMIT" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1('c')</span></dt><dd><p>Указывает, что это сообщение о фиксации транзакции в потоке.</p></dd><dt><span class="term">Int32 (TransactionId)</span></dt><dd><p>Идентификатор транзакции.</p></dd><dt><span class="term">Int8(0)</span></dt><dd><p>Флаги; в настоящее время не используются.</p></dd><dt><span class="term">Int64 (XLogRecPtr)</span></dt><dd><p>LSN записи фиксации.</p></dd><dt><span class="term">Int64 (XLogRecPtr)</span></dt><dd><p>Конечный LSN транзакции.</p></dd><dt><span class="term">Int64 (TimestampTz)</span></dt><dd><p>Время фиксации транзакции. Значение задаётся в микросекундах, прошедших с начала эпохи PostgreSQL (2000-01-01).</p></dd></dl></div></dd><dt id="PROTOCOL-LOGICALREP-MESSAGE-FORMATS-STREAM-ABORT"><span class="term">Stream Abort</span> <a href="#PROTOCOL-LOGICALREP-MESSAGE-FORMATS-STREAM-ABORT" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1('A')</span></dt><dd><p>Указывает, что это сообщение о прерывании транзакции в потоке.</p></dd><dt><span class="term">Int32 (TransactionId)</span></dt><dd><p>Идентификатор транзакции.</p></dd><dt><span class="term">Int32 (TransactionId)</span></dt><dd><p>Идентификатор подтранзакции (для транзакций верхнего уровня совпадает с идентификатором транзакции).</p></dd><dt><span class="term">Int64 (XLogRecPtr)</span></dt><dd><p>LSN прерывания транзакции. Это поле присутствует с 4-й версии протокола.</p></dd><dt><span class="term">Int64 (TimestampTz)</span></dt><dd><p>Время прерывания транзакции. Значение задаётся в микросекундах, прошедших с начала эпохи PostgreSQL (2000-01-01). Это поле присутствует с 4-й версии протокола.</p></dd></dl></div></dd></dl></div><p>Описанные ниже сообщения (Begin Prepare, Prepare, Commit Prepared, Rollback Prepared, Stream Prepare) доступны с 3-й версии протокола.</p><div class="variablelist"><dl class="variablelist"><dt id="PROTOCOL-LOGICALREP-MESSAGE-FORMATS-BEGIN-PREPARE"><span class="term">Begin Prepare</span> <a href="#PROTOCOL-LOGICALREP-MESSAGE-FORMATS-BEGIN-PREPARE" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1('b')</span></dt><dd><p>Указывает, что это сообщение о начале подготовленной транзакции.</p></dd><dt><span class="term">Int64 (XLogRecPtr)</span></dt><dd><p>LSN подготовки транзакции.</p></dd><dt><span class="term">Int64 (XLogRecPtr)</span></dt><dd><p>Конечный LSN подготовленной транзакции.</p></dd><dt><span class="term">Int64 (TimestampTz)</span></dt><dd><p>Время подготовки транзакции. Значение задаётся в микросекундах, прошедших с начала эпохи PostgreSQL (2000-01-01).</p></dd><dt><span class="term">Int32 (TransactionId)</span></dt><dd><p>Идентификатор транзакции.</p></dd><dt><span class="term">String</span></dt><dd><p>Пользовательский GID подготовленной транзакции.</p></dd></dl></div></dd><dt id="PROTOCOL-LOGICALREP-MESSAGE-FORMATS-PREPARE"><span class="term">Prepare</span> <a href="#PROTOCOL-LOGICALREP-MESSAGE-FORMATS-PREPARE" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1('P')</span></dt><dd><p>Указывает, что это сообщение о подготовленной транзакции.</p></dd><dt><span class="term">Int8(0)</span></dt><dd><p>Флаги; в настоящее время не используются.</p></dd><dt><span class="term">Int64 (XLogRecPtr)</span></dt><dd><p>LSN подготовки транзакции.</p></dd><dt><span class="term">Int64 (XLogRecPtr)</span></dt><dd><p>Конечный LSN подготовленной транзакции.</p></dd><dt><span class="term">Int64 (TimestampTz)</span></dt><dd><p>Время подготовки транзакции. Значение задаётся в микросекундах, прошедших с начала эпохи PostgreSQL (2000-01-01).</p></dd><dt><span class="term">Int32 (TransactionId)</span></dt><dd><p>Идентификатор транзакции.</p></dd><dt><span class="term">String</span></dt><dd><p>Пользовательский GID подготовленной транзакции.</p></dd></dl></div></dd><dt id="PROTOCOL-LOGICALREP-MESSAGE-FORMATS-COMMIT-PREPARED"><span class="term">Commit Prepared</span> <a href="#PROTOCOL-LOGICALREP-MESSAGE-FORMATS-COMMIT-PREPARED" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1('K')</span></dt><dd><p>Указывает, что это сообщение о фиксации подготовленной транзакции.</p></dd><dt><span class="term">Int8(0)</span></dt><dd><p>Флаги; в настоящее время не используются.</p></dd><dt><span class="term">Int64 (XLogRecPtr)</span></dt><dd><p>LSN фиксации подготовленной транзакции.</p></dd><dt><span class="term">Int64 (XLogRecPtr)</span></dt><dd><p>Конечный LSN фиксации подготовленной транзакции.</p></dd><dt><span class="term">Int64 (TimestampTz)</span></dt><dd><p>Время фиксации транзакции. Значение задаётся в микросекундах, прошедших с начала эпохи PostgreSQL (2000-01-01).</p></dd><dt><span class="term">Int32 (TransactionId)</span></dt><dd><p>Идентификатор транзакции.</p></dd><dt><span class="term">String</span></dt><dd><p>Пользовательский GID подготовленной транзакции.</p></dd></dl></div></dd><dt id="PROTOCOL-LOGICALREP-MESSAGE-FORMATS-ROLLBACK-PREPARED"><span class="term">Rollback Prepared</span> <a href="#PROTOCOL-LOGICALREP-MESSAGE-FORMATS-ROLLBACK-PREPARED" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1('r')</span></dt><dd><p>Указывает, что это сообщение об откате подготовленной транзакции.</p></dd><dt><span class="term">Int8(0)</span></dt><dd><p>Флаги; в настоящее время не используются.</p></dd><dt><span class="term">Int64 (XLogRecPtr)</span></dt><dd><p>Конечный LSN подготовленной транзакции.</p></dd><dt><span class="term">Int64 (XLogRecPtr)</span></dt><dd><p>Конечный LSN отката подготовленной транзакции.</p></dd><dt><span class="term">Int64 (TimestampTz)</span></dt><dd><p>Время подготовки транзакции. Значение задаётся в микросекундах, прошедших с начала эпохи PostgreSQL (2000-01-01).</p></dd><dt><span class="term">Int64 (TimestampTz)</span></dt><dd><p>Время отката транзакции. Значение задаётся в микросекундах, прошедших с начала эпохи PostgreSQL (2000-01-01).</p></dd><dt><span class="term">Int32 (TransactionId)</span></dt><dd><p>Идентификатор транзакции.</p></dd><dt><span class="term">String</span></dt><dd><p>Пользовательский GID подготовленной транзакции.</p></dd></dl></div></dd><dt id="PROTOCOL-LOGICALREP-MESSAGE-FORMATS-STREAM-PREPARE"><span class="term">Stream Prepare</span> <a href="#PROTOCOL-LOGICALREP-MESSAGE-FORMATS-STREAM-PREPARE" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1('p')</span></dt><dd><p>Указывает, что это сообщение о подготовленной транзакции, передаваемой в потоке.</p></dd><dt><span class="term">Int8(0)</span></dt><dd><p>Флаги; в настоящее время не используются.</p></dd><dt><span class="term">Int64 (XLogRecPtr)</span></dt><dd><p>LSN подготовки транзакции.</p></dd><dt><span class="term">Int64 (XLogRecPtr)</span></dt><dd><p>Конечный LSN подготовленной транзакции.</p></dd><dt><span class="term">Int64 (TimestampTz)</span></dt><dd><p>Время подготовки транзакции. Значение задаётся в микросекундах, прошедших с начала эпохи PostgreSQL (2000-01-01).</p></dd><dt><span class="term">Int32 (TransactionId)</span></dt><dd><p>Идентификатор транзакции.</p></dd><dt><span class="term">String</span></dt><dd><p>Пользовательский GID подготовленной транзакции.</p></dd></dl></div></dd></dl></div><p>Описанные выше сообщения имеют следующие общие блоки.</p><div class="variablelist"><dl class="variablelist"><dt id="PROTOCOL-LOGICALREP-MESSAGE-FORMATS-TUPLEDATA"><span class="term">TupleData</span> <a href="#PROTOCOL-LOGICALREP-MESSAGE-FORMATS-TUPLEDATA" class="id_link">#</a></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Int16</span></dt><dd><p>Число столбцов.</p></dd></dl></div><p>Затем для каждого столбца (за исключением генерируемых) идёт одно из следующих вложенных сообщений: </p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1('n')</span></dt><dd><p>Обозначает данные как значение NULL.</p></dd></dl></div><p> Или </p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1('u')</span></dt><dd><p>Обозначает неизменённое значение TOAST (само значение не передаётся).</p></dd></dl></div><p> Или </p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1('t')</span></dt><dd><p>Обозначает данные как значение в текстовом формате.</p></dd></dl></div><p> Или </p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Byte1('b')</span></dt><dd><p>Обозначает данные как значение в двоичном формате.</p></dd><dt><span class="term">Int32</span></dt><dd><p>Длина значения столбца.</p></dd><dt><span class="term">Byte<em class="replaceable"><code>n</code></em></span></dt><dd><p>Значение столбца в двоичном или текстовом формате, определённом предшествующим байтом формата. Переменная <em class="replaceable"><code>n</code></em> задаёт длину значения.</p></dd></dl></div></dd></dl></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="protocol-error-fields.html" title="55.8. Поля сообщений с ошибками и замечаниями">Пред.</a> </td><td width="20%" align="center"><a accesskey="u" href="protocol.html" title="Глава 55. Клиент-серверный протокол">Наверх</a></td><td width="40%" align="right"> <a accesskey="n" href="protocol-changes.html" title="55.10. Сводка изменений по сравнению с протоколом версии 2.0">След.</a></td></tr><tr><td width="40%" align="left" valign="top">55.8. Поля сообщений с ошибками и замечаниями </td><td width="20%" align="center"><a accesskey="h" href="index.html" title="Документация к PostgreSQL 16.3">Начало</a></td><td width="40%" align="right" valign="top"> 55.10. Сводка изменений по сравнению с протоколом версии 2.0</td></tr></table></div></body></html>