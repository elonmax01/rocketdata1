<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>8.5. Типы даты/времени</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@lists.postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot" /><link rel="prev" href="datatype-binary.html" title="8.4. Двоичные типы данных" /><link rel="next" href="datatype-boolean.html" title="8.6. Логический тип" /></head><body id="docContent" class="container-fluid col-10"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">8.5. Типы даты/времени</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="datatype-binary.html" title="8.4. Двоичные типы данных">Пред.</a> </td><td width="10%" align="left"><a accesskey="u" href="datatype.html" title="Глава 8. Типы данных">Наверх</a></td><th width="60%" align="center">Глава 8. Типы данных</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="Документация к PostgreSQL 16.3">Начало</a></td><td width="10%" align="right"> <a accesskey="n" href="datatype-boolean.html" title="8.6. Логический тип">След.</a></td></tr></table><hr /></div><div class="sect1" id="DATATYPE-DATETIME"><div class="titlepage"><div><div><h2 class="title" style="clear: both">8.5. Типы даты/времени <a href="#DATATYPE-DATETIME" class="id_link">#</a></h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="sect2"><a href="datatype-datetime.html#DATATYPE-DATETIME-INPUT">8.5.1. Ввод даты/времени</a></span></dt><dt><span class="sect2"><a href="datatype-datetime.html#DATATYPE-DATETIME-OUTPUT">8.5.2. Вывод даты/времени</a></span></dt><dt><span class="sect2"><a href="datatype-datetime.html#DATATYPE-TIMEZONES">8.5.3. Часовые пояса</a></span></dt><dt><span class="sect2"><a href="datatype-datetime.html#DATATYPE-INTERVAL-INPUT">8.5.4. Ввод интервалов</a></span></dt><dt><span class="sect2"><a href="datatype-datetime.html#DATATYPE-INTERVAL-OUTPUT">8.5.5. Вывод интервалов</a></span></dt></dl></div><a id="id-1.5.7.13.2" class="indexterm"></a><a id="id-1.5.7.13.3" class="indexterm"></a><a id="id-1.5.7.13.4" class="indexterm"></a><a id="id-1.5.7.13.5" class="indexterm"></a><a id="id-1.5.7.13.6" class="indexterm"></a><a id="id-1.5.7.13.7" class="indexterm"></a><a id="id-1.5.7.13.8" class="indexterm"></a><a id="id-1.5.7.13.9" class="indexterm"></a><a id="id-1.5.7.13.10" class="indexterm"></a><a id="id-1.5.7.13.11" class="indexterm"></a><p><span class="productname">PostgreSQL</span> поддерживает полный набор типов даты и времени <acronym class="acronym">SQL</acronym>, показанный в <a class="xref" href="datatype-datetime.html#DATATYPE-DATETIME-TABLE" title="Таблица 8.9. Типы даты/времени">Таблице 8.9</a>. Операции, возможные с этими типами данных, описаны в <a class="xref" href="functions-datetime.html" title="9.9. Операторы и функции даты/времени">Разделе 9.9</a>. Все даты считаются по Григорианскому календарю, даже для времени до его введения (за дополнительными сведениями обратитесь к <a class="xref" href="datetime-units-history.html" title="B.6. История единиц измерения времени">Разделу B.6</a>).</p><div class="table" id="DATATYPE-DATETIME-TABLE"><p class="title"><strong>Таблица 8.9. Типы даты/времени</strong></p><div class="table-contents"><table class="table" summary="Типы даты/времени" border="1"><colgroup><col /><col /><col /><col /><col /><col /></colgroup><thead><tr><th>Name</th><th>Размер</th><th>Описание</th><th>Наименьшее значение</th><th>Наибольшее значение</th><th>Точность</th></tr></thead><tbody><tr><td><code class="type">timestamp [ (<em class="replaceable"><code>p</code></em>) ] [ without time zone ]</code></td><td>8 байт</td><td>дата и время (без часового пояса)</td><td>4713 до н. э.</td><td>294276 н. э.</td><td>1 микросекунда</td></tr><tr><td><code class="type">timestamp [ (<em class="replaceable"><code>p</code></em>) ] with time zone</code></td><td>8 байт</td><td>дата и время (с часовым поясом)</td><td>4713 до н. э.</td><td>294276 н. э.</td><td>1 микросекунда</td></tr><tr><td><code class="type">date</code></td><td>4 байта</td><td>дата (без времени суток)</td><td>4713 до н. э.</td><td>5874897 н. э.</td><td>1 день</td></tr><tr><td><code class="type">time [ (<em class="replaceable"><code>p</code></em>) ] [ without time zone ]</code></td><td>8 байт</td><td>время суток (без даты)</td><td>00:00:00</td><td>24:00:00</td><td>1 микросекунда</td></tr><tr><td><code class="type">time [ (<em class="replaceable"><code>p</code></em>) ] with time zone</code></td><td>12 байт</td><td>время дня (без даты), с часовым поясом</td><td>00:00:00+1559</td><td>24:00:00-1559</td><td>1 микросекунда</td></tr><tr><td><code class="type">interval [ <em class="replaceable"><code>поля</code></em> ] [ (<em class="replaceable"><code>p</code></em>) ]</code></td><td>16 байт</td><td>временной интервал</td><td>-178000000 лет</td><td>178000000 лет</td><td>1 микросекунда</td></tr></tbody></table></div></div><br class="table-break" /><div class="note"><h3 class="title">Примечание</h3><p>Стандарт SQL требует, чтобы тип <code class="type">timestamp</code> подразумевал <code class="type">timestamp without time zone</code> (время без часового пояса), и <span class="productname">PostgreSQL</span> следует этому. Для краткости <code class="type">timestamp with time zone</code> можно записать как <code class="type">timestamptz</code>; это расширение <span class="productname">PostgreSQL</span>.</p></div><p>Типы <code class="type">time</code>, <code class="type">timestamp</code> и <code class="type">interval</code> принимают необязательное значение точности <em class="replaceable"><code>p</code></em>, определяющее, сколько знаков после запятой должно сохраняться в секундах. По умолчанию точность не ограничивается. Допустимые значения <em class="replaceable"><code>p</code></em> лежат в интервале от 0 до 6.</p><p>Тип <code class="type">interval</code> дополнительно позволяет ограничить набор сохраняемых полей следующими фразами: </p><pre class="literallayout">
YEAR
MONTH
DAY
HOUR
MINUTE
SECOND
YEAR TO MONTH
DAY TO HOUR
DAY TO MINUTE
DAY TO SECOND
HOUR TO MINUTE
HOUR TO SECOND
MINUTE TO SECOND
</pre><p> Заметьте, что если указаны и <em class="replaceable"><code>поля</code></em>, и точность <em class="replaceable"><code>p</code></em>, указание <em class="replaceable"><code>поля</code></em> должно включать <code class="literal">SECOND</code>, так как точность применима только к секундам.</p><p>Тип <code class="type">time with time zone</code> определён стандартом SQL, но в его определении описаны свойства сомнительной ценности. В большинстве случаев сочетание типов <code class="type">date</code>, <code class="type">time</code>, <code class="type">timestamp without time zone</code> и <code class="type">timestamp with time zone</code> удовлетворяет все потребности в функционале дат/времени, возникающие в приложениях.</p><div class="sect2" id="DATATYPE-DATETIME-INPUT"><div class="titlepage"><div><div><h3 class="title">8.5.1. Ввод даты/времени <a href="#DATATYPE-DATETIME-INPUT" class="id_link">#</a></h3></div></div></div><p>Значения даты и времени принимаются практически в любом разумном формате, включая ISO 8601, <acronym class="acronym">SQL</acronym>-совместимый, традиционный формат <span class="productname">POSTGRES</span> и другие. В некоторых форматах порядок даты, месяца и года во вводимой дате неоднозначен и поэтому поддерживается явное определение формата. Для этого предназначен параметр <a class="xref" href="runtime-config-client.html#GUC-DATESTYLE">DateStyle</a>. Когда он имеет значение <code class="literal">MDY</code>, выбирается интерпретация месяц-день-год, значению <code class="literal">DMY</code> соответствует день-месяц-год, а <code class="literal">YMD</code> — год-месяц-день.</p><p><span class="productname">PostgreSQL</span> обрабатывает вводимые значения даты/времени более гибко, чем того требует стандарт <acronym class="acronym">SQL</acronym>. Точные правила разбора даты/времени и распознаваемые текстовые поля, в том числе названия месяцев, дней недели и часовых поясов описаны в <a class="xref" href="datetime-appendix.html" title="Приложение B. Поддержка даты и времени">Приложении B</a>.</p><p>Помните, что любые вводимые значения даты и времени нужно заключать в апострофы, как текстовые строки. За дополнительной информацией обратитесь к <a class="xref" href="sql-syntax-lexical.html#SQL-SYNTAX-CONSTANTS-GENERIC" title="4.1.2.7. Константы других типов">Подразделу 4.1.2.7</a>. <acronym class="acronym">SQL</acronym> предусматривает следующий синтаксис: </p><pre class="synopsis">
<em class="replaceable"><code>тип</code></em> [ (<em class="replaceable"><code>p</code></em>) ] '<em class="replaceable"><code>значение</code></em>'
</pre><p> Здесь <em class="replaceable"><code>p</code></em> — необязательное указание точности, определяющее число знаков после точки в секундах. Точность может быть определена для типов <code class="type">time</code>, <code class="type">timestamp</code> и <code class="type">interval</code> в интервале от 0 до 6. Если в определении константы точность не указана, она считается равной точности значения в строке (но не больше 6 цифр).</p><div class="sect3" id="DATATYPE-DATETIME-INPUT-DATES"><div class="titlepage"><div><div><h4 class="title">8.5.1.1. Даты <a href="#DATATYPE-DATETIME-INPUT-DATES" class="id_link">#</a></h4></div></div></div><a id="id-1.5.7.13.18.5.2" class="indexterm"></a><p>В <a class="xref" href="datatype-datetime.html#DATATYPE-DATETIME-DATE-TABLE" title="Таблица 8.10. Вводимые даты">Таблице 8.10</a> приведены некоторые допустимые значения типа <code class="type">date</code>.</p><div class="table" id="DATATYPE-DATETIME-DATE-TABLE"><p class="title"><strong>Таблица 8.10. Вводимые даты</strong></p><div class="table-contents"><table class="table" summary="Вводимые даты" border="1"><colgroup><col class="col1" /><col class="col2" /></colgroup><thead><tr><th>Пример</th><th>Описание</th></tr></thead><tbody><tr><td>1999-01-08</td><td>ISO 8601; 8 января в любом режиме (рекомендуемый формат)</td></tr><tr><td>January 8, 1999</td><td>воспринимается однозначно в любом режиме <code class="varname">datestyle</code></td></tr><tr><td>1/8/1999</td><td>8 января в режиме <code class="literal">MDY</code> и 1 августа в режиме <code class="literal">DMY</code></td></tr><tr><td>1/18/1999</td><td>18 января в режиме <code class="literal">MDY</code>; недопустимая дата в других режимах</td></tr><tr><td>01/02/03</td><td>2 января 2003 г. в режиме <code class="literal">MDY</code>; 1 февраля 2003 г. в режиме <code class="literal">DMY</code> и 3 февраля 2001 г. в режиме <code class="literal">YMD</code></td></tr><tr><td>1999-Jan-08</td><td>8 января в любом режиме</td></tr><tr><td>Jan-08-1999</td><td>8 января в любом режиме</td></tr><tr><td>08-Jan-1999</td><td>8 января в любом режиме</td></tr><tr><td>99-Jan-08</td><td>8 января в режиме <code class="literal">YMD</code>; ошибка в других режимах</td></tr><tr><td>08-Jan-99</td><td>8 января; ошибка в режиме <code class="literal">YMD</code></td></tr><tr><td>Jan-08-99</td><td>8 января; ошибка в режиме <code class="literal">YMD</code></td></tr><tr><td>19990108</td><td>ISO 8601; 8 января 1999 в любом режиме</td></tr><tr><td>990108</td><td>ISO 8601; 8 января 1999 в любом режиме</td></tr><tr><td>1999.008</td><td>год и день года</td></tr><tr><td>J2451187</td><td>юлианский день</td></tr><tr><td>January 8, 99 BC</td><td>99 до н. э.</td></tr></tbody></table></div></div><br class="table-break" /></div><div class="sect3" id="DATATYPE-DATETIME-INPUT-TIMES"><div class="titlepage"><div><div><h4 class="title">8.5.1.2. Время <a href="#DATATYPE-DATETIME-INPUT-TIMES" class="id_link">#</a></h4></div></div></div><a id="id-1.5.7.13.18.6.2" class="indexterm"></a><a id="id-1.5.7.13.18.6.3" class="indexterm"></a><a id="id-1.5.7.13.18.6.4" class="indexterm"></a><p>Для хранения времени суток без даты предназначены типы <code class="type">time [ (<em class="replaceable"><code>p</code></em>) ] without time zone</code> и <code class="type">time [ (<em class="replaceable"><code>p</code></em>) ] with time zone</code>. Тип <code class="type">time</code> без уточнения эквивалентен типу <code class="type">time without time zone</code>.</p><p>Допустимые вводимые значения этих типов состоят из записи времени суток и необязательного указания часового пояса. (См. <a class="xref" href="datatype-datetime.html#DATATYPE-DATETIME-TIME-TABLE" title="Таблица 8.11. Вводимое время">Таблицу 8.11</a> и <a class="xref" href="datatype-datetime.html#DATATYPE-TIMEZONE-TABLE" title="Таблица 8.12. Вводимый часовой пояс">Таблицу 8.12</a>.) Если в значении для типа <code class="type">time without time zone</code> указывается часовой пояс, он просто игнорируется. Так же будет игнорироваться дата, если её указать, за исключением случаев, когда в указанном часовом поясе принят переход на летнее время, например <code class="literal">America/New_York</code>. В данном случае указать дату необходимо, чтобы система могла определить, применяется ли обычное или летнее время. Соответствующее смещение часового пояса записывается в значении <code class="type">time with time zone</code> и выводится без изменений, оно не привязано к активному часовому поясу.</p><div class="table" id="DATATYPE-DATETIME-TIME-TABLE"><p class="title"><strong>Таблица 8.11. Вводимое время</strong></p><div class="table-contents"><table class="table" summary="Вводимое время" border="1"><colgroup><col class="col1" /><col class="col2" /></colgroup><thead><tr><th>Пример</th><th>Описание</th></tr></thead><tbody><tr><td><code class="literal">04:05:06.789</code></td><td>ISO 8601</td></tr><tr><td><code class="literal">04:05:06</code></td><td>ISO 8601</td></tr><tr><td><code class="literal">04:05</code></td><td>ISO 8601</td></tr><tr><td><code class="literal">040506</code></td><td>ISO 8601</td></tr><tr><td><code class="literal">04:05 AM</code></td><td>то же, что и 04:05; AM не меняет значение времени</td></tr><tr><td><code class="literal">04:05 PM</code></td><td>то же, что и 16:05; часы должны быть &lt;= 12</td></tr><tr><td><code class="literal">04:05:06.789-8</code></td><td>ISO 8601, с часовым поясом в виде смещения от UTC</td></tr><tr><td><code class="literal">04:05:06-08:00</code></td><td>ISO 8601, с часовым поясом в виде смещения от UTC</td></tr><tr><td><code class="literal">04:05-08:00</code></td><td>ISO 8601, с часовым поясом в виде смещения от UTC</td></tr><tr><td><code class="literal">040506-08</code></td><td>ISO 8601, с часовым поясом в виде смещения от UTC</td></tr><tr><td><code class="literal">040506+0730</code></td><td>ISO 8601, с часовым поясом, задаваемым нецелочисленным смещением от UTC</td></tr><tr><td><code class="literal">040506+07:30:00</code></td><td>смещение от UTC, заданное до секунд (не допускается в ISO 8601)</td></tr><tr><td><code class="literal">04:05:06 PST</code></td><td>часовой пояс задаётся аббревиатурой</td></tr><tr><td><code class="literal">2003-04-12 04:05:06 America/New_York</code></td><td>часовой пояс задаётся полным названием</td></tr></tbody></table></div></div><br class="table-break" /><div class="table" id="DATATYPE-TIMEZONE-TABLE"><p class="title"><strong>Таблица 8.12. Вводимый часовой пояс</strong></p><div class="table-contents"><table class="table" summary="Вводимый часовой пояс" border="1"><colgroup><col /><col /></colgroup><thead><tr><th>Пример</th><th>Описание</th></tr></thead><tbody><tr><td><code class="literal">PST</code></td><td>аббревиатура (Pacific Standard Time, Стандартное тихоокеанское время)</td></tr><tr><td><code class="literal">America/New_York</code></td><td>полное название часового пояса</td></tr><tr><td><code class="literal">PST8PDT</code></td><td>указание часового пояса в стиле POSIX</td></tr><tr><td><code class="literal">-8:00:00</code></td><td>смещение часового пояса PST от UTC</td></tr><tr><td><code class="literal">-8:00</code></td><td>смещение часового пояса PST от UTC (расширенный формат ISO 8601)</td></tr><tr><td><code class="literal">-800</code></td><td>смещение часового пояса PST от UTC (стандартный формат ISO 8601)</td></tr><tr><td><code class="literal">-8</code></td><td>смещение часового пояса PST от UTC (стандартный формат ISO 8601)</td></tr><tr><td><code class="literal">zulu</code></td><td>принятое у военных сокращение UTC</td></tr><tr><td><code class="literal">z</code></td><td>краткая форма <code class="literal">zulu</code> (также определена в ISO 8601)</td></tr></tbody></table></div></div><br class="table-break" /><p>Подробнее узнать о том, как указывается часовой пояс, можно в <a class="xref" href="datatype-datetime.html#DATATYPE-TIMEZONES" title="8.5.3. Часовые пояса">Подразделе 8.5.3</a>.</p></div><div class="sect3" id="DATATYPE-DATETIME-INPUT-TIME-STAMPS"><div class="titlepage"><div><div><h4 class="title">8.5.1.3. Даты и время <a href="#DATATYPE-DATETIME-INPUT-TIME-STAMPS" class="id_link">#</a></h4></div></div></div><a id="id-1.5.7.13.18.7.2" class="indexterm"></a><a id="id-1.5.7.13.18.7.3" class="indexterm"></a><a id="id-1.5.7.13.18.7.4" class="indexterm"></a><p>Допустимые значения типов timestamp состоят из записи даты и времени, после которого может указываться часовой пояс и необязательное уточнение <code class="literal">AD</code> или <code class="literal">BC</code>, определяющее эпоху до нашей эры и нашу эру соответственно. (<code class="literal">AD</code>/<code class="literal">BC</code> можно указать и перед часовым поясом, но предпочтительнее первый вариант.) Таким образом: </p><pre class="programlisting">1999-01-08 04:05:06</pre><p> и </p><pre class="programlisting">1999-01-08 04:05:06 -8:00</pre><p> допустимые варианты, соответствующие стандарту <acronym class="acronym">ISO</acronym> 8601. В дополнение к этому поддерживается распространённый формат: </p><pre class="programlisting">January 8 04:05:06 1999 PST</pre><p>Стандарт <acronym class="acronym">SQL</acronym> различает константы типов <code class="type">timestamp without time zone</code> и <code class="type">timestamp with time zone</code> по знаку <span class="quote">«<span class="quote">+</span>»</span> или <span class="quote">«<span class="quote">-</span>»</span> и смещению часового пояса, добавленному после времени. Следовательно, согласно стандарту, записи </p><pre class="programlisting">TIMESTAMP '2004-10-19 10:23:54'</pre><p> должен соответствовать тип <code class="type">timestamp without time zone</code>, а </p><pre class="programlisting">TIMESTAMP '2004-10-19 10:23:54+02'</pre><p> тип <code class="type">timestamp with time zone</code>. <span class="productname">PostgreSQL</span> никогда не анализирует содержимое текстовой строки, чтобы определить тип значения, и поэтому обе записи будут обработаны как значения типа <code class="type">timestamp without time zone</code>. Чтобы текстовая константа обрабатывалась как <code class="type">timestamp with time zone</code>, укажите этот тип явно: </p><pre class="programlisting">TIMESTAMP WITH TIME ZONE '2004-10-19 10:23:54+02'</pre><p> В константе типа <code class="type">timestamp without time zone</code> <span class="productname">PostgreSQL</span> просто игнорирует часовой пояс. То есть результирующее значение вычисляется только из полей даты/времени и не подстраивается под указанный часовой пояс.</p><p>Значения <code class="type">timestamp with time zone</code> внутри всегда хранятся в UTC (Universal Coordinated Time, Всемирное скоординированное время или время по Гринвичу, <acronym class="acronym">GMT</acronym>). Вводимое значение, в котором явно указан часовой пояс, переводится в UTC с учётом смещения данного часового пояса. Если во входной строке не указан часовой пояс, подразумевается часовой пояс, заданный системным параметром <a class="xref" href="runtime-config-client.html#GUC-TIMEZONE">TimeZone</a> и время так же пересчитывается в UTC со смещением <code class="varname">timezone</code>.</p><p>Когда значение <code class="type">timestamp with time zone</code> выводится, оно всегда преобразуется из UTC в текущий часовой пояс <code class="varname">timezone</code> и отображается как локальное время. Чтобы получить время для другого часового пояса, нужно либо изменить <code class="varname">timezone</code>, либо воспользоваться конструкцией <code class="literal">AT TIME ZONE</code> (см. <a class="xref" href="functions-datetime.html#FUNCTIONS-DATETIME-ZONECONVERT" title="9.9.4. AT TIME ZONE">Подраздел 9.9.4</a>).</p><p>В преобразованиях между <code class="type">timestamp without time zone</code> и <code class="type">timestamp with time zone</code> обычно предполагается, что значение <code class="type">timestamp without time zone</code> содержит местное время (для часового пояса <code class="varname">timezone</code>). Другой часовой пояс для преобразования можно задать с помощью <code class="literal">AT TIME ZONE</code>.</p></div><div class="sect3" id="DATATYPE-DATETIME-SPECIAL-VALUES"><div class="titlepage"><div><div><h4 class="title">8.5.1.4. Специальные значения <a href="#DATATYPE-DATETIME-SPECIAL-VALUES" class="id_link">#</a></h4></div></div></div><a id="id-1.5.7.13.18.8.2" class="indexterm"></a><a id="id-1.5.7.13.18.8.3" class="indexterm"></a><p><span class="productname">PostgreSQL</span> для удобства поддерживает несколько специальных значений даты/времени, перечисленных в <a class="xref" href="datatype-datetime.html#DATATYPE-DATETIME-SPECIAL-TABLE" title="Таблица 8.13. Специальные значения даты/времени">Таблице 8.13</a>. Значения <code class="literal">infinity</code> и <code class="literal">-infinity</code> имеют особое представление в системе и они отображаются в том же виде, тогда как другие варианты при чтении преобразуются в значения даты/времени. (В частности, <code class="literal">now</code> и подобные строки преобразуются в актуальные значения времени в момент чтения.) Чтобы использовать эти значения в качестве констант в командах SQL, их нужно заключать в апострофы.</p><div class="table" id="DATATYPE-DATETIME-SPECIAL-TABLE"><p class="title"><strong>Таблица 8.13. Специальные значения даты/времени</strong></p><div class="table-contents"><table class="table" summary="Специальные значения даты/времени" border="1"><colgroup><col /><col /><col /></colgroup><thead><tr><th>Вводимая строка</th><th>Допустимые типы</th><th>Описание</th></tr></thead><tbody><tr><td><code class="literal">epoch</code></td><td><code class="type">date</code>, <code class="type">timestamp</code></td><td>1970-01-01 00:00:00+00 (точка отсчёта времени в Unix)</td></tr><tr><td><code class="literal">infinity</code></td><td><code class="type">date</code>, <code class="type">timestamp</code></td><td>время после максимальной допустимой даты</td></tr><tr><td><code class="literal">-infinity</code></td><td><code class="type">date</code>, <code class="type">timestamp</code></td><td>время до минимальной допустимой даты</td></tr><tr><td><code class="literal">now</code></td><td><code class="type">date</code>, <code class="type">time</code>, <code class="type">timestamp</code></td><td>время начала текущей транзакции</td></tr><tr><td><code class="literal">today</code></td><td><code class="type">date</code>, <code class="type">timestamp</code></td><td>время начала текущих суток (<code class="literal">00:00</code>)</td></tr><tr><td><code class="literal">tomorrow</code></td><td><code class="type">date</code>, <code class="type">timestamp</code></td><td>время начала следующих суток (<code class="literal">00:00</code>)</td></tr><tr><td><code class="literal">yesterday</code></td><td><code class="type">date</code>, <code class="type">timestamp</code></td><td>время начала предыдущих суток (<code class="literal">00:00</code>)</td></tr><tr><td><code class="literal">allballs</code></td><td><code class="type">time</code></td><td>00:00:00.00 UTC</td></tr></tbody></table></div></div><br class="table-break" /><p>Для получения текущей даты/времени соответствующего типа можно также использовать следующие <acronym class="acronym">SQL</acronym>-совместимые функции: <code class="literal">CURRENT_DATE</code>, <code class="literal">CURRENT_TIME</code>, <code class="literal">CURRENT_TIMESTAMP</code>, <code class="literal">LOCALTIME</code> и <code class="literal">LOCALTIMESTAMP</code>. (См. <a class="xref" href="functions-datetime.html#FUNCTIONS-DATETIME-CURRENT" title="9.9.5. Текущая дата/время">Подраздел 9.9.5</a>.) Заметьте, что во входных строках эти SQL-функции <span class="emphasis"><em>не</em></span> распознаются.</p><div class="caution"><h3 class="title">Внимание</h3><p>Входные значения <code class="literal">now</code>, <code class="literal">today</code>, <code class="literal">tomorrow</code> и <code class="literal">yesterday</code> вполне корректно работают в интерактивных SQL-командах, но когда команды сохраняются для последующего выполнения, например в подготовленных операторах, представлениях или определениях функций, их поведение может быть неожиданным. Такая строка может преобразоваться в конкретное значение времени, которое затем будет использоваться гораздо позже момента, когда оно было получено. В таких случаях следует использовать одну из SQL-функций. Например, <code class="literal">CURRENT_DATE + 1</code> будет работать надёжнее, чем <code class="literal">'tomorrow'::date</code>.</p></div></div></div><div class="sect2" id="DATATYPE-DATETIME-OUTPUT"><div class="titlepage"><div><div><h3 class="title">8.5.2. Вывод даты/времени <a href="#DATATYPE-DATETIME-OUTPUT" class="id_link">#</a></h3></div></div></div><a id="id-1.5.7.13.19.2" class="indexterm"></a><a id="id-1.5.7.13.19.3" class="indexterm"></a><p>В качестве выходного формата типов даты/времени можно использовать один из четырёх стилей: ISO 8601, <acronym class="acronym">SQL</acronym> (Ingres), традиционный формат <span class="productname">POSTGRES</span> (формат <span class="application">date</span> в Unix) или German. По умолчанию выбран формат <acronym class="acronym">ISO</acronym>. (Стандарт <acronym class="acronym">SQL</acronym> требует, чтобы использовался именно ISO 8601. Другой формат называется <span class="quote">«<span class="quote">SQL</span>»</span> исключительно по историческим причинам.) Примеры всех стилей вывода перечислены в <a class="xref" href="datatype-datetime.html#DATATYPE-DATETIME-OUTPUT-TABLE" title="Таблица 8.14. Стили вывода даты/время">Таблице 8.14</a>. Вообще со значениями типов <code class="type">date</code> и <code class="type">time</code> выводилась бы только часть даты или времени из показанных примеров, но со стилем <span class="productname">POSTGRES</span> значение даты без времени выводится в формате <acronym class="acronym">ISO</acronym>.</p><div class="table" id="DATATYPE-DATETIME-OUTPUT-TABLE"><p class="title"><strong>Таблица 8.14. Стили вывода даты/время</strong></p><div class="table-contents"><table class="table" summary="Стили вывода даты/время" border="1"><colgroup><col class="col1" /><col class="col2" /><col class="col3" /></colgroup><thead><tr><th>Стиль</th><th>Описание</th><th>Пример</th></tr></thead><tbody><tr><td><code class="literal">ISO</code></td><td>ISO 8601, стандарт SQL</td><td><code class="literal">1997-12-17 07:37:16-08</code></td></tr><tr><td><code class="literal">SQL</code></td><td>традиционный стиль</td><td><code class="literal">12/17/1997 07:37:16.00 PST</code></td></tr><tr><td><code class="literal">Postgres</code></td><td>изначальный стиль</td><td><code class="literal">Wed Dec 17 07:37:16 1997 PST</code></td></tr><tr><td><code class="literal">German</code></td><td>региональный стиль</td><td><code class="literal">17.12.1997 07:37:16.00 PST</code></td></tr></tbody></table></div></div><br class="table-break" /><div class="note"><h3 class="title">Примечание</h3><p>ISO 8601 указывает, что дата должна отделяться от времени буквой <code class="literal">T</code> в верхнем регистре. <span class="productname">PostgreSQL</span> принимает этот формат при вводе, но при выводе вставляет вместо <code class="literal">T</code> пробел, как показано выше. Это сделано для улучшения читаемости и для совместимости с <a class="ulink" href="https://datatracker.ietf.org/doc/html/rfc3339" target="_top">RFC 3339</a> и другими СУБД.</p></div><p>В стилях <acronym class="acronym">SQL</acronym> и POSTGRES день выводится перед месяцем, если установлен порядок DMY, а в противном случае месяц выводится перед днём. (Как этот параметр также влияет на интерпретацию входных значений, описано в <a class="xref" href="datatype-datetime.html#DATATYPE-DATETIME-INPUT" title="8.5.1. Ввод даты/времени">Подразделе 8.5.1</a>) Соответствующие примеры показаны в <a class="xref" href="datatype-datetime.html#DATATYPE-DATETIME-OUTPUT2-TABLE" title="Таблица 8.15. Соглашения о порядке компонентов даты">Таблице 8.15</a>.</p><div class="table" id="DATATYPE-DATETIME-OUTPUT2-TABLE"><p class="title"><strong>Таблица 8.15. Соглашения о порядке компонентов даты</strong></p><div class="table-contents"><table class="table" summary="Соглашения о порядке компонентов даты" border="1"><colgroup><col class="col1" /><col class="col2" /><col class="col3" /></colgroup><thead><tr><th>Параметр <code class="varname">datestyle</code></th><th>Порядок при вводе</th><th>Пример вывода</th></tr></thead><tbody><tr><td><code class="literal">SQL, DMY</code></td><td><em class="replaceable"><code>день</code></em>/<em class="replaceable"><code>месяц</code></em>/<em class="replaceable"><code>год</code></em></td><td><code class="literal">17/12/1997 15:37:16.00 CET</code></td></tr><tr><td><code class="literal">SQL, MDY</code></td><td><em class="replaceable"><code>месяц</code></em>/<em class="replaceable"><code>день</code></em>/<em class="replaceable"><code>год</code></em></td><td><code class="literal">12/17/1997 07:37:16.00 PST</code></td></tr><tr><td><code class="literal">Postgres, DMY</code></td><td><em class="replaceable"><code>день</code></em>/<em class="replaceable"><code>месяц</code></em>/<em class="replaceable"><code>год</code></em></td><td><code class="literal">Wed 17 Dec 07:37:16 1997 PST</code></td></tr></tbody></table></div></div><br class="table-break" /><p>В формате <acronym class="acronym">ISO</acronym> часовой пояс всегда отображается в виде числового смещения со знаком относительно всемирного координированного времени (UTC); для зон к востоку от Гринвича знак смещения положительный. Смещение будет отображаться как <em class="replaceable"><code>hh</code></em> (только часы), если оно задаётся целым числом часов, как <em class="replaceable"><code>hh</code></em>:<em class="replaceable"><code>mm</code></em>, если оно задаётся целым числом минут, или как <em class="replaceable"><code>hh</code></em>:<em class="replaceable"><code>mm</code></em>:<em class="replaceable"><code>ss</code></em>. (Третий вариант невозможен в современных стандартах часовых поясов, но он может понадобиться при работе с отметками времени, предшествующими принятию стандартизированных часовых поясов.) В других форматах даты часовой пояс отображается как буквенное сокращение, если оно принято в текущем поясе. В противном случае он отображается как числовое смещение со знаком в стандартном формате ISO 8601 (<em class="replaceable"><code>hh</code></em> или <em class="replaceable"><code>hhmm</code></em>).</p><p>Стиль даты/времени пользователь может выбрать с помощью команды <code class="command">SET datestyle</code>, параметра <a class="xref" href="runtime-config-client.html#GUC-DATESTYLE">DateStyle</a> в файле конфигурации <code class="filename">postgresql.conf</code> или переменной окружения <code class="envar">PGDATESTYLE</code> на сервере или клиенте.</p><p>Для большей гибкости при форматировании выводимой даты/времени можно использовать функцию <code class="function">to_char</code> (см. <a class="xref" href="functions-formatting.html" title="9.8. Функции форматирования данных">Раздел 9.8</a>).</p></div><div class="sect2" id="DATATYPE-TIMEZONES"><div class="titlepage"><div><div><h3 class="title">8.5.3. Часовые пояса <a href="#DATATYPE-TIMEZONES" class="id_link">#</a></h3></div></div></div><a id="id-1.5.7.13.20.2" class="indexterm"></a><p>Часовые пояса и правила их применения определяются, как вы знаете, не только по географическим, но и по политическим соображениям. Часовые пояса во всём мире были более-менее стандартизированы в начале прошлого века, но они продолжают претерпевать изменения, в частности это касается перехода на летнее время. Для расчёта времени в прошлом <span class="productname">PostgreSQL</span> получает исторические сведения о правилах часовых поясов из распространённой базы данных IANA (Olson). Для будущего времени предполагается, что в заданном часовом поясе будут продолжать действовать последние принятые правила.</p><p><span class="productname">PostgreSQL</span> стремится к совместимости со стандартом <acronym class="acronym">SQL</acronym> в наиболее типичных случаях. Однако стандарт <acronym class="acronym">SQL</acronym> допускает некоторые странности при смешивании типов даты и времени. Две очевидные проблемы: </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Хотя для типа <code class="type">date</code> часовой пояс указать нельзя, это можно сделать для типа <code class="type">time</code>. В реальности это не очень полезно, так как без даты нельзя точно определить смещение при переходе на летнее время.</p></li><li class="listitem"><p>По умолчанию часовой пояс задаётся постоянным смещением от <acronym class="acronym">UTC</acronym>. Это также не позволяет учесть летнее время при арифметических операций с датами, пересекающими границы летнего времени.</p></li></ul></div><p>Поэтому мы советуем использовать часовой пояс с типами, включающими и время, и дату. Мы <span class="emphasis"><em>не</em></span> рекомендуем использовать тип <code class="type">time with time zone</code> (хотя <span class="productname">PostgreSQL</span> поддерживает его для старых приложений и совместимости со стандартом <acronym class="acronym">SQL</acronym>). Для типов, включающих только дату или только время, в <span class="productname">PostgreSQL</span> предполагается местный часовой пояс.</p><p>Все значения даты и времени с часовым поясом представляются внутри в <acronym class="acronym">UTC</acronym>, а при передаче клиентскому приложению они переводятся в местное время, при этом часовой пояс по умолчанию определяется параметром конфигурации <a class="xref" href="runtime-config-client.html#GUC-TIMEZONE">TimeZone</a>.</p><p><span class="productname">PostgreSQL</span> позволяет задать часовой пояс тремя способами: </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Полное название часового пояса, например <code class="literal">America/New_York</code>. Все допустимые названия перечислены в представлении <code class="literal">pg_timezone_names</code> (см. <a class="xref" href="view-pg-timezone-names.html" title="54.32. pg_timezone_names">Раздел 54.32</a>). Определения часовых поясов <span class="productname">PostgreSQL</span> берёт из широко распространённой базы IANA, так что имена часовых поясов PostgreSQL будут воспринимать и другие приложения.</p></li><li class="listitem"><p>Аббревиатура часового пояса, например <code class="literal">PST</code>. Такое определение просто задаёт смещение от UTC, в отличие от полных названий поясов, которые кроме того подразумевают и правила перехода на летнее время. Распознаваемые аббревиатуры перечислены в представлении <code class="literal">pg_timezone_abbrevs</code> (см. <a class="xref" href="view-pg-timezone-abbrevs.html" title="54.31. pg_timezone_abbrevs">Раздел 54.31</a>). Аббревиатуры можно использовать во вводимых значениях даты/времени и в операторе <code class="literal">AT TIME ZONE</code>, но не в параметрах конфигурации <a class="xref" href="runtime-config-client.html#GUC-TIMEZONE">TimeZone</a> и <a class="xref" href="runtime-config-logging.html#GUC-LOG-TIMEZONE">log_timezone</a>.</p></li><li class="listitem"><p>Помимо аббревиатур и названий часовых поясов <span class="productname">PostgreSQL</span> принимает указания часовых поясов в стиле POSIX, как описано в <a class="xref" href="datetime-posix-timezone-specs.html" title="B.5. Указание часовых поясов в стиле POSIX">Разделе B.5</a>. Этот вариант обычно менее предпочтителен, чем использование именованного часового пояса, но он может быть единственным возможным, если для нужного часового пояса нет записи в базе данных IANA.</p></li></ul></div><p> Вкратце, различие между аббревиатурами и полными названиями заключаются в следующем: аббревиатуры представляют определённый сдвиг от UTC, а полное название подразумевает ещё и местное правило по переходу на летнее время, то есть, возможно, два сдвига от UTC. Например, <code class="literal">2014-06-04 12:00 America/New_York</code> представляет полдень по местному времени в Нью-Йорк, что для данного дня было бы летним восточным временем (EDT или UTC-4). Так что <code class="literal">2014-06-04 12:00 EDT</code> обозначает тот же момент времени. Но <code class="literal">2014-06-04 12:00 EST</code> задаёт стандартное восточное время (UTC-5), не зависящее о того, действовало ли летнее время в этот день.</p><p>Мало того, в некоторых юрисдикциях одна и та же аббревиатура часового пояса означала разные сдвиги UTC в разное время; например, аббревиатура московского времени <code class="literal">MSK</code> несколько лет означала UTC+3, а затем стала означать UTC+4. <span class="productname">PostgreSQL</span> обрабатывает такие аббревиатуры в соответствии с их значениями на заданную дату, но, как и с примером выше <code class="literal">EST</code>, это не обязательно будет соответствовать местному гражданскому времени в этот день.</p><p>Независимо от формы, регистр в названиях и аббревиатурах часовых поясов не важен. (В <span class="productname">PostgreSQL</span> до версии 8.2 он где-то имел значение, а где-то нет.)</p><p>Ни названия, ни аббревиатуры часовых поясов, не зашиты в самом сервере; они считываются из файлов конфигурации, находящихся в путях <code class="filename">.../share/timezone/</code> и <code class="filename">.../share/timezonesets/</code> относительно каталога установки (см. <a class="xref" href="datetime-config-files.html" title="B.4. Файлы конфигурации даты/времени">Раздел B.4</a>).</p><p>Параметр конфигурации <a class="xref" href="runtime-config-client.html#GUC-TIMEZONE">TimeZone</a> можно установить в <code class="filename">postgresql.conf</code> или любым другим стандартным способом, описанным в <a class="xref" href="runtime-config.html" title="Глава 20. Настройка сервера">Главе 20</a>. Часовой пояс может быть также определён следующими специальными способами: </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Часовой пояс для текущего сеанса можно установить с помощью <acronym class="acronym">SQL</acronym>-команды <code class="command">SET TIME ZONE</code>. Это альтернативная запись команды <code class="command">SET TIMEZONE TO</code>, более соответствующая SQL-стандарту.</p></li><li class="listitem"><p>Если установлена переменная окружения <code class="envar">PGTZ</code>, клиенты <span class="application">libpq</span> используют её значение, выполняя при подключении к серверу команду <code class="command">SET TIME ZONE</code>.</p></li></ul></div></div><div class="sect2" id="DATATYPE-INTERVAL-INPUT"><div class="titlepage"><div><div><h3 class="title">8.5.4. Ввод интервалов <a href="#DATATYPE-INTERVAL-INPUT" class="id_link">#</a></h3></div></div></div><a id="id-1.5.7.13.21.2" class="indexterm"></a><p>Значения типа <code class="type">interval</code> могут быть записаны в следующей расширенной форме: </p><pre class="synopsis">
[<span class="optional">@</span>] <em class="replaceable"><code>количество</code></em> <em class="replaceable"><code>единица</code></em> [<span class="optional"><em class="replaceable"><code>количество</code></em> <em class="replaceable"><code>единица</code></em>...</span>] [<span class="optional"><em class="replaceable"><code>направление</code></em></span>]
</pre><p> где <em class="replaceable"><code>количество</code></em> — это число (возможно, со знаком); <em class="replaceable"><code>единица</code></em> — одно из значений: <code class="literal">microsecond</code>, <code class="literal">millisecond</code>, <code class="literal">second</code>, <code class="literal">minute</code>, <code class="literal">hour</code>, <code class="literal">day</code>, <code class="literal">week</code>, <code class="literal">month</code>, <code class="literal">year</code>, <code class="literal">decade</code>, <code class="literal">century</code>, <code class="literal">millennium</code> (которые обозначают соответственно микросекунды, миллисекунды, секунды, минуты, часы, дни, недели, месяцы, годы, десятилетия, века и тысячелетия), либо эти же слова во множественном числе, либо их сокращения; <em class="replaceable"><code>направление</code></em> может принимать значение <code class="literal">ago</code> (назад) или быть пустым. Знак <code class="literal">@</code> является необязательным. Все заданные величины различных единиц суммируются вместе с учётом знака чисел. Указание <code class="literal">ago</code> меняет знак всех полей на противоположный. Этот синтаксис также используется при выводе интервала, если параметр <a class="xref" href="runtime-config-client.html#GUC-INTERVALSTYLE">IntervalStyle</a> имеет значение <code class="literal">postgres_verbose</code>.</p><p>Количества дней, часов, минут и секунд можно определить, не указывая явно соответствующие единицы. Например, запись <code class="literal">'1 12:59:10'</code> равнозначна <code class="literal">'1 day 12 hours 59 min 10 sec'</code>. Сочетание года и месяца также можно записать через минус; например <code class="literal">'200-10'</code> означает то, же что и <code class="literal">'200 years 10 months'</code>. (На самом деле только эти краткие формы разрешены стандартом <acronym class="acronym">SQL</acronym> и они используются при выводе, когда <code class="varname">IntervalStyle</code> имеет значение <code class="literal">sql_standard</code>.)</p><p>Интервалы можно также записывать в виде, определённом в ISO 8601, либо в <span class="quote">«<span class="quote">формате с кодами</span>»</span>, описанном в разделе 4.4.3.2 этого стандарта, либо в <span class="quote">«<span class="quote">альтернативном формате</span>»</span>, описанном в разделе 4.4.3.3. Формат с кодами выглядит так: </p><pre class="synopsis">
P <em class="replaceable"><code>количество</code></em> <em class="replaceable"><code>единица</code></em> [<span class="optional"> <em class="replaceable"><code>количество</code></em> <em class="replaceable"><code>единица</code></em> ...</span>] [<span class="optional"> T [<span class="optional"> <em class="replaceable"><code>количество</code></em> <em class="replaceable"><code>единица</code></em> ...</span>]</span>]
</pre><p> Строка должна начинаться с символа <code class="literal">P</code> и может включать также <code class="literal">T</code> перед временем суток. Допустимые коды единиц перечислены в <a class="xref" href="datatype-datetime.html#DATATYPE-INTERVAL-ISO8601-UNITS" title="Таблица 8.16. Коды единиц временных интервалов ISO 8601">Таблице 8.16</a>. Коды единиц можно опустить или указать в любом порядке, но компоненты времени суток должны идти после символа <code class="literal">T</code>. В частности, значение кода <code class="literal">M</code> зависит от того, располагается ли он до или после <code class="literal">T</code>.</p><div class="table" id="DATATYPE-INTERVAL-ISO8601-UNITS"><p class="title"><strong>Таблица 8.16. Коды единиц временных интервалов ISO 8601</strong></p><div class="table-contents"><table class="table" summary="Коды единиц временных интервалов ISO 8601" border="1"><colgroup><col /><col /></colgroup><thead><tr><th>Код</th><th>Значение</th></tr></thead><tbody><tr><td>Y</td><td>годы</td></tr><tr><td>M</td><td>месяцы (в дате)</td></tr><tr><td>W</td><td>недели</td></tr><tr><td>D</td><td>дни</td></tr><tr><td>H</td><td>часы</td></tr><tr><td>M</td><td>минуты (во времени)</td></tr><tr><td>S</td><td>секунды</td></tr></tbody></table></div></div><br class="table-break" /><p>В альтернативном формате: </p><pre class="synopsis">
P [<span class="optional"> <em class="replaceable"><code>год</code></em>-<em class="replaceable"><code>месяц</code></em>-<em class="replaceable"><code>день</code></em> </span>] [<span class="optional"> T <em class="replaceable"><code>часы</code></em>:<em class="replaceable"><code>минуты</code></em>:<em class="replaceable"><code>секунды</code></em> </span>]
</pre><p> строка должна начинаться с <code class="literal">P</code>, а <code class="literal">T</code> разделяет компоненты даты и времени. Значения выражаются числами так же, как и в датах ISO 8601.</p><p>При записи интервальной константы с указанием <em class="replaceable"><code>полей</code></em> или присваивании столбцу типа interval строки с <em class="replaceable"><code>полями</code></em>, интерпретация непомеченных величин зависит от <em class="replaceable"><code>полей</code></em>. Например, <code class="literal">INTERVAL '1' YEAR</code> воспринимается как 1 год, а <code class="literal">INTERVAL '1'</code> — как 1 секунда. Кроме того, значения <span class="quote">«<span class="quote">справа</span>»</span> от меньшего значащего поля, заданного в определении <em class="replaceable"><code>полей</code></em>, просто отбрасываются. Например, в записи <code class="literal">INTERVAL '1 day 2:03:04' HOUR TO MINUTE</code> будут отброшены секунды, но не день.</p><p>Согласно стандарту <acronym class="acronym">SQL</acronym>, все компоненты значения interval должны быть одного знака, и ведущий минус применяется ко всем компонентам; например, минус в записи <code class="literal">'-1 2:03:04'</code> применяется и к дню, и к часам/минутам/секундам. <span class="productname">PostgreSQL</span> позволяет задавать для разных компонентов разные знаки и традиционно обрабатывает знак каждого компонента в текстовом представлении отдельно от других, так что в данном случае часы/минуты/секунды будут считаться положительными. Если параметр <code class="varname">IntervalStyle</code> имеет значение <code class="literal">sql_standard</code>, ведущий знак применяется ко всем компонентам (но только если они не содержат знаки явно). В противном случае действуют традиционные правила <span class="productname">PostgreSQL</span>. Во избежание неоднозначности рекомендуется добавлять знак к каждому компоненту с отрицательным значением.</p><p>Значения <code class="type">interval</code> хранятся в виде трёх целочисленных полей: месяцы, дни и микросекунды. Эти поля хранятся отдельно, поскольку количество дней в месяце варьируется, а день может состоять из 23 или 25 часов при переходе на летнее/зимнее время. Входная строка интервала, в которой используются другие единицы измерения, нормализуется в этот формат, а затем стандартизированным образом реконструируется для вывода, например: </p><pre class="programlisting">SELECT '2 years 15 months 100 weeks 99 hours 123456789 milliseconds'::interval;
               interval
---------------------------------------
 3 years 3 mons 700 days 133:17:36.789</pre><p> Здесь недели, под которыми понимаются <span class="quote">«<span class="quote">7 дней</span>»</span>, были сохранены отдельно, а меньшие и большие единицы измерения времени были объединены и нормализованы.</p><p>Значения полей могут содержать дробную часть, например <code class="literal">'1.5 weeks'</code> или <code class="literal">'01:02:03.45'</code>. Однако поскольку <code class="type">interval</code> содержит только целые единицы, дробные значения должны быть преобразованы в более мелкие единицы. Дробные части единиц, превышающих месяцы, округляются до целого числа месяцев, например <code class="literal">'1.5 years'</code> преобразуется в <code class="literal">'1 year 6 mons'</code>. Дробные части недель и дней пересчитываются в целое число дней и микросекунд, из расчёта, что в месяце 30 дней, а в сутках — 24 часа, например, <code class="literal">'1.75 months'</code> становится <code class="literal">1 mon 22 days 12:00:00</code>. На выходе только секунды могут иметь дробную часть.</p><p>В <a class="xref" href="datatype-datetime.html#DATATYPE-INTERVAL-INPUT-EXAMPLES" title="Таблица 8.17. Ввод интервалов">Таблице 8.17</a> показано несколько примеров допустимых вводимых значений типа <code class="type">interval</code>.</p><div class="table" id="DATATYPE-INTERVAL-INPUT-EXAMPLES"><p class="title"><strong>Таблица 8.17. Ввод интервалов</strong></p><div class="table-contents"><table class="table" summary="Ввод интервалов" border="1"><colgroup><col /><col /></colgroup><thead><tr><th>Пример</th><th>Описание</th></tr></thead><tbody><tr><td><code class="literal">1-2</code></td><td>Стандартный формат SQL: 1 год и 2 месяца</td></tr><tr><td><code class="literal">3 4:05:06</code></td><td>Стандартный формат SQL: 3 дня 4 часа 5 минут 6 секунд</td></tr><tr><td><code class="literal">1 year 2 months 3 days 4 hours 5 minutes 6 seconds</code></td><td>Традиционный формат Postgres: 1 год 2 месяца 3 дня 4 часа 5 минут 6 секунд</td></tr><tr><td><code class="literal">P1Y2M3DT4H5M6S</code></td><td><span class="quote">«<span class="quote">Формат с кодами</span>»</span> ISO 8601: то же значение, что и выше</td></tr><tr><td><code class="literal">P0001-02-03T04:05:06</code></td><td><span class="quote">«<span class="quote">Альтернативный формат</span>»</span> ISO 8601: то же значение, что и выше</td></tr></tbody></table></div></div><br class="table-break" /></div><div class="sect2" id="DATATYPE-INTERVAL-OUTPUT"><div class="titlepage"><div><div><h3 class="title">8.5.5. Вывод интервалов <a href="#DATATYPE-INTERVAL-OUTPUT" class="id_link">#</a></h3></div></div></div><a id="id-1.5.7.13.22.2" class="indexterm"></a><p>Как объяснялось ранее, <span class="productname">PostgreSQL</span> хранит значения <code class="type">interval</code> в виде месяцев, дней и микросекунд. При выводе значение месяцев преобразуется в годы и месяцы путём деления на 12. Значение в днях отображается как есть. Значение в микросекундах преобразуется в часы, минуты, секунды и доли секунды. Таким образом, месяцы, минуты и секунды никогда не будут выводиться вне диапазонов 0–11, 0–59 и 0–59 соответственно, тогда как отображаемые значения в годах, днях и часах могут быть довольно большими. (Чтобы перенести большие значения дней и часов в следующее поле, можно использовать функции <a class="link" href="functions-datetime.html#FUNCTION-JUSTIFY-DAYS"><code class="function">justify_days</code></a> и <a class="link" href="functions-datetime.html#FUNCTION-JUSTIFY-HOURS"><code class="function">justify_hours</code></a>.)</p><p>Формат вывода типа interval может определяться одним из четырёх стилей: <code class="literal">sql_standard</code>, <code class="literal">postgres</code>, <code class="literal">postgres_verbose</code> и <code class="literal">iso_8601</code>. Выбрать нужный стиль позволяет команда <code class="literal">SET intervalstyle</code> (по умолчанию выбран <code class="literal">postgres</code>). Примеры форматов разных стилей показаны в <a class="xref" href="datatype-datetime.html#INTERVAL-STYLE-OUTPUT-TABLE" title="Таблица 8.18. Примеры стилей вывода интервалов">Таблице 8.18</a>.</p><p>Стиль <code class="literal">sql_standard</code> выдаёт результат, соответствующий стандарту SQL, если значение интервала удовлетворяет ограничениям стандарта (и содержит либо только год и месяц, либо только день и время, и при этом все его компоненты одного знака). В противном случае выводится год-месяц, за которым идёт дата-время, а в компоненты для однозначности явно добавляются знаки.</p><p>Вывод в стиле <code class="literal">postgres</code> соответствует формату, который был принят в <span class="productname">PostgreSQL</span> до версии 8.4, когда параметр <a class="xref" href="runtime-config-client.html#GUC-DATESTYLE">DateStyle</a> имел значение <code class="literal">ISO</code>.</p><p>Вывод в стиле <code class="literal">postgres_verbose</code> соответствует формату, который был принят в <span class="productname">PostgreSQL</span> до версии 8.4, когда значением параметром <code class="varname">DateStyle</code> было не <code class="literal">ISO</code>.</p><p>Вывод в стиле <code class="literal">iso_8601</code> соответствует <span class="quote">«<span class="quote">формату с кодами</span>»</span> описанному в разделе 4.4.3.2 формата ISO 8601.</p><div class="table" id="INTERVAL-STYLE-OUTPUT-TABLE"><p class="title"><strong>Таблица 8.18. Примеры стилей вывода интервалов</strong></p><div class="table-contents"><table class="table" summary="Примеры стилей вывода интервалов" border="1"><colgroup><col /><col /><col /><col /></colgroup><thead><tr><th>Стиль</th><th>Интервал год-месяц</th><th>Интервал день-время</th><th>Смешанный интервал</th></tr></thead><tbody><tr><td><code class="literal">sql_standard</code></td><td>1-2</td><td>3 4:05:06</td><td>-1-2 +3 -4:05:06</td></tr><tr><td><code class="literal">postgres</code></td><td>1 year 2 mons</td><td>3 days 04:05:06</td><td>-1 year -2 mons +3 days -04:05:06</td></tr><tr><td><code class="literal">postgres_verbose</code></td><td>@ 1 year 2 mons</td><td>@ 3 days 4 hours 5 mins 6 secs</td><td>@ 1 year 2 mons -3 days 4 hours 5 mins 6 secs ago</td></tr><tr><td><code class="literal">iso_8601</code></td><td>P1Y2M</td><td>P3DT4H5M6S</td><td>P-1Y-2M3D​T-4H-5M-6S</td></tr></tbody></table></div></div><br class="table-break" /></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="datatype-binary.html" title="8.4. Двоичные типы данных">Пред.</a> </td><td width="20%" align="center"><a accesskey="u" href="datatype.html" title="Глава 8. Типы данных">Наверх</a></td><td width="40%" align="right"> <a accesskey="n" href="datatype-boolean.html" title="8.6. Логический тип">След.</a></td></tr><tr><td width="40%" align="left" valign="top">8.4. Двоичные типы данных </td><td width="20%" align="center"><a accesskey="h" href="index.html" title="Документация к PostgreSQL 16.3">Начало</a></td><td width="40%" align="right" valign="top"> 8.6. Логический тип</td></tr></table></div></body></html>