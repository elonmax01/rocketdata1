<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>CREATE EXTENSION</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@lists.postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot" /><link rel="prev" href="sql-createeventtrigger.html" title="CREATE EVENT TRIGGER" /><link rel="next" href="sql-createforeigndatawrapper.html" title="CREATE FOREIGN DATA WRAPPER" /></head><body id="docContent" class="container-fluid col-10"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">CREATE EXTENSION</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="sql-createeventtrigger.html" title="CREATE EVENT TRIGGER">Пред.</a> </td><td width="10%" align="left"><a accesskey="u" href="sql-commands.html" title="Команды SQL">Наверх</a></td><th width="60%" align="center">Команды SQL</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="Документация к PostgreSQL 16.3">Начало</a></td><td width="10%" align="right"> <a accesskey="n" href="sql-createforeigndatawrapper.html" title="CREATE FOREIGN DATA WRAPPER">След.</a></td></tr></table><hr /></div><div class="refentry" id="SQL-CREATEEXTENSION"><div class="titlepage"></div><a id="id-1.9.3.64.1" class="indexterm"></a><div class="refnamediv"><h2><span class="refentrytitle">CREATE EXTENSION</span></h2><p>CREATE EXTENSION — установить расширение</p></div><div class="refsynopsisdiv"><h2>Синтаксис</h2><pre class="synopsis">CREATE EXTENSION [ IF NOT EXISTS ] <em class="replaceable"><code>имя_расширения</code></em>
    [ WITH ] [ SCHEMA <em class="replaceable"><code>имя_схемы</code></em> ]
             [ VERSION <em class="replaceable"><code>версия</code></em> ]
             [ CASCADE ]</pre></div><div class="refsect1" id="id-1.9.3.64.5"><h2>Описание</h2><p><code class="command">CREATE EXTENSION</code> загружает в текущую базу данных новое расширение. Расширение с таким именем не должно быть уже загружено.</p><p>Загрузка расширения по сути сводится к запуску скрипта расширения. Этот скрипт обычно создаёт новые <acronym class="acronym">SQL</acronym>-объекты, такие как функции, типы данных, операторы и методы поддержки индексов. <code class="command">CREATE EXTENSION</code> дополнительно записывает идентификаторы всех добавляемых объектов, так что впоследствии их можно удалить, выполнив команду <code class="command">DROP EXTENSION</code>.</p><p>Пользователь, выполняющий <code class="command">CREATE EXTENSION</code>, становится владельцем самого расширения, что определяет его права в дальнейшем, а также обычно он становится владельцем всех объектов, созданных скриптом расширения.</p><p>Для загрузки расширения как правило требуются те же права, что необходимы для создания составляющих его объектов. Для многих расширений это означает, что необходимы права суперпользователя. Однако если расширение помечено как <code class="literal">trusted</code> (<em class="firstterm">доверенное</em>) в своём управляющем файле, его может установить любой пользователь, имеющий в базе данных право <code class="literal">CREATE</code>. В этом случае сам объект расширения будет принадлежать вызывающему пользователю, но владельцем содержащихся в нём объектов будет начальный суперпользователь (если только вызывающий пользователь не назначается их владельцем в скрипте расширения). Такая схема даёт вызывающему пользователю возможность удалить расширение, но не модифицировать отдельные объекты внутри него.</p></div><div class="refsect1" id="id-1.9.3.64.6"><h2>Параметры</h2><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">IF NOT EXISTS</code></span></dt><dd><p>Не считать ошибкой, если расширение с таким именем уже существует. В этом случае будет выдано замечание. Заметьте, что нет никакой гарантии, что существующее расширение как-то соотносится с тем, которое могло бы быть создано из указанного скрипта.</p></dd><dt><span class="term"><em class="replaceable"><code>имя_расширения</code></em></span></dt><dd><p>Имя устанавливаемого расширения. <span class="productname">PostgreSQL</span> создаст расширение, используя инструкции из файла <code class="literal">SHAREDIR/extension/</code><em class="replaceable"><code>имя_расширения</code></em><code class="literal">.control</code>.</p></dd><dt><span class="term"><em class="replaceable"><code>имя_схемы</code></em></span></dt><dd><p>Имя схемы, в которую будут установлены объекты расширения (подразумевается, что расширение позволяет управлять размещением своих объектов). Указанная схема должна уже существовать. Если имя не указано и в управляющем файле расширения оно так же не задано, для создания объектов используется текущая схема.</p><p>Если в управляющем файле расширения задаётся параметр <code class="literal">schema</code>, заданную схему нельзя переопределить предложением <code class="literal">SCHEMA</code>. Обычно при указании предложения <code class="literal">SCHEMA</code> возникает ошибка, если эта схема конфликтует с параметром <code class="literal">schema</code> данного расширения. Однако если также задаётся предложение <code class="literal">CASCADE</code>, в случае конфликта <em class="replaceable"><code>имя_схемы</code></em> игнорируется. Заданное <em class="replaceable"><code>имя_схемы</code></em> будет использоваться для установки всех необходимых расширений, в управляющих файлах которых не задаётся <code class="literal">schema</code>.</p><p>Помните, что само расширение не считается принадлежащим какой-либо схеме; имена расширений не дополняются схемой и потому должны быть уникальными во всей базе данных. Однако объекты, принадлежащие расширениям, могут относиться к схемам.</p></dd><dt><span class="term"><em class="replaceable"><code>версия</code></em></span></dt><dd><p>Версия устанавливаемого расширения. Её можно записать в виде идентификатора или строкового значения. По умолчанию версия считывается из управляющего файла расширения.</p></dd><dt><span class="term"><code class="literal">CASCADE</code></span></dt><dd><p>Автоматически устанавливать все расширения, от которого зависит данное, если они ещё не установлены. Их зависимости подобным образом рекурсивно устанавливаются автоматически. Предложение <code class="literal">SCHEMA</code>, если задано, применяется ко всем расширениям, устанавливаемым таким способом. Другие параметры оператора к автоматически устанавливаемым расширениям не применяются; в частности, всегда выбираются их версии по умолчанию.</p></dd></dl></div></div><div class="refsect1" id="id-1.9.3.64.7"><h2>Замечания</h2><p>Прежде чем вы сможете выполнить <code class="command">CREATE EXTENSION</code> и загрузить расширение в базу данных, необходимо правильно установить сопутствующие файлы расширения. Информацию об установке расширений, поставляемых в составе <span class="productname">PostgreSQL</span>, можно найти по ссылке <a class="link" href="contrib.html" title="Приложение F. Дополнительно поставляемые модули и расширения">Дополнительные поставляемые модули</a>.</p><p>Расширения, доступные для установки в данный момент, можно найти в системном представлении <a class="link" href="view-pg-available-extensions.html" title="54.2. pg_available_extensions"><code class="structname">pg_available_extensions</code></a> или <a class="link" href="view-pg-available-extension-versions.html" title="54.3. pg_available_extension_versions"><code class="structname">pg_available_extension_versions</code></a>.</p><div class="caution"><h3 class="title">Внимание</h3><p>Устанавливая расширение от имени суперпользователя, важно иметь уверенность в том, что автор расширения написал установочный скрипт безопасным образом. Для злонамеренного пользователя не составит большого труда создать объект типа троянского коня, который впоследствии скомпрометирует выполнение неаккуратно написанного скрипта расширения и позволит этому пользователю стать суперпользователем. Однако такие объекты опасны, только если они находятся в пути <code class="varname">search_path</code> во время выполнения скрипта, то есть, если они находятся в схеме, в которую устанавливается расширение, или в схеме, где располагается другое расширение, от которого зависит первое. Таким образом, имея дело с расширениями, скрипты которых не были тщательно проверены, рекомендуется устанавливать их только в те схемы, в которых недоверенные пользователи не имеют и не будут иметь права CREATE. То же самое касается их зависимостей, других расширений.</p><p>Расширения, поставляемые в составе <span class="productname">PostgreSQL</span>, можно считать защищёнными от подобного рода атак времени выполнения, за исключением некоторых, зависящих от других расширений. Как отмечается в документации таких расширений, их следует устанавливать в безопасные схемы и/или в те же схемы, в которые устанавливаются требующиеся им расширения.</p></div><p>За информацией для разработчиков расширений обратитесь к <a class="xref" href="extend-extensions.html" title="38.17. Упаковывание связанных объектов в расширение">Разделу 38.17</a>.</p></div><div class="refsect1" id="id-1.9.3.64.8"><h2>Примеры</h2><p>Установка расширения <a class="link" href="hstore.html" title="F.18. hstore — тип данных hstore для хранения пар ключ-значение">hstore</a> в текущую базу данных (при этом объекты расширения размещаются в схеме <code class="literal">addons</code>): </p><pre class="programlisting">CREATE EXTENSION hstore SCHEMA addons;</pre><p> Другой способ сделать то же самое: </p><pre class="programlisting">SET search_path = addons;
CREATE EXTENSION hstore;</pre></div><div class="refsect1" id="id-1.9.3.64.9"><h2>Совместимость</h2><p><code class="command">CREATE EXTENSION</code> является расширением <span class="productname">PostgreSQL</span>.</p></div><div class="refsect1" id="id-1.9.3.64.10"><h2>См. также</h2><span class="simplelist"><a class="xref" href="sql-alterextension.html" title="ALTER EXTENSION"><span class="refentrytitle">ALTER EXTENSION</span></a>, <a class="xref" href="sql-dropextension.html" title="DROP EXTENSION"><span class="refentrytitle">DROP EXTENSION</span></a></span></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="sql-createeventtrigger.html" title="CREATE EVENT TRIGGER">Пред.</a> </td><td width="20%" align="center"><a accesskey="u" href="sql-commands.html" title="Команды SQL">Наверх</a></td><td width="40%" align="right"> <a accesskey="n" href="sql-createforeigndatawrapper.html" title="CREATE FOREIGN DATA WRAPPER">След.</a></td></tr><tr><td width="40%" align="left" valign="top">CREATE EVENT TRIGGER </td><td width="20%" align="center"><a accesskey="h" href="index.html" title="Документация к PostgreSQL 16.3">Начало</a></td><td width="40%" align="right" valign="top"> CREATE FOREIGN DATA WRAPPER</td></tr></table></div></body></html>