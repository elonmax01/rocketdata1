<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>F.28. pgcrypto — криптографические функции</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@lists.postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot" /><link rel="prev" href="pgbuffercache.html" title="F.27. pg_buffercache — информация о состоянии буферного кеша PostgreSQL" /><link rel="next" href="pgfreespacemap.html" title="F.29. pg_freespacemap — просмотр карты свободного пространства" /></head><body id="docContent" class="container-fluid col-10"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">F.28. pgcrypto — криптографические функции</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="pgbuffercache.html" title="F.27. pg_buffercache — информация о состоянии буферного кеша PostgreSQL">Пред.</a> </td><td width="10%" align="left"><a accesskey="u" href="contrib.html" title="Приложение F. Дополнительно поставляемые модули и расширения">Наверх</a></td><th width="60%" align="center">Приложение F. Дополнительно поставляемые модули и расширения</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="Документация к PostgreSQL 16.3">Начало</a></td><td width="10%" align="right"> <a accesskey="n" href="pgfreespacemap.html" title="F.29. pg_freespacemap — просмотр карты свободного пространства">След.</a></td></tr></table><hr /></div><div class="sect1" id="PGCRYPTO"><div class="titlepage"><div><div><h2 class="title" style="clear: both">F.28. pgcrypto — криптографические функции <a href="#PGCRYPTO" class="id_link">#</a></h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="sect2"><a href="pgcrypto.html#PGCRYPTO-GENERAL-HASHING-FUNCS">F.28.1. Стандартные функции хеширования</a></span></dt><dt><span class="sect2"><a href="pgcrypto.html#PGCRYPTO-PASSWORD-HASHING-FUNCS">F.28.2. Функции хеширования пароля</a></span></dt><dt><span class="sect2"><a href="pgcrypto.html#PGCRYPTO-PGP-ENC-FUNCS">F.28.3. Функции шифрования на базе PGP</a></span></dt><dt><span class="sect2"><a href="pgcrypto.html#PGCRYPTO-RAW-ENC-FUNCS">F.28.4. Низкоуровневые функции шифрования</a></span></dt><dt><span class="sect2"><a href="pgcrypto.html#PGCRYPTO-RANDOM-DATA-FUNCS">F.28.5. Функции получения случайных данных</a></span></dt><dt><span class="sect2"><a href="pgcrypto.html#PGCRYPTO-NOTES">F.28.6. Замечания</a></span></dt><dt><span class="sect2"><a href="pgcrypto.html#PGCRYPTO-AUTHOR">F.28.7. Автор</a></span></dt></dl></div><a id="id-1.11.7.38.2" class="indexterm"></a><a id="id-1.11.7.38.3" class="indexterm"></a><p>Модуль <code class="filename">pgcrypto</code> предоставляет криптографические функции для <span class="productname">PostgreSQL</span>.</p><p>Данный модуль считается <span class="quote">«<span class="quote">доверенным</span>»</span>, то есть его могут устанавливать обычные пользователи, имеющие право <code class="literal">CREATE</code> в текущей базе данных.</p><p>Для работы <code class="filename">pgcrypto</code> требуется OpenSSL — модуль не будет установлен, если PostgreSQL был собран без OpenSSL.</p><div class="sect2" id="PGCRYPTO-GENERAL-HASHING-FUNCS"><div class="titlepage"><div><div><h3 class="title">F.28.1. Стандартные функции хеширования <a href="#PGCRYPTO-GENERAL-HASHING-FUNCS" class="id_link">#</a></h3></div></div></div><div class="sect3" id="PGCRYPTO-GENERAL-HASHING-FUNCS-DIGEST"><div class="titlepage"><div><div><h4 class="title">F.28.1.1. <code class="function">digest()</code> <a href="#PGCRYPTO-GENERAL-HASHING-FUNCS-DIGEST" class="id_link">#</a></h4></div></div></div><a id="id-1.11.7.38.7.2.2" class="indexterm"></a><pre class="synopsis">digest(data text, type text) returns bytea
digest(data bytea, type text) returns bytea</pre><p>Вычисляет двоичный хеш данных (<em class="parameter"><code>data</code></em>). Параметр <em class="parameter"><code>type</code></em> выбирает используемый алгоритм. Поддерживаются стандартные алгоритмы: <code class="literal">md5</code>, <code class="literal">sha1</code>, <code class="literal">sha224</code>, <code class="literal">sha256</code>, <code class="literal">sha384</code> и <code class="literal">sha512</code>. Кроме того, эта функция автоматически поддерживает любые другие алгоритмы хеширования, которые поддерживает <span class="productname">OpenSSL</span>.</p><p>Если вы хотите получить дайджест в виде шестнадцатеричной строки, примените <code class="function">encode()</code> к результату. Например: </p><pre class="programlisting">CREATE OR REPLACE FUNCTION sha1(bytea) returns text AS $$
    SELECT encode(digest($1, 'sha1'), 'hex')
$$ LANGUAGE SQL STRICT IMMUTABLE;</pre></div><div class="sect3" id="PGCRYPTO-GENERAL-HASHING-FUNCS-HMAC"><div class="titlepage"><div><div><h4 class="title">F.28.1.2. <code class="function">hmac()</code> <a href="#PGCRYPTO-GENERAL-HASHING-FUNCS-HMAC" class="id_link">#</a></h4></div></div></div><a id="id-1.11.7.38.7.3.2" class="indexterm"></a><pre class="synopsis">hmac(data text, key text, type text) returns bytea
hmac(data bytea, key bytea, type text) returns bytea</pre><p>Вычисляет имитовставку на основе хеша для данных <em class="parameter"><code>data</code></em> с ключом <em class="parameter"><code>key</code></em>. Параметр <em class="parameter"><code>type</code></em> имеет то же значение, что и для <code class="function">digest()</code>.</p><p>Эта функция похожа на <code class="function">digest()</code>, но вычислить хеш с ней можно, только зная ключ. Это защищает от сценария подмены данных и хеша вместе с ними.</p><p>Если размер ключа больше размера блока хеша, он сначала хешируется, а затем используется в качестве ключа хеширования данных.</p></div></div><div class="sect2" id="PGCRYPTO-PASSWORD-HASHING-FUNCS"><div class="titlepage"><div><div><h3 class="title">F.28.2. Функции хеширования пароля <a href="#PGCRYPTO-PASSWORD-HASHING-FUNCS" class="id_link">#</a></h3></div></div></div><p>Функции <code class="function">crypt()</code> и <code class="function">gen_salt()</code> разработаны специально для хеширования паролей. Функция <code class="function">crypt()</code> выполняет хеширование, а <code class="function">gen_salt()</code> подготавливает параметры алгоритма для неё.</p><p>Алгоритмы в <code class="function">crypt()</code> отличаются от обычных алгоритмов хеширования MD5 и SHA1 в следующих аспектах:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Они медленные. Так как объём данных невелик, это единственный способ усложнить перебор паролей.</p></li><li class="listitem"><p>Они используют случайное значение, называемое <em class="firstterm">солью</em>, чтобы у пользователей с одинаковыми паролями зашифрованные пароли оказывались разными. Это также обеспечивает дополнительную защиту от получения обратного алгоритма.</p></li><li class="listitem"><p>Они включают в результат тип алгоритма, что допускает сосуществование паролей, хешированных разными алгоритмами.</p></li><li class="listitem"><p>Некоторые из них являются адаптируемыми — то есть с ростом производительности компьютеров эти алгоритмы можно настроить так, чтобы они стали медленнее, при этом сохраняя совместимость с существующими паролями.</p></li></ol></div><p>В <a class="xref" href="pgcrypto.html#PGCRYPTO-CRYPT-ALGORITHMS" title="Таблица F.18. Алгоритмы, которые поддерживает crypt()">Таблице F.18</a> перечислены алгоритмы, поддерживаемые функцией <code class="function">crypt()</code>.</p><div class="table" id="PGCRYPTO-CRYPT-ALGORITHMS"><p class="title"><strong>Таблица F.18. Алгоритмы, которые поддерживает <code class="function">crypt()</code></strong></p><div class="table-contents"><table class="table" summary="Алгоритмы, которые поддерживает crypt()" border="1"><colgroup><col /><col /><col /><col /><col /><col /></colgroup><thead><tr><th>Алгоритм</th><th>Макс. длина пароля</th><th>Адаптивный?</th><th>Размер соли (бит)</th><th>Размер результата</th><th>Описание</th></tr></thead><tbody><tr><td><code class="literal">bf</code></td><td>72</td><td>да</td><td>128</td><td>60</td><td>На базе Blowfish, вариация 2a</td></tr><tr><td><code class="literal">md5</code></td><td>без ограничений</td><td>нет</td><td>48</td><td>34</td><td>crypt на базе MD5</td></tr><tr><td><code class="literal">xdes</code></td><td>8</td><td>да</td><td>24</td><td>20</td><td>Расширенный DES</td></tr><tr><td><code class="literal">des</code></td><td>8</td><td>нет</td><td>12</td><td>13</td><td>Изначальный crypt из UNIX</td></tr></tbody></table></div></div><br class="table-break" /><div class="sect3" id="PGCRYPTO-PASSWORD-HASHING-FUNCS-CRYPT"><div class="titlepage"><div><div><h4 class="title">F.28.2.1. <code class="function">crypt()</code> <a href="#PGCRYPTO-PASSWORD-HASHING-FUNCS-CRYPT" class="id_link">#</a></h4></div></div></div><a id="id-1.11.7.38.8.7.2" class="indexterm"></a><pre class="synopsis">crypt(password text, salt text) returns text</pre><p>Вычисляет хеш пароля (<em class="parameter"><code>password</code></em>) в стиле crypt(3). Для сохранения нового пароля необходимо вызвать <code class="function">gen_salt()</code>, чтобы сгенерировать новое значение соли (<em class="parameter"><code>salt</code></em>). Для проверки пароля нужно передать сохранённое значение хеша в параметре <em class="parameter"><code>salt</code></em> и проверить, соответствует ли результат сохранённому значению.</p><p>Пример установки нового пароля: </p><pre class="programlisting">UPDATE ... SET pswhash = crypt('new password', gen_salt('md5'));</pre><p>Пример проверки пароля: </p><pre class="programlisting">SELECT (pswhash = crypt('entered password', pswhash)) AS pswmatch FROM ... ;</pre><p> Этот запрос возвращает <code class="literal">true</code>, если введённый пароль правильный.</p></div><div class="sect3" id="PGCRYPTO-PASSWORD-HASHING-FUNCS-GEN-SALT"><div class="titlepage"><div><div><h4 class="title">F.28.2.2. <code class="function">gen_salt()</code> <a href="#PGCRYPTO-PASSWORD-HASHING-FUNCS-GEN-SALT" class="id_link">#</a></h4></div></div></div><a id="id-1.11.7.38.8.8.2" class="indexterm"></a><pre class="synopsis">gen_salt(type text [, iter_count integer ]) returns text</pre><p>Вычисляет новое случайное значение соли для функции <code class="function">crypt()</code>. Строка соли также говорит <code class="function">crypt()</code>, какой алгоритм использовать.</p><p>Параметр <em class="parameter"><code>type</code></em> задаёт алгоритм хеширования. Принимаются следующие варианты: <code class="literal">des</code>, <code class="literal">xdes</code>, <code class="literal">md5</code> и <code class="literal">bf</code>.</p><p>Параметр <em class="parameter"><code>iter_count</code></em> позволяет пользователю указать счётчик итераций для алгоритма, который его принимает. Чем больше это число, тем больше времени уйдёт на вычисление хеша пароля, а значит, тем больше времени понадобится, чтобы взломать его. Хотя со слишком большим значением время вычисления хеша может вырасти до нескольких лет — это вряд ли практично. Когда параметр <em class="parameter"><code>iter_count</code></em> опускается, применяется количество итераций по умолчанию. Множество допустимых значений для <em class="parameter"><code>iter_count</code></em> зависит от алгоритма, как показано в <a class="xref" href="pgcrypto.html#PGCRYPTO-ICFC-TABLE" title="Таблица F.19. Счётчики итераций для crypt()">Таблице F.19</a>.</p><div class="table" id="PGCRYPTO-ICFC-TABLE"><p class="title"><strong>Таблица F.19. Счётчики итераций для <code class="function">crypt()</code></strong></p><div class="table-contents"><table class="table" summary="Счётчики итераций для crypt()" border="1"><colgroup><col /><col /><col /><col /></colgroup><thead><tr><th>Алгоритм</th><th>По умолчанию</th><th>Мин.</th><th>Макс.</th></tr></thead><tbody><tr><td><code class="literal">xdes</code></td><td>725</td><td>1</td><td>16777215</td></tr><tr><td><code class="literal">bf</code></td><td>6</td><td>4</td><td>31</td></tr></tbody></table></div></div><br class="table-break" /><p>Для <code class="literal">xdes</code> есть дополнительное ограничение: счётчик итераций должен быть нечётным.</p><p>При выборе подходящего числа итераций учтите, что оригинальный алгоритм DES crypt был рассчитан так, чтобы выдавать 4 хеша в секунду на компьютерах того времени. Если за секунду будет вычисляться меньше 4 хешей, скорее всего, возникнут определённые неудобства при пользовании. С другой стороны, скорость больше, чем 100 хешей в секунду, вероятно, будет слишком высокой.</p><p>В <a class="xref" href="pgcrypto.html#PGCRYPTO-HASH-SPEED-TABLE" title="Таблица F.20. Скорости алгоритмов хеширования">Таблице F.20</a> дана сводка относительной скорости различных алгоритмов хеширования. В таблице показано, сколько времени уйдёт на перебор всех комбинацией символов в восьмисимвольном пароле, в предположении, что пароль содержит только буквы в нижнем регистре, либо буквы в верхнем и нижнем регистре, а также цифры. В строках <code class="literal">crypt-bf</code> числа после косой черты показывают значение параметра <em class="parameter"><code>iter_count</code></em> функции <code class="function">gen_salt</code>.</p><div class="table" id="PGCRYPTO-HASH-SPEED-TABLE"><p class="title"><strong>Таблица F.20. Скорости алгоритмов хеширования</strong></p><div class="table-contents"><table class="table" summary="Скорости алгоритмов хеширования" border="1"><colgroup><col /><col /><col /><col /><col /></colgroup><thead><tr><th>Алгоритм</th><th>Хешей/сек.</th><th>Для <code class="literal">[a-z]</code></th><th>Для <code class="literal">[A-Za-z0-9]</code></th><th>Длительность относительно <code class="literal">md5</code></th></tr></thead><tbody><tr><td><code class="literal">crypt-bf/8</code></td><td>1792</td><td>4 года</td><td>3927 лет</td><td>100k</td></tr><tr><td><code class="literal">crypt-bf/7</code></td><td>3648</td><td>2 года</td><td>1929 лет</td><td>50k</td></tr><tr><td><code class="literal">crypt-bf/6</code></td><td>7168</td><td>1 год</td><td>982 лет</td><td>25k</td></tr><tr><td><code class="literal">crypt-bf/5</code></td><td>13504</td><td>188 дней</td><td>521 лет</td><td>12.5k</td></tr><tr><td><code class="literal">crypt-md5</code></td><td>171584</td><td>15 дней</td><td>41 год</td><td>1k</td></tr><tr><td><code class="literal">crypt-des</code></td><td>23221568</td><td>157.5 минут</td><td>108 дней</td><td>7</td></tr><tr><td><code class="literal">sha1</code></td><td>37774272</td><td>90 минут</td><td>68 дней</td><td>4</td></tr><tr><td><code class="literal">md5</code> (хеш)</td><td>150085504</td><td>22.5 минут</td><td>17 дней</td><td>1</td></tr></tbody></table></div></div><br class="table-break" /><p>Замечания:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Для расчётов использовался процессор Intel Mobile Core i3.</p></li><li class="listitem"><p>Показатели алгоритмов <code class="literal">crypt-des</code> и <code class="literal">crypt-md5</code> взяты из вывода теста программы John the Ripper v1.6.38.</p></li><li class="listitem"><p>Показатели <code class="literal">md5</code> получены программой mdcrack 1.2.</p></li><li class="listitem"><p>Показатели <code class="literal">sha1</code> получены программой lcrack-20031130-beta.</p></li><li class="listitem"><p>Показатели <code class="literal">crypt-bf</code> получены простой программой, обрабатывающей в цикле 1000 паролей из 8 символов. Таким способом можно показать скорость с разным числом итераций. Для справки: <code class="literal">john -test</code> показывает 13506 циклов/с для <code class="literal">crypt-bf/5</code>. (Это очень небольшое различие в результатах согласуется с тем фактом, что реализация <code class="literal">crypt-bf</code> в <code class="filename">pgcrypto</code> не отличается от применяемой в программе John the Ripper.)</p></li></ul></div><p>Заметьте, что вариант <span class="quote">«<span class="quote">перепробовать все комбинации</span>»</span> не вполне реалистичен. Обычно перебор паролей производится с применением словарей, которые содержат и обычные слова, и их различные видоизменения. Поэтому даже похожие на слова пароли обычно можно подобрать быстрее, чем за указанное время, тогда как 6-символьный несловесный пароль может избежать взлома. А может и не избежать.</p></div></div><div class="sect2" id="PGCRYPTO-PGP-ENC-FUNCS"><div class="titlepage"><div><div><h3 class="title">F.28.3. Функции шифрования на базе PGP <a href="#PGCRYPTO-PGP-ENC-FUNCS" class="id_link">#</a></h3></div></div></div><p>Функции, описанные здесь, реализуют часть стандарта OpenPGP (<a class="ulink" href="https://datatracker.ietf.org/doc/html/rfc4880" target="_top">RFC 4880</a>), относящуюся к шифрованию. Они поддерживают шифрование как с симметричным, так и с закрытым ключом.</p><p>Зашифрованное PGP сообщение состоит из 2 частей или <em class="firstterm">пакетов</em>:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Пакет, содержащий сеансовый ключ — либо симметричный, либо открытый (в зашифрованном виде).</p></li><li class="listitem"><p>Пакет, содержащий данные, зашифрованные сеансовым ключом.</p></li></ul></div><p>При шифровании с симметричным ключом (то есть, паролем):</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Заданный пароль хешируется по алгоритму String2Key (S2K). Этот алгоритм подобен алгоритмам <code class="function">crypt()</code> — специально замедлен и добавляет случайную соль — но на выход выдаёт двоичный ключ полной длины.</p></li><li class="listitem"><p>Если требуется отдельный сеансовый ключ, генерируется новый случайный ключ. В противном случае в качестве сеансового будет использоваться непосредственно ключ S2K.</p></li><li class="listitem"><p>Когда используется непосредственно ключ S2K, в пакет сеансового ключа помещаются только параметры S2K. В противном случае сеансовый ключ шифруется ключом S2K и результат помещается в пакет сеансового ключа.</p></li></ol></div><p>При шифровании с открытым ключом:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Генерируется новый случайный сеансовый ключ.</p></li><li class="listitem"><p>Он зашифровывается открытым ключом и помещается в пакет сеансового ключа.</p></li></ol></div><p>В любом случае данные, которые должны быть зашифрованы, обрабатываются так:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Необязательная подготовка данных: сжатие, перекодировка в UTF-8 и/или преобразование концов строк.</p></li><li class="listitem"><p>Перед данными добавляется блок случайных байт. Это равносильно использованию случайного вектора инициализации.</p></li><li class="listitem"><p>В конце добавляется хеш SHA1 случайного префикса и данных.</p></li><li class="listitem"><p>Всё это шифруется сеансовым ключом и помещается в пакет данных.</p></li></ol></div><div class="sect3" id="PGCRYPTO-PGP-ENC-FUNCS-PGP-SYM-ENCRYPT"><div class="titlepage"><div><div><h4 class="title">F.28.3.1. <code class="function">pgp_sym_encrypt()</code> <a href="#PGCRYPTO-PGP-ENC-FUNCS-PGP-SYM-ENCRYPT" class="id_link">#</a></h4></div></div></div><a id="id-1.11.7.38.9.11.2" class="indexterm"></a><a id="id-1.11.7.38.9.11.3" class="indexterm"></a><pre class="synopsis">pgp_sym_encrypt(data text, psw text [, options text ]) returns bytea
pgp_sym_encrypt_bytea(data bytea, psw text [, options text ]) returns bytea</pre><p>Шифрует данные (<em class="parameter"><code>data</code></em>) симметричным ключом PGP <em class="parameter"><code>psw</code></em>. В <em class="parameter"><code>options</code></em> могут передаваться криптографические параметры, описанные ниже.</p></div><div class="sect3" id="PGCRYPTO-PGP-ENC-FUNCS-PGP-SYM-DECRYPT"><div class="titlepage"><div><div><h4 class="title">F.28.3.2. <code class="function">pgp_sym_decrypt()</code> <a href="#PGCRYPTO-PGP-ENC-FUNCS-PGP-SYM-DECRYPT" class="id_link">#</a></h4></div></div></div><a id="id-1.11.7.38.9.12.2" class="indexterm"></a><a id="id-1.11.7.38.9.12.3" class="indexterm"></a><pre class="synopsis">pgp_sym_decrypt(msg bytea, psw text [, options text ]) returns text
pgp_sym_decrypt_bytea(msg bytea, psw text [, options text ]) returns bytea</pre><p>Расшифровывает сообщение, зашифрованное симметричным ключом PGP.</p><p>Расшифровывать данные <code class="type">bytea</code> функцией <code class="function">pgp_sym_decrypt</code> запрещено. Это ограничение введено, чтобы не допустить вывода некорректных символьных данных. Расшифровывать изначально текстовые данные с помощью <code class="function">pgp_sym_decrypt_bytea</code> можно без ограничений.</p><p>Аргумент <em class="parameter"><code>options</code></em> может содержать криптографические параметры, описанные ниже.</p></div><div class="sect3" id="PGCRYPTO-PGP-ENC-FUNCS-PGP-PUB-ENCRYPT"><div class="titlepage"><div><div><h4 class="title">F.28.3.3. <code class="function">pgp_pub_encrypt()</code> <a href="#PGCRYPTO-PGP-ENC-FUNCS-PGP-PUB-ENCRYPT" class="id_link">#</a></h4></div></div></div><a id="id-1.11.7.38.9.13.2" class="indexterm"></a><a id="id-1.11.7.38.9.13.3" class="indexterm"></a><pre class="synopsis">pgp_pub_encrypt(data text, key bytea [, options text ]) returns bytea
pgp_pub_encrypt_bytea(data bytea, key bytea [, options text ]) returns bytea</pre><p>Зашифровывает данные (<em class="parameter"><code>data</code></em>) открытым ключом PGP (<em class="parameter"><code>key</code></em>). Если передать этой функции закрытый ключ, она выдаст ошибку.</p><p>Аргумент <em class="parameter"><code>options</code></em> может содержать криптографические параметры, описанные ниже.</p></div><div class="sect3" id="PGCRYPTO-PGP-ENC-FUNCS-PGP-PUB-DECRYPT"><div class="titlepage"><div><div><h4 class="title">F.28.3.4. <code class="function">pgp_pub_decrypt()</code> <a href="#PGCRYPTO-PGP-ENC-FUNCS-PGP-PUB-DECRYPT" class="id_link">#</a></h4></div></div></div><a id="id-1.11.7.38.9.14.2" class="indexterm"></a><a id="id-1.11.7.38.9.14.3" class="indexterm"></a><pre class="synopsis">pgp_pub_decrypt(msg bytea, key bytea [, psw text [, options text ]]) returns text
pgp_pub_decrypt_bytea(msg bytea, key bytea [, psw text [, options text ]]) returns bytea</pre><p>Расшифровывает сообщение, зашифрованное открытым ключом. В <em class="parameter"><code>key</code></em> должен передаваться закрытый ключ, соответствующий открытому ключу, применяющемуся при шифровании. Если секретный ключ защищён паролем, этот пароль нужно передать в параметре <em class="parameter"><code>psw</code></em>. Если пароля нет, но необходимо передать криптографические параметры, вы должны передать пустой пароль.</p><p>Расшифровывать данные <code class="type">bytea</code> функцией <code class="function">pgp_pub_decrypt</code> запрещено. Это ограничение введено, чтобы не допустить вывода недопустимых символьных данных. Расшифровывать изначально текстовые данные с помощью <code class="function">pgp_pub_decrypt_bytea</code> можно без ограничений.</p><p>Аргумент <em class="parameter"><code>options</code></em> может содержать криптографические параметры, описанные ниже.</p></div><div class="sect3" id="PGCRYPTO-PGP-ENC-FUNCS-PGP-KEY-ID"><div class="titlepage"><div><div><h4 class="title">F.28.3.5. <code class="function">pgp_key_id()</code> <a href="#PGCRYPTO-PGP-ENC-FUNCS-PGP-KEY-ID" class="id_link">#</a></h4></div></div></div><a id="id-1.11.7.38.9.15.2" class="indexterm"></a><pre class="synopsis">pgp_key_id(bytea) returns text</pre><p><code class="function">pgp_key_id</code> извлекает идентификатор ключа из открытого или закрытого ключа PGP. Она также может выдать идентификатор ключа, которым были зашифрованы данные, если ей передаётся зашифрованное сообщение.</p><p>Она может выдать два специальных идентификатора ключа:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
      <code class="literal">SYMKEY</code>
     </p><p>Сообщение зашифровано симметричным ключом.</p></li><li class="listitem"><p>
      <code class="literal">ANYKEY</code>
     </p><p>Сообщение зашифровано открытом ключом, но идентификатор ключа был удалён. Это означает, что вам надо будет перепробовать ключи, чтобы подобрать подходящий. Сама библиотека <code class="filename">pgcrypto</code> не генерирует такие сообщения.</p></li></ul></div><p>Заметьте, что разные ключи могут иметь одинаковый идентификатор. Это редкое, но не невероятное явление. В таком случае клиентское приложение должно пытаться расшифровать данные с каждым ключом, пока не найдёт подходящий — примерно так же, как и с <code class="literal">ANYKEY</code>.</p></div><div class="sect3" id="PGCRYPTO-PGP-ENC-FUNCS-ARMOR"><div class="titlepage"><div><div><h4 class="title">F.28.3.6. <code class="function">armor()</code>, <code class="function">dearmor()</code> <a href="#PGCRYPTO-PGP-ENC-FUNCS-ARMOR" class="id_link">#</a></h4></div></div></div><a id="id-1.11.7.38.9.16.2" class="indexterm"></a><a id="id-1.11.7.38.9.16.3" class="indexterm"></a><pre class="synopsis">armor(data bytea [ , keys text[], values text[] ]) returns text
dearmor(data text) returns bytea</pre><p>Эти функции переводят двоичные данные в/из формата PGP «ASCII Armor», по сути представляющий собой кодировку Base64 с контрольными суммами и дополнительным форматированием.</p><p>Если задаются массивы <em class="parameter"><code>keys</code></em> и <em class="parameter"><code>values</code></em>, для каждой пары ключ/значения в формат Armor добавляется <em class="firstterm">заголовок Armor</em>. Оба массива должны быть одномерными и иметь одинаковую длину. Задаваемые ключи и значения могут содержать только символы ASCII.</p></div><div class="sect3" id="PGCRYPTO-PGP-ENC-FUNCS-PGP-ARMOR-HEADERS"><div class="titlepage"><div><div><h4 class="title">F.28.3.7. <code class="function">pgp_armor_headers</code> <a href="#PGCRYPTO-PGP-ENC-FUNCS-PGP-ARMOR-HEADERS" class="id_link">#</a></h4></div></div></div><a id="id-1.11.7.38.9.17.2" class="indexterm"></a><pre class="synopsis">pgp_armor_headers(data text, key out text, value out text) returns setof record</pre><p>Функция <code class="function">pgp_armor_headers()</code> извлекает заголовки Armor из параметра <em class="parameter"><code>data</code></em>. Она возвращает набор строк с двумя столбцами, key и value. Если в ключах или значениях оказываются символы не ASCII, они воспринимаются как UTF-8.</p></div><div class="sect3" id="PGCRYPTO-PGP-ENC-FUNCS-OPTS"><div class="titlepage"><div><div><h4 class="title">F.28.3.8. Параметры функций PGP <a href="#PGCRYPTO-PGP-ENC-FUNCS-OPTS" class="id_link">#</a></h4></div></div></div><p>Имена параметров подобны принятым в GnuPG. Значение параметра должно задаваться после знака равно; друг от друга параметры отделяются запятыми. Например: </p><pre class="programlisting">pgp_sym_encrypt(data, psw, 'compress-algo=1, cipher-algo=aes256')</pre><p>Все эти параметры, кроме <code class="literal">convert-crlf</code>, применяются только к функциям шифрования. Функции расшифровывания получают параметры из данных PGP.</p><p>Вероятно, самые интересные параметры — это <code class="literal">compress-algo</code> и <code class="literal">unicode-mode</code>. Остальные должны иметь достаточно адекватные значения по умолчанию.</p><div class="sect4" id="PGCRYPTO-PGP-ENC-FUNCS-OPTS-CIPHER-ALGO"><div class="titlepage"><div><div><h5 class="title">F.28.3.8.1. cipher-algo <a href="#PGCRYPTO-PGP-ENC-FUNCS-OPTS-CIPHER-ALGO" class="id_link">#</a></h5></div></div></div><p>Выбирает алгоритм шифрования.</p><div class="literallayout"><p>Значения: bf, aes128, aes192, aes256, 3des, cast5<br />
По умолчанию: aes128<br />
Применим к: pgp_sym_encrypt, pgp_pub_encrypt</p></div></div><div class="sect4" id="PGCRYPTO-PGP-ENC-FUNCS-OPTS-COMPRESS-ALGO"><div class="titlepage"><div><div><h5 class="title">F.28.3.8.2. compress-algo <a href="#PGCRYPTO-PGP-ENC-FUNCS-OPTS-COMPRESS-ALGO" class="id_link">#</a></h5></div></div></div><p>Выбирает алгоритм сжатия. Принимается, только если <span class="productname">PostgreSQL</span> собран с zlib.</p><div class="literallayout"><p>Значения:<br />
  0 — без сжатия<br />
  1 — сжатие ZIP<br />
  2 — сжатие ZLIB (= ZIP плюс метаданные и CRC блоков)<br />
По умолчанию: 0<br />
Применим к: pgp_sym_encrypt, pgp_pub_encrypt</p></div></div><div class="sect4" id="PGCRYPTO-PGP-ENC-FUNCS-OPTS-COMPRESS-LEVEL"><div class="titlepage"><div><div><h5 class="title">F.28.3.8.3. compress-level <a href="#PGCRYPTO-PGP-ENC-FUNCS-OPTS-COMPRESS-LEVEL" class="id_link">#</a></h5></div></div></div><p>Определяет уровень сжатия. Чем больше уровень, тем меньшего объёма результат, но длительнее процесс. Значение 0 отключает сжатие.</p><div class="literallayout"><p>Значения: 0, 1-9<br />
По умолчанию: 6<br />
Применим к: pgp_sym_encrypt, pgp_pub_encrypt</p></div></div><div class="sect4" id="PGCRYPTO-PGP-ENC-FUNCS-OPTS-CONVERT-CRLF"><div class="titlepage"><div><div><h5 class="title">F.28.3.8.4. convert-crlf <a href="#PGCRYPTO-PGP-ENC-FUNCS-OPTS-CONVERT-CRLF" class="id_link">#</a></h5></div></div></div><p>Определяет, преобразовывать ли <code class="literal">\n</code> в <code class="literal">\r\n</code> при шифровании и <code class="literal">\r\n</code> в <code class="literal">\n</code> при дешифровании. В <acronym class="acronym">RFC</acronym> 4880 требуется, чтобы текстовые данные хранились с переводами строк в виде <code class="literal">\r\n</code>. Воспользуйтесь этим параметром, чтобы поведение полностью соответствовало RFC.</p><div class="literallayout"><p>Значения: 0, 1<br />
По умолчанию: 0<br />
Применим к: pgp_sym_encrypt, pgp_pub_encrypt, pgp_sym_decrypt, pgp_pub_decrypt</p></div></div><div class="sect4" id="PGCRYPTO-PGP-ENC-FUNCS-OPTS-DISABLE-MDC"><div class="titlepage"><div><div><h5 class="title">F.28.3.8.5. disable-mdc <a href="#PGCRYPTO-PGP-ENC-FUNCS-OPTS-DISABLE-MDC" class="id_link">#</a></h5></div></div></div><p>Не защищать данные хешем SHA-1. Единственная разумная причина использовать этот параметр — добиться совместимости с древними программами PGP, вышедшими до того, как в <acronym class="acronym">RFC</acronym> 4880 была предусмотрена защита пакетов с SHA-1. Все последние реализации с gnupg.org и pgp.com прекрасно поддерживают это.</p><div class="literallayout"><p>Значения: 0, 1<br />
По умолчанию: 0<br />
Применим к: pgp_sym_encrypt, pgp_pub_encrypt</p></div></div><div class="sect4" id="PGCRYPTO-PGP-ENC-FUNCS-OPTS-SESS-KEY"><div class="titlepage"><div><div><h5 class="title">F.28.3.8.6. sess-key <a href="#PGCRYPTO-PGP-ENC-FUNCS-OPTS-SESS-KEY" class="id_link">#</a></h5></div></div></div><p>Использовать отдельный сеансовый ключ. Для шифрования с открытым ключом всегда используется отдельный сеансовый ключ; этот параметр предназначен для шифрования с симметричным ключом, которое по умолчанию использует непосредственно ключ S2K.</p><div class="literallayout"><p>Значения: 0, 1<br />
По умолчанию: 0<br />
Применим к: pgp_sym_encrypt</p></div></div><div class="sect4" id="PGCRYPTO-PGP-ENC-FUNCS-OPTS-S2K-MODE"><div class="titlepage"><div><div><h5 class="title">F.28.3.8.7. s2k-mode <a href="#PGCRYPTO-PGP-ENC-FUNCS-OPTS-S2K-MODE" class="id_link">#</a></h5></div></div></div><p>Режим алгоритма S2K.</p><div class="literallayout"><p>Значения:<br />
  0 — Без соли. Опасно!<br />
  1 — С солью, но с фиксированным числом итераций.<br />
  3 — С переменным числом итераций.<br />
По умолчанию: 3<br />
Применим к: pgp_sym_encrypt</p></div></div><div class="sect4" id="PGCRYPTO-PGP-ENC-FUNCS-OPTS-S2K-COUNT"><div class="titlepage"><div><div><h5 class="title">F.28.3.8.8. s2k-count <a href="#PGCRYPTO-PGP-ENC-FUNCS-OPTS-S2K-COUNT" class="id_link">#</a></h5></div></div></div><p>Число итераций для алгоритма S2K. Оно должно быть не меньше 1024 и не больше 65011712.</p><div class="literallayout"><p>По умолчанию: случайное значение между 65536 и 253952<br />
Применим к: pgp_sym_encrypt, только с s2k-mode=3</p></div></div><div class="sect4" id="PGCRYPTO-PGP-ENC-FUNCS-OPTS-S2K-DIGEST-ALGO"><div class="titlepage"><div><div><h5 class="title">F.28.3.8.9. s2k-digest-algo <a href="#PGCRYPTO-PGP-ENC-FUNCS-OPTS-S2K-DIGEST-ALGO" class="id_link">#</a></h5></div></div></div><p>Выбирает алгоритм хеширования, который будет использоваться для вычисления S2K.</p><div class="literallayout"><p>Значения: md5, sha1<br />
По умолчанию: sha1<br />
Применим к: pgp_sym_encrypt</p></div></div><div class="sect4" id="PGCRYPTO-PGP-ENC-FUNCS-OPTS-S2K-CIPHER-ALGO"><div class="titlepage"><div><div><h5 class="title">F.28.3.8.10. s2k-cipher-algo <a href="#PGCRYPTO-PGP-ENC-FUNCS-OPTS-S2K-CIPHER-ALGO" class="id_link">#</a></h5></div></div></div><p>Выбирает шифр, который будет использоваться для шифрования отдельного сеансового ключа.</p><div class="literallayout"><p>Значения: bf, aes, aes128, aes192, aes256<br />
По умолчанию: используется cipher-algo<br />
Применим к: pgp_sym_encrypt</p></div></div><div class="sect4" id="PGCRYPTO-PGP-ENC-FUNCS-OPTS-UNICODE-MODE"><div class="titlepage"><div><div><h5 class="title">F.28.3.8.11. unicode-mode <a href="#PGCRYPTO-PGP-ENC-FUNCS-OPTS-UNICODE-MODE" class="id_link">#</a></h5></div></div></div><p>Определяет, преобразовывать ли текстовые данные из внутренней кодировки базы данных в UTF-8 и обратно. Если кодировка базы уже UTF-8, перекодировка не производится, но сообщение помечается как UTF-8. Без данного параметра этого не происходит.</p><div class="literallayout"><p>Значения: 0, 1<br />
По умолчанию: 0<br />
Применим к: pgp_sym_encrypt, pgp_pub_encrypt</p></div></div></div><div class="sect3" id="PGCRYPTO-PGP-ENC-FUNCS-GNUPG"><div class="titlepage"><div><div><h4 class="title">F.28.3.9. Формирование ключей PGP с применением GnuPG <a href="#PGCRYPTO-PGP-ENC-FUNCS-GNUPG" class="id_link">#</a></h4></div></div></div><p>Формирование нового ключа: </p><pre class="programlisting">gpg --gen-key</pre><p>Предпочитаемый тип ключей: <span class="quote">«<span class="quote">DSA and Elgamal</span>»</span>.</p><p>Для шифрования RSA вы должны создать главный ключ либо DSA, либо RSA только для подписания, а затем добавить подключ для шифрования, выполнив команду <code class="literal">gpg --edit-key</code>.</p><p>Просмотр списка ключей: </p><pre class="programlisting">gpg --list-secret-keys</pre><p>Экспорт открытого ключа в формате «ASCII Armor»: </p><pre class="programlisting">gpg -a --export KEYID &gt; public.key</pre><p>Экспорт закрытого ключа в формате «ASCII Armor»: </p><pre class="programlisting">gpg -a --export-secret-keys KEYID &gt; secret.key</pre><p>Прежде чем передавать эти ключи функциям PGP, вы должны применить функцию <code class="function">dearmor()</code> к этим ключам. Либо, если вы можете обработать двоичные данные, уберите <code class="literal">-a</code> из команды.</p><p>Дополнительную информацию вы можете получить в руководстве <code class="literal">man gpg</code>, <a class="ulink" href="https://www.gnupg.org/gph/en/manual.html" target="_top">The GNU Privacy Handbook</a> (Руководство GNU по обеспечению конфиденциальности) и другой документации на сайте <a class="ulink" href="https://www.gnupg.org/" target="_top">https://www.gnupg.org/</a>.</p></div><div class="sect3" id="PGCRYPTO-PGP-ENC-FUNCS-LIMITATIONS"><div class="titlepage"><div><div><h4 class="title">F.28.3.10. Ограничения кода PGP <a href="#PGCRYPTO-PGP-ENC-FUNCS-LIMITATIONS" class="id_link">#</a></h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Не поддерживается подписывание. Это также означает, что принадлежность подключа шифрования главному ключу не проверяется.</p></li><li class="listitem"><p>Не поддерживается использование ключа шифрования в качестве главного ключа. Так как подобная практика обычно не приветствуется, это не должно быть проблемой.</p></li><li class="listitem"><p>Нет поддержки нескольких подключей. Это может представляться проблемой, так как такие ключи не редкость. С другой стороны, вы всё равно не должны использовать обычные ключи GPG/PGP с <code class="filename">pgcrypto</code>, а должны создать новые, учитывая, что это другой сценарий использования.</p></li></ul></div></div></div><div class="sect2" id="PGCRYPTO-RAW-ENC-FUNCS"><div class="titlepage"><div><div><h3 class="title">F.28.4. Низкоуровневые функции шифрования <a href="#PGCRYPTO-RAW-ENC-FUNCS" class="id_link">#</a></h3></div></div></div><p>Эти функции выполняют только шифрование данных; они не предоставляют расширенные возможности шифрования PGP. Таким образом, с ними связаны следующие проблемы:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Они используют ключ пользователя непосредственно в качестве ключа шифрования.</p></li><li class="listitem"><p>Они не обеспечивают проверку целостности, которая должна выявлять модификацию зашифрованных данных.</p></li><li class="listitem"><p>Они рассчитаны на то, что пользователи будут управлять всеми параметрами шифрования самостоятельно, даже вектором инициализации.</p></li><li class="listitem"><p>Они не рассчитаны на текст.</p></li></ol></div><p>Поэтому с появлением поддержки шифрования PGP использовать низкоуровневые функции шифрования не рекомендуется.</p><a id="id-1.11.7.38.10.5" class="indexterm"></a><a id="id-1.11.7.38.10.6" class="indexterm"></a><a id="id-1.11.7.38.10.7" class="indexterm"></a><a id="id-1.11.7.38.10.8" class="indexterm"></a><pre class="synopsis">encrypt(data bytea, key bytea, type text) returns bytea
decrypt(data bytea, key bytea, type text) returns bytea

encrypt_iv(data bytea, key bytea, iv bytea, type text) returns bytea
decrypt_iv(data bytea, key bytea, iv bytea, type text) returns bytea</pre><p>Эти функции зашифровывают/расшифровывают данные, применяя метод шифрования, заданный параметром <em class="parameter"><code>type</code></em>. Строка <em class="parameter"><code>type</code></em> имеет следующий формат: </p><pre class="synopsis">
<em class="replaceable"><code>алгоритм</code></em> [<span class="optional"> <code class="literal">-</code> <em class="replaceable"><code>режим</code></em> </span>] [<span class="optional"> <code class="literal">/pad:</code> <em class="replaceable"><code>дозаполнение</code></em> </span>]
</pre><p> где допустимый <em class="replaceable"><code>алгоритм</code></em>: </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="literal">bf</code> — Blowfish</p></li><li class="listitem"><p><code class="literal">aes</code> — AES (Rijndael-128, -192 или -256)</p></li></ul></div><p> допустимый <em class="replaceable"><code>режим</code></em>: </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="literal">cbc</code> — следующий блок зависит от предыдущего (по умолчанию)</p></li><li class="listitem"><p><code class="literal">ecb</code> — каждый блок шифруется отдельно (только для тестирования)</p></li></ul></div><p> и допустимое <em class="replaceable"><code>дозаполнение</code></em>: </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="literal">pkcs</code> — данные могут быть любой длины (по умолчанию)</p></li><li class="listitem"><p><code class="literal">none</code> — размер данных должен быть кратен размеру блока шифра</p></li></ul></div><p>Так что, например, эти вызовы равнозначны: </p><pre class="programlisting">encrypt(data, 'fooz', 'bf')
encrypt(data, 'fooz', 'bf-cbc/pad:pkcs')</pre><p>Для функций <code class="function">encrypt_iv</code> и <code class="function">decrypt_iv</code> параметр <em class="parameter"><code>iv</code></em> задаёт начальное значение для режима CBC; для ECB он игнорируется. Оно обрезается или дополняется нулями, если его размер не равен ровно размеру блока. В функциях без этого параметра оно по умолчанию заполняется нулями.</p></div><div class="sect2" id="PGCRYPTO-RANDOM-DATA-FUNCS"><div class="titlepage"><div><div><h3 class="title">F.28.5. Функции получения случайных данных <a href="#PGCRYPTO-RANDOM-DATA-FUNCS" class="id_link">#</a></h3></div></div></div><a id="id-1.11.7.38.11.2" class="indexterm"></a><pre class="synopsis">gen_random_bytes(count integer) returns bytea</pre><p>Возвращает криптографически стойкие случайные байты в количестве <em class="parameter"><code>count</code></em>. За один вызов можно получить максимум 1024 байт. Это ограничение предотвращает исчерпание пула энтропии.</p><a id="id-1.11.7.38.11.5" class="indexterm"></a><pre class="synopsis">gen_random_uuid() returns uuid</pre><p>Возвращает UUID версии 4 (случайный). (Эта функция в данном модуле считается устаревшей, она вызывает одноимённую <a class="link" href="functions-uuid.html" title="9.14. Функции генерирования UUID">функцию ядра</a>.)</p></div><div class="sect2" id="PGCRYPTO-NOTES"><div class="titlepage"><div><div><h3 class="title">F.28.6. Замечания <a href="#PGCRYPTO-NOTES" class="id_link">#</a></h3></div></div></div><div class="sect3" id="PGCRYPTO-NOTES-CONFIG"><div class="titlepage"><div><div><h4 class="title">F.28.6.1. Конфигурирование <a href="#PGCRYPTO-NOTES-CONFIG" class="id_link">#</a></h4></div></div></div><p>Модуль <code class="filename">pgcrypto</code> настраивается согласно установкам, полученным в главном скрипте <code class="literal">configure</code> PostgreSQL. На его конфигурацию влияют аргументы <code class="literal">--with-zlib</code> и <code class="literal">--with-ssl=openssl</code>.</p><p>При компиляции с zlib шифрующие функции PGP могут сжимать данные перед шифрованием.</p><p>Для работы <code class="filename">pgcrypto</code> требуется <span class="productname">OpenSSL</span>. Без этой библиотеки модуль не будет собран и установлен.</p><p>Чтобы использовать устаревшие алгоритмы шифрования, такие как DES или Blowfish, при компиляции с <span class="productname">OpenSSL</span> версии 3.0.0 и выше, нужно активировать поставщиков этих алгоритмов в файле конфигурации <code class="filename">openssl.cnf</code>.</p></div><div class="sect3" id="PGCRYPTO-NOTES-NULL-HANDLING"><div class="titlepage"><div><div><h4 class="title">F.28.6.2. Обработка NULL <a href="#PGCRYPTO-NOTES-NULL-HANDLING" class="id_link">#</a></h4></div></div></div><p>Как и положено по стандарту SQL, все эти функции возвращают NULL, если один из аргументов — NULL. Это может угрожать безопасности при неаккуратном использовании.</p></div><div class="sect3" id="PGCRYPTO-NOTES-SEC-LIMITS"><div class="titlepage"><div><div><h4 class="title">F.28.6.3. Ограничения безопасности <a href="#PGCRYPTO-NOTES-SEC-LIMITS" class="id_link">#</a></h4></div></div></div><p>Все функции <code class="filename">pgcrypto</code> выполняются внутри сервера баз данных. Это означает, что все данные и пароли передаются между функциями <code class="filename">pgcrypto</code> и клиентскими приложениями открытым текстом. Поэтому вы должны:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Подключаться локально или использовать подключения SSL.</p></li><li class="listitem"><p>Доверять и системе, и администратору баз данных.</p></li></ol></div><p>Если это невозможно, лучше произвести шифрование в клиентском приложении.</p><p>Эта реализация не противостоит <a class="ulink" href="httsp://en.wikipedia.org/wiki/Side-channel_attack" target="_top">атакам по сторонним каналам</a>. Например, время, требующееся для выполнения функции дешифрования <code class="filename">pgcrypto</code>, будет разным для разного шифротекста заданного размера.</p></div></div><div class="sect2" id="PGCRYPTO-AUTHOR"><div class="titlepage"><div><div><h3 class="title">F.28.7. Автор <a href="#PGCRYPTO-AUTHOR" class="id_link">#</a></h3></div></div></div><p>Марко Крин <code class="email">&lt;<a class="email" href="mailto:markokr@gmail.com">markokr@gmail.com</a>&gt;</code></p><p>Модуль <code class="filename">pgcrypto</code> заимствует код из следующих источников:</p><div class="informaltable"><table class="informaltable" border="1"><colgroup><col /><col /><col /></colgroup><thead><tr><th>Алгоритм</th><th>Автор</th><th>Источник исходного кода</th></tr></thead><tbody><tr><td>Шифрование DES</td><td>Дэвид Буррен и другие</td><td>FreeBSD, libcrypt</td></tr><tr><td>Хеширование MD5</td><td>Пол-Хеннинг Камп</td><td>FreeBSD, libcrypt</td></tr><tr><td>Шифрование Blowfish</td><td>Solar Designer</td><td>www.openwall.com</td></tr></tbody></table></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="pgbuffercache.html" title="F.27. pg_buffercache — информация о состоянии буферного кеша PostgreSQL">Пред.</a> </td><td width="20%" align="center"><a accesskey="u" href="contrib.html" title="Приложение F. Дополнительно поставляемые модули и расширения">Наверх</a></td><td width="40%" align="right"> <a accesskey="n" href="pgfreespacemap.html" title="F.29. pg_freespacemap — просмотр карты свободного пространства">След.</a></td></tr><tr><td width="40%" align="left" valign="top">F.27. pg_buffercache — информация о состоянии буферного кеша <span class="productname">PostgreSQL</span> </td><td width="20%" align="center"><a accesskey="h" href="index.html" title="Документация к PostgreSQL 16.3">Начало</a></td><td width="40%" align="right" valign="top"> F.29. pg_freespacemap — просмотр карты свободного пространства</td></tr></table></div></body></html>