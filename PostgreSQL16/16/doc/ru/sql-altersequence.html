<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>ALTER SEQUENCE</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@lists.postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot" /><link rel="prev" href="sql-alterschema.html" title="ALTER SCHEMA" /><link rel="next" href="sql-alterserver.html" title="ALTER SERVER" /></head><body id="docContent" class="container-fluid col-10"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">ALTER SEQUENCE</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="sql-alterschema.html" title="ALTER SCHEMA">Пред.</a> </td><td width="10%" align="left"><a accesskey="u" href="sql-commands.html" title="Команды SQL">Наверх</a></td><th width="60%" align="center">Команды SQL</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="Документация к PostgreSQL 16.3">Начало</a></td><td width="10%" align="right"> <a accesskey="n" href="sql-alterserver.html" title="ALTER SERVER">След.</a></td></tr></table><hr /></div><div class="refentry" id="SQL-ALTERSEQUENCE"><div class="titlepage"></div><a id="id-1.9.3.30.1" class="indexterm"></a><div class="refnamediv"><h2><span class="refentrytitle">ALTER SEQUENCE</span></h2><p>ALTER SEQUENCE — изменить определение генератора последовательности</p></div><div class="refsynopsisdiv"><h2>Синтаксис</h2><pre class="synopsis">ALTER SEQUENCE [ IF EXISTS ] <em class="replaceable"><code>имя</code></em>
    [ AS <em class="replaceable"><code>тип_данных</code></em> ]
    [ INCREMENT [ BY ] <em class="replaceable"><code>шаг</code></em> ]
    [ MINVALUE <em class="replaceable"><code>мин_значение</code></em> | NO MINVALUE ] [ MAXVALUE <em class="replaceable"><code>макс_значение</code></em> | NO MAXVALUE ]
    [ START [ WITH ] <em class="replaceable"><code>начало</code></em> ]
    [ RESTART [ [ WITH ] <em class="replaceable"><code>перезапуск</code></em> ] ]
    [ CACHE <em class="replaceable"><code>кеш</code></em> ] [ [ NO ] CYCLE ]
    [ OWNED BY { <em class="replaceable"><code>имя_таблицы</code></em>.<em class="replaceable"><code>имя_столбца</code></em> | NONE } ]
ALTER SEQUENCE [ IF EXISTS ] <em class="replaceable"><code>имя</code></em> SET { LOGGED | UNLOGGED }
ALTER SEQUENCE [ IF EXISTS ] <em class="replaceable"><code>имя</code></em> OWNER TO { <em class="replaceable"><code>новый_владелец</code></em> | CURRENT_ROLE | CURRENT_USER | SESSION_USER }
ALTER SEQUENCE [ IF EXISTS ] <em class="replaceable"><code>имя</code></em> RENAME TO <em class="replaceable"><code>новое_имя</code></em>
ALTER SEQUENCE [ IF EXISTS ] <em class="replaceable"><code>имя</code></em> SET SCHEMA <em class="replaceable"><code>новая_схема</code></em></pre></div><div class="refsect1" id="id-1.9.3.30.5"><h2>Описание</h2><p><code class="command">ALTER SEQUENCE</code> меняет параметры существующего генератора последовательности. Параметры, не определяемые явно в команде <code class="command">ALTER SEQUENCE</code>, сохраняют свои предыдущие значения.</p><p>Выполнить <code class="command">ALTER SEQUENCE</code> может только владелец соответствующей последовательности. Чтобы сменить схему последовательности, необходимо также иметь право <code class="literal">CREATE</code> в новой схеме. Чтобы сменить владельца, необходимо иметь право <code class="literal">SET ROLE</code> для новой роли-владельца, а эта роль должна иметь право <code class="literal">CREATE</code> в схеме последовательности. (С такими ограничениями при смене владельца не происходит ничего такого, что нельзя было бы сделать, имея право удалить и вновь создать последовательность. Однако суперпользователь может сменить владельца последовательности в любом случае.)</p></div><div class="refsect1" id="id-1.9.3.30.6"><h2>Параметры</h2><p>
    </p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><em class="replaceable"><code>имя</code></em></span></dt><dd><p>Имя (возможно, дополненное схемой) последовательности, подлежащей изменению.</p></dd><dt><span class="term"><code class="literal">IF EXISTS</code></span></dt><dd><p>Не считать ошибкой, если последовательность не существует. В этом случае будет выдано замечание.</p></dd><dt><span class="term"><em class="replaceable"><code>тип_данных</code></em></span></dt><dd><p>Необязательное предложение <code class="literal">AS <em class="replaceable"><code>тип_данных</code></em></code> меняет тип данных для последовательности. Допустимые типы: <code class="literal">smallint</code>, <code class="literal">integer</code> и <code class="literal">bigint</code>.</p><p>При изменении типа данных автоматически меняются минимальное и максимальное значения последовательности, в том и только в том случае, если это были минимальные и максимальные значения старого типа данных (другими словами, если последовательность была создана со свойствами <code class="literal">NO MINVALUE</code> или <code class="literal">NO MAXVALUE</code>, неявно или явно). В противном случае минимальные и максимальные значения сохраняются, если только в этой же команде не указаны новые значения. Если минимальное/максимальное значение не умещается в новом типе данных, выдаётся ошибка.</p></dd><dt><span class="term"><em class="replaceable"><code>шаг</code></em></span></dt><dd><p>Предложение <code class="literal">INCREMENT BY <em class="replaceable"><code>шаг</code></em></code> является необязательным. При положительном значении шага генерируется возрастающая последовательность, при отрицательном ­­­— убывающая; если шаг не указан, сохраняется предыдущее значение.</p></dd><dt><span class="term"><em class="replaceable"><code>мин_значение</code></em><br /></span><span class="term"><code class="literal">NO MINVALUE</code></span></dt><dd><p>Необязательное предложение <code class="literal">MINVALUE <em class="replaceable"><code>мин_значение</code></em></code> определяет минимальное значение, которое будет генерировать данная последовательность. Если указано <code class="literal">NO MINVALUE</code>, для возрастающей последовательности этим значением будет 1, а для убывающей — минимальное число для её типа данных. В отсутствие этих указаний будет сохранено текущее минимальное значение.</p></dd><dt><span class="term"><em class="replaceable"><code>макс_значение</code></em><br /></span><span class="term"><code class="literal">NO MAXVALUE</code></span></dt><dd><p>Необязательное предложение <code class="literal">MAXVALUE <em class="replaceable"><code>макс_значение</code></em></code> определяет максимальное значение, которое будет генерировать данная последовательность. Если указано <code class="literal">NO MAXVALUE</code>, для возрастающей последовательности этим значением будет максимальное число для её типа данных, а для убывающей — -1. В отсутствие этих указаний будет сохранено текущее максимальное значение.</p></dd><dt><span class="term"><em class="replaceable"><code>начало</code></em></span></dt><dd><p>Необязательное предложение <code class="literal">START WITH <em class="replaceable"><code>начало</code></em></code> меняет записанное начальное значение последовательности. При этом <span class="emphasis"><em>текущее</em></span> значение последовательности не меняется, а только устанавливается значение, которое будет применено будущими командами <code class="command">ALTER SEQUENCE RESTART</code>.</p></dd><dt><span class="term"><em class="replaceable"><code>перезапуск</code></em></span></dt><dd><p>Необязательное предложение <code class="literal">RESTART [ WITH <em class="replaceable"><code>перезапуск</code></em> ]</code> меняет текущее значение последовательности. Оно подобно вызову функции <code class="function">setval</code> с параметром <code class="literal">is_called</code> = <code class="literal">false</code>: указанное значение перезапуска будет возвращено при <span class="emphasis"><em>следующем</em></span> вызове функции <code class="function">nextval</code>. Отсутствие в <code class="literal">RESTART</code> значения <em class="replaceable"><code>перезапуск</code></em> равносильно передаче стартового значения, записанного командой <code class="command">CREATE SEQUENCE</code> или последнего установленного командой <code class="command">ALTER SEQUENCE START WITH</code>.</p><p>В отличие от вызова <code class="function">setval</code>, операция <code class="literal">RESTART</code> с последовательностью является транзакционной и не даёт параллельным транзакциям получать числа из той же последовательности. Если это поведение не устраивает, следует воспользоваться функцией <code class="function">setval</code>.</p></dd><dt><span class="term"><em class="replaceable"><code>кеш</code></em></span></dt><dd><p>Предложение <code class="literal">CACHE <em class="replaceable"><code>кеш</code></em></code> разрешает предварительно выделять и сохранять в памяти числа последовательности для ускорения доступа к ним. Минимальное значение равно 1 (т. е. за один раз генерируется только одно значение, кеширования нет). Если это предложение отсутствует, сохраняется старое значение размера кеша.</p></dd><dt><span class="term"><code class="literal">CYCLE</code></span></dt><dd><p>Необязательное ключевое слово <code class="literal">CYCLE</code> позволяет зациклить последовательность при достижении <em class="replaceable"><code>макс_значения</code></em> или <em class="replaceable"><code>мин_значения</code></em> для возрастающей и убывающей последовательности, соответственно. Когда этот предел достигается, следующим числом этих последовательностей будет соответственно <em class="replaceable"><code>мин_значение</code></em> или <em class="replaceable"><code>макс_значение</code></em>.</p></dd><dt><span class="term"><code class="literal">NO CYCLE</code></span></dt><dd><p>Если добавляется необязательное указание <code class="literal">NO CYCLE</code>, при каждом вызове <code class="function">nextval</code> после достижения предельного значения будет возникать ошибка. Если же указания <code class="literal">CYCLE</code> и <code class="literal">NO CYCLE</code> отсутствуют, сохраняется предыдущее поведение зацикливания.</p></dd><dt><span class="term"><code class="literal">SET { LOGGED | UNLOGGED }</code></span></dt><dd><p>Эта форма меняет характеристику журналирования последовательности, делает последовательность журналируемой/нежурналируемой соответственно (см. <a class="xref" href="sql-createsequence.html" title="CREATE SEQUENCE"><span class="refentrytitle">CREATE SEQUENCE</span></a>). К временной последовательности она неприменима.</p></dd><dt><span class="term"><code class="literal">OWNED BY</code> <em class="replaceable"><code>имя_таблицы</code></em>.<em class="replaceable"><code>имя_столбца</code></em><br /></span><span class="term"><code class="literal">OWNED BY NONE</code></span></dt><dd><p>Указание <code class="literal">OWNED BY</code> связывает последовательность с определённым столбцом таблицы, с тем чтобы при удалении этого столбца (или всей таблицы) автоматически удалилась и последовательность. Это указание заменяет любую ранее установленную связь данной последовательности. Целевая таблица должна иметь того же владельца и находиться в той же схеме, что и последовательность. Указание <code class="literal">OWNED BY NONE</code> убирает все существующие связи, обозначая последовательность <span class="quote">«<span class="quote">независимой</span>»</span>.</p></dd><dt><span class="term"><em class="replaceable"><code>новый_владелец</code></em></span></dt><dd><p>Имя пользователя, назначаемого новым владельцем последовательности.</p></dd><dt><span class="term"><em class="replaceable"><code>новое_имя</code></em></span></dt><dd><p>Новое имя последовательности.</p></dd><dt><span class="term"><em class="replaceable"><code>новая_схема</code></em></span></dt><dd><p>Новая схема последовательности.</p></dd></dl></div><p>
   </p></div><div class="refsect1" id="id-1.9.3.30.7"><h2>Замечания</h2><p><code class="command">ALTER SEQUENCE</code> не оказывает немедленного влияния на результаты <code class="function">nextval</code> в серверных процессах, кроме текущего, которые могли предварительно сгенерировать (кешировать) значения последовательности. Эти процессы заметят изменения только после того, как будут израсходованы все кешированные значения. Текущий серверный процесс реагирует на изменения сразу.</p><p><code class="command">ALTER SEQUENCE</code> не влияет на значение <code class="function">currval</code> последовательности. (В <span class="productname">PostgreSQL</span> до версии 8.3 это могло происходить.)</p><p><code class="command">ALTER SEQUENCE</code> блокирует параллельные вызовы <code class="function">nextval</code>, <code class="function">currval</code>, <code class="function">lastval</code> и <code class="command">setval</code>.</p><p>По историческим причинам <code class="command">ALTER TABLE</code> тоже может работать с последовательностями, но все разновидности <code class="command">ALTER TABLE</code>, допустимые для управления последовательностями, равнозначны вышеперечисленным формам.</p></div><div class="refsect1" id="id-1.9.3.30.8"><h2>Примеры</h2><p>Перезапуск последовательности <code class="literal">serial</code> с числа 105: </p><pre class="programlisting">ALTER SEQUENCE serial RESTART WITH 105;</pre></div><div class="refsect1" id="id-1.9.3.30.9"><h2>Совместимость</h2><p>Оператор <code class="command">ALTER SEQUENCE</code> соответствует стандарту <acronym class="acronym">SQL</acronym>, за исключением предложений <code class="literal">AS</code>, <code class="literal">START WITH</code>, <code class="literal">OWNED BY</code>, <code class="literal">OWNER TO</code>, <code class="literal">RENAME TO</code> и <code class="literal">SET SCHEMA</code>, являющихся расширениями <span class="productname">PostgreSQL</span>.</p></div><div class="refsect1" id="id-1.9.3.30.10"><h2>См. также</h2><span class="simplelist"><a class="xref" href="sql-createsequence.html" title="CREATE SEQUENCE"><span class="refentrytitle">CREATE SEQUENCE</span></a>, <a class="xref" href="sql-dropsequence.html" title="DROP SEQUENCE"><span class="refentrytitle">DROP SEQUENCE</span></a></span></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="sql-alterschema.html" title="ALTER SCHEMA">Пред.</a> </td><td width="20%" align="center"><a accesskey="u" href="sql-commands.html" title="Команды SQL">Наверх</a></td><td width="40%" align="right"> <a accesskey="n" href="sql-alterserver.html" title="ALTER SERVER">След.</a></td></tr><tr><td width="40%" align="left" valign="top">ALTER SCHEMA </td><td width="20%" align="center"><a accesskey="h" href="index.html" title="Документация к PostgreSQL 16.3">Начало</a></td><td width="40%" align="right" valign="top"> ALTER SERVER</td></tr></table></div></body></html>