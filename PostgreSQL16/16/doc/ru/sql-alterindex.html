<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>ALTER INDEX</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@lists.postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot" /><link rel="prev" href="sql-altergroup.html" title="ALTER GROUP" /><link rel="next" href="sql-alterlanguage.html" title="ALTER LANGUAGE" /></head><body id="docContent" class="container-fluid col-10"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">ALTER INDEX</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="sql-altergroup.html" title="ALTER GROUP">Пред.</a> </td><td width="10%" align="left"><a accesskey="u" href="sql-commands.html" title="Команды SQL">Наверх</a></td><th width="60%" align="center">Команды SQL</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="Документация к PostgreSQL 16.3">Начало</a></td><td width="10%" align="right"> <a accesskey="n" href="sql-alterlanguage.html" title="ALTER LANGUAGE">След.</a></td></tr></table><hr /></div><div class="refentry" id="SQL-ALTERINDEX"><div class="titlepage"></div><a id="id-1.9.3.16.1" class="indexterm"></a><div class="refnamediv"><h2><span class="refentrytitle">ALTER INDEX</span></h2><p>ALTER INDEX — изменить определение индекса</p></div><div class="refsynopsisdiv"><h2>Синтаксис</h2><pre class="synopsis">ALTER INDEX [ IF EXISTS ] <em class="replaceable"><code>имя</code></em> RENAME TO <em class="replaceable"><code>новое_имя</code></em>
ALTER INDEX [ IF EXISTS ] <em class="replaceable"><code>имя</code></em> SET TABLESPACE <em class="replaceable"><code>табл_пространство</code></em>
ALTER INDEX <em class="replaceable"><code>имя</code></em> ATTACH PARTITION <em class="replaceable"><code>имя_индекса</code></em>
ALTER INDEX <em class="replaceable"><code>имя</code></em> [ NO ] DEPENDS ON EXTENSION <em class="replaceable"><code>имя_расширения</code></em>
ALTER INDEX [ IF EXISTS ] <em class="replaceable"><code>имя</code></em> SET ( <em class="replaceable"><code>параметр_хранения</code></em> [= <em class="replaceable"><code>значение</code></em>] [, ... ] )
ALTER INDEX [ IF EXISTS ] <em class="replaceable"><code>имя</code></em> RESET ( <em class="replaceable"><code>параметр_хранения</code></em> [, ... ] )
ALTER INDEX [ IF EXISTS ] <em class="replaceable"><code>имя</code></em> ALTER [ COLUMN ] <em class="replaceable"><code>номер_столбца</code></em>
    SET STATISTICS <em class="replaceable"><code>целое</code></em>
ALTER INDEX ALL IN TABLESPACE <em class="replaceable"><code>имя</code></em> [ OWNED BY <em class="replaceable"><code>имя_роли</code></em> [, ... ] ]
    SET TABLESPACE <em class="replaceable"><code>новое_табл_пространство</code></em> [ NOWAIT ]</pre></div><div class="refsect1" id="id-1.9.3.16.5"><h2>Описание</h2><p><code class="command">ALTER INDEX</code> меняет определение существующего индекса. Несколько её разновидностей описаны ниже. Заметьте, что для разных разновидностей могут требоваться разные уровни блокировок. Если явно не отмечено другое, требуется блокировка <code class="literal">ACCESS EXCLUSIVE</code>. При перечислении нескольких подкоманд будет запрашиваться самая сильная блокировка из требуемых ими. </p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">RENAME</code></span></dt><dd><p>Форма <code class="literal">RENAME</code> меняет имя индекса. Если этот индекс связан с ограничением таблицы (<code class="literal">UNIQUE</code>, <code class="literal">PRIMARY KEY</code> или <code class="literal">EXCLUDE</code>), это ограничение тоже переименовывается. На сохранённые данные это не влияет.</p><p>Для переименования индекса требуется блокировка <code class="literal">SHARE UPDATE EXCLUSIVE</code>.</p></dd><dt><span class="term"><code class="literal">SET TABLESPACE</code></span></dt><dd><p>Эта форма меняет табличное пространство индекса на заданное и переносит в него файл(ы) данных, связанные с индексом. Для изменения табличного пространства индекса нужно быть владельцем индекса и иметь право <code class="literal">CREATE</code> в новом табличном пространстве. Форма <code class="literal">ALL IN TABLESPACE</code> позволяет перенести из заданного пространства все индексы в текущей базе данных, блокируя их для перемещения и затем перемещая каждый индекс. Эта форма также поддерживает указание <code class="literal">OWNED BY</code>, с которым будут перемещены только индексы, принадлежащие заданным ролям. Если указан параметр <code class="literal">NOWAIT</code>, команда завершится ошибкой, если не сможет немедленно получить все требуемые блокировки. Заметьте, что эта команда не переместит системные каталоги; вместо неё следует использовать <code class="command">ALTER DATABASE</code> или явные вызовы <code class="command">ALTER INDEX</code>. См. также описание <a class="link" href="sql-createtablespace.html" title="CREATE TABLESPACE"><code class="command">CREATE TABLESPACE</code></a>.</p></dd><dt><span class="term"><code class="literal">ATTACH PARTITION</code></span></dt><dd><p>Эта форма присоединяет указанный индекс к изменяемому. Указанный индекс должен относиться к секции таблицы, содержащей изменяемый индекс, и иметь такое же определение. Присоединённый индекс не может быть удалён независимо, но будет удалён автоматически при удалении родительского индекса.</p></dd><dt><span class="term"><code class="literal">DEPENDS ON EXTENSION <em class="replaceable"><code>имя_расширения</code></em></code><br /></span><span class="term"><code class="literal">NO DEPENDS ON EXTENSION <em class="replaceable"><code>имя_расширения</code></em></code></span></dt><dd><p>Эта форма делает индекс зависимым от расширения или, наоборот, удаляет эту зависимость, если указывается <code class="literal">NO</code>. Индекс, помеченный как зависимый от расширения, автоматически удаляется при удалении расширения.</p></dd><dt><span class="term"><code class="literal">SET ( <em class="replaceable"><code>параметр_хранения</code></em> [= <em class="replaceable"><code>значение</code></em>] [, ... ] )</code></span></dt><dd><p>Эта форма настраивает один или несколько специфичных для индекса параметров хранения. Список доступных параметров приведён в описании <a class="link" href="sql-createindex.html" title="CREATE INDEX"><code class="command">CREATE INDEX</code></a>. Заметьте, что эта команда не меняет содержимое индекса немедленно; для получения желаемого эффекта в зависимости от параметров может потребоваться перестроить индекс командой <a class="link" href="sql-reindex.html" title="REINDEX"><code class="command">REINDEX</code></a>.</p></dd><dt><span class="term"><code class="literal">RESET ( <em class="replaceable"><code>параметр_хранения</code></em> [, ... ] )</code></span></dt><dd><p>Эта форма сбрасывает один или несколько специфичных для индекса параметров хранения к значениям по умолчанию. Как и с <code class="literal">SET</code>, для полного обновления индекса может потребоваться выполнить <code class="literal">REINDEX</code>.</p></dd><dt><span class="term"><code class="literal">ALTER [ COLUMN ] <em class="replaceable"><code>номер_столбца</code></em> SET STATISTICS <em class="replaceable"><code>целое</code></em></code></span></dt><dd><p>Эта форма задаёт ориентир сбора статистики по столбцу для последующих операций <a class="link" href="sql-analyze.html" title="ANALYZE"><code class="command">ANALYZE</code></a>, хотя её можно использовать только для индексируемых столбцов, заданных в виде выражений. Так как у выражений нет уникальных имён, мы обращаемся к ним по порядковым номерам столбцов в индексе. Диапазон допустимых значений ориентира: 0..10000; при -1 применяется системное значение по умолчанию (<a class="xref" href="runtime-config-query.html#GUC-DEFAULT-STATISTICS-TARGET">default_statistics_target</a>). За дополнительными сведениями об использовании статистики планировщиком запросов <span class="productname">PostgreSQL</span> обратитесь к <a class="xref" href="planner-stats.html" title="14.2. Статистика, используемая планировщиком">Разделу 14.2</a>.</p></dd></dl></div></div><div class="refsect1" id="id-1.9.3.16.6"><h2>Параметры</h2><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">IF EXISTS</code></span></dt><dd><p>Не считать ошибкой, если индекс не существует. В этом случае будет выдано замечание.</p></dd><dt><span class="term"><em class="replaceable"><code>номер_столбца</code></em></span></dt><dd><p>Число, указывающее на номер столбца в индексе по порядку (слева направо).</p></dd><dt><span class="term"><em class="replaceable"><code>имя</code></em></span></dt><dd><p>Имя (возможно, дополненное схемой) существующего индекса, подлежащего изменению.</p></dd><dt><span class="term"><em class="replaceable"><code>новое_имя</code></em></span></dt><dd><p>Новое имя индекса.</p></dd><dt><span class="term"><em class="replaceable"><code>табл_пространство</code></em></span></dt><dd><p>Табличное пространство, в которое будет перемещён индекс.</p></dd><dt><span class="term"><em class="replaceable"><code>имя_расширения</code></em></span></dt><dd><p>Имя расширения, от которого будет зависеть индекс.</p></dd><dt><span class="term"><em class="replaceable"><code>параметр_хранения</code></em></span></dt><dd><p>Имя специфичного для индекса параметра хранения.</p></dd><dt><span class="term"><em class="replaceable"><code>значение</code></em></span></dt><dd><p>Новое значение специфичного для индекса параметра хранения. Это может быть число или строка, в зависимости от параметра.</p></dd></dl></div></div><div class="refsect1" id="id-1.9.3.16.7"><h2>Замечания</h2><p>Эти операции также возможно выполнить с помощью <a class="link" href="sql-altertable.html" title="ALTER TABLE"><code class="command">ALTER TABLE</code></a>. На самом деле <code class="command">ALTER INDEX</code> ­­­— это просто синоним форм <code class="command">ALTER TABLE</code>, работающих с индексами.</p><p>Ранее существовала форма <code class="command">ALTER INDEX OWNER</code>, но сейчас она игнорируется (с предупреждением). Владельцем индекса может быть только владелец соответствующей таблицы. При смене владельца таблицы владелец индекса меняется автоматически.</p><p>Какие-либо изменения индексов системного каталога не допускаются.</p></div><div class="refsect1" id="id-1.9.3.16.8"><h2>Примеры</h2><p>Переименование существующего индекса: </p><pre class="programlisting">ALTER INDEX distributors RENAME TO suppliers;</pre><p>Перемещение индекса в другое табличное пространство: </p><pre class="programlisting">ALTER INDEX distributors SET TABLESPACE fasttablespace;</pre><p>Изменение фактора заполнения индекса (предполагается, что это поддерживает метод индекса): </p><pre class="programlisting">ALTER INDEX distributors SET (fillfactor = 75);
REINDEX INDEX distributors;</pre><p>Устанавливает ориентир сбора статистики для индекса по выражению: </p><pre class="programlisting">CREATE INDEX coord_idx ON measured (x, y, (z + t));
ALTER INDEX coord_idx ALTER COLUMN 3 SET STATISTICS 1000;</pre></div><div class="refsect1" id="id-1.9.3.16.9"><h2>Совместимость</h2><p><code class="command">ALTER INDEX</code> является расширением <span class="productname">PostgreSQL</span>.</p></div><div class="refsect1" id="id-1.9.3.16.10"><h2>См. также</h2><span class="simplelist"><a class="xref" href="sql-createindex.html" title="CREATE INDEX"><span class="refentrytitle">CREATE INDEX</span></a>, <a class="xref" href="sql-reindex.html" title="REINDEX"><span class="refentrytitle">REINDEX</span></a></span></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="sql-altergroup.html" title="ALTER GROUP">Пред.</a> </td><td width="20%" align="center"><a accesskey="u" href="sql-commands.html" title="Команды SQL">Наверх</a></td><td width="40%" align="right"> <a accesskey="n" href="sql-alterlanguage.html" title="ALTER LANGUAGE">След.</a></td></tr><tr><td width="40%" align="left" valign="top">ALTER GROUP </td><td width="20%" align="center"><a accesskey="h" href="index.html" title="Документация к PostgreSQL 16.3">Начало</a></td><td width="40%" align="right" valign="top"> ALTER LANGUAGE</td></tr></table></div></body></html>