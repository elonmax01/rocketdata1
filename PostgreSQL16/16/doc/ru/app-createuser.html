<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>createuser</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@lists.postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot" /><link rel="prev" href="app-createdb.html" title="createdb" /><link rel="next" href="app-dropdb.html" title="dropdb" /></head><body id="docContent" class="container-fluid col-10"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center"><span class="application">createuser</span></th></tr><tr><td width="10%" align="left"><a accesskey="p" href="app-createdb.html" title="createdb">Пред.</a> </td><td width="10%" align="left"><a accesskey="u" href="reference-client.html" title="Клиентские приложения PostgreSQL">Наверх</a></td><th width="60%" align="center">Клиентские приложения PostgreSQL</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="Документация к PostgreSQL 16.3">Начало</a></td><td width="10%" align="right"> <a accesskey="n" href="app-dropdb.html" title="dropdb">След.</a></td></tr></table><hr /></div><div class="refentry" id="APP-CREATEUSER"><div class="titlepage"></div><a id="id-1.9.4.5.1" class="indexterm"></a><div class="refnamediv"><h2><span class="refentrytitle"><span class="application">createuser</span></span></h2><p>createuser — создать новую учётную запись <span class="productname">PostgreSQL</span></p></div><div class="refsynopsisdiv"><h2>Синтаксис</h2><div class="cmdsynopsis"><p id="id-1.9.4.5.4.1"><code class="command">createuser</code> [<em class="replaceable"><code>параметр-подключения</code></em>...] [<em class="replaceable"><code>параметр</code></em>...] [<em class="replaceable"><code>имя_пользователя</code></em>]</p></div></div><div class="refsect1" id="id-1.9.4.5.5"><h2>Описание</h2><p><span class="application">createuser</span> создаёт нового пользователя <span class="productname">PostgreSQL</span>, а если точнее — роль. Лишь суперпользователь и пользователи с привилегией <code class="literal">CREATEROLE</code> могут создавать новые роли, таким образом, <span class="application">createuser</span> должна запускаться от их лица.</p><p>Чтобы создать роль с правом <code class="literal">SUPERUSER</code>, <code class="literal">REPLICATION</code> или <code class="literal">BYPASSRLS</code>, необходимо подключиться от имени существующего суперпользователя, одного лишь права <code class="literal">CREATEROLE</code> недостаточно. Поскольку суперпользователи могут обходить все ограничения доступа в базе данных, к назначению этих полномочий не следует относиться легкомысленно.</p><p><span class="application">createuser</span> — это обёртка для <acronym class="acronym">SQL</acronym>-команды <a class="link" href="sql-createrole.html" title="CREATE ROLE"><code class="command">CREATE ROLE</code></a>. Создание пользователей с её помощью по сути не отличается от выполнения того же действия при обращении к серверу другими способами.</p></div><div class="refsect1" id="id-1.9.4.5.6"><h2>Параметры</h2><p><span class="application">createuser</span> принимает следующие аргументы: </p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><em class="replaceable"><code>имя_пользователя</code></em></span></dt><dd><p>Задаёт имя создаваемого пользователя <span class="productname">PostgreSQL</span>. Это имя должно отличаться от имён всех существующих ролей в данной инсталляции <span class="productname">PostgreSQL</span>.</p></dd><dt><span class="term"><code class="option">-a <em class="replaceable"><code>role</code></em></code><br /></span><span class="term"><code class="option">--with-admin=<em class="replaceable"><code>role</code></em></code></span></dt><dd><p>Указывает существующую роль, которая автоматически добавляется в качестве члена новой роли с правом <code class="literal">ADMIN OPTION</code>, что позволяет ей выдавать членство в новой роли другим ролям. Можно указать несколько существующих ролей, добавив ключ <code class="option">-a</code> несколько раз.</p></dd><dt><span class="term"><code class="option">-c <em class="replaceable"><code>номер</code></em></code><br /></span><span class="term"><code class="option">--connection-limit=<em class="replaceable"><code>номер</code></em></code></span></dt><dd><p>Устанавливает максимальное допустимое количество соединений для создаваемого пользователя. По умолчанию ограничение в количестве соединений отсутствует.</p></dd><dt><span class="term"><code class="option">-d</code><br /></span><span class="term"><code class="option">--createdb</code></span></dt><dd><p>Разрешает новому пользователю создавать базы данных.</p></dd><dt><span class="term"><code class="option">-D</code><br /></span><span class="term"><code class="option">--no-createdb</code></span></dt><dd><p>Запрещает новому пользователю создавать базы данных. Это поведение по умолчанию.</p></dd><dt><span class="term"><code class="option">-e</code><br /></span><span class="term"><code class="option">--echo</code></span></dt><dd><p>Вывести команды к серверу, генерируемые при выполнении <span class="application">createuser</span>.</p></dd><dt><span class="term"><code class="option">-E</code><br /></span><span class="term"><code class="option">--encrypted</code></span></dt><dd><p>Параметр является устаревшим, но в целях совместимости ещё работает.</p></dd><dt><span class="term"><code class="option">-g <em class="replaceable"><code>role</code></em></code><br /></span><span class="term"><code class="option">--member-of=<em class="replaceable"><code>role</code></em></code><br /></span><span class="term"><code class="option">--role=<em class="replaceable"><code>роль</code></em></code> (устаревший аргумент)</span></dt><dd><p>Указывает, что новая роль должна быть автоматически добавлена в качестве члена указанной существующей группы. Можно указать несколько существующих ролей, добавив ключ <code class="option">-g</code> несколько раз.</p></dd><dt><span class="term"><code class="option">-i</code><br /></span><span class="term"><code class="option">--inherit</code></span></dt><dd><p>Создаваемая роль автоматически унаследует права ролей, в которые она включается. Это поведение по умолчанию.</p></dd><dt><span class="term"><code class="option">-I</code><br /></span><span class="term"><code class="option">--no-inherit</code></span></dt><dd><p>Роль не будет наследовать права ролей, в которые она включается.</p></dd><dt><span class="term"><code class="option">--interactive</code></span></dt><dd><p>Запросить имя для создаваемого пользователя, а также значения для флагов <code class="option">-d</code>/<code class="option">-D</code>, <code class="option">-r</code>/<code class="option">-R</code>, <code class="option">-s</code>/<code class="option">-S</code>, если они явно не указаны в командной строке. До версии PostgreSQL 9.1 включительно это было поведением по умолчанию.</p></dd><dt><span class="term"><code class="option">-l</code><br /></span><span class="term"><code class="option">--login</code></span></dt><dd><p>Новый пользователь сможет подключаться к серверу (то есть его имя может быть идентификатором начального пользователя сеанса). Это свойство по умолчанию.</p></dd><dt><span class="term"><code class="option">-L</code><br /></span><span class="term"><code class="option">--no-login</code></span></dt><dd><p>Новый пользователь не сможет подключаться к серверу. (Роль без права входа на сервер тем не менее полезна для управления разрешениями в базе данных.)</p></dd><dt><span class="term"><code class="option">-m <em class="replaceable"><code>role</code></em></code><br /></span><span class="term"><code class="option">--with-member=<em class="replaceable"><code>role</code></em></code></span></dt><dd><p>Указывает существующую роль, которая автоматически добавляется в качестве члена новой роли. Можно указать несколько существующих ролей, добавив ключ <code class="option">-m</code> несколько раз.</p></dd><dt><span class="term"><code class="option">-P</code><br /></span><span class="term"><code class="option">--pwprompt</code></span></dt><dd><p>Если флаг указан, то <span class="application">createuser</span> запросит пароль для создаваемого пользователя. Если не планируется аутентификация по паролю, то пароль можно не устанавливать.</p></dd><dt><span class="term"><code class="option">-r</code><br /></span><span class="term"><code class="option">--createrole</code></span></dt><dd><p>Новый пользователь сможет создавать, изменять и удалять другие роли, добавлять для них комментарии и изменять метку безопасности (то есть этот пользователь будет иметь право <code class="literal">CREATEROLE</code>). Подробнее возможности, предоставляемые этим правом, описаны в <a class="xref" href="role-attributes.html#ROLE-CREATION">Создание роли</a>.</p></dd><dt><span class="term"><code class="option">-R</code><br /></span><span class="term"><code class="option">--no-createrole</code></span></dt><dd><p>Запрещает пользователю создавать новые роли. Это поведение по умолчанию.</p></dd><dt><span class="term"><code class="option">-s</code><br /></span><span class="term"><code class="option">--superuser</code></span></dt><dd><p>Создаваемая роль будет иметь права суперпользователя.</p></dd><dt><span class="term"><code class="option">-S</code><br /></span><span class="term"><code class="option">--no-superuser</code></span></dt><dd><p>Новый пользователь не будет суперпользователем. Это поведение по умолчанию.</p></dd><dt><span class="term"><code class="option">-v <em class="replaceable"><code>отметка_времени</code></em></code><br /></span><span class="term"><code class="option">--valid-until=<em class="replaceable"><code>отметка_времени</code></em></code></span></dt><dd><p>Задаёт дату и время, после которого пароль роли перестаёт действовать. По умолчанию срок действия пароля будет неограниченным.</p></dd><dt><span class="term"><code class="option">-V</code><br /></span><span class="term"><code class="option">--version</code></span></dt><dd><p>Вывести версию <span class="application">createuser</span> и завершить выполнение.</p></dd><dt><span class="term"><code class="option">--bypassrls</code></span></dt><dd><p>Новый пользователь не подчиняется никаким политикам защиты на уровне строк (RLS).</p></dd><dt><span class="term"><code class="option">--no-bypassrls</code></span></dt><dd><p>На нового пользователя распространяются политики защиты на уровне строк (RLS). Это поведение по умолчанию.</p></dd><dt><span class="term"><code class="option">--replication</code></span></dt><dd><p>Создаваемый пользователь будет наделён правом <code class="literal">REPLICATION</code>. Это рассмотрено подробнее в документации по <a class="xref" href="sql-createrole.html" title="CREATE ROLE"><span class="refentrytitle">CREATE ROLE</span></a>.</p></dd><dt><span class="term"><code class="option">--no-replication</code></span></dt><dd><p>Создаваемый пользователь не будет иметь привилегии <code class="literal">REPLICATION</code>, что рассмотрено подробнее в документации по <a class="xref" href="sql-createrole.html" title="CREATE ROLE"><span class="refentrytitle">CREATE ROLE</span></a>. Это поведение по умолчанию.</p></dd><dt><span class="term"><code class="option">-?</code><br /></span><span class="term"><code class="option">--help</code></span></dt><dd><p>Вывести помощь по команде <span class="application">createuser</span>.</p></dd></dl></div><p><span class="application">createuser</span> также принимает из командной строки параметры подключения: </p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="option">-h <em class="replaceable"><code>сервер</code></em></code><br /></span><span class="term"><code class="option">--host=<em class="replaceable"><code>сервер</code></em></code></span></dt><dd><p>Указывает имя компьютера, на котором работает сервер. Если значение начинается с косой черты, оно определяет каталог Unix-сокета.</p></dd><dt><span class="term"><code class="option">-p <em class="replaceable"><code>порт</code></em></code><br /></span><span class="term"><code class="option">--port=<em class="replaceable"><code>порт</code></em></code></span></dt><dd><p>Указывает TCP-порт или расширение файла локального Unix-сокета, через который сервер принимает подключения.</p></dd><dt><span class="term"><code class="option">-U <em class="replaceable"><code>имя_пользователя</code></em></code><br /></span><span class="term"><code class="option">--username=<em class="replaceable"><code>имя_пользователя</code></em></code></span></dt><dd><p>Имя пользователя для подключения (не имя создаваемого пользователя).</p></dd><dt><span class="term"><code class="option">-w</code><br /></span><span class="term"><code class="option">--no-password</code></span></dt><dd><p>Не выдавать запрос на ввод пароля. Если сервер требует аутентификацию по паролю и пароль не доступен с помощью других средств, таких как файл <code class="filename">.pgpass</code>, попытка соединения не удастся. Этот параметр может быть полезен в пакетных заданиях и скриптах, где нет пользователя, который вводит пароль.</p></dd><dt><span class="term"><code class="option">-W</code><br /></span><span class="term"><code class="option">--password</code></span></dt><dd><p>Принудительно запрашивать пароль перед подключением к базе данных.</p><p>Это несущественный параметр, так как <span class="application">createuser</span> запрашивает пароль автоматически, если сервер проверяет подлинность по паролю. Однако чтобы понять это, <span class="application">createuser</span> лишний раз подключается к серверу. Поэтому иногда имеет смысл ввести <code class="option">-W</code>, чтобы исключить эту ненужную попытку подключения.</p></dd></dl></div></div><div class="refsect1" id="id-1.9.4.5.7"><h2>Переменные окружения</h2><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="envar">PGHOST</code><br /></span><span class="term"><code class="envar">PGPORT</code><br /></span><span class="term"><code class="envar">PGUSER</code></span></dt><dd><p>Параметры подключения по умолчанию</p></dd><dt><span class="term"><code class="envar">PG_COLOR</code></span></dt><dd><p>Выбирает вариант использования цвета в диагностических сообщениях. Возможные значения: <code class="literal">always</code> (всегда), <code class="literal">auto</code> (автоматически) и <code class="literal">never</code> (никогда).</p></dd></dl></div><p>Эта утилита, как и большинство других утилит <span class="productname">PostgreSQL</span>, также использует переменные среды, поддерживаемые <span class="application">libpq</span> (см. <a class="xref" href="libpq-envars.html" title="34.15. Переменные окружения">Раздел 34.15</a>).</p></div><div class="refsect1" id="id-1.9.4.5.8"><h2>Диагностика</h2><p>В случае возникновения трудностей, обратитесь к <a class="xref" href="sql-createrole.html" title="CREATE ROLE"><span class="refentrytitle">CREATE ROLE</span></a> и <a class="xref" href="app-psql.html" title="psql"><span class="refentrytitle"><span class="application">psql</span></span></a>. Переменные окружения и параметры подключения по умолчанию <span class="application">libpq</span> будут применены при запуске утилиты, это следует учитывать при диагностике.</p></div><div class="refsect1" id="id-1.9.4.5.9"><h2>Примеры</h2><p>Чтобы создать роль <code class="literal">joe</code> на сервере, используемом по умолчанию: </p><pre class="screen">
<code class="prompt">$ </code><strong class="userinput"><code>createuser joe</code></strong>
</pre><p>Чтобы создать роль <code class="literal">joe</code> на сервере, используемом по умолчанию, с запросом дополнительных параметров: </p><pre class="screen">
<code class="prompt">$ </code><strong class="userinput"><code>createuser --interactive joe</code></strong>
<code class="computeroutput">Назначить роль суперпользователем? (y/n) </code><strong class="userinput"><code>n</code></strong>
<code class="computeroutput">Разрешить новой роли создавать базы данных? (y/n) </code><strong class="userinput"><code>n</code></strong>
<code class="computeroutput">Разрешить новой роли создавать другие роли? (y/n) </code><strong class="userinput"><code>n</code></strong>
</pre><p>Чтобы создать того же пользователя <code class="literal">joe</code> с явно заданными атрибутами, подключившись к компьютеру <code class="literal">eden</code>, порту 5000: </p><pre class="screen">
<code class="prompt">$ </code><strong class="userinput"><code>createuser -h eden -p 5000 -S -D -R -e joe</code></strong>
<code class="computeroutput">CREATE ROLE joe NOSUPERUSER NOCREATEDB NOCREATEROLE INHERIT LOGIN;</code>
</pre><p>Чтобы создать роль <code class="literal">joe</code> с правами суперпользователя и предустановленным паролем: </p><pre class="screen">
<code class="prompt">$ </code><strong class="userinput"><code>createuser -P -s -e joe</code></strong>
<code class="computeroutput">Введите пароль для новой роли: </code><strong class="userinput"><code>xyzzy</code></strong>
<code class="computeroutput">Повторите его: </code><strong class="userinput"><code>xyzzy</code></strong>
<code class="computeroutput">CREATE ROLE joe PASSWORD 'md5b5f5ba1a423792b526f799ae4eb3d59e' SUPERUSER CREATEDB CREATEROLE INHERIT LOGIN;</code>
</pre><p> В приведённом примере введённый пароль отображается лишь для отражения сути, на деле же он не выводится на экран. Как можно видеть, он шифруется прежде чем передаётся в команде клиенту.</p></div><div class="refsect1" id="id-1.9.4.5.10"><h2>См. также</h2><span class="simplelist"><a class="xref" href="app-dropuser.html" title="dropuser"><span class="refentrytitle"><span class="application">dropuser</span></span></a>, <a class="xref" href="sql-createrole.html" title="CREATE ROLE"><span class="refentrytitle">CREATE ROLE</span></a>, <a class="xref" href="runtime-config-client.html#GUC-CREATEROLE-SELF-GRANT">createrole_self_grant</a></span></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="app-createdb.html" title="createdb">Пред.</a> </td><td width="20%" align="center"><a accesskey="u" href="reference-client.html" title="Клиентские приложения PostgreSQL">Наверх</a></td><td width="40%" align="right"> <a accesskey="n" href="app-dropdb.html" title="dropdb">След.</a></td></tr><tr><td width="40%" align="left" valign="top"><span class="application">createdb</span> </td><td width="20%" align="center"><a accesskey="h" href="index.html" title="Документация к PostgreSQL 16.3">Начало</a></td><td width="40%" align="right" valign="top"> <span class="application">dropdb</span></td></tr></table></div></body></html>