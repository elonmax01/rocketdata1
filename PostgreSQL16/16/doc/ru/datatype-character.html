<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>8.3. Символьные типы</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@lists.postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot" /><link rel="prev" href="datatype-money.html" title="8.2. Денежные типы" /><link rel="next" href="datatype-binary.html" title="8.4. Двоичные типы данных" /></head><body id="docContent" class="container-fluid col-10"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">8.3. Символьные типы</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="datatype-money.html" title="8.2. Денежные типы">Пред.</a> </td><td width="10%" align="left"><a accesskey="u" href="datatype.html" title="Глава 8. Типы данных">Наверх</a></td><th width="60%" align="center">Глава 8. Типы данных</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="Документация к PostgreSQL 16.3">Начало</a></td><td width="10%" align="right"> <a accesskey="n" href="datatype-binary.html" title="8.4. Двоичные типы данных">След.</a></td></tr></table><hr /></div><div class="sect1" id="DATATYPE-CHARACTER"><div class="titlepage"><div><div><h2 class="title" style="clear: both">8.3. Символьные типы <a href="#DATATYPE-CHARACTER" class="id_link">#</a></h2></div></div></div><a id="id-1.5.7.11.2" class="indexterm"></a><a id="id-1.5.7.11.3" class="indexterm"></a><a id="id-1.5.7.11.4" class="indexterm"></a><a id="id-1.5.7.11.5" class="indexterm"></a><a id="id-1.5.7.11.6" class="indexterm"></a><a id="id-1.5.7.11.7" class="indexterm"></a><a id="id-1.5.7.11.8" class="indexterm"></a><a id="id-1.5.7.11.9" class="indexterm"></a><div class="table" id="DATATYPE-CHARACTER-TABLE"><p class="title"><strong>Таблица 8.4. Символьные типы</strong></p><div class="table-contents"><table class="table" summary="Символьные типы" border="1"><colgroup><col /><col /></colgroup><thead><tr><th>Name</th><th>Описание</th></tr></thead><tbody><tr><td><code class="type">character varying(<em class="replaceable"><code>n</code></em>)</code>, <code class="type">varchar(<em class="replaceable"><code>n</code></em>)</code></td><td>строка ограниченной переменной длины</td></tr><tr><td><code class="type">character(<em class="replaceable"><code>n</code></em>)</code>, <code class="type">char(<em class="replaceable"><code>n</code></em>)</code>, <code class="type">bpchar(<em class="replaceable"><code>n</code></em>)</code></td><td>строка фиксированной длины, дополненная пробелами</td></tr><tr><td><code class="type">bpchar</code></td><td>строка неограниченной переменной длины с удалением пробелов</td></tr><tr><td><code class="type">text</code></td><td>строка неограниченной переменной длины</td></tr></tbody></table></div></div><br class="table-break" /><p>В <a class="xref" href="datatype-character.html#DATATYPE-CHARACTER-TABLE" title="Таблица 8.4. Символьные типы">Таблице 8.4</a> перечислены символьные типы общего назначения, доступные в <span class="productname">PostgreSQL</span>.</p><p><acronym class="acronym">SQL</acronym> определяет два основных символьных типа: <code class="type">character varying(<em class="replaceable"><code>n</code></em>)</code> и <code class="type">character(<em class="replaceable"><code>n</code></em>)</code>, где <em class="replaceable"><code>n</code></em> — положительное число. Оба эти типа могут хранить текстовые строки длиной до <em class="replaceable"><code>n</code></em> символов (не байт). Попытка сохранить в столбце такого типа более длинную строку приведёт к ошибке, если только все лишние символы не являются пробелами (тогда они будут усечены до максимально допустимой длины). (Это несколько странное исключение продиктовано стандартом <acronym class="acronym">SQL</acronym>.) Однако если явно привести значение к типу <code class="type">character varying(<em class="replaceable"><code>n</code></em>)</code> или <code class="type">character(<em class="replaceable"><code>n</code></em>)</code>, то слишком длинное значение будет усечено до <em class="replaceable"><code>n</code></em> символов без возникновения ошибки. (Это также является требованием стандарта <acronym class="acronym">SQL</acronym>.) Если длина сохраняемой строки оказывается меньше объявленной, значения типа <code class="type">character</code> будут дополнятся пробелами, а тип <code class="type">character varying</code> просто сохранит короткую строку.</p><p>Помимо этого, <span class="productname">PostgreSQL</span> предлагает тип <code class="type">text</code>, в котором можно хранить строки произвольной длины. Хотя тип <code class="type">text</code> не описан в стандарте <acronym class="acronym">SQL</acronym>, его поддерживают и некоторые другие СУБД SQL. Тип <code class="type">text</code> — это встроенный строковый тип данных <span class="productname">PostgreSQL</span>, и большинство встроенных функций, работающих со строками, объявляются принимающими или возвращающими <code class="type">text</code>, а не <code class="type">character varying</code>. Во многих случаях <code class="type">character varying</code> действует так, как если бы это был <a class="link" href="domains.html" title="8.18. Типы доменов">домен</a> поверх <code class="type">text</code>.</p><p>Имя типа <code class="type">varchar</code> является псевдонимом для <code class="type">character varying</code>, а <code class="type">char</code> и <code class="type">bpchar</code> (с указанием длины) — для <code class="type">character</code>. Псевдонимы <code class="type">varchar</code> и <code class="type">char</code> определены в стандарте <acronym class="acronym">SQL</acronym>, но <code class="type">bpchar</code> — это расширение <span class="productname">PostgreSQL</span>.</p><p>Если <em class="replaceable"><code>n</code></em> задано, оно должно быть больше нуля и меньше или равно 10485760. При использовании типов <code class="type">character varying</code> (или <code class="type">varchar</code>) без указания длины принимаются строки любой длины. При использовании типа <code class="type">bpchar</code> без указания длины также принимаются строки любой длины, но конечные пробелы семантически не учитываются. Записи <code class="type">character</code> (или <code class="type">char</code>) без указания длины соответствует <code class="type">character(1)</code>.</p><p>Значения типа <code class="type">character</code> физически дополняются пробелами до <em class="replaceable"><code>n</code></em> символов и хранятся, а затем отображаются в таком виде. Однако при сравнении двух значений типа <code class="type">character</code> дополняющие пробелы считаются незначащими и игнорируются. С правилами сортировки, где пробельные символы являются значащими, это поведение может приводить к неожиданным результатам, например <code class="command">SELECT 'a '::CHAR(2) collate "C" &lt; E'a\n'::CHAR(2)</code> вернёт true (условие будет истинным), хотя в локали C символ пробела считается больше символа новой строки. При приведении значения <code class="type">character</code> к другому символьному типу дополняющие пробелы отбрасываются. Заметьте, что эти пробелы <span class="emphasis"><em>несут</em></span> смысловую нагрузку в типах <code class="type">character varying</code> и <code class="type">text</code> и в проверках по шаблонам, то есть в <code class="literal">LIKE</code> и регулярных выражениях.</p><p>Какие именно символы можно сохранить в этих типах данных, зависит от того, какой набор символов был выбран при создании базы данных. Однако символ с кодом 0 (иногда называемый NUL) сохранить нельзя, вне зависимости от выбранного набора символов. За подробностями обратитесь к <a class="xref" href="multibyte.html" title="24.3. Поддержка кодировок">Разделу 24.3</a>.</p><p>Для хранения короткой строки (до 126 байт) требуется дополнительный 1 байт плюс размер самой строки, включая дополняющие пробелы для типа <code class="type">character</code>. Для строк длиннее требуется не 1, а 4 дополнительных байта. Система может автоматически сжимать длинные строки, так что физический размер на диске может быть меньше. Очень длинные текстовые строки переносятся в отдельные таблицы, чтобы они не замедляли работу с другими столбцами. В любом случае максимально возможный размер строки составляет около 1 ГБ. (Допустимое значение <em class="replaceable"><code>n</code></em> в объявлении типа данных меньше этого числа. Это объясняется тем, что в зависимости от кодировки каждый символ может занимать несколько байт. Если вы желаете сохранять строки без определённого предела длины, используйте типы <code class="type">text</code> или <code class="type">character varying</code> без указания длины, а не задавайте какое-либо большое максимальное значение.)</p><div class="tip"><h3 class="title">Подсказка</h3><p>По быстродействию эти три типа практически не отличаются друг от друга, не считая большего размера хранения для типа с дополняющими пробелами и нескольких машинных операций для проверки длины при сохранении строк в столбце с ограниченной длиной. Хотя в некоторых СУБД тип <code class="type">character(<em class="replaceable"><code>n</code></em>)</code> работает быстрее других, в <span class="productname">PostgreSQL</span> это не так; на деле <code class="type">character(<em class="replaceable"><code>n</code></em>)</code> обычно оказывается медленнее остальных типов из-за большего размера данных и более медленной сортировки. В большинстве случаев вместо него лучше применять <code class="type">text</code> или <code class="type">character varying</code>.</p></div><p>За информацией о синтаксисе строковых констант обратитесь к <a class="xref" href="sql-syntax-lexical.html#SQL-SYNTAX-STRINGS" title="4.1.2.1. Строковые константы">Подразделу 4.1.2.1</a>, а об имеющихся операторах и функциях вы можете узнать в <a class="xref" href="functions.html" title="Глава 9. Функции и операторы">Главе 9</a>.</p><div class="example" id="id-1.5.7.11.21"><p class="title"><strong>Пример 8.1. Использование символьных типов</strong></p><div class="example-contents"><pre class="programlisting">CREATE TABLE test1 (a character(4));
INSERT INTO test1 VALUES ('ok');
SELECT a, char_length(a) FROM test1; -- <span id="co.datatype-char"></span>(1)
<code class="computeroutput">
  a   | char_length
------+-------------
 ok   |           2
</code>

CREATE TABLE test2 (b varchar(5));
INSERT INTO test2 VALUES ('ok');
INSERT INTO test2 VALUES ('good      ');
INSERT INTO test2 VALUES ('too long');
<code class="computeroutput">ОШИБКА:  значение не умещается в тип character varying(5)</code>
INSERT INTO test2 VALUES ('too long'::varchar(5)); -- явное усечение
SELECT b, char_length(b) FROM test2;
<code class="computeroutput">
   b   | char_length
-------+-------------
 ok    |           2
 good  |           5
 too l |           5
</code></pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#co.datatype-char">(1)</a> </p></td><td valign="top" align="left"><p>Функция <code class="function">char_length</code> рассматривается в <a class="xref" href="functions-string.html" title="9.4. Строковые функции и операторы">Разделе 9.4</a>.</p></td></tr></table></div></div></div><br class="example-break" /><p>В <span class="productname">PostgreSQL</span> есть ещё два символьных типа фиксированной длины, приведённые в <a class="xref" href="datatype-character.html#DATATYPE-CHARACTER-SPECIAL-TABLE" title="Таблица 8.5. Специальные символьные типы">Таблице 8.5</a>. Они предназначены не для широкого применения, а для использования только во внутренних системных каталогах. Тип <code class="type">name</code> создан для хранения идентификаторов. В настоящее время его длина составляет 64 байта (63 ASCII-символа плюс завершающий ноль), но в исходном коде <code class="literal">C</code> она задаётся константой <code class="symbol">NAMEDATALEN</code>. Эта константа определяется во время компиляции (и её можно менять в особых случаях), а кроме того, максимальная длина по умолчанию может быть увеличена в следующих версиях. Тип <code class="type">"char"</code> (обратите внимание на кавычки) отличается от <code class="type">char(1)</code> тем, что он занимает только один байт хранилища и поэтому может хранить только один ASCII-символ. Он используется в системных каталогах для простых перечислений.</p><div class="table" id="DATATYPE-CHARACTER-SPECIAL-TABLE"><p class="title"><strong>Таблица 8.5. Специальные символьные типы</strong></p><div class="table-contents"><table class="table" summary="Специальные символьные типы" border="1"><colgroup><col /><col /><col /></colgroup><thead><tr><th>Name</th><th>Размер</th><th>Описание</th></tr></thead><tbody><tr><td><code class="type">"char"</code></td><td>1 байт</td><td>внутренний однобайтный тип</td></tr><tr><td><code class="type">name</code></td><td>64 байта</td><td>внутренний тип для имён объектов</td></tr></tbody></table></div></div><br class="table-break" /></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="datatype-money.html" title="8.2. Денежные типы">Пред.</a> </td><td width="20%" align="center"><a accesskey="u" href="datatype.html" title="Глава 8. Типы данных">Наверх</a></td><td width="40%" align="right"> <a accesskey="n" href="datatype-binary.html" title="8.4. Двоичные типы данных">След.</a></td></tr><tr><td width="40%" align="left" valign="top">8.2. Денежные типы </td><td width="20%" align="center"><a accesskey="h" href="index.html" title="Документация к PostgreSQL 16.3">Начало</a></td><td width="40%" align="right" valign="top"> 8.4. Двоичные типы данных</td></tr></table></div></body></html>