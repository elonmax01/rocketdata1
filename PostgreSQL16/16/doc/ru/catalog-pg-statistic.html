<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>53.51. pg_statistic</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@lists.postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot" /><link rel="prev" href="catalog-pg-shseclabel.html" title="53.50. pg_shseclabel" /><link rel="next" href="catalog-pg-statistic-ext.html" title="53.52. pg_statistic_ext" /></head><body id="docContent" class="container-fluid col-10"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">53.51. <code class="structname">pg_statistic</code></th></tr><tr><td width="10%" align="left"><a accesskey="p" href="catalog-pg-shseclabel.html" title="53.50. pg_shseclabel">Пред.</a> </td><td width="10%" align="left"><a accesskey="u" href="catalogs.html" title="Глава 53. Системные каталоги">Наверх</a></td><th width="60%" align="center">Глава 53. Системные каталоги</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="Документация к PostgreSQL 16.3">Начало</a></td><td width="10%" align="right"> <a accesskey="n" href="catalog-pg-statistic-ext.html" title="53.52. pg_statistic_ext">След.</a></td></tr></table><hr /></div><div class="sect1" id="CATALOG-PG-STATISTIC"><div class="titlepage"><div><div><h2 class="title" style="clear: both">53.51. <code class="structname">pg_statistic</code> <a href="#CATALOG-PG-STATISTIC" class="id_link">#</a></h2></div></div></div><a id="id-1.10.4.53.2" class="indexterm"></a><p>В каталоге <code class="structname">pg_statistic</code> хранится статистическая информация о содержимом базы данных. Записи в нём создаются командой <a class="link" href="sql-analyze.html" title="ANALYZE"><code class="command">ANALYZE</code></a>, а затем используются планировщиком запросов. Заметьте, что все эти данные по природе своей неточные, даже если предполагается, что они актуальны.</p><p>Обычно для каждого столбца, подлежащего анализу, в этом каталоге есть одна запись со значением <code class="structfield">stainherit</code> = <code class="literal">false</code>. Если у таблицы имеются секции или потомки в иерархии наследования, также создаётся вторая запись с <code class="structfield">stainherit</code> = <code class="literal">true</code>. Эта строка представляет статистику по столбцу в дереве наследования, то есть статистику по данным, которые возвратит запрос <code class="literal">SELECT <em class="replaceable"><code>столбец</code></em> FROM <em class="replaceable"><code>таблица</code></em>*</code>, тогда как строка с <code class="structfield">stainherit</code> = <code class="literal">false</code> представляет результаты запроса <code class="literal">SELECT <em class="replaceable"><code>столбец</code></em> FROM ONLY <em class="replaceable"><code>таблица</code></em></code>.</p><p>В <code class="structname">pg_statistic</code> также хранится статистическая информация о значениях выражений индексов. Она описывается так же, как если бы это были столбцы данных; в частности, <code class="structfield">starelid</code> ссылается на индекс. Однако для столбцов, задействуемых в индексе без выражений, дополнительная запись не добавляется, так как она повторяла бы запись для нижележащего столбца таблицы. В настоящее время во всех записях для выражений индексов <code class="structfield">stainherit</code> = <code class="literal">false</code>.</p><p>Так как для различных типов данных могут быть уместны различные типы статистики, в каталоге <code class="structname">pg_statistic</code> не делается конкретных предположений о том, какая статистика в нём хранится. Отдельные столбцы в <code class="structname">pg_statistic</code> выделены только для самых общих свойств (например, доля NULL). Всё остальное хранится в <span class="quote">«<span class="quote">слотах</span>»</span>, представляющих собой группы связанных столбцов, содержимое которых определяется кодовым числом в одном из столбцов слотов. За подробностями обратитесь к <code class="filename">src/include/catalog/pg_statistic.h</code>.</p><p>Каталог <code class="structname">pg_statistic</code> не должен быть доступен на чтение всем, так как даже статистическая информация о содержимом таблицы может считаться конфиденциальной. (Например, довольно интересны могут быть минимальные и максимальные значения в столбце зарплаты.) Поэтому существует <a class="link" href="view-pg-stats.html" title="54.27. pg_stats"><code class="structname">pg_stats</code></a> — доступное всем для чтения представление на базе <code class="structname">pg_statistic</code>, в котором выдаётся информация только по тем таблицам, которые может читать текущий пользователь.</p><div class="table" id="id-1.10.4.53.8"><p class="title"><strong>Таблица 53.51. Столбцы <code class="structname">pg_statistic</code></strong></p><div class="table-contents"><table class="table" summary="Столбцы pg_statistic" border="1"><colgroup><col /></colgroup><thead><tr><th class="catalog_table_entry"><p class="column_definition">Тип столбца</p>
      <p>Описание</p></th></tr></thead><tbody><tr><td class="catalog_table_entry"><p class="column_definition"><code class="structfield">starelid</code> <code class="type">oid</code> (ссылается на <a class="link" href="catalog-pg-class.html" title="53.11. pg_class"><code class="structname">pg_class</code></a>.<code class="structfield">oid</code>)</p>
      <p>Таблица (или индекс), к которой принадлежит описываемый столбец</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition"><code class="structfield">staattnum</code> <code class="type">int2</code> (ссылается на <a class="link" href="catalog-pg-attribute.html" title="53.7. pg_attribute"><code class="structname">pg_attribute</code></a>.<code class="structfield">attnum</code>)</p>
      <p>Номер описываемого столбца</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">stainherit</code> <code class="type">bool</code>
      </p>
      <p>Если true, в статистике учитываются значения из дочерних таблиц, а не только в указанном отношении</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">stanullfrac</code> <code class="type">float4</code>
      </p>
      <p>Доля записей, в которых этот столбец содержит NULL</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">stawidth</code> <code class="type">int4</code>
      </p>
      <p>Средний размер хранения не NULL-элементов, в байтах</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">stadistinct</code> <code class="type">float4</code>
      </p>
      <p>Число различных и отличных от NULL значений в столбце. Число больше нуля представляет фактическое количество различных значений. Если это число меньше нуля, его модуль представляет множитель для общего количества строк в таблице; например, для столбца, в котором примерно 80% значений не NULL, и каждое отличное от NULL значение в среднем повторяется дважды, может быть представлено значение <code class="structfield">stadistinct</code> = -0.4. Ноль означает, что количество различных значений неизвестно.</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">stakind<em class="replaceable"><code>N</code></em></code> <code class="type">int2</code>
      </p>
      <p>Кодовое число, определяющее род статистики, хранящейся в <em class="replaceable"><code>N</code></em>-ом <span class="quote">«<span class="quote">слоте</span>»</span> строки <code class="structname">pg_statistic</code> row.</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition"><code class="structfield">staop<em class="replaceable"><code>N</code></em></code> <code class="type">oid</code> (ссылается на <a class="link" href="catalog-pg-operator.html" title="53.34. pg_operator"><code class="structname">pg_operator</code></a>.<code class="structfield">oid</code>)</p>
      <p>Оператор, с которым была получена статистика, хранящаяся в <em class="replaceable"><code>N</code></em>-ом <span class="quote">«<span class="quote">слоте</span>»</span>. Например, для слота гистограммы это будет оператор <code class="literal">&lt;</code>, определяющий порядок сортировки данных. Ноль, если для получения статистики оператор не нужен.</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition"><code class="structfield">stacoll<em class="replaceable"><code>N</code></em></code> <code class="type">oid</code> (ссылается на <a class="link" href="catalog-pg-collation.html" title="53.12. pg_collation"><code class="structname">pg_collation</code></a>.<code class="structfield">oid</code>)</p>
      <p>Правило сортировки, с которым была получена статистика, хранящаяся в <em class="replaceable"><code>N</code></em>-ом <span class="quote">«<span class="quote">слоте</span>»</span>. Например, для слота гистограммы, построенной для сортируемого столбца, это будет правило сортировки, определяющее порядок сортировки данных. Для несортируемых данных это поле содержит 0.</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">stanumbers<em class="replaceable"><code>N</code></em></code> <code class="type">float4[]</code>
      </p>
      <p>Численная статистика соответствующего рода для <em class="replaceable"><code>N</code></em>-ного <span class="quote">«<span class="quote">слота</span>»</span>, либо NULL, если с этим родом слота не связаны числовые значения</p></td></tr><tr><td class="catalog_table_entry"><p class="column_definition">
       <code class="structfield">stavalues<em class="replaceable"><code>N</code></em></code> <code class="type">anyarray</code>
      </p>
      <p>Значения столбцов соответствующего рода для <em class="replaceable"><code>N</code></em>-го <span class="quote">«<span class="quote">слота</span>»</span>, либо NULL, если для этого рода слота не хранятся никакие значения. Все значения элементов массива фактически имеют тип данных столбца или связанный тип, например, тип элемента массива, так что определить типы эти столбцов более конкретно, чем <code class="type">anyarray</code>, нельзя.</p></td></tr></tbody></table></div></div><br class="table-break" /></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="catalog-pg-shseclabel.html" title="53.50. pg_shseclabel">Пред.</a> </td><td width="20%" align="center"><a accesskey="u" href="catalogs.html" title="Глава 53. Системные каталоги">Наверх</a></td><td width="40%" align="right"> <a accesskey="n" href="catalog-pg-statistic-ext.html" title="53.52. pg_statistic_ext">След.</a></td></tr><tr><td width="40%" align="left" valign="top">53.50. <code class="structname">pg_shseclabel</code> </td><td width="20%" align="center"><a accesskey="h" href="index.html" title="Документация к PostgreSQL 16.3">Начало</a></td><td width="40%" align="right" valign="top"> 53.52. <code class="structname">pg_statistic_ext</code></td></tr></table></div></body></html>