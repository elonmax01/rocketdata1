<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>B.2. Обработка недопустимых или неоднозначных значений даты/времени</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@lists.postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot" /><link rel="prev" href="datetime-input-rules.html" title="B.1. Интерпретация данных даты и времени" /><link rel="next" href="datetime-keywords.html" title="B.3. Ключевые слова для обозначения даты и времени" /></head><body id="docContent" class="container-fluid col-10"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">B.2. Обработка недопустимых или неоднозначных значений даты/времени</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="datetime-input-rules.html" title="B.1. Интерпретация данных даты и времени">Пред.</a> </td><td width="10%" align="left"><a accesskey="u" href="datetime-appendix.html" title="Приложение B. Поддержка даты и времени">Наверх</a></td><th width="60%" align="center">Приложение B. Поддержка даты и времени</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="Документация к PostgreSQL 16.3">Начало</a></td><td width="10%" align="right"> <a accesskey="n" href="datetime-keywords.html" title="B.3. Ключевые слова для обозначения даты и времени">След.</a></td></tr></table><hr /></div><div class="sect1" id="DATETIME-INVALID-INPUT"><div class="titlepage"><div><div><h2 class="title" style="clear: both">B.2. Обработка недопустимых или неоднозначных значений даты/времени <a href="#DATETIME-INVALID-INPUT" class="id_link">#</a></h2></div></div></div><p>Обычно, если строка даты/времени синтаксически корректна, но содержит поля со значениями вне допустимого диапазона, выдаётся ошибка. Например, не будет принята строка с числом 31 февраля.</p><p>Однако с учётом перевода часов на летнее время визуально корректная строка с датой/временем может указывать не несуществующий или неоднозначный момент времени. Такие значения тем не менее принимаются; для разрешения неоднозначности учитывается смещение от UTC. Например, в предположении, что значение <a class="xref" href="runtime-config-client.html#GUC-TIMEZONE">TimeZone</a> — <code class="literal">America/New_York</code>, рассмотрите следующий пример: </p><pre class="programlisting">=&gt; SELECT '2018-03-11 02:30'::timestamptz;
      timestamptz
------------------------
 2018-03-11 03:30:00-04
(1 row)</pre><p> Так как в этот день в данном часовом поясе стрелки часов переводились вперёд, по гражданским часам не существовал момент времени 2:30; они перескочили с 2:00 (EST) на 3:00 (EDT). <span class="productname">PostgreSQL</span> воспринимает заданное время, как если бы оно было стандартным временем (в часовом поясе UTC-5), в результате чего оно преобразуется в 3:30AM (в часовом поясе EDT или UTC-4).</p><p>И наоборот, рассмотрите поведение в случае перевода времени назад: </p><pre class="programlisting">=&gt; SELECT '2018-11-04 01:30'::timestamptz;
      timestamptz
------------------------
 2018-11-04 01:30:00-05
(1 row)</pre><p> В этот день возможны две интерпретации времени 1:30; сначала было 1:30 в часовом поясе EDT, а час спустя, после перевода часов назад с 2:00 на 1:00 и смены часового пояса с EDT на EST, наступило 1:30 в часовом поясе EST. Так же и в этом случае <span class="productname">PostgreSQL</span> интерпретирует заданное время, как если бы оно было стандартным (UTC-5). Мы можем выбрать другой момент, указав часовой пояс летнего времени: </p><pre class="programlisting">=&gt; SELECT '2018-11-04 01:30 EDT'::timestamptz;
      timestamptz
------------------------
 2018-11-04 01:30:00-04
(1 row)</pre><p>Точное правило, применяемое в таких случаях, звучит так: несуществующий момент времени, попадающий в интервал перевода часов вперёд, привязывается к смещению от UTC, действовавшему в данном часовом поясе до перевода, а неоднозначный момент времени, попадающий в оба интервала при переводе часов назад, привязывается к смещению от UTC, действующему после перевода. Для большинства часовых поясов это равносильно правилу <span class="quote">«<span class="quote">в случае неясности предпочитать интерпретацию со стандартным временем</span>»</span>.</p><p>В любом случае смещение от UTC, связанное с меткой времени, можно задать явно, добавив либо числовое смещение, либо аббревиатуру часового пояса, которой соответствует некоторое фиксированное смещение. Вышеприведённое правило применяется, только когда необходимо вычислить смещение от UTC для часового пояса, в котором оно меняется.</p></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="datetime-input-rules.html" title="B.1. Интерпретация данных даты и времени">Пред.</a> </td><td width="20%" align="center"><a accesskey="u" href="datetime-appendix.html" title="Приложение B. Поддержка даты и времени">Наверх</a></td><td width="40%" align="right"> <a accesskey="n" href="datetime-keywords.html" title="B.3. Ключевые слова для обозначения даты и времени">След.</a></td></tr><tr><td width="40%" align="left" valign="top">B.1. Интерпретация данных даты и времени </td><td width="20%" align="center"><a accesskey="h" href="index.html" title="Документация к PostgreSQL 16.3">Начало</a></td><td width="40%" align="right" valign="top"> B.3. Ключевые слова для обозначения даты и времени</td></tr></table></div></body></html>